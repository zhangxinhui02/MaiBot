import{r as m,j as e,L as Fn,e as ca,R as Rs,b as Q0,f as Y0,g as J0,h as X0,k as Z0,l as Qs,m as W0,n as ew,O as rj,o as sw}from"./router-9vIXuQkh.js";import{a as tw,b as aw,g as lw}from"./react-vendor-BmxF9s7Q.js";import{N as nw,c as rw,O as Wr,P as iw,g as Tm}from"./utils-BqoaXoQ1.js";import{L as ij,T as cj,C as oj,R as cw,a as dj,V as ow,b as dw,S as uj,c as uw,d as mj,I as mw,e as xj,f as xw,g as hj,h as hw,i as fw,j as pw,O as fj,P as gw,k as pj,l as gj,D as jj,A as vj,m as Nj,n as jw,o as vw,p as bj,q as Nw,r as yj,s as bw,t as yw,u as wj,v as ww,w as _w,x as _j,y as Sj,F as kj,z as Cj,B as Sw,E as kw,G as Tj,H as Cw,J as Tw,K as Ew,M as Mw,N as Aw,Q as zw,U as Rw,W as Dw,X as Ow,Y as Lw,Z as Uw,_ as $w,$ as Bw,a0 as Pw,a1 as Iw,a2 as Ej,a3 as Fw,a4 as Hw}from"./radix-extra-DmmnfeQE.js";import{R as Mj,T as Aj,L as Vw,g as Gw,C as Qi,X as Yi,Y as Hr,h as qw,B as Uo,j as Ji,P as Kw,k as Qw,l as Yw}from"./charts-simvewUa.js";import{S as Jw,O as zj,o as Xw,C as Rj,p as Zw,T as Dj,D as Oj,R as Ww,q as e_,H as Lj,I as s_,J as Uj,K as t_,L as $j,M as Bj,N as a_,Q as Pj,V as l_,U as Ij,X as Fj,Y as n_,Z as r_,_ as Hj,$ as i_,a0 as c_,a1 as Vj,e as Gj,f as sd,c as td,P as Zn,d as ad,b as gn,h as o_,l as d_,m as u_,u as qm,r as m_,a as x_,a2 as h_,a3 as qj,a4 as f_,a5 as p_,a6 as g_,a7 as Kj,a8 as Qj,a9 as Yj,aa as Jj,ab as Xj,ac as Zj,ad as j_}from"./radix-core-DyJi0yyw.js";import{R as dt,a as lc,C as _t,b as pt,L as zs,X as Aa,c as Ct,d as za,e as Qr,f as Da,g as Wt,E as v_,h as na,i as Ka,S as Tt,B as Vn,U as jn,P as hc,Z as el,j as Wj,F as Ea,k as N_,l as vn,m as b_,M as Ra,A as sx,D as y_,n as Yr,T as tx,o as w_,p as ev,I as Ft,q as Jt,r as Fo,s as nc,t as ia,H as __,u as ns,v as Xt,w as rc,x as ax,y as ec,z as bg,K as lx,G as sv,J as S_,N as $o,O as k_,Q as ld,V as C_,W as T_,Y as nd,_ as Ma,$ as et,a0 as nx,a1 as tv,a2 as fc,a3 as av,a4 as lv,a5 as Kn,a6 as Nn,a7 as bn,a8 as rx,a9 as nv,aa as ra,ab as Ll,ac as Qn,ad as Yn,ae as rd,af as E_,ag as M_,ah as A_,ai as ix,aj as Bo,ak as Jn,al as z_,am as Jr,an as Ho,ao as R_,ap as Vo,aq as ic,ar as rv,as as D_,at as O_,au as Go,av as L_,aw as cx,ax as U_,ay as yg,az as $_,aA as B_,aB as iv,aC as P_,aD as mn,aE as cv,aF as Em,aG as wg,aH as I_,aI as Mm,aJ as F_,aK as H_,aL as V_,aM as G_,aN as ov,aO as q_,aP as Xr,aQ as K_,aR as Q_,aS as dv,aT as uv,aU as Y_,aV as J_,aW as _g,aX as X_,aY as Z_,aZ as W_,a_ as e1,a$ as s1}from"./icons-9Z4kBNLK.js";import{S as t1,p as a1,j as l1,a as n1,E as Sg,R as r1,o as i1}from"./codemirror-TZqPU532.js";import{u as mv,a as qo,s as xv,K as hv,P as fv,b as pv,D as gv,c as jv,S as vv,v as c1,d as Nv,C as bv,h as o1}from"./dnd-BiPfFtVp.js";import{_ as ja,c as d1,g as yv,D as u1,z as Ro}from"./misc-CJqnlRwD.js";import{D as m1,U as x1}from"./uppy-DFP_VzYR.js";import{M as h1,r as f1,a as p1,b as g1}from"./markdown-CKA5gBQ9.js";import{c as j1,H as Ko,P as Qo,u as v1,d as N1,R as b1,B as y1,e as w1,C as _1,M as S1,f as k1}from"./reactflow-DtsZHOR4.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const u of d)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function r(d){const u={};return d.integrity&&(u.integrity=d.integrity),d.referrerPolicy&&(u.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?u.credentials="include":d.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function c(d){if(d.ep)return;d.ep=!0;const u=r(d);fetch(d.href,u)}})();var Am={exports:{}},Gi={},zm={exports:{}},Rm={};var kg;function C1(){return kg||(kg=1,(function(a){function n(M,K){var P=M.length;M.push(K);e:for(;0<P;){var ue=P-1>>>1,Q=M[ue];if(0<d(Q,K))M[ue]=K,M[P]=Q,P=ue;else break e}}function r(M){return M.length===0?null:M[0]}function c(M){if(M.length===0)return null;var K=M[0],P=M.pop();if(P!==K){M[0]=P;e:for(var ue=0,Q=M.length,Se=Q>>>1;ue<Se;){var pe=2*(ue+1)-1,Te=M[pe],z=pe+1,D=M[z];if(0>d(Te,P))z<Q&&0>d(D,Te)?(M[ue]=D,M[z]=P,ue=z):(M[ue]=Te,M[pe]=P,ue=pe);else if(z<Q&&0>d(D,P))M[ue]=D,M[z]=P,ue=z;else break e}}return K}function d(M,K){var P=M.sortIndex-K.sortIndex;return P!==0?P:M.id-K.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;a.unstable_now=function(){return u.now()}}else{var h=Date,f=h.now();a.unstable_now=function(){return h.now()-f}}var p=[],g=[],N=1,v=null,w=3,b=!1,y=!1,O=!1,R=!1,S=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function C(M){for(var K=r(g);K!==null;){if(K.callback===null)c(g);else if(K.startTime<=M)c(g),K.sortIndex=K.expirationTime,n(p,K);else break;K=r(g)}}function A(M){if(O=!1,C(M),!y)if(r(p)!==null)y=!0,F||(F=!0,je());else{var K=r(g);K!==null&&ge(A,K.startTime-M)}}var F=!1,L=-1,J=5,U=-1;function oe(){return R?!0:!(a.unstable_now()-U<J)}function Ne(){if(R=!1,F){var M=a.unstable_now();U=M;var K=!0;try{e:{y=!1,O&&(O=!1,B(L),L=-1),b=!0;var P=w;try{s:{for(C(M),v=r(p);v!==null&&!(v.expirationTime>M&&oe());){var ue=v.callback;if(typeof ue=="function"){v.callback=null,w=v.priorityLevel;var Q=ue(v.expirationTime<=M);if(M=a.unstable_now(),typeof Q=="function"){v.callback=Q,C(M),K=!0;break s}v===r(p)&&c(p),C(M)}else c(p);v=r(p)}if(v!==null)K=!0;else{var Se=r(g);Se!==null&&ge(A,Se.startTime-M),K=!1}}break e}finally{v=null,w=P,b=!1}K=void 0}}finally{K?je():F=!1}}}var je;if(typeof E=="function")je=function(){E(Ne)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,fe=re.port2;re.port1.onmessage=Ne,je=function(){fe.postMessage(null)}}else je=function(){S(Ne,0)};function ge(M,K){L=S(function(){M(a.unstable_now())},K)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(M){M.callback=null},a.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<M?Math.floor(1e3/M):5},a.unstable_getCurrentPriorityLevel=function(){return w},a.unstable_next=function(M){switch(w){case 1:case 2:case 3:var K=3;break;default:K=w}var P=w;w=K;try{return M()}finally{w=P}},a.unstable_requestPaint=function(){R=!0},a.unstable_runWithPriority=function(M,K){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var P=w;w=M;try{return K()}finally{w=P}},a.unstable_scheduleCallback=function(M,K,P){var ue=a.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?ue+P:ue):P=ue,M){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=P+Q,M={id:N++,callback:K,priorityLevel:M,startTime:P,expirationTime:Q,sortIndex:-1},P>ue?(M.sortIndex=P,n(g,M),r(p)===null&&M===r(g)&&(O?(B(L),L=-1):O=!0,ge(A,P-ue))):(M.sortIndex=Q,n(p,M),y||b||(y=!0,F||(F=!0,je()))),M},a.unstable_shouldYield=oe,a.unstable_wrapCallback=function(M){var K=w;return function(){var P=w;w=K;try{return M.apply(this,arguments)}finally{w=P}}}})(Rm)),Rm}var Cg;function T1(){return Cg||(Cg=1,zm.exports=C1()),zm.exports}var Tg;function E1(){if(Tg)return Gi;Tg=1;var a=T1(),n=tw(),r=aw();function c(s){var t="https://react.dev/errors/"+s;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)t+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var t=s,l=s;if(s.alternate)for(;t.return;)t=t.return;else{s=t;do t=s,(t.flags&4098)!==0&&(l=t.return),s=t.return;while(s)}return t.tag===3?l:null}function h(s){if(s.tag===13){var t=s.memoizedState;if(t===null&&(s=s.alternate,s!==null&&(t=s.memoizedState)),t!==null)return t.dehydrated}return null}function f(s){if(s.tag===31){var t=s.memoizedState;if(t===null&&(s=s.alternate,s!==null&&(t=s.memoizedState)),t!==null)return t.dehydrated}return null}function p(s){if(u(s)!==s)throw Error(c(188))}function g(s){var t=s.alternate;if(!t){if(t=u(s),t===null)throw Error(c(188));return t!==s?null:s}for(var l=s,i=t;;){var o=l.return;if(o===null)break;var x=o.alternate;if(x===null){if(i=o.return,i!==null){l=i;continue}break}if(o.child===x.child){for(x=o.child;x;){if(x===l)return p(o),s;if(x===i)return p(o),t;x=x.sibling}throw Error(c(188))}if(l.return!==i.return)l=o,i=x;else{for(var j=!1,k=o.child;k;){if(k===l){j=!0,l=o,i=x;break}if(k===i){j=!0,i=o,l=x;break}k=k.sibling}if(!j){for(k=x.child;k;){if(k===l){j=!0,l=x,i=o;break}if(k===i){j=!0,i=x,l=o;break}k=k.sibling}if(!j)throw Error(c(189))}}if(l.alternate!==i)throw Error(c(190))}if(l.tag!==3)throw Error(c(188));return l.stateNode.current===l?s:t}function N(s){var t=s.tag;if(t===5||t===26||t===27||t===6)return s;for(s=s.child;s!==null;){if(t=N(s),t!==null)return t;s=s.sibling}return null}var v=Object.assign,w=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),B=Symbol.for("react.consumer"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),oe=Symbol.for("react.memo_cache_sentinel"),Ne=Symbol.iterator;function je(s){return s===null||typeof s!="object"?null:(s=Ne&&s[Ne]||s["@@iterator"],typeof s=="function"?s:null)}var re=Symbol.for("react.client.reference");function fe(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===re?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case O:return"Fragment";case S:return"Profiler";case R:return"StrictMode";case A:return"Suspense";case F:return"SuspenseList";case U:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case y:return"Portal";case E:return s.displayName||"Context";case B:return(s._context.displayName||"Context")+".Consumer";case C:var t=s.render;return s=s.displayName,s||(s=t.displayName||t.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case L:return t=s.displayName||null,t!==null?t:fe(s.type)||"Memo";case J:t=s._payload,s=s._init;try{return fe(s(t))}catch{}}return null}var ge=Array.isArray,M=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P={pending:!1,data:null,method:null,action:null},ue=[],Q=-1;function Se(s){return{current:s}}function pe(s){0>Q||(s.current=ue[Q],ue[Q]=null,Q--)}function Te(s,t){Q++,ue[Q]=s.current,s.current=t}var z=Se(null),D=Se(null),G=Se(null),de=Se(null);function Re(s,t){switch(Te(G,t),Te(D,s),Te(z,null),t.nodeType){case 9:case 11:s=(s=t.documentElement)&&(s=s.namespaceURI)?Vp(s):0;break;default:if(s=t.tagName,t=t.namespaceURI)t=Vp(t),s=Gp(t,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}pe(z),Te(z,s)}function W(){pe(z),pe(D),pe(G)}function Y(s){s.memoizedState!==null&&Te(de,s);var t=z.current,l=Gp(t,s.type);t!==l&&(Te(D,s),Te(z,l))}function Fe(s){D.current===s&&(pe(z),pe(D)),de.current===s&&(pe(de),Ii._currentValue=P)}var H,ee;function Ue(s){if(H===void 0)try{throw Error()}catch(l){var t=l.stack.trim().match(/\n( *(at )?)/);H=t&&t[1]||"",ee=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+H+s+ee}var ie=!1;function Ee(s,t){if(!s||ie)return"";ie=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(xe){var ce=xe}Reflect.construct(s,[],ye)}else{try{ye.call()}catch(xe){ce=xe}s.call(ye.prototype)}}else{try{throw Error()}catch(xe){ce=xe}(ye=s())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(xe){if(xe&&ce&&typeof xe.stack=="string")return[xe.stack,ce.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var o=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");o&&o.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=i.DetermineComponentFrameRoot(),j=x[0],k=x[1];if(j&&k){var $=j.split(`
`),le=k.split(`
`);for(o=i=0;i<$.length&&!$[i].includes("DetermineComponentFrameRoot");)i++;for(;o<le.length&&!le[o].includes("DetermineComponentFrameRoot");)o++;if(i===$.length||o===le.length)for(i=$.length-1,o=le.length-1;1<=i&&0<=o&&$[i]!==le[o];)o--;for(;1<=i&&0<=o;i--,o--)if($[i]!==le[o]){if(i!==1||o!==1)do if(i--,o--,0>o||$[i]!==le[o]){var ve=`
`+$[i].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=i&&0<=o);break}}}finally{ie=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?Ue(l):""}function me(s,t){switch(s.tag){case 26:case 27:case 5:return Ue(s.type);case 16:return Ue("Lazy");case 13:return s.child!==t&&t!==null?Ue("Suspense Fallback"):Ue("Suspense");case 19:return Ue("SuspenseList");case 0:case 15:return Ee(s.type,!1);case 11:return Ee(s.type.render,!1);case 1:return Ee(s.type,!0);case 31:return Ue("Activity");default:return""}}function Ae(s){try{var t="",l=null;do t+=me(s,l),l=s,s=s.return;while(s);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var rs=Object.prototype.hasOwnProperty,Ut=a.unstable_scheduleCallback,aa=a.unstable_cancelCallback,Ja=a.unstable_shouldYield,Ht=a.unstable_requestPaint,mt=a.unstable_now,q=a.unstable_getCurrentPriorityLevel,qe=a.unstable_ImmediatePriority,Qe=a.unstable_UserBlockingPriority,es=a.unstable_NormalPriority,Us=a.unstable_LowPriority,as=a.unstable_IdlePriority,Cs=a.log,ze=a.unstable_setDisableYieldValue,bs=null,ls=null;function ss(s){if(typeof Cs=="function"&&ze(s),ls&&typeof ls.setStrictMode=="function")try{ls.setStrictMode(bs,s)}catch{}}var ys=Math.clz32?Math.clz32:tt,gt=Math.log,$t=Math.LN2;function tt(s){return s>>>=0,s===0?32:31-(gt(s)/$t|0)|0}var Ms=256,Et=262144,Bt=4194304;function Oa(s){var t=s&42;if(t!==0)return t;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ll(s,t,l){var i=s.pendingLanes;if(i===0)return 0;var o=0,x=s.suspendedLanes,j=s.pingedLanes;s=s.warmLanes;var k=i&134217727;return k!==0?(i=k&~x,i!==0?o=Oa(i):(j&=k,j!==0?o=Oa(j):l||(l=k&~s,l!==0&&(o=Oa(l))))):(k=i&~x,k!==0?o=Oa(k):j!==0?o=Oa(j):l||(l=i&~s,l!==0&&(o=Oa(l)))),o===0?0:t!==0&&t!==o&&(t&x)===0&&(x=o&-o,l=t&-t,x>=l||x===32&&(l&4194048)!==0)?t:o}function xl(s,t){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&t)===0}function sr(s,t){switch(s){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function se(){var s=Bt;return Bt<<=1,(Bt&62914560)===0&&(Bt=4194304),s}function we(s){for(var t=[],l=0;31>l;l++)t.push(s);return t}function Le(s,t){s.pendingLanes|=t,t!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Fs(s,t,l,i,o,x){var j=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var k=s.entanglements,$=s.expirationTimes,le=s.hiddenUpdates;for(l=j&~l;0<l;){var ve=31-ys(l),ye=1<<ve;k[ve]=0,$[ve]=-1;var ce=le[ve];if(ce!==null)for(le[ve]=null,ve=0;ve<ce.length;ve++){var xe=ce[ve];xe!==null&&(xe.lane&=-536870913)}l&=~ye}i!==0&&Dt(s,i,0),x!==0&&o===0&&s.tag!==0&&(s.suspendedLanes|=x&~(j&~t))}function Dt(s,t,l){s.pendingLanes|=t,s.suspendedLanes&=~t;var i=31-ys(t);s.entangledLanes|=t,s.entanglements[i]=s.entanglements[i]|1073741824|l&261930}function ea(s,t){var l=s.entangledLanes|=t;for(s=s.entanglements;l;){var i=31-ys(l),o=1<<i;o&t|s[i]&t&&(s[i]|=t),l&=~o}}function rt(s,t){var l=t&-t;return l=(l&42)!==0?1:sa(l),(l&(s.suspendedLanes|t))!==0?0:l}function sa(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function xt(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function ne(){var s=K.p;return s!==0?s:(s=window.event,s===void 0?32:hg(s.type))}function he(s,t){var l=K.p;try{return K.p=s,t()}finally{K.p=l}}var ts=Math.random().toString(36).slice(2),js="__reactFiber$"+ts,is="__reactProps$"+ts,jt="__reactContainer$"+ts,va="__reactEvents$"+ts,Il="__reactListeners$"+ts,tr="__reactHandles$"+ts,ti="__reactResources$"+ts,_n="__reactMarker$"+ts;function Nd(s){delete s[js],delete s[is],delete s[va],delete s[Il],delete s[tr]}function ar(s){var t=s[js];if(t)return t;for(var l=s.parentNode;l;){if(t=l[jt]||l[js]){if(l=t.alternate,t.child!==null||l!==null&&l.child!==null)for(s=Zp(s);s!==null;){if(l=s[js])return l;s=Zp(s)}return t}s=l,l=s.parentNode}return null}function lr(s){if(s=s[js]||s[jt]){var t=s.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return s}return null}function ai(s){var t=s.tag;if(t===5||t===26||t===27||t===6)return s.stateNode;throw Error(c(33))}function nr(s){var t=s[ti];return t||(t=s[ti]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Pt(s){s[_n]=!0}var Ax=new Set,zx={};function Sn(s,t){rr(s,t),rr(s+"Capture",t)}function rr(s,t){for(zx[s]=t,s=0;s<t.length;s++)Ax.add(t[s])}var Bb=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Rx={},Dx={};function Pb(s){return rs.call(Dx,s)?!0:rs.call(Rx,s)?!1:Bb.test(s)?Dx[s]=!0:(Rx[s]=!0,!1)}function Nc(s,t,l){if(Pb(t))if(l===null)s.removeAttribute(t);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){s.removeAttribute(t);return}}s.setAttribute(t,""+l)}}function bc(s,t,l){if(l===null)s.removeAttribute(t);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(t);return}s.setAttribute(t,""+l)}}function hl(s,t,l,i){if(i===null)s.removeAttribute(l);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(t,l,""+i)}}function La(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ox(s){var t=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ib(s,t,l){var i=Object.getOwnPropertyDescriptor(s.constructor.prototype,t);if(!s.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var o=i.get,x=i.set;return Object.defineProperty(s,t,{configurable:!0,get:function(){return o.call(this)},set:function(j){l=""+j,x.call(this,j)}}),Object.defineProperty(s,t,{enumerable:i.enumerable}),{getValue:function(){return l},setValue:function(j){l=""+j},stopTracking:function(){s._valueTracker=null,delete s[t]}}}}function bd(s){if(!s._valueTracker){var t=Ox(s)?"checked":"value";s._valueTracker=Ib(s,t,""+s[t])}}function Lx(s){if(!s)return!1;var t=s._valueTracker;if(!t)return!0;var l=t.getValue(),i="";return s&&(i=Ox(s)?s.checked?"true":"false":s.value),s=i,s!==l?(t.setValue(s),!0):!1}function yc(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Fb=/[\n"\\]/g;function Ua(s){return s.replace(Fb,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function yd(s,t,l,i,o,x,j,k){s.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?s.type=j:s.removeAttribute("type"),t!=null?j==="number"?(t===0&&s.value===""||s.value!=t)&&(s.value=""+La(t)):s.value!==""+La(t)&&(s.value=""+La(t)):j!=="submit"&&j!=="reset"||s.removeAttribute("value"),t!=null?wd(s,j,La(t)):l!=null?wd(s,j,La(l)):i!=null&&s.removeAttribute("value"),o==null&&x!=null&&(s.defaultChecked=!!x),o!=null&&(s.checked=o&&typeof o!="function"&&typeof o!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?s.name=""+La(k):s.removeAttribute("name")}function Ux(s,t,l,i,o,x,j,k){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.type=x),t!=null||l!=null){if(!(x!=="submit"&&x!=="reset"||t!=null)){bd(s);return}l=l!=null?""+La(l):"",t=t!=null?""+La(t):l,k||t===s.value||(s.value=t),s.defaultValue=t}i=i??o,i=typeof i!="function"&&typeof i!="symbol"&&!!i,s.checked=k?s.checked:!!i,s.defaultChecked=!!i,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(s.name=j),bd(s)}function wd(s,t,l){t==="number"&&yc(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function ir(s,t,l,i){if(s=s.options,t){t={};for(var o=0;o<l.length;o++)t["$"+l[o]]=!0;for(l=0;l<s.length;l++)o=t.hasOwnProperty("$"+s[l].value),s[l].selected!==o&&(s[l].selected=o),o&&i&&(s[l].defaultSelected=!0)}else{for(l=""+La(l),t=null,o=0;o<s.length;o++){if(s[o].value===l){s[o].selected=!0,i&&(s[o].defaultSelected=!0);return}t!==null||s[o].disabled||(t=s[o])}t!==null&&(t.selected=!0)}}function $x(s,t,l){if(t!=null&&(t=""+La(t),t!==s.value&&(s.value=t),l==null)){s.defaultValue!==t&&(s.defaultValue=t);return}s.defaultValue=l!=null?""+La(l):""}function Bx(s,t,l,i){if(t==null){if(i!=null){if(l!=null)throw Error(c(92));if(ge(i)){if(1<i.length)throw Error(c(93));i=i[0]}l=i}l==null&&(l=""),t=l}l=La(t),s.defaultValue=l,i=s.textContent,i===l&&i!==""&&i!==null&&(s.value=i),bd(s)}function cr(s,t){if(t){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=t;return}}s.textContent=t}var Hb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Px(s,t,l){var i=t.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?i?s.setProperty(t,""):t==="float"?s.cssFloat="":s[t]="":i?s.setProperty(t,l):typeof l!="number"||l===0||Hb.has(t)?t==="float"?s.cssFloat=l:s[t]=(""+l).trim():s[t]=l+"px"}function Ix(s,t,l){if(t!=null&&typeof t!="object")throw Error(c(62));if(s=s.style,l!=null){for(var i in l)!l.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="");for(var o in t)i=t[o],t.hasOwnProperty(o)&&l[o]!==i&&Px(s,o,i)}else for(var x in t)t.hasOwnProperty(x)&&Px(s,x,t[x])}function _d(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Gb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wc(s){return Gb.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function fl(){}var Sd=null;function kd(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var or=null,dr=null;function Fx(s){var t=lr(s);if(t&&(s=t.stateNode)){var l=s[is]||null;e:switch(s=t.stateNode,t.type){case"input":if(yd(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),t=l.name,l.type==="radio"&&t!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ua(""+t)+'"][type="radio"]'),t=0;t<l.length;t++){var i=l[t];if(i!==s&&i.form===s.form){var o=i[is]||null;if(!o)throw Error(c(90));yd(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name)}}for(t=0;t<l.length;t++)i=l[t],i.form===s.form&&Lx(i)}break e;case"textarea":$x(s,l.value,l.defaultValue);break e;case"select":t=l.value,t!=null&&ir(s,!!l.multiple,t,!1)}}}var Cd=!1;function Hx(s,t,l){if(Cd)return s(t,l);Cd=!0;try{var i=s(t);return i}finally{if(Cd=!1,(or!==null||dr!==null)&&(uo(),or&&(t=or,s=dr,dr=or=null,Fx(t),s)))for(t=0;t<s.length;t++)Fx(s[t])}}function li(s,t){var l=s.stateNode;if(l===null)return null;var i=l[is]||null;if(i===null)return null;l=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(s=s.type,i=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!i;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(c(231,t,typeof l));return l}var pl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Td=!1;if(pl)try{var ni={};Object.defineProperty(ni,"passive",{get:function(){Td=!0}}),window.addEventListener("test",ni,ni),window.removeEventListener("test",ni,ni)}catch{Td=!1}var Fl=null,Ed=null,_c=null;function Vx(){if(_c)return _c;var s,t=Ed,l=t.length,i,o="value"in Fl?Fl.value:Fl.textContent,x=o.length;for(s=0;s<l&&t[s]===o[s];s++);var j=l-s;for(i=1;i<=j&&t[l-i]===o[x-i];i++);return _c=o.slice(s,1<i?1-i:void 0)}function Sc(s){var t=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&t===13&&(s=13)):s=t,s===10&&(s=13),32<=s||s===13?s:0}function kc(){return!0}function Gx(){return!1}function da(s){function t(l,i,o,x,j){this._reactName=l,this._targetInst=o,this.type=i,this.nativeEvent=x,this.target=j,this.currentTarget=null;for(var k in s)s.hasOwnProperty(k)&&(l=s[k],this[k]=l?l(x):x[k]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?kc:Gx,this.isPropagationStopped=Gx,this}return v(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=kc)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=kc)},persist:function(){},isPersistent:kc}),t}var kn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cc=da(kn),ri=v({},kn,{view:0,detail:0}),qb=da(ri),Md,Ad,ii,Tc=v({},ri,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ii&&(ii&&s.type==="mousemove"?(Md=s.screenX-ii.screenX,Ad=s.screenY-ii.screenY):Ad=Md=0,ii=s),Md)},movementY:function(s){return"movementY"in s?s.movementY:Ad}}),qx=da(Tc),Kb=v({},Tc,{dataTransfer:0}),Qb=da(Kb),Yb=v({},ri,{relatedTarget:0}),zd=da(Yb),Jb=v({},kn,{animationName:0,elapsedTime:0,pseudoElement:0}),Xb=da(Jb),Zb=v({},kn,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Wb=da(Zb),ey=v({},kn,{data:0}),Kx=da(ey),sy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ty={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ay={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ly(s){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(s):(s=ay[s])?!!t[s]:!1}function Rd(){return ly}var ny=v({},ri,{key:function(s){if(s.key){var t=sy[s.key]||s.key;if(t!=="Unidentified")return t}return s.type==="keypress"?(s=Sc(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ty[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rd,charCode:function(s){return s.type==="keypress"?Sc(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Sc(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ry=da(ny),iy=v({},Tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qx=da(iy),cy=v({},ri,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rd}),oy=da(cy),dy=v({},kn,{propertyName:0,elapsedTime:0,pseudoElement:0}),uy=da(dy),my=v({},Tc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),xy=da(my),hy=v({},kn,{newState:0,oldState:0}),fy=da(hy),py=[9,13,27,32],Dd=pl&&"CompositionEvent"in window,ci=null;pl&&"documentMode"in document&&(ci=document.documentMode);var gy=pl&&"TextEvent"in window&&!ci,Yx=pl&&(!Dd||ci&&8<ci&&11>=ci),Jx=" ",Xx=!1;function Zx(s,t){switch(s){case"keyup":return py.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wx(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ur=!1;function jy(s,t){switch(s){case"compositionend":return Wx(t);case"keypress":return t.which!==32?null:(Xx=!0,Jx);case"textInput":return s=t.data,s===Jx&&Xx?null:s;default:return null}}function vy(s,t){if(ur)return s==="compositionend"||!Dd&&Zx(s,t)?(s=Vx(),_c=Ed=Fl=null,ur=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Yx&&t.locale!=="ko"?null:t.data;default:return null}}var Ny={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eh(s){var t=s&&s.nodeName&&s.nodeName.toLowerCase();return t==="input"?!!Ny[s.type]:t==="textarea"}function sh(s,t,l,i){or?dr?dr.push(i):dr=[i]:or=i,t=jo(t,"onChange"),0<t.length&&(l=new Cc("onChange","change",null,l,i),s.push({event:l,listeners:t}))}var oi=null,di=null;function by(s){$p(s,0)}function Ec(s){var t=ai(s);if(Lx(t))return s}function th(s,t){if(s==="change")return t}var ah=!1;if(pl){var Od;if(pl){var Ld="oninput"in document;if(!Ld){var lh=document.createElement("div");lh.setAttribute("oninput","return;"),Ld=typeof lh.oninput=="function"}Od=Ld}else Od=!1;ah=Od&&(!document.documentMode||9<document.documentMode)}function nh(){oi&&(oi.detachEvent("onpropertychange",rh),di=oi=null)}function rh(s){if(s.propertyName==="value"&&Ec(di)){var t=[];sh(t,di,s,kd(s)),Hx(by,t)}}function yy(s,t,l){s==="focusin"?(nh(),oi=t,di=l,oi.attachEvent("onpropertychange",rh)):s==="focusout"&&nh()}function wy(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ec(di)}function _y(s,t){if(s==="click")return Ec(t)}function Sy(s,t){if(s==="input"||s==="change")return Ec(t)}function ky(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var Na=typeof Object.is=="function"?Object.is:ky;function ui(s,t){if(Na(s,t))return!0;if(typeof s!="object"||s===null||typeof t!="object"||t===null)return!1;var l=Object.keys(s),i=Object.keys(t);if(l.length!==i.length)return!1;for(i=0;i<l.length;i++){var o=l[i];if(!rs.call(t,o)||!Na(s[o],t[o]))return!1}return!0}function ih(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ch(s,t){var l=ih(s);s=0;for(var i;l;){if(l.nodeType===3){if(i=s+l.textContent.length,s<=t&&i>=t)return{node:l,offset:t-s};s=i}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=ih(l)}}function oh(s,t){return s&&t?s===t?!0:s&&s.nodeType===3?!1:t&&t.nodeType===3?oh(s,t.parentNode):"contains"in s?s.contains(t):s.compareDocumentPosition?!!(s.compareDocumentPosition(t)&16):!1:!1}function dh(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var t=yc(s.document);t instanceof s.HTMLIFrameElement;){try{var l=typeof t.contentWindow.location.href=="string"}catch{l=!1}if(l)s=t.contentWindow;else break;t=yc(s.document)}return t}function Ud(s){var t=s&&s.nodeName&&s.nodeName.toLowerCase();return t&&(t==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||t==="textarea"||s.contentEditable==="true")}var Cy=pl&&"documentMode"in document&&11>=document.documentMode,mr=null,$d=null,mi=null,Bd=!1;function uh(s,t,l){var i=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Bd||mr==null||mr!==yc(i)||(i=mr,"selectionStart"in i&&Ud(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),mi&&ui(mi,i)||(mi=i,i=jo($d,"onSelect"),0<i.length&&(t=new Cc("onSelect","select",null,t,l),s.push({event:t,listeners:i}),t.target=mr)))}function Cn(s,t){var l={};return l[s.toLowerCase()]=t.toLowerCase(),l["Webkit"+s]="webkit"+t,l["Moz"+s]="moz"+t,l}var xr={animationend:Cn("Animation","AnimationEnd"),animationiteration:Cn("Animation","AnimationIteration"),animationstart:Cn("Animation","AnimationStart"),transitionrun:Cn("Transition","TransitionRun"),transitionstart:Cn("Transition","TransitionStart"),transitioncancel:Cn("Transition","TransitionCancel"),transitionend:Cn("Transition","TransitionEnd")},Pd={},mh={};pl&&(mh=document.createElement("div").style,"AnimationEvent"in window||(delete xr.animationend.animation,delete xr.animationiteration.animation,delete xr.animationstart.animation),"TransitionEvent"in window||delete xr.transitionend.transition);function Tn(s){if(Pd[s])return Pd[s];if(!xr[s])return s;var t=xr[s],l;for(l in t)if(t.hasOwnProperty(l)&&l in mh)return Pd[s]=t[l];return s}var xh=Tn("animationend"),hh=Tn("animationiteration"),fh=Tn("animationstart"),Ty=Tn("transitionrun"),Ey=Tn("transitionstart"),My=Tn("transitioncancel"),ph=Tn("transitionend"),gh=new Map,Id="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Id.push("scrollEnd");function Xa(s,t){gh.set(s,t),Sn(t,[s])}var Mc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},$a=[],hr=0,Fd=0;function Ac(){for(var s=hr,t=Fd=hr=0;t<s;){var l=$a[t];$a[t++]=null;var i=$a[t];$a[t++]=null;var o=$a[t];$a[t++]=null;var x=$a[t];if($a[t++]=null,i!==null&&o!==null){var j=i.pending;j===null?o.next=o:(o.next=j.next,j.next=o),i.pending=o}x!==0&&jh(l,o,x)}}function zc(s,t,l,i){$a[hr++]=s,$a[hr++]=t,$a[hr++]=l,$a[hr++]=i,Fd|=i,s.lanes|=i,s=s.alternate,s!==null&&(s.lanes|=i)}function Hd(s,t,l,i){return zc(s,t,l,i),Rc(s)}function En(s,t){return zc(s,null,null,t),Rc(s)}function jh(s,t,l){s.lanes|=l;var i=s.alternate;i!==null&&(i.lanes|=l);for(var o=!1,x=s.return;x!==null;)x.childLanes|=l,i=x.alternate,i!==null&&(i.childLanes|=l),x.tag===22&&(s=x.stateNode,s===null||s._visibility&1||(o=!0)),s=x,x=x.return;return s.tag===3?(x=s.stateNode,o&&t!==null&&(o=31-ys(l),s=x.hiddenUpdates,i=s[o],i===null?s[o]=[t]:i.push(t),t.lane=l|536870912),x):null}function Rc(s){if(50<Di)throw Di=0,Zu=null,Error(c(185));for(var t=s.return;t!==null;)s=t,t=s.return;return s.tag===3?s.stateNode:null}var fr={};function Ay(s,t,l,i){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ba(s,t,l,i){return new Ay(s,t,l,i)}function Vd(s){return s=s.prototype,!(!s||!s.isReactComponent)}function gl(s,t){var l=s.alternate;return l===null?(l=ba(s.tag,t,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=t,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,t=s.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function vh(s,t){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s}function Dc(s,t,l,i,o,x){var j=0;if(i=s,typeof s=="function")Vd(s)&&(j=1);else if(typeof s=="string")j=L0(s,l,z.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case U:return s=ba(31,l,t,o),s.elementType=U,s.lanes=x,s;case O:return Mn(l.children,o,x,t);case R:j=8,o|=24;break;case S:return s=ba(12,l,t,o|2),s.elementType=S,s.lanes=x,s;case A:return s=ba(13,l,t,o),s.elementType=A,s.lanes=x,s;case F:return s=ba(19,l,t,o),s.elementType=F,s.lanes=x,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case E:j=10;break e;case B:j=9;break e;case C:j=11;break e;case L:j=14;break e;case J:j=16,i=null;break e}j=29,l=Error(c(130,s===null?"null":typeof s,"")),i=null}return t=ba(j,l,t,o),t.elementType=s,t.type=i,t.lanes=x,t}function Mn(s,t,l,i){return s=ba(7,s,i,t),s.lanes=l,s}function Gd(s,t,l){return s=ba(6,s,null,t),s.lanes=l,s}function Nh(s){var t=ba(18,null,null,0);return t.stateNode=s,t}function qd(s,t,l){return t=ba(4,s.children!==null?s.children:[],s.key,t),t.lanes=l,t.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},t}var bh=new WeakMap;function Ba(s,t){if(typeof s=="object"&&s!==null){var l=bh.get(s);return l!==void 0?l:(t={value:s,source:t,stack:Ae(t)},bh.set(s,t),t)}return{value:s,source:t,stack:Ae(t)}}var pr=[],gr=0,Oc=null,xi=0,Pa=[],Ia=0,Hl=null,nl=1,rl="";function jl(s,t){pr[gr++]=xi,pr[gr++]=Oc,Oc=s,xi=t}function yh(s,t,l){Pa[Ia++]=nl,Pa[Ia++]=rl,Pa[Ia++]=Hl,Hl=s;var i=nl;s=rl;var o=32-ys(i)-1;i&=~(1<<o),l+=1;var x=32-ys(t)+o;if(30<x){var j=o-o%5;x=(i&(1<<j)-1).toString(32),i>>=j,o-=j,nl=1<<32-ys(t)+o|l<<o|i,rl=x+s}else nl=1<<x|l<<o|i,rl=s}function Kd(s){s.return!==null&&(jl(s,1),yh(s,1,0))}function Qd(s){for(;s===Oc;)Oc=pr[--gr],pr[gr]=null,xi=pr[--gr],pr[gr]=null;for(;s===Hl;)Hl=Pa[--Ia],Pa[Ia]=null,rl=Pa[--Ia],Pa[Ia]=null,nl=Pa[--Ia],Pa[Ia]=null}function wh(s,t){Pa[Ia++]=nl,Pa[Ia++]=rl,Pa[Ia++]=Hl,nl=t.id,rl=t.overflow,Hl=s}var Vt=null,it=null,As=!1,Vl=null,Fa=!1,Yd=Error(c(519));function Gl(s){var t=Error(c(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hi(Ba(t,s)),Yd}function _h(s){var t=s.stateNode,l=s.type,i=s.memoizedProps;switch(t[js]=s,t[is]=i,l){case"dialog":Ss("cancel",t),Ss("close",t);break;case"iframe":case"object":case"embed":Ss("load",t);break;case"video":case"audio":for(l=0;l<Li.length;l++)Ss(Li[l],t);break;case"source":Ss("error",t);break;case"img":case"image":case"link":Ss("error",t),Ss("load",t);break;case"details":Ss("toggle",t);break;case"input":Ss("invalid",t),Ux(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Ss("invalid",t);break;case"textarea":Ss("invalid",t),Bx(t,i.value,i.defaultValue,i.children)}l=i.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||t.textContent===""+l||i.suppressHydrationWarning===!0||Fp(t.textContent,l)?(i.popover!=null&&(Ss("beforetoggle",t),Ss("toggle",t)),i.onScroll!=null&&Ss("scroll",t),i.onScrollEnd!=null&&Ss("scrollend",t),i.onClick!=null&&(t.onclick=fl),t=!0):t=!1,t||Gl(s,!0)}function Sh(s){for(Vt=s.return;Vt;)switch(Vt.tag){case 5:case 31:case 13:Fa=!1;return;case 27:case 3:Fa=!0;return;default:Vt=Vt.return}}function jr(s){if(s!==Vt)return!1;if(!As)return Sh(s),As=!0,!1;var t=s.tag,l;if((l=t!==3&&t!==27)&&((l=t===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||xm(s.type,s.memoizedProps)),l=!l),l&&it&&Gl(s),Sh(s),t===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));it=Xp(s)}else if(t===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));it=Xp(s)}else t===27?(t=it,nn(s.type)?(s=jm,jm=null,it=s):it=t):it=Vt?Va(s.stateNode.nextSibling):null;return!0}function An(){it=Vt=null,As=!1}function Jd(){var s=Vl;return s!==null&&(ha===null?ha=s:ha.push.apply(ha,s),Vl=null),s}function hi(s){Vl===null?Vl=[s]:Vl.push(s)}var Xd=Se(null),zn=null,vl=null;function ql(s,t,l){Te(Xd,t._currentValue),t._currentValue=l}function Nl(s){s._currentValue=Xd.current,pe(Xd)}function Zd(s,t,l){for(;s!==null;){var i=s.alternate;if((s.childLanes&t)!==t?(s.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),s===l)break;s=s.return}}function Wd(s,t,l,i){var o=s.child;for(o!==null&&(o.return=s);o!==null;){var x=o.dependencies;if(x!==null){var j=o.child;x=x.firstContext;e:for(;x!==null;){var k=x;x=o;for(var $=0;$<t.length;$++)if(k.context===t[$]){x.lanes|=l,k=x.alternate,k!==null&&(k.lanes|=l),Zd(x.return,l,s),i||(j=null);break e}x=k.next}}else if(o.tag===18){if(j=o.return,j===null)throw Error(c(341));j.lanes|=l,x=j.alternate,x!==null&&(x.lanes|=l),Zd(j,l,s),j=null}else j=o.child;if(j!==null)j.return=o;else for(j=o;j!==null;){if(j===s){j=null;break}if(o=j.sibling,o!==null){o.return=j.return,j=o;break}j=j.return}o=j}}function vr(s,t,l,i){s=null;for(var o=t,x=!1;o!==null;){if(!x){if((o.flags&524288)!==0)x=!0;else if((o.flags&262144)!==0)break}if(o.tag===10){var j=o.alternate;if(j===null)throw Error(c(387));if(j=j.memoizedProps,j!==null){var k=o.type;Na(o.pendingProps.value,j.value)||(s!==null?s.push(k):s=[k])}}else if(o===de.current){if(j=o.alternate,j===null)throw Error(c(387));j.memoizedState.memoizedState!==o.memoizedState.memoizedState&&(s!==null?s.push(Ii):s=[Ii])}o=o.return}s!==null&&Wd(t,s,l,i),t.flags|=262144}function Lc(s){for(s=s.firstContext;s!==null;){if(!Na(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Rn(s){zn=s,vl=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Gt(s){return kh(zn,s)}function Uc(s,t){return zn===null&&Rn(s),kh(s,t)}function kh(s,t){var l=t._currentValue;if(t={context:t,memoizedValue:l,next:null},vl===null){if(s===null)throw Error(c(308));vl=t,s.dependencies={lanes:0,firstContext:t},s.flags|=524288}else vl=vl.next=t;return l}var zy=typeof AbortController<"u"?AbortController:function(){var s=[],t=this.signal={aborted:!1,addEventListener:function(l,i){s.push(i)}};this.abort=function(){t.aborted=!0,s.forEach(function(l){return l()})}},Ry=a.unstable_scheduleCallback,Dy=a.unstable_NormalPriority,Mt={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function eu(){return{controller:new zy,data:new Map,refCount:0}}function fi(s){s.refCount--,s.refCount===0&&Ry(Dy,function(){s.controller.abort()})}var pi=null,su=0,Nr=0,br=null;function Oy(s,t){if(pi===null){var l=pi=[];su=0,Nr=lm(),br={status:"pending",value:void 0,then:function(i){l.push(i)}}}return su++,t.then(Ch,Ch),t}function Ch(){if(--su===0&&pi!==null){br!==null&&(br.status="fulfilled");var s=pi;pi=null,Nr=0,br=null;for(var t=0;t<s.length;t++)(0,s[t])()}}function Ly(s,t){var l=[],i={status:"pending",value:null,reason:null,then:function(o){l.push(o)}};return s.then(function(){i.status="fulfilled",i.value=t;for(var o=0;o<l.length;o++)(0,l[o])(t)},function(o){for(i.status="rejected",i.reason=o,o=0;o<l.length;o++)(0,l[o])(void 0)}),i}var Th=M.S;M.S=function(s,t){mp=mt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Oy(s,t),Th!==null&&Th(s,t)};var Dn=Se(null);function tu(){var s=Dn.current;return s!==null?s:Ws.pooledCache}function $c(s,t){t===null?Te(Dn,Dn.current):Te(Dn,t.pool)}function Eh(){var s=tu();return s===null?null:{parent:Mt._currentValue,pool:s}}var yr=Error(c(460)),au=Error(c(474)),Bc=Error(c(542)),Pc={then:function(){}};function Mh(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Ah(s,t,l){switch(l=s[l],l===void 0?s.push(t):l!==t&&(t.then(fl,fl),t=l),t.status){case"fulfilled":return t.value;case"rejected":throw s=t.reason,Rh(s),s;default:if(typeof t.status=="string")t.then(fl,fl);else{if(s=Ws,s!==null&&100<s.shellSuspendCounter)throw Error(c(482));s=t,s.status="pending",s.then(function(i){if(t.status==="pending"){var o=t;o.status="fulfilled",o.value=i}},function(i){if(t.status==="pending"){var o=t;o.status="rejected",o.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw s=t.reason,Rh(s),s}throw Ln=t,yr}}function On(s){try{var t=s._init;return t(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Ln=l,yr):l}}var Ln=null;function zh(){if(Ln===null)throw Error(c(459));var s=Ln;return Ln=null,s}function Rh(s){if(s===yr||s===Bc)throw Error(c(483))}var wr=null,gi=0;function Ic(s){var t=gi;return gi+=1,wr===null&&(wr=[]),Ah(wr,s,t)}function ji(s,t){t=t.props.ref,s.ref=t!==void 0?t:null}function Fc(s,t){throw t.$$typeof===w?Error(c(525)):(s=Object.prototype.toString.call(t),Error(c(31,s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)))}function Dh(s){function t(X,V){if(s){var te=X.deletions;te===null?(X.deletions=[V],X.flags|=16):te.push(V)}}function l(X,V){if(!s)return null;for(;V!==null;)t(X,V),V=V.sibling;return null}function i(X){for(var V=new Map;X!==null;)X.key!==null?V.set(X.key,X):V.set(X.index,X),X=X.sibling;return V}function o(X,V){return X=gl(X,V),X.index=0,X.sibling=null,X}function x(X,V,te){return X.index=te,s?(te=X.alternate,te!==null?(te=te.index,te<V?(X.flags|=67108866,V):te):(X.flags|=67108866,V)):(X.flags|=1048576,V)}function j(X){return s&&X.alternate===null&&(X.flags|=67108866),X}function k(X,V,te,be){return V===null||V.tag!==6?(V=Gd(te,X.mode,be),V.return=X,V):(V=o(V,te),V.return=X,V)}function $(X,V,te,be){var Ye=te.type;return Ye===O?ve(X,V,te.props.children,be,te.key):V!==null&&(V.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===J&&On(Ye)===V.type)?(V=o(V,te.props),ji(V,te),V.return=X,V):(V=Dc(te.type,te.key,te.props,null,X.mode,be),ji(V,te),V.return=X,V)}function le(X,V,te,be){return V===null||V.tag!==4||V.stateNode.containerInfo!==te.containerInfo||V.stateNode.implementation!==te.implementation?(V=qd(te,X.mode,be),V.return=X,V):(V=o(V,te.children||[]),V.return=X,V)}function ve(X,V,te,be,Ye){return V===null||V.tag!==7?(V=Mn(te,X.mode,be,Ye),V.return=X,V):(V=o(V,te),V.return=X,V)}function ye(X,V,te){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return V=Gd(""+V,X.mode,te),V.return=X,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case b:return te=Dc(V.type,V.key,V.props,null,X.mode,te),ji(te,V),te.return=X,te;case y:return V=qd(V,X.mode,te),V.return=X,V;case J:return V=On(V),ye(X,V,te)}if(ge(V)||je(V))return V=Mn(V,X.mode,te,null),V.return=X,V;if(typeof V.then=="function")return ye(X,Ic(V),te);if(V.$$typeof===E)return ye(X,Uc(X,V),te);Fc(X,V)}return null}function ce(X,V,te,be){var Ye=V!==null?V.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return Ye!==null?null:k(X,V,""+te,be);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case b:return te.key===Ye?$(X,V,te,be):null;case y:return te.key===Ye?le(X,V,te,be):null;case J:return te=On(te),ce(X,V,te,be)}if(ge(te)||je(te))return Ye!==null?null:ve(X,V,te,be,null);if(typeof te.then=="function")return ce(X,V,Ic(te),be);if(te.$$typeof===E)return ce(X,V,Uc(X,te),be);Fc(X,te)}return null}function xe(X,V,te,be,Ye){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return X=X.get(te)||null,k(V,X,""+be,Ye);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case b:return X=X.get(be.key===null?te:be.key)||null,$(V,X,be,Ye);case y:return X=X.get(be.key===null?te:be.key)||null,le(V,X,be,Ye);case J:return be=On(be),xe(X,V,te,be,Ye)}if(ge(be)||je(be))return X=X.get(te)||null,ve(V,X,be,Ye,null);if(typeof be.then=="function")return xe(X,V,te,Ic(be),Ye);if(be.$$typeof===E)return xe(X,V,te,Uc(V,be),Ye);Fc(V,be)}return null}function He(X,V,te,be){for(var Ye=null,$s=null,Ge=V,ds=V=0,Es=null;Ge!==null&&ds<te.length;ds++){Ge.index>ds?(Es=Ge,Ge=null):Es=Ge.sibling;var Bs=ce(X,Ge,te[ds],be);if(Bs===null){Ge===null&&(Ge=Es);break}s&&Ge&&Bs.alternate===null&&t(X,Ge),V=x(Bs,V,ds),$s===null?Ye=Bs:$s.sibling=Bs,$s=Bs,Ge=Es}if(ds===te.length)return l(X,Ge),As&&jl(X,ds),Ye;if(Ge===null){for(;ds<te.length;ds++)Ge=ye(X,te[ds],be),Ge!==null&&(V=x(Ge,V,ds),$s===null?Ye=Ge:$s.sibling=Ge,$s=Ge);return As&&jl(X,ds),Ye}for(Ge=i(Ge);ds<te.length;ds++)Es=xe(Ge,X,ds,te[ds],be),Es!==null&&(s&&Es.alternate!==null&&Ge.delete(Es.key===null?ds:Es.key),V=x(Es,V,ds),$s===null?Ye=Es:$s.sibling=Es,$s=Es);return s&&Ge.forEach(function(un){return t(X,un)}),As&&jl(X,ds),Ye}function Ze(X,V,te,be){if(te==null)throw Error(c(151));for(var Ye=null,$s=null,Ge=V,ds=V=0,Es=null,Bs=te.next();Ge!==null&&!Bs.done;ds++,Bs=te.next()){Ge.index>ds?(Es=Ge,Ge=null):Es=Ge.sibling;var un=ce(X,Ge,Bs.value,be);if(un===null){Ge===null&&(Ge=Es);break}s&&Ge&&un.alternate===null&&t(X,Ge),V=x(un,V,ds),$s===null?Ye=un:$s.sibling=un,$s=un,Ge=Es}if(Bs.done)return l(X,Ge),As&&jl(X,ds),Ye;if(Ge===null){for(;!Bs.done;ds++,Bs=te.next())Bs=ye(X,Bs.value,be),Bs!==null&&(V=x(Bs,V,ds),$s===null?Ye=Bs:$s.sibling=Bs,$s=Bs);return As&&jl(X,ds),Ye}for(Ge=i(Ge);!Bs.done;ds++,Bs=te.next())Bs=xe(Ge,X,ds,Bs.value,be),Bs!==null&&(s&&Bs.alternate!==null&&Ge.delete(Bs.key===null?ds:Bs.key),V=x(Bs,V,ds),$s===null?Ye=Bs:$s.sibling=Bs,$s=Bs);return s&&Ge.forEach(function(K0){return t(X,K0)}),As&&jl(X,ds),Ye}function Zs(X,V,te,be){if(typeof te=="object"&&te!==null&&te.type===O&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case b:e:{for(var Ye=te.key;V!==null;){if(V.key===Ye){if(Ye=te.type,Ye===O){if(V.tag===7){l(X,V.sibling),be=o(V,te.props.children),be.return=X,X=be;break e}}else if(V.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===J&&On(Ye)===V.type){l(X,V.sibling),be=o(V,te.props),ji(be,te),be.return=X,X=be;break e}l(X,V);break}else t(X,V);V=V.sibling}te.type===O?(be=Mn(te.props.children,X.mode,be,te.key),be.return=X,X=be):(be=Dc(te.type,te.key,te.props,null,X.mode,be),ji(be,te),be.return=X,X=be)}return j(X);case y:e:{for(Ye=te.key;V!==null;){if(V.key===Ye)if(V.tag===4&&V.stateNode.containerInfo===te.containerInfo&&V.stateNode.implementation===te.implementation){l(X,V.sibling),be=o(V,te.children||[]),be.return=X,X=be;break e}else{l(X,V);break}else t(X,V);V=V.sibling}be=qd(te,X.mode,be),be.return=X,X=be}return j(X);case J:return te=On(te),Zs(X,V,te,be)}if(ge(te))return He(X,V,te,be);if(je(te)){if(Ye=je(te),typeof Ye!="function")throw Error(c(150));return te=Ye.call(te),Ze(X,V,te,be)}if(typeof te.then=="function")return Zs(X,V,Ic(te),be);if(te.$$typeof===E)return Zs(X,V,Uc(X,te),be);Fc(X,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,V!==null&&V.tag===6?(l(X,V.sibling),be=o(V,te),be.return=X,X=be):(l(X,V),be=Gd(te,X.mode,be),be.return=X,X=be),j(X)):l(X,V)}return function(X,V,te,be){try{gi=0;var Ye=Zs(X,V,te,be);return wr=null,Ye}catch(Ge){if(Ge===yr||Ge===Bc)throw Ge;var $s=ba(29,Ge,null,X.mode);return $s.lanes=be,$s.return=X,$s}finally{}}}var Un=Dh(!0),Oh=Dh(!1),Kl=!1;function lu(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nu(s,t){s=s.updateQueue,t.updateQueue===s&&(t.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ql(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Yl(s,t,l){var i=s.updateQueue;if(i===null)return null;if(i=i.shared,(Is&2)!==0){var o=i.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),i.pending=t,t=Rc(s),jh(s,null,l),t}return zc(s,i,t,l),Rc(s)}function vi(s,t,l){if(t=t.updateQueue,t!==null&&(t=t.shared,(l&4194048)!==0)){var i=t.lanes;i&=s.pendingLanes,l|=i,t.lanes=l,ea(s,l)}}function ru(s,t){var l=s.updateQueue,i=s.alternate;if(i!==null&&(i=i.updateQueue,l===i)){var o=null,x=null;if(l=l.firstBaseUpdate,l!==null){do{var j={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};x===null?o=x=j:x=x.next=j,l=l.next}while(l!==null);x===null?o=x=t:x=x.next=t}else o=x=t;l={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:x,shared:i.shared,callbacks:i.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=t:s.next=t,l.lastBaseUpdate=t}var iu=!1;function Ni(){if(iu){var s=br;if(s!==null)throw s}}function bi(s,t,l,i){iu=!1;var o=s.updateQueue;Kl=!1;var x=o.firstBaseUpdate,j=o.lastBaseUpdate,k=o.shared.pending;if(k!==null){o.shared.pending=null;var $=k,le=$.next;$.next=null,j===null?x=le:j.next=le,j=$;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,k=ve.lastBaseUpdate,k!==j&&(k===null?ve.firstBaseUpdate=le:k.next=le,ve.lastBaseUpdate=$))}if(x!==null){var ye=o.baseState;j=0,ve=le=$=null,k=x;do{var ce=k.lane&-536870913,xe=ce!==k.lane;if(xe?(Ts&ce)===ce:(i&ce)===ce){ce!==0&&ce===Nr&&(iu=!0),ve!==null&&(ve=ve.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var He=s,Ze=k;ce=t;var Zs=l;switch(Ze.tag){case 1:if(He=Ze.payload,typeof He=="function"){ye=He.call(Zs,ye,ce);break e}ye=He;break e;case 3:He.flags=He.flags&-65537|128;case 0:if(He=Ze.payload,ce=typeof He=="function"?He.call(Zs,ye,ce):He,ce==null)break e;ye=v({},ye,ce);break e;case 2:Kl=!0}}ce=k.callback,ce!==null&&(s.flags|=64,xe&&(s.flags|=8192),xe=o.callbacks,xe===null?o.callbacks=[ce]:xe.push(ce))}else xe={lane:ce,tag:k.tag,payload:k.payload,callback:k.callback,next:null},ve===null?(le=ve=xe,$=ye):ve=ve.next=xe,j|=ce;if(k=k.next,k===null){if(k=o.shared.pending,k===null)break;xe=k,k=xe.next,xe.next=null,o.lastBaseUpdate=xe,o.shared.pending=null}}while(!0);ve===null&&($=ye),o.baseState=$,o.firstBaseUpdate=le,o.lastBaseUpdate=ve,x===null&&(o.shared.lanes=0),en|=j,s.lanes=j,s.memoizedState=ye}}function Lh(s,t){if(typeof s!="function")throw Error(c(191,s));s.call(t)}function Uh(s,t){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)Lh(l[s],t)}var _r=Se(null),Hc=Se(0);function $h(s,t){s=El,Te(Hc,s),Te(_r,t),El=s|t.baseLanes}function cu(){Te(Hc,El),Te(_r,_r.current)}function ou(){El=Hc.current,pe(_r),pe(Hc)}var ya=Se(null),Ha=null;function Jl(s){var t=s.alternate;Te(St,St.current&1),Te(ya,s),Ha===null&&(t===null||_r.current!==null||t.memoizedState!==null)&&(Ha=s)}function du(s){Te(St,St.current),Te(ya,s),Ha===null&&(Ha=s)}function Bh(s){s.tag===22?(Te(St,St.current),Te(ya,s),Ha===null&&(Ha=s)):Xl()}function Xl(){Te(St,St.current),Te(ya,ya.current)}function wa(s){pe(ya),Ha===s&&(Ha=null),pe(St)}var St=Se(0);function Vc(s){for(var t=s;t!==null;){if(t.tag===13){var l=t.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||pm(l)||gm(l)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break;for(;t.sibling===null;){if(t.return===null||t.return===s)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var bl=0,cs=null,Js=null,At=null,Gc=!1,Sr=!1,$n=!1,qc=0,yi=0,kr=null,Uy=0;function vt(){throw Error(c(321))}function uu(s,t){if(t===null)return!1;for(var l=0;l<t.length&&l<s.length;l++)if(!Na(s[l],t[l]))return!1;return!0}function mu(s,t,l,i,o,x){return bl=x,cs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,M.H=s===null||s.memoizedState===null?wf:Cu,$n=!1,x=l(i,o),$n=!1,Sr&&(x=Ih(t,l,i,o)),Ph(s),x}function Ph(s){M.H=Si;var t=Js!==null&&Js.next!==null;if(bl=0,At=Js=cs=null,Gc=!1,yi=0,kr=null,t)throw Error(c(300));s===null||zt||(s=s.dependencies,s!==null&&Lc(s)&&(zt=!0))}function Ih(s,t,l,i){cs=s;var o=0;do{if(Sr&&(kr=null),yi=0,Sr=!1,25<=o)throw Error(c(301));if(o+=1,At=Js=null,s.updateQueue!=null){var x=s.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}M.H=_f,x=t(l,i)}while(Sr);return x}function $y(){var s=M.H,t=s.useState()[0];return t=typeof t.then=="function"?wi(t):t,s=s.useState()[0],(Js!==null?Js.memoizedState:null)!==s&&(cs.flags|=1024),t}function xu(){var s=qc!==0;return qc=0,s}function hu(s,t,l){t.updateQueue=s.updateQueue,t.flags&=-2053,s.lanes&=~l}function fu(s){if(Gc){for(s=s.memoizedState;s!==null;){var t=s.queue;t!==null&&(t.pending=null),s=s.next}Gc=!1}bl=0,At=Js=cs=null,Sr=!1,yi=qc=0,kr=null}function la(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return At===null?cs.memoizedState=At=s:At=At.next=s,At}function kt(){if(Js===null){var s=cs.alternate;s=s!==null?s.memoizedState:null}else s=Js.next;var t=At===null?cs.memoizedState:At.next;if(t!==null)At=t,Js=s;else{if(s===null)throw cs.alternate===null?Error(c(467)):Error(c(310));Js=s,s={memoizedState:Js.memoizedState,baseState:Js.baseState,baseQueue:Js.baseQueue,queue:Js.queue,next:null},At===null?cs.memoizedState=At=s:At=At.next=s}return At}function Kc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wi(s){var t=yi;return yi+=1,kr===null&&(kr=[]),s=Ah(kr,s,t),t=cs,(At===null?t.memoizedState:At.next)===null&&(t=t.alternate,M.H=t===null||t.memoizedState===null?wf:Cu),s}function Qc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return wi(s);if(s.$$typeof===E)return Gt(s)}throw Error(c(438,String(s)))}function pu(s){var t=null,l=cs.updateQueue;if(l!==null&&(t=l.memoCache),t==null){var i=cs.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(o){return o.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),l===null&&(l=Kc(),cs.updateQueue=l),l.memoCache=t,l=t.data[t.index],l===void 0)for(l=t.data[t.index]=Array(s),i=0;i<s;i++)l[i]=oe;return t.index++,l}function yl(s,t){return typeof t=="function"?t(s):t}function Yc(s){var t=kt();return gu(t,Js,s)}function gu(s,t,l){var i=s.queue;if(i===null)throw Error(c(311));i.lastRenderedReducer=l;var o=s.baseQueue,x=i.pending;if(x!==null){if(o!==null){var j=o.next;o.next=x.next,x.next=j}t.baseQueue=o=x,i.pending=null}if(x=s.baseState,o===null)s.memoizedState=x;else{t=o.next;var k=j=null,$=null,le=t,ve=!1;do{var ye=le.lane&-536870913;if(ye!==le.lane?(Ts&ye)===ye:(bl&ye)===ye){var ce=le.revertLane;if(ce===0)$!==null&&($=$.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),ye===Nr&&(ve=!0);else if((bl&ce)===ce){le=le.next,ce===Nr&&(ve=!0);continue}else ye={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},$===null?(k=$=ye,j=x):$=$.next=ye,cs.lanes|=ce,en|=ce;ye=le.action,$n&&l(x,ye),x=le.hasEagerState?le.eagerState:l(x,ye)}else ce={lane:ye,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},$===null?(k=$=ce,j=x):$=$.next=ce,cs.lanes|=ye,en|=ye;le=le.next}while(le!==null&&le!==t);if($===null?j=x:$.next=k,!Na(x,s.memoizedState)&&(zt=!0,ve&&(l=br,l!==null)))throw l;s.memoizedState=x,s.baseState=j,s.baseQueue=$,i.lastRenderedState=x}return o===null&&(i.lanes=0),[s.memoizedState,i.dispatch]}function ju(s){var t=kt(),l=t.queue;if(l===null)throw Error(c(311));l.lastRenderedReducer=s;var i=l.dispatch,o=l.pending,x=t.memoizedState;if(o!==null){l.pending=null;var j=o=o.next;do x=s(x,j.action),j=j.next;while(j!==o);Na(x,t.memoizedState)||(zt=!0),t.memoizedState=x,t.baseQueue===null&&(t.baseState=x),l.lastRenderedState=x}return[x,i]}function Fh(s,t,l){var i=cs,o=kt(),x=As;if(x){if(l===void 0)throw Error(c(407));l=l()}else l=t();var j=!Na((Js||o).memoizedState,l);if(j&&(o.memoizedState=l,zt=!0),o=o.queue,bu(Gh.bind(null,i,o,s),[s]),o.getSnapshot!==t||j||At!==null&&At.memoizedState.tag&1){if(i.flags|=2048,Cr(9,{destroy:void 0},Vh.bind(null,i,o,l,t),null),Ws===null)throw Error(c(349));x||(bl&127)!==0||Hh(i,t,l)}return l}function Hh(s,t,l){s.flags|=16384,s={getSnapshot:t,value:l},t=cs.updateQueue,t===null?(t=Kc(),cs.updateQueue=t,t.stores=[s]):(l=t.stores,l===null?t.stores=[s]:l.push(s))}function Vh(s,t,l,i){t.value=l,t.getSnapshot=i,qh(t)&&Kh(s)}function Gh(s,t,l){return l(function(){qh(t)&&Kh(s)})}function qh(s){var t=s.getSnapshot;s=s.value;try{var l=t();return!Na(s,l)}catch{return!0}}function Kh(s){var t=En(s,2);t!==null&&fa(t,s,2)}function vu(s){var t=la();if(typeof s=="function"){var l=s;if(s=l(),$n){ss(!0);try{l()}finally{ss(!1)}}}return t.memoizedState=t.baseState=s,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:s},t}function Qh(s,t,l,i){return s.baseState=l,gu(s,Js,typeof i=="function"?i:yl)}function By(s,t,l,i,o){if(Zc(s))throw Error(c(485));if(s=t.action,s!==null){var x={payload:o,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){x.listeners.push(j)}};M.T!==null?l(!0):x.isTransition=!1,i(x),l=t.pending,l===null?(x.next=t.pending=x,Yh(t,x)):(x.next=l.next,t.pending=l.next=x)}}function Yh(s,t){var l=t.action,i=t.payload,o=s.state;if(t.isTransition){var x=M.T,j={};M.T=j;try{var k=l(o,i),$=M.S;$!==null&&$(j,k),Jh(s,t,k)}catch(le){Nu(s,t,le)}finally{x!==null&&j.types!==null&&(x.types=j.types),M.T=x}}else try{x=l(o,i),Jh(s,t,x)}catch(le){Nu(s,t,le)}}function Jh(s,t,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(i){Xh(s,t,i)},function(i){return Nu(s,t,i)}):Xh(s,t,l)}function Xh(s,t,l){t.status="fulfilled",t.value=l,Zh(t),s.state=l,t=s.pending,t!==null&&(l=t.next,l===t?s.pending=null:(l=l.next,t.next=l,Yh(s,l)))}function Nu(s,t,l){var i=s.pending;if(s.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=l,Zh(t),t=t.next;while(t!==i)}s.action=null}function Zh(s){s=s.listeners;for(var t=0;t<s.length;t++)(0,s[t])()}function Wh(s,t){return t}function ef(s,t){if(As){var l=Ws.formState;if(l!==null){e:{var i=cs;if(As){if(it){s:{for(var o=it,x=Fa;o.nodeType!==8;){if(!x){o=null;break s}if(o=Va(o.nextSibling),o===null){o=null;break s}}x=o.data,o=x==="F!"||x==="F"?o:null}if(o){it=Va(o.nextSibling),i=o.data==="F!";break e}}Gl(i)}i=!1}i&&(t=l[0])}}return l=la(),l.memoizedState=l.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wh,lastRenderedState:t},l.queue=i,l=Nf.bind(null,cs,i),i.dispatch=l,i=vu(!1),x=ku.bind(null,cs,!1,i.queue),i=la(),o={state:t,dispatch:null,action:s,pending:null},i.queue=o,l=By.bind(null,cs,o,x,l),o.dispatch=l,i.memoizedState=s,[t,l,!1]}function sf(s){var t=kt();return tf(t,Js,s)}function tf(s,t,l){if(t=gu(s,t,Wh)[0],s=Yc(yl)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=wi(t)}catch(j){throw j===yr?Bc:j}else i=t;t=kt();var o=t.queue,x=o.dispatch;return l!==t.memoizedState&&(cs.flags|=2048,Cr(9,{destroy:void 0},Py.bind(null,o,l),null)),[i,x,s]}function Py(s,t){s.action=t}function af(s){var t=kt(),l=Js;if(l!==null)return tf(t,l,s);kt(),t=t.memoizedState,l=kt();var i=l.queue.dispatch;return l.memoizedState=s,[t,i,!1]}function Cr(s,t,l,i){return s={tag:s,create:l,deps:i,inst:t,next:null},t=cs.updateQueue,t===null&&(t=Kc(),cs.updateQueue=t),l=t.lastEffect,l===null?t.lastEffect=s.next=s:(i=l.next,l.next=s,s.next=i,t.lastEffect=s),s}function lf(){return kt().memoizedState}function Jc(s,t,l,i){var o=la();cs.flags|=s,o.memoizedState=Cr(1|t,{destroy:void 0},l,i===void 0?null:i)}function Xc(s,t,l,i){var o=kt();i=i===void 0?null:i;var x=o.memoizedState.inst;Js!==null&&i!==null&&uu(i,Js.memoizedState.deps)?o.memoizedState=Cr(t,x,l,i):(cs.flags|=s,o.memoizedState=Cr(1|t,x,l,i))}function nf(s,t){Jc(8390656,8,s,t)}function bu(s,t){Xc(2048,8,s,t)}function Iy(s){cs.flags|=4;var t=cs.updateQueue;if(t===null)t=Kc(),cs.updateQueue=t,t.events=[s];else{var l=t.events;l===null?t.events=[s]:l.push(s)}}function rf(s){var t=kt().memoizedState;return Iy({ref:t,nextImpl:s}),function(){if((Is&2)!==0)throw Error(c(440));return t.impl.apply(void 0,arguments)}}function cf(s,t){return Xc(4,2,s,t)}function of(s,t){return Xc(4,4,s,t)}function df(s,t){if(typeof t=="function"){s=s();var l=t(s);return function(){typeof l=="function"?l():t(null)}}if(t!=null)return s=s(),t.current=s,function(){t.current=null}}function uf(s,t,l){l=l!=null?l.concat([s]):null,Xc(4,4,df.bind(null,t,s),l)}function yu(){}function mf(s,t){var l=kt();t=t===void 0?null:t;var i=l.memoizedState;return t!==null&&uu(t,i[1])?i[0]:(l.memoizedState=[s,t],s)}function xf(s,t){var l=kt();t=t===void 0?null:t;var i=l.memoizedState;if(t!==null&&uu(t,i[1]))return i[0];if(i=s(),$n){ss(!0);try{s()}finally{ss(!1)}}return l.memoizedState=[i,t],i}function wu(s,t,l){return l===void 0||(bl&1073741824)!==0&&(Ts&261930)===0?s.memoizedState=t:(s.memoizedState=l,s=hp(),cs.lanes|=s,en|=s,l)}function hf(s,t,l,i){return Na(l,t)?l:_r.current!==null?(s=wu(s,l,i),Na(s,t)||(zt=!0),s):(bl&42)===0||(bl&1073741824)!==0&&(Ts&261930)===0?(zt=!0,s.memoizedState=l):(s=hp(),cs.lanes|=s,en|=s,t)}function ff(s,t,l,i,o){var x=K.p;K.p=x!==0&&8>x?x:8;var j=M.T,k={};M.T=k,ku(s,!1,t,l);try{var $=o(),le=M.S;if(le!==null&&le(k,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var ve=Ly($,i);_i(s,t,ve,ka(s))}else _i(s,t,i,ka(s))}catch(ye){_i(s,t,{then:function(){},status:"rejected",reason:ye},ka())}finally{K.p=x,j!==null&&k.types!==null&&(j.types=k.types),M.T=j}}function Fy(){}function _u(s,t,l,i){if(s.tag!==5)throw Error(c(476));var o=pf(s).queue;ff(s,o,t,P,l===null?Fy:function(){return gf(s),l(i)})}function pf(s){var t=s.memoizedState;if(t!==null)return t;t={memoizedState:P,baseState:P,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:P},next:null};var l={};return t.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:l},next:null},s.memoizedState=t,s=s.alternate,s!==null&&(s.memoizedState=t),t}function gf(s){var t=pf(s);t.next===null&&(t=s.alternate.memoizedState),_i(s,t.next.queue,{},ka())}function Su(){return Gt(Ii)}function jf(){return kt().memoizedState}function vf(){return kt().memoizedState}function Hy(s){for(var t=s.return;t!==null;){switch(t.tag){case 24:case 3:var l=ka();s=Ql(l);var i=Yl(t,s,l);i!==null&&(fa(i,t,l),vi(i,t,l)),t={cache:eu()},s.payload=t;return}t=t.return}}function Vy(s,t,l){var i=ka();l={lane:i,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Zc(s)?bf(t,l):(l=Hd(s,t,l,i),l!==null&&(fa(l,s,i),yf(l,t,i)))}function Nf(s,t,l){var i=ka();_i(s,t,l,i)}function _i(s,t,l,i){var o={lane:i,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Zc(s))bf(t,o);else{var x=s.alternate;if(s.lanes===0&&(x===null||x.lanes===0)&&(x=t.lastRenderedReducer,x!==null))try{var j=t.lastRenderedState,k=x(j,l);if(o.hasEagerState=!0,o.eagerState=k,Na(k,j))return zc(s,t,o,0),Ws===null&&Ac(),!1}catch{}finally{}if(l=Hd(s,t,o,i),l!==null)return fa(l,s,i),yf(l,t,i),!0}return!1}function ku(s,t,l,i){if(i={lane:2,revertLane:lm(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Zc(s)){if(t)throw Error(c(479))}else t=Hd(s,l,i,2),t!==null&&fa(t,s,2)}function Zc(s){var t=s.alternate;return s===cs||t!==null&&t===cs}function bf(s,t){Sr=Gc=!0;var l=s.pending;l===null?t.next=t:(t.next=l.next,l.next=t),s.pending=t}function yf(s,t,l){if((l&4194048)!==0){var i=t.lanes;i&=s.pendingLanes,l|=i,t.lanes=l,ea(s,l)}}var Si={readContext:Gt,use:Qc,useCallback:vt,useContext:vt,useEffect:vt,useImperativeHandle:vt,useLayoutEffect:vt,useInsertionEffect:vt,useMemo:vt,useReducer:vt,useRef:vt,useState:vt,useDebugValue:vt,useDeferredValue:vt,useTransition:vt,useSyncExternalStore:vt,useId:vt,useHostTransitionStatus:vt,useFormState:vt,useActionState:vt,useOptimistic:vt,useMemoCache:vt,useCacheRefresh:vt};Si.useEffectEvent=vt;var wf={readContext:Gt,use:Qc,useCallback:function(s,t){return la().memoizedState=[s,t===void 0?null:t],s},useContext:Gt,useEffect:nf,useImperativeHandle:function(s,t,l){l=l!=null?l.concat([s]):null,Jc(4194308,4,df.bind(null,t,s),l)},useLayoutEffect:function(s,t){return Jc(4194308,4,s,t)},useInsertionEffect:function(s,t){Jc(4,2,s,t)},useMemo:function(s,t){var l=la();t=t===void 0?null:t;var i=s();if($n){ss(!0);try{s()}finally{ss(!1)}}return l.memoizedState=[i,t],i},useReducer:function(s,t,l){var i=la();if(l!==void 0){var o=l(t);if($n){ss(!0);try{l(t)}finally{ss(!1)}}}else o=t;return i.memoizedState=i.baseState=o,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},i.queue=s,s=s.dispatch=Vy.bind(null,cs,s),[i.memoizedState,s]},useRef:function(s){var t=la();return s={current:s},t.memoizedState=s},useState:function(s){s=vu(s);var t=s.queue,l=Nf.bind(null,cs,t);return t.dispatch=l,[s.memoizedState,l]},useDebugValue:yu,useDeferredValue:function(s,t){var l=la();return wu(l,s,t)},useTransition:function(){var s=vu(!1);return s=ff.bind(null,cs,s.queue,!0,!1),la().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,t,l){var i=cs,o=la();if(As){if(l===void 0)throw Error(c(407));l=l()}else{if(l=t(),Ws===null)throw Error(c(349));(Ts&127)!==0||Hh(i,t,l)}o.memoizedState=l;var x={value:l,getSnapshot:t};return o.queue=x,nf(Gh.bind(null,i,x,s),[s]),i.flags|=2048,Cr(9,{destroy:void 0},Vh.bind(null,i,x,l,t),null),l},useId:function(){var s=la(),t=Ws.identifierPrefix;if(As){var l=rl,i=nl;l=(i&~(1<<32-ys(i)-1)).toString(32)+l,t="_"+t+"R_"+l,l=qc++,0<l&&(t+="H"+l.toString(32)),t+="_"}else l=Uy++,t="_"+t+"r_"+l.toString(32)+"_";return s.memoizedState=t},useHostTransitionStatus:Su,useFormState:ef,useActionState:ef,useOptimistic:function(s){var t=la();t.memoizedState=t.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=l,t=ku.bind(null,cs,!0,l),l.dispatch=t,[s,t]},useMemoCache:pu,useCacheRefresh:function(){return la().memoizedState=Hy.bind(null,cs)},useEffectEvent:function(s){var t=la(),l={impl:s};return t.memoizedState=l,function(){if((Is&2)!==0)throw Error(c(440));return l.impl.apply(void 0,arguments)}}},Cu={readContext:Gt,use:Qc,useCallback:mf,useContext:Gt,useEffect:bu,useImperativeHandle:uf,useInsertionEffect:cf,useLayoutEffect:of,useMemo:xf,useReducer:Yc,useRef:lf,useState:function(){return Yc(yl)},useDebugValue:yu,useDeferredValue:function(s,t){var l=kt();return hf(l,Js.memoizedState,s,t)},useTransition:function(){var s=Yc(yl)[0],t=kt().memoizedState;return[typeof s=="boolean"?s:wi(s),t]},useSyncExternalStore:Fh,useId:jf,useHostTransitionStatus:Su,useFormState:sf,useActionState:sf,useOptimistic:function(s,t){var l=kt();return Qh(l,Js,s,t)},useMemoCache:pu,useCacheRefresh:vf};Cu.useEffectEvent=rf;var _f={readContext:Gt,use:Qc,useCallback:mf,useContext:Gt,useEffect:bu,useImperativeHandle:uf,useInsertionEffect:cf,useLayoutEffect:of,useMemo:xf,useReducer:ju,useRef:lf,useState:function(){return ju(yl)},useDebugValue:yu,useDeferredValue:function(s,t){var l=kt();return Js===null?wu(l,s,t):hf(l,Js.memoizedState,s,t)},useTransition:function(){var s=ju(yl)[0],t=kt().memoizedState;return[typeof s=="boolean"?s:wi(s),t]},useSyncExternalStore:Fh,useId:jf,useHostTransitionStatus:Su,useFormState:af,useActionState:af,useOptimistic:function(s,t){var l=kt();return Js!==null?Qh(l,Js,s,t):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:pu,useCacheRefresh:vf};_f.useEffectEvent=rf;function Tu(s,t,l,i){t=s.memoizedState,l=l(i,t),l=l==null?t:v({},t,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Eu={enqueueSetState:function(s,t,l){s=s._reactInternals;var i=ka(),o=Ql(i);o.payload=t,l!=null&&(o.callback=l),t=Yl(s,o,i),t!==null&&(fa(t,s,i),vi(t,s,i))},enqueueReplaceState:function(s,t,l){s=s._reactInternals;var i=ka(),o=Ql(i);o.tag=1,o.payload=t,l!=null&&(o.callback=l),t=Yl(s,o,i),t!==null&&(fa(t,s,i),vi(t,s,i))},enqueueForceUpdate:function(s,t){s=s._reactInternals;var l=ka(),i=Ql(l);i.tag=2,t!=null&&(i.callback=t),t=Yl(s,i,l),t!==null&&(fa(t,s,l),vi(t,s,l))}};function Sf(s,t,l,i,o,x,j){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(i,x,j):t.prototype&&t.prototype.isPureReactComponent?!ui(l,i)||!ui(o,x):!0}function kf(s,t,l,i){s=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(l,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(l,i),t.state!==s&&Eu.enqueueReplaceState(t,t.state,null)}function Bn(s,t){var l=t;if("ref"in t){l={};for(var i in t)i!=="ref"&&(l[i]=t[i])}if(s=s.defaultProps){l===t&&(l=v({},l));for(var o in s)l[o]===void 0&&(l[o]=s[o])}return l}function Cf(s){Mc(s)}function Tf(s){console.error(s)}function Ef(s){Mc(s)}function Wc(s,t){try{var l=s.onUncaughtError;l(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Mf(s,t,l){try{var i=s.onCaughtError;i(l.value,{componentStack:l.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(o){setTimeout(function(){throw o})}}function Mu(s,t,l){return l=Ql(l),l.tag=3,l.payload={element:null},l.callback=function(){Wc(s,t)},l}function Af(s){return s=Ql(s),s.tag=3,s}function zf(s,t,l,i){var o=l.type.getDerivedStateFromError;if(typeof o=="function"){var x=i.value;s.payload=function(){return o(x)},s.callback=function(){Mf(t,l,i)}}var j=l.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(s.callback=function(){Mf(t,l,i),typeof o!="function"&&(sn===null?sn=new Set([this]):sn.add(this));var k=i.stack;this.componentDidCatch(i.value,{componentStack:k!==null?k:""})})}function Gy(s,t,l,i,o){if(l.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=l.alternate,t!==null&&vr(t,l,o,!0),l=ya.current,l!==null){switch(l.tag){case 31:case 13:return Ha===null?mo():l.alternate===null&&Nt===0&&(Nt=3),l.flags&=-257,l.flags|=65536,l.lanes=o,i===Pc?l.flags|=16384:(t=l.updateQueue,t===null?l.updateQueue=new Set([i]):t.add(i),sm(s,i,o)),!1;case 22:return l.flags|=65536,i===Pc?l.flags|=16384:(t=l.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},l.updateQueue=t):(l=t.retryQueue,l===null?t.retryQueue=new Set([i]):l.add(i)),sm(s,i,o)),!1}throw Error(c(435,l.tag))}return sm(s,i,o),mo(),!1}if(As)return t=ya.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=o,i!==Yd&&(s=Error(c(422),{cause:i}),hi(Ba(s,l)))):(i!==Yd&&(t=Error(c(423),{cause:i}),hi(Ba(t,l))),s=s.current.alternate,s.flags|=65536,o&=-o,s.lanes|=o,i=Ba(i,l),o=Mu(s.stateNode,i,o),ru(s,o),Nt!==4&&(Nt=2)),!1;var x=Error(c(520),{cause:i});if(x=Ba(x,l),Ri===null?Ri=[x]:Ri.push(x),Nt!==4&&(Nt=2),t===null)return!0;i=Ba(i,l),l=t;do{switch(l.tag){case 3:return l.flags|=65536,s=o&-o,l.lanes|=s,s=Mu(l.stateNode,i,s),ru(l,s),!1;case 1:if(t=l.type,x=l.stateNode,(l.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(sn===null||!sn.has(x))))return l.flags|=65536,o&=-o,l.lanes|=o,o=Af(o),zf(o,s,l,i),ru(l,o),!1}l=l.return}while(l!==null);return!1}var Au=Error(c(461)),zt=!1;function qt(s,t,l,i){t.child=s===null?Oh(t,null,l,i):Un(t,s.child,l,i)}function Rf(s,t,l,i,o){l=l.render;var x=t.ref;if("ref"in i){var j={};for(var k in i)k!=="ref"&&(j[k]=i[k])}else j=i;return Rn(t),i=mu(s,t,l,j,x,o),k=xu(),s!==null&&!zt?(hu(s,t,o),wl(s,t,o)):(As&&k&&Kd(t),t.flags|=1,qt(s,t,i,o),t.child)}function Df(s,t,l,i,o){if(s===null){var x=l.type;return typeof x=="function"&&!Vd(x)&&x.defaultProps===void 0&&l.compare===null?(t.tag=15,t.type=x,Of(s,t,x,i,o)):(s=Dc(l.type,null,i,t,t.mode,o),s.ref=t.ref,s.return=t,t.child=s)}if(x=s.child,!Bu(s,o)){var j=x.memoizedProps;if(l=l.compare,l=l!==null?l:ui,l(j,i)&&s.ref===t.ref)return wl(s,t,o)}return t.flags|=1,s=gl(x,i),s.ref=t.ref,s.return=t,t.child=s}function Of(s,t,l,i,o){if(s!==null){var x=s.memoizedProps;if(ui(x,i)&&s.ref===t.ref)if(zt=!1,t.pendingProps=i=x,Bu(s,o))(s.flags&131072)!==0&&(zt=!0);else return t.lanes=s.lanes,wl(s,t,o)}return zu(s,t,l,i,o)}function Lf(s,t,l,i){var o=i.children,x=s!==null?s.memoizedState:null;if(s===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(x=x!==null?x.baseLanes|l:l,s!==null){for(i=t.child=s.child,o=0;i!==null;)o=o|i.lanes|i.childLanes,i=i.sibling;i=o&~x}else i=0,t.child=null;return Uf(s,t,x,l,i)}if((l&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},s!==null&&$c(t,x!==null?x.cachePool:null),x!==null?$h(t,x):cu(),Bh(t);else return i=t.lanes=536870912,Uf(s,t,x!==null?x.baseLanes|l:l,l,i)}else x!==null?($c(t,x.cachePool),$h(t,x),Xl(),t.memoizedState=null):(s!==null&&$c(t,null),cu(),Xl());return qt(s,t,o,l),t.child}function ki(s,t){return s!==null&&s.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Uf(s,t,l,i,o){var x=tu();return x=x===null?null:{parent:Mt._currentValue,pool:x},t.memoizedState={baseLanes:l,cachePool:x},s!==null&&$c(t,null),cu(),Bh(t),s!==null&&vr(s,t,i,!0),t.childLanes=o,null}function eo(s,t){return t=to({mode:t.mode,children:t.children},s.mode),t.ref=s.ref,s.child=t,t.return=s,t}function $f(s,t,l){return Un(t,s.child,null,l),s=eo(t,t.pendingProps),s.flags|=2,wa(t),t.memoizedState=null,s}function qy(s,t,l){var i=t.pendingProps,o=(t.flags&128)!==0;if(t.flags&=-129,s===null){if(As){if(i.mode==="hidden")return s=eo(t,i),t.lanes=536870912,ki(null,s);if(du(t),(s=it)?(s=Jp(s,Fa),s=s!==null&&s.data==="&"?s:null,s!==null&&(t.memoizedState={dehydrated:s,treeContext:Hl!==null?{id:nl,overflow:rl}:null,retryLane:536870912,hydrationErrors:null},l=Nh(s),l.return=t,t.child=l,Vt=t,it=null)):s=null,s===null)throw Gl(t);return t.lanes=536870912,null}return eo(t,i)}var x=s.memoizedState;if(x!==null){var j=x.dehydrated;if(du(t),o)if(t.flags&256)t.flags&=-257,t=$f(s,t,l);else if(t.memoizedState!==null)t.child=s.child,t.flags|=128,t=null;else throw Error(c(558));else if(zt||vr(s,t,l,!1),o=(l&s.childLanes)!==0,zt||o){if(i=Ws,i!==null&&(j=rt(i,l),j!==0&&j!==x.retryLane))throw x.retryLane=j,En(s,j),fa(i,s,j),Au;mo(),t=$f(s,t,l)}else s=x.treeContext,it=Va(j.nextSibling),Vt=t,As=!0,Vl=null,Fa=!1,s!==null&&wh(t,s),t=eo(t,i),t.flags|=4096;return t}return s=gl(s.child,{mode:i.mode,children:i.children}),s.ref=t.ref,t.child=s,s.return=t,s}function so(s,t){var l=t.ref;if(l===null)s!==null&&s.ref!==null&&(t.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(c(284));(s===null||s.ref!==l)&&(t.flags|=4194816)}}function zu(s,t,l,i,o){return Rn(t),l=mu(s,t,l,i,void 0,o),i=xu(),s!==null&&!zt?(hu(s,t,o),wl(s,t,o)):(As&&i&&Kd(t),t.flags|=1,qt(s,t,l,o),t.child)}function Bf(s,t,l,i,o,x){return Rn(t),t.updateQueue=null,l=Ih(t,i,l,o),Ph(s),i=xu(),s!==null&&!zt?(hu(s,t,x),wl(s,t,x)):(As&&i&&Kd(t),t.flags|=1,qt(s,t,l,x),t.child)}function Pf(s,t,l,i,o){if(Rn(t),t.stateNode===null){var x=fr,j=l.contextType;typeof j=="object"&&j!==null&&(x=Gt(j)),x=new l(i,x),t.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Eu,t.stateNode=x,x._reactInternals=t,x=t.stateNode,x.props=i,x.state=t.memoizedState,x.refs={},lu(t),j=l.contextType,x.context=typeof j=="object"&&j!==null?Gt(j):fr,x.state=t.memoizedState,j=l.getDerivedStateFromProps,typeof j=="function"&&(Tu(t,l,j,i),x.state=t.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(j=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),j!==x.state&&Eu.enqueueReplaceState(x,x.state,null),bi(t,i,x,o),Ni(),x.state=t.memoizedState),typeof x.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(s===null){x=t.stateNode;var k=t.memoizedProps,$=Bn(l,k);x.props=$;var le=x.context,ve=l.contextType;j=fr,typeof ve=="object"&&ve!==null&&(j=Gt(ve));var ye=l.getDerivedStateFromProps;ve=typeof ye=="function"||typeof x.getSnapshotBeforeUpdate=="function",k=t.pendingProps!==k,ve||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(k||le!==j)&&kf(t,x,i,j),Kl=!1;var ce=t.memoizedState;x.state=ce,bi(t,i,x,o),Ni(),le=t.memoizedState,k||ce!==le||Kl?(typeof ye=="function"&&(Tu(t,l,ye,i),le=t.memoizedState),($=Kl||Sf(t,l,$,i,ce,le,j))?(ve||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(t.flags|=4194308)):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=le),x.props=i,x.state=le,x.context=j,i=$):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{x=t.stateNode,nu(s,t),j=t.memoizedProps,ve=Bn(l,j),x.props=ve,ye=t.pendingProps,ce=x.context,le=l.contextType,$=fr,typeof le=="object"&&le!==null&&($=Gt(le)),k=l.getDerivedStateFromProps,(le=typeof k=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(j!==ye||ce!==$)&&kf(t,x,i,$),Kl=!1,ce=t.memoizedState,x.state=ce,bi(t,i,x,o),Ni();var xe=t.memoizedState;j!==ye||ce!==xe||Kl||s!==null&&s.dependencies!==null&&Lc(s.dependencies)?(typeof k=="function"&&(Tu(t,l,k,i),xe=t.memoizedState),(ve=Kl||Sf(t,l,ve,i,ce,xe,$)||s!==null&&s.dependencies!==null&&Lc(s.dependencies))?(le||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(i,xe,$),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(i,xe,$)),typeof x.componentDidUpdate=="function"&&(t.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof x.componentDidUpdate!="function"||j===s.memoizedProps&&ce===s.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&ce===s.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=xe),x.props=i,x.state=xe,x.context=$,i=ve):(typeof x.componentDidUpdate!="function"||j===s.memoizedProps&&ce===s.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&ce===s.memoizedState||(t.flags|=1024),i=!1)}return x=i,so(s,t),i=(t.flags&128)!==0,x||i?(x=t.stateNode,l=i&&typeof l.getDerivedStateFromError!="function"?null:x.render(),t.flags|=1,s!==null&&i?(t.child=Un(t,s.child,null,o),t.child=Un(t,null,l,o)):qt(s,t,l,o),t.memoizedState=x.state,s=t.child):s=wl(s,t,o),s}function If(s,t,l,i){return An(),t.flags|=256,qt(s,t,l,i),t.child}var Ru={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Du(s){return{baseLanes:s,cachePool:Eh()}}function Ou(s,t,l){return s=s!==null?s.childLanes&~l:0,t&&(s|=Sa),s}function Ff(s,t,l){var i=t.pendingProps,o=!1,x=(t.flags&128)!==0,j;if((j=x)||(j=s!==null&&s.memoizedState===null?!1:(St.current&2)!==0),j&&(o=!0,t.flags&=-129),j=(t.flags&32)!==0,t.flags&=-33,s===null){if(As){if(o?Jl(t):Xl(),(s=it)?(s=Jp(s,Fa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(t.memoizedState={dehydrated:s,treeContext:Hl!==null?{id:nl,overflow:rl}:null,retryLane:536870912,hydrationErrors:null},l=Nh(s),l.return=t,t.child=l,Vt=t,it=null)):s=null,s===null)throw Gl(t);return gm(s)?t.lanes=32:t.lanes=536870912,null}var k=i.children;return i=i.fallback,o?(Xl(),o=t.mode,k=to({mode:"hidden",children:k},o),i=Mn(i,o,l,null),k.return=t,i.return=t,k.sibling=i,t.child=k,i=t.child,i.memoizedState=Du(l),i.childLanes=Ou(s,j,l),t.memoizedState=Ru,ki(null,i)):(Jl(t),Lu(t,k))}var $=s.memoizedState;if($!==null&&(k=$.dehydrated,k!==null)){if(x)t.flags&256?(Jl(t),t.flags&=-257,t=Uu(s,t,l)):t.memoizedState!==null?(Xl(),t.child=s.child,t.flags|=128,t=null):(Xl(),k=i.fallback,o=t.mode,i=to({mode:"visible",children:i.children},o),k=Mn(k,o,l,null),k.flags|=2,i.return=t,k.return=t,i.sibling=k,t.child=i,Un(t,s.child,null,l),i=t.child,i.memoizedState=Du(l),i.childLanes=Ou(s,j,l),t.memoizedState=Ru,t=ki(null,i));else if(Jl(t),gm(k)){if(j=k.nextSibling&&k.nextSibling.dataset,j)var le=j.dgst;j=le,i=Error(c(419)),i.stack="",i.digest=j,hi({value:i,source:null,stack:null}),t=Uu(s,t,l)}else if(zt||vr(s,t,l,!1),j=(l&s.childLanes)!==0,zt||j){if(j=Ws,j!==null&&(i=rt(j,l),i!==0&&i!==$.retryLane))throw $.retryLane=i,En(s,i),fa(j,s,i),Au;pm(k)||mo(),t=Uu(s,t,l)}else pm(k)?(t.flags|=192,t.child=s.child,t=null):(s=$.treeContext,it=Va(k.nextSibling),Vt=t,As=!0,Vl=null,Fa=!1,s!==null&&wh(t,s),t=Lu(t,i.children),t.flags|=4096);return t}return o?(Xl(),k=i.fallback,o=t.mode,$=s.child,le=$.sibling,i=gl($,{mode:"hidden",children:i.children}),i.subtreeFlags=$.subtreeFlags&65011712,le!==null?k=gl(le,k):(k=Mn(k,o,l,null),k.flags|=2),k.return=t,i.return=t,i.sibling=k,t.child=i,ki(null,i),i=t.child,k=s.child.memoizedState,k===null?k=Du(l):(o=k.cachePool,o!==null?($=Mt._currentValue,o=o.parent!==$?{parent:$,pool:$}:o):o=Eh(),k={baseLanes:k.baseLanes|l,cachePool:o}),i.memoizedState=k,i.childLanes=Ou(s,j,l),t.memoizedState=Ru,ki(s.child,i)):(Jl(t),l=s.child,s=l.sibling,l=gl(l,{mode:"visible",children:i.children}),l.return=t,l.sibling=null,s!==null&&(j=t.deletions,j===null?(t.deletions=[s],t.flags|=16):j.push(s)),t.child=l,t.memoizedState=null,l)}function Lu(s,t){return t=to({mode:"visible",children:t},s.mode),t.return=s,s.child=t}function to(s,t){return s=ba(22,s,null,t),s.lanes=0,s}function Uu(s,t,l){return Un(t,s.child,null,l),s=Lu(t,t.pendingProps.children),s.flags|=2,t.memoizedState=null,s}function Hf(s,t,l){s.lanes|=t;var i=s.alternate;i!==null&&(i.lanes|=t),Zd(s.return,t,l)}function $u(s,t,l,i,o,x){var j=s.memoizedState;j===null?s.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:l,tailMode:o,treeForkCount:x}:(j.isBackwards=t,j.rendering=null,j.renderingStartTime=0,j.last=i,j.tail=l,j.tailMode=o,j.treeForkCount=x)}function Vf(s,t,l){var i=t.pendingProps,o=i.revealOrder,x=i.tail;i=i.children;var j=St.current,k=(j&2)!==0;if(k?(j=j&1|2,t.flags|=128):j&=1,Te(St,j),qt(s,t,i,l),i=As?xi:0,!k&&s!==null&&(s.flags&128)!==0)e:for(s=t.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Hf(s,l,t);else if(s.tag===19)Hf(s,l,t);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(o){case"forwards":for(l=t.child,o=null;l!==null;)s=l.alternate,s!==null&&Vc(s)===null&&(o=l),l=l.sibling;l=o,l===null?(o=t.child,t.child=null):(o=l.sibling,l.sibling=null),$u(t,!1,o,l,x,i);break;case"backwards":case"unstable_legacy-backwards":for(l=null,o=t.child,t.child=null;o!==null;){if(s=o.alternate,s!==null&&Vc(s)===null){t.child=o;break}s=o.sibling,o.sibling=l,l=o,o=s}$u(t,!0,l,null,x,i);break;case"together":$u(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function wl(s,t,l){if(s!==null&&(t.dependencies=s.dependencies),en|=t.lanes,(l&t.childLanes)===0)if(s!==null){if(vr(s,t,l,!1),(l&t.childLanes)===0)return null}else return null;if(s!==null&&t.child!==s.child)throw Error(c(153));if(t.child!==null){for(s=t.child,l=gl(s,s.pendingProps),t.child=l,l.return=t;s.sibling!==null;)s=s.sibling,l=l.sibling=gl(s,s.pendingProps),l.return=t;l.sibling=null}return t.child}function Bu(s,t){return(s.lanes&t)!==0?!0:(s=s.dependencies,!!(s!==null&&Lc(s)))}function Ky(s,t,l){switch(t.tag){case 3:Re(t,t.stateNode.containerInfo),ql(t,Mt,s.memoizedState.cache),An();break;case 27:case 5:Y(t);break;case 4:Re(t,t.stateNode.containerInfo);break;case 10:ql(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,du(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(Jl(t),t.flags|=128,null):(l&t.child.childLanes)!==0?Ff(s,t,l):(Jl(t),s=wl(s,t,l),s!==null?s.sibling:null);Jl(t);break;case 19:var o=(s.flags&128)!==0;if(i=(l&t.childLanes)!==0,i||(vr(s,t,l,!1),i=(l&t.childLanes)!==0),o){if(i)return Vf(s,t,l);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Te(St,St.current),i)break;return null;case 22:return t.lanes=0,Lf(s,t,l,t.pendingProps);case 24:ql(t,Mt,s.memoizedState.cache)}return wl(s,t,l)}function Gf(s,t,l){if(s!==null)if(s.memoizedProps!==t.pendingProps)zt=!0;else{if(!Bu(s,l)&&(t.flags&128)===0)return zt=!1,Ky(s,t,l);zt=(s.flags&131072)!==0}else zt=!1,As&&(t.flags&1048576)!==0&&yh(t,xi,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(s=On(t.elementType),t.type=s,typeof s=="function")Vd(s)?(i=Bn(s,i),t.tag=1,t=Pf(null,t,s,i,l)):(t.tag=0,t=zu(null,t,s,i,l));else{if(s!=null){var o=s.$$typeof;if(o===C){t.tag=11,t=Rf(null,t,s,i,l);break e}else if(o===L){t.tag=14,t=Df(null,t,s,i,l);break e}}throw t=fe(s)||s,Error(c(306,t,""))}}return t;case 0:return zu(s,t,t.type,t.pendingProps,l);case 1:return i=t.type,o=Bn(i,t.pendingProps),Pf(s,t,i,o,l);case 3:e:{if(Re(t,t.stateNode.containerInfo),s===null)throw Error(c(387));i=t.pendingProps;var x=t.memoizedState;o=x.element,nu(s,t),bi(t,i,null,l);var j=t.memoizedState;if(i=j.cache,ql(t,Mt,i),i!==x.cache&&Wd(t,[Mt],l,!0),Ni(),i=j.element,x.isDehydrated)if(x={element:i,isDehydrated:!1,cache:j.cache},t.updateQueue.baseState=x,t.memoizedState=x,t.flags&256){t=If(s,t,i,l);break e}else if(i!==o){o=Ba(Error(c(424)),t),hi(o),t=If(s,t,i,l);break e}else{switch(s=t.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(it=Va(s.firstChild),Vt=t,As=!0,Vl=null,Fa=!0,l=Oh(t,null,i,l),t.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(An(),i===o){t=wl(s,t,l);break e}qt(s,t,i,l)}t=t.child}return t;case 26:return so(s,t),s===null?(l=tg(t.type,null,t.pendingProps,null))?t.memoizedState=l:As||(l=t.type,s=t.pendingProps,i=vo(G.current).createElement(l),i[js]=t,i[is]=s,Kt(i,l,s),Pt(i),t.stateNode=i):t.memoizedState=tg(t.type,s.memoizedProps,t.pendingProps,s.memoizedState),null;case 27:return Y(t),s===null&&As&&(i=t.stateNode=Wp(t.type,t.pendingProps,G.current),Vt=t,Fa=!0,o=it,nn(t.type)?(jm=o,it=Va(i.firstChild)):it=o),qt(s,t,t.pendingProps.children,l),so(s,t),s===null&&(t.flags|=4194304),t.child;case 5:return s===null&&As&&((o=i=it)&&(i=w0(i,t.type,t.pendingProps,Fa),i!==null?(t.stateNode=i,Vt=t,it=Va(i.firstChild),Fa=!1,o=!0):o=!1),o||Gl(t)),Y(t),o=t.type,x=t.pendingProps,j=s!==null?s.memoizedProps:null,i=x.children,xm(o,x)?i=null:j!==null&&xm(o,j)&&(t.flags|=32),t.memoizedState!==null&&(o=mu(s,t,$y,null,null,l),Ii._currentValue=o),so(s,t),qt(s,t,i,l),t.child;case 6:return s===null&&As&&((s=l=it)&&(l=_0(l,t.pendingProps,Fa),l!==null?(t.stateNode=l,Vt=t,it=null,s=!0):s=!1),s||Gl(t)),null;case 13:return Ff(s,t,l);case 4:return Re(t,t.stateNode.containerInfo),i=t.pendingProps,s===null?t.child=Un(t,null,i,l):qt(s,t,i,l),t.child;case 11:return Rf(s,t,t.type,t.pendingProps,l);case 7:return qt(s,t,t.pendingProps,l),t.child;case 8:return qt(s,t,t.pendingProps.children,l),t.child;case 12:return qt(s,t,t.pendingProps.children,l),t.child;case 10:return i=t.pendingProps,ql(t,t.type,i.value),qt(s,t,i.children,l),t.child;case 9:return o=t.type._context,i=t.pendingProps.children,Rn(t),o=Gt(o),i=i(o),t.flags|=1,qt(s,t,i,l),t.child;case 14:return Df(s,t,t.type,t.pendingProps,l);case 15:return Of(s,t,t.type,t.pendingProps,l);case 19:return Vf(s,t,l);case 31:return qy(s,t,l);case 22:return Lf(s,t,l,t.pendingProps);case 24:return Rn(t),i=Gt(Mt),s===null?(o=tu(),o===null&&(o=Ws,x=eu(),o.pooledCache=x,x.refCount++,x!==null&&(o.pooledCacheLanes|=l),o=x),t.memoizedState={parent:i,cache:o},lu(t),ql(t,Mt,o)):((s.lanes&l)!==0&&(nu(s,t),bi(t,null,null,l),Ni()),o=s.memoizedState,x=t.memoizedState,o.parent!==i?(o={parent:i,cache:i},t.memoizedState=o,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=o),ql(t,Mt,i)):(i=x.cache,ql(t,Mt,i),i!==o.cache&&Wd(t,[Mt],l,!0))),qt(s,t,t.pendingProps.children,l),t.child;case 29:throw t.pendingProps}throw Error(c(156,t.tag))}function _l(s){s.flags|=4}function Pu(s,t,l,i,o){if((t=(s.mode&32)!==0)&&(t=!1),t){if(s.flags|=16777216,(o&335544128)===o)if(s.stateNode.complete)s.flags|=8192;else if(jp())s.flags|=8192;else throw Ln=Pc,au}else s.flags&=-16777217}function qf(s,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!ig(t))if(jp())s.flags|=8192;else throw Ln=Pc,au}function ao(s,t){t!==null&&(s.flags|=4),s.flags&16384&&(t=s.tag!==22?se():536870912,s.lanes|=t,Ar|=t)}function Ci(s,t){if(!As)switch(s.tailMode){case"hidden":t=s.tail;for(var l=null;t!==null;)t.alternate!==null&&(l=t),t=t.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var i=null;l!==null;)l.alternate!==null&&(i=l),l=l.sibling;i===null?t||s.tail===null?s.tail=null:s.tail.sibling=null:i.sibling=null}}function ct(s){var t=s.alternate!==null&&s.alternate.child===s.child,l=0,i=0;if(t)for(var o=s.child;o!==null;)l|=o.lanes|o.childLanes,i|=o.subtreeFlags&65011712,i|=o.flags&65011712,o.return=s,o=o.sibling;else for(o=s.child;o!==null;)l|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=s,o=o.sibling;return s.subtreeFlags|=i,s.childLanes=l,t}function Qy(s,t,l){var i=t.pendingProps;switch(Qd(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ct(t),null;case 1:return ct(t),null;case 3:return l=t.stateNode,i=null,s!==null&&(i=s.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Nl(Mt),W(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(jr(t)?_l(t):s===null||s.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Jd())),ct(t),null;case 26:var o=t.type,x=t.memoizedState;return s===null?(_l(t),x!==null?(ct(t),qf(t,x)):(ct(t),Pu(t,o,null,i,l))):x?x!==s.memoizedState?(_l(t),ct(t),qf(t,x)):(ct(t),t.flags&=-16777217):(s=s.memoizedProps,s!==i&&_l(t),ct(t),Pu(t,o,s,i,l)),null;case 27:if(Fe(t),l=G.current,o=t.type,s!==null&&t.stateNode!=null)s.memoizedProps!==i&&_l(t);else{if(!i){if(t.stateNode===null)throw Error(c(166));return ct(t),null}s=z.current,jr(t)?_h(t):(s=Wp(o,i,l),t.stateNode=s,_l(t))}return ct(t),null;case 5:if(Fe(t),o=t.type,s!==null&&t.stateNode!=null)s.memoizedProps!==i&&_l(t);else{if(!i){if(t.stateNode===null)throw Error(c(166));return ct(t),null}if(x=z.current,jr(t))_h(t);else{var j=vo(G.current);switch(x){case 1:x=j.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:x=j.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":x=j.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":x=j.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":x=j.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof i.is=="string"?j.createElement("select",{is:i.is}):j.createElement("select"),i.multiple?x.multiple=!0:i.size&&(x.size=i.size);break;default:x=typeof i.is=="string"?j.createElement(o,{is:i.is}):j.createElement(o)}}x[js]=t,x[is]=i;e:for(j=t.child;j!==null;){if(j.tag===5||j.tag===6)x.appendChild(j.stateNode);else if(j.tag!==4&&j.tag!==27&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===t)break e;for(;j.sibling===null;){if(j.return===null||j.return===t)break e;j=j.return}j.sibling.return=j.return,j=j.sibling}t.stateNode=x;e:switch(Kt(x,o,i),o){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&_l(t)}}return ct(t),Pu(t,t.type,s===null?null:s.memoizedProps,t.pendingProps,l),null;case 6:if(s&&t.stateNode!=null)s.memoizedProps!==i&&_l(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(c(166));if(s=G.current,jr(t)){if(s=t.stateNode,l=t.memoizedProps,i=null,o=Vt,o!==null)switch(o.tag){case 27:case 5:i=o.memoizedProps}s[js]=t,s=!!(s.nodeValue===l||i!==null&&i.suppressHydrationWarning===!0||Fp(s.nodeValue,l)),s||Gl(t,!0)}else s=vo(s).createTextNode(i),s[js]=t,t.stateNode=s}return ct(t),null;case 31:if(l=t.memoizedState,s===null||s.memoizedState!==null){if(i=jr(t),l!==null){if(s===null){if(!i)throw Error(c(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(557));s[js]=t}else An(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ct(t),s=!1}else l=Jd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return t.flags&256?(wa(t),t):(wa(t),null);if((t.flags&128)!==0)throw Error(c(558))}return ct(t),null;case 13:if(i=t.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(o=jr(t),i!==null&&i.dehydrated!==null){if(s===null){if(!o)throw Error(c(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(c(317));o[js]=t}else An(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ct(t),o=!1}else o=Jd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),o=!0;if(!o)return t.flags&256?(wa(t),t):(wa(t),null)}return wa(t),(t.flags&128)!==0?(t.lanes=l,t):(l=i!==null,s=s!==null&&s.memoizedState!==null,l&&(i=t.child,o=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(o=i.alternate.memoizedState.cachePool.pool),x=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(x=i.memoizedState.cachePool.pool),x!==o&&(i.flags|=2048)),l!==s&&l&&(t.child.flags|=8192),ao(t,t.updateQueue),ct(t),null);case 4:return W(),s===null&&cm(t.stateNode.containerInfo),ct(t),null;case 10:return Nl(t.type),ct(t),null;case 19:if(pe(St),i=t.memoizedState,i===null)return ct(t),null;if(o=(t.flags&128)!==0,x=i.rendering,x===null)if(o)Ci(i,!1);else{if(Nt!==0||s!==null&&(s.flags&128)!==0)for(s=t.child;s!==null;){if(x=Vc(s),x!==null){for(t.flags|=128,Ci(i,!1),s=x.updateQueue,t.updateQueue=s,ao(t,s),t.subtreeFlags=0,s=l,l=t.child;l!==null;)vh(l,s),l=l.sibling;return Te(St,St.current&1|2),As&&jl(t,i.treeForkCount),t.child}s=s.sibling}i.tail!==null&&mt()>co&&(t.flags|=128,o=!0,Ci(i,!1),t.lanes=4194304)}else{if(!o)if(s=Vc(x),s!==null){if(t.flags|=128,o=!0,s=s.updateQueue,t.updateQueue=s,ao(t,s),Ci(i,!0),i.tail===null&&i.tailMode==="hidden"&&!x.alternate&&!As)return ct(t),null}else 2*mt()-i.renderingStartTime>co&&l!==536870912&&(t.flags|=128,o=!0,Ci(i,!1),t.lanes=4194304);i.isBackwards?(x.sibling=t.child,t.child=x):(s=i.last,s!==null?s.sibling=x:t.child=x,i.last=x)}return i.tail!==null?(s=i.tail,i.rendering=s,i.tail=s.sibling,i.renderingStartTime=mt(),s.sibling=null,l=St.current,Te(St,o?l&1|2:l&1),As&&jl(t,i.treeForkCount),s):(ct(t),null);case 22:case 23:return wa(t),ou(),i=t.memoizedState!==null,s!==null?s.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(l&536870912)!==0&&(t.flags&128)===0&&(ct(t),t.subtreeFlags&6&&(t.flags|=8192)):ct(t),l=t.updateQueue,l!==null&&ao(t,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==l&&(t.flags|=2048),s!==null&&pe(Dn),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),t.memoizedState.cache!==l&&(t.flags|=2048),Nl(Mt),ct(t),null;case 25:return null;case 30:return null}throw Error(c(156,t.tag))}function Yy(s,t){switch(Qd(t),t.tag){case 1:return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 3:return Nl(Mt),W(),s=t.flags,(s&65536)!==0&&(s&128)===0?(t.flags=s&-65537|128,t):null;case 26:case 27:case 5:return Fe(t),null;case 31:if(t.memoizedState!==null){if(wa(t),t.alternate===null)throw Error(c(340));An()}return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 13:if(wa(t),s=t.memoizedState,s!==null&&s.dehydrated!==null){if(t.alternate===null)throw Error(c(340));An()}return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 19:return pe(St),null;case 4:return W(),null;case 10:return Nl(t.type),null;case 22:case 23:return wa(t),ou(),s!==null&&pe(Dn),s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 24:return Nl(Mt),null;case 25:return null;default:return null}}function Kf(s,t){switch(Qd(t),t.tag){case 3:Nl(Mt),W();break;case 26:case 27:case 5:Fe(t);break;case 4:W();break;case 31:t.memoizedState!==null&&wa(t);break;case 13:wa(t);break;case 19:pe(St);break;case 10:Nl(t.type);break;case 22:case 23:wa(t),ou(),s!==null&&pe(Dn);break;case 24:Nl(Mt)}}function Ti(s,t){try{var l=t.updateQueue,i=l!==null?l.lastEffect:null;if(i!==null){var o=i.next;l=o;do{if((l.tag&s)===s){i=void 0;var x=l.create,j=l.inst;i=x(),j.destroy=i}l=l.next}while(l!==o)}}catch(k){Gs(t,t.return,k)}}function Zl(s,t,l){try{var i=t.updateQueue,o=i!==null?i.lastEffect:null;if(o!==null){var x=o.next;i=x;do{if((i.tag&s)===s){var j=i.inst,k=j.destroy;if(k!==void 0){j.destroy=void 0,o=t;var $=l,le=k;try{le()}catch(ve){Gs(o,$,ve)}}}i=i.next}while(i!==x)}}catch(ve){Gs(t,t.return,ve)}}function Qf(s){var t=s.updateQueue;if(t!==null){var l=s.stateNode;try{Uh(t,l)}catch(i){Gs(s,s.return,i)}}}function Yf(s,t,l){l.props=Bn(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(i){Gs(s,t,i)}}function Ei(s,t){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var i=s.stateNode;break;case 30:i=s.stateNode;break;default:i=s.stateNode}typeof l=="function"?s.refCleanup=l(i):l.current=i}}catch(o){Gs(s,t,o)}}function il(s,t){var l=s.ref,i=s.refCleanup;if(l!==null)if(typeof i=="function")try{i()}catch(o){Gs(s,t,o)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(o){Gs(s,t,o)}else l.current=null}function Jf(s){var t=s.type,l=s.memoizedProps,i=s.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break e;case"img":l.src?i.src=l.src:l.srcSet&&(i.srcset=l.srcSet)}}catch(o){Gs(s,s.return,o)}}function Iu(s,t,l){try{var i=s.stateNode;g0(i,s.type,l,t),i[is]=t}catch(o){Gs(s,s.return,o)}}function Xf(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&nn(s.type)||s.tag===4}function Fu(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Xf(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&nn(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Hu(s,t,l){var i=s.tag;if(i===5||i===6)s=s.stateNode,t?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,t):(t=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,t.appendChild(s),l=l._reactRootContainer,l!=null||t.onclick!==null||(t.onclick=fl));else if(i!==4&&(i===27&&nn(s.type)&&(l=s.stateNode,t=null),s=s.child,s!==null))for(Hu(s,t,l),s=s.sibling;s!==null;)Hu(s,t,l),s=s.sibling}function lo(s,t,l){var i=s.tag;if(i===5||i===6)s=s.stateNode,t?l.insertBefore(s,t):l.appendChild(s);else if(i!==4&&(i===27&&nn(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(lo(s,t,l),s=s.sibling;s!==null;)lo(s,t,l),s=s.sibling}function Zf(s){var t=s.stateNode,l=s.memoizedProps;try{for(var i=s.type,o=t.attributes;o.length;)t.removeAttributeNode(o[0]);Kt(t,i,l),t[js]=s,t[is]=l}catch(x){Gs(s,s.return,x)}}var Sl=!1,Rt=!1,Vu=!1,Wf=typeof WeakSet=="function"?WeakSet:Set,It=null;function Jy(s,t){if(s=s.containerInfo,um=ko,s=dh(s),Ud(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var i=l.getSelection&&l.getSelection();if(i&&i.rangeCount!==0){l=i.anchorNode;var o=i.anchorOffset,x=i.focusNode;i=i.focusOffset;try{l.nodeType,x.nodeType}catch{l=null;break e}var j=0,k=-1,$=-1,le=0,ve=0,ye=s,ce=null;s:for(;;){for(var xe;ye!==l||o!==0&&ye.nodeType!==3||(k=j+o),ye!==x||i!==0&&ye.nodeType!==3||($=j+i),ye.nodeType===3&&(j+=ye.nodeValue.length),(xe=ye.firstChild)!==null;)ce=ye,ye=xe;for(;;){if(ye===s)break s;if(ce===l&&++le===o&&(k=j),ce===x&&++ve===i&&($=j),(xe=ye.nextSibling)!==null)break;ye=ce,ce=ye.parentNode}ye=xe}l=k===-1||$===-1?null:{start:k,end:$}}else l=null}l=l||{start:0,end:0}}else l=null;for(mm={focusedElem:s,selectionRange:l},ko=!1,It=t;It!==null;)if(t=It,s=t.child,(t.subtreeFlags&1028)!==0&&s!==null)s.return=t,It=s;else for(;It!==null;){switch(t=It,x=t.alternate,s=t.flags,t.tag){case 0:if((s&4)!==0&&(s=t.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)o=s[l],o.ref.impl=o.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&x!==null){s=void 0,l=t,o=x.memoizedProps,x=x.memoizedState,i=l.stateNode;try{var He=Bn(l.type,o);s=i.getSnapshotBeforeUpdate(He,x),i.__reactInternalSnapshotBeforeUpdate=s}catch(Ze){Gs(l,l.return,Ze)}}break;case 3:if((s&1024)!==0){if(s=t.stateNode.containerInfo,l=s.nodeType,l===9)fm(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":fm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(c(163))}if(s=t.sibling,s!==null){s.return=t.return,It=s;break}It=t.return}}function ep(s,t,l){var i=l.flags;switch(l.tag){case 0:case 11:case 15:Cl(s,l),i&4&&Ti(5,l);break;case 1:if(Cl(s,l),i&4)if(s=l.stateNode,t===null)try{s.componentDidMount()}catch(j){Gs(l,l.return,j)}else{var o=Bn(l.type,t.memoizedProps);t=t.memoizedState;try{s.componentDidUpdate(o,t,s.__reactInternalSnapshotBeforeUpdate)}catch(j){Gs(l,l.return,j)}}i&64&&Qf(l),i&512&&Ei(l,l.return);break;case 3:if(Cl(s,l),i&64&&(s=l.updateQueue,s!==null)){if(t=null,l.child!==null)switch(l.child.tag){case 27:case 5:t=l.child.stateNode;break;case 1:t=l.child.stateNode}try{Uh(s,t)}catch(j){Gs(l,l.return,j)}}break;case 27:t===null&&i&4&&Zf(l);case 26:case 5:Cl(s,l),t===null&&i&4&&Jf(l),i&512&&Ei(l,l.return);break;case 12:Cl(s,l);break;case 31:Cl(s,l),i&4&&ap(s,l);break;case 13:Cl(s,l),i&4&&lp(s,l),i&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=n0.bind(null,l),S0(s,l))));break;case 22:if(i=l.memoizedState!==null||Sl,!i){t=t!==null&&t.memoizedState!==null||Rt,o=Sl;var x=Rt;Sl=i,(Rt=t)&&!x?Tl(s,l,(l.subtreeFlags&8772)!==0):Cl(s,l),Sl=o,Rt=x}break;case 30:break;default:Cl(s,l)}}function sp(s){var t=s.alternate;t!==null&&(s.alternate=null,sp(t)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(t=s.stateNode,t!==null&&Nd(t)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ht=null,ua=!1;function kl(s,t,l){for(l=l.child;l!==null;)tp(s,t,l),l=l.sibling}function tp(s,t,l){if(ls&&typeof ls.onCommitFiberUnmount=="function")try{ls.onCommitFiberUnmount(bs,l)}catch{}switch(l.tag){case 26:Rt||il(l,t),kl(s,t,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Rt||il(l,t);var i=ht,o=ua;nn(l.type)&&(ht=l.stateNode,ua=!1),kl(s,t,l),$i(l.stateNode),ht=i,ua=o;break;case 5:Rt||il(l,t);case 6:if(i=ht,o=ua,ht=null,kl(s,t,l),ht=i,ua=o,ht!==null)if(ua)try{(ht.nodeType===9?ht.body:ht.nodeName==="HTML"?ht.ownerDocument.body:ht).removeChild(l.stateNode)}catch(x){Gs(l,t,x)}else try{ht.removeChild(l.stateNode)}catch(x){Gs(l,t,x)}break;case 18:ht!==null&&(ua?(s=ht,Qp(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Br(s)):Qp(ht,l.stateNode));break;case 4:i=ht,o=ua,ht=l.stateNode.containerInfo,ua=!0,kl(s,t,l),ht=i,ua=o;break;case 0:case 11:case 14:case 15:Zl(2,l,t),Rt||Zl(4,l,t),kl(s,t,l);break;case 1:Rt||(il(l,t),i=l.stateNode,typeof i.componentWillUnmount=="function"&&Yf(l,t,i)),kl(s,t,l);break;case 21:kl(s,t,l);break;case 22:Rt=(i=Rt)||l.memoizedState!==null,kl(s,t,l),Rt=i;break;default:kl(s,t,l)}}function ap(s,t){if(t.memoizedState===null&&(s=t.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Br(s)}catch(l){Gs(t,t.return,l)}}}function lp(s,t){if(t.memoizedState===null&&(s=t.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Br(s)}catch(l){Gs(t,t.return,l)}}function Xy(s){switch(s.tag){case 31:case 13:case 19:var t=s.stateNode;return t===null&&(t=s.stateNode=new Wf),t;case 22:return s=s.stateNode,t=s._retryCache,t===null&&(t=s._retryCache=new Wf),t;default:throw Error(c(435,s.tag))}}function no(s,t){var l=Xy(s);t.forEach(function(i){if(!l.has(i)){l.add(i);var o=r0.bind(null,s,i);i.then(o,o)}})}function ma(s,t){var l=t.deletions;if(l!==null)for(var i=0;i<l.length;i++){var o=l[i],x=s,j=t,k=j;e:for(;k!==null;){switch(k.tag){case 27:if(nn(k.type)){ht=k.stateNode,ua=!1;break e}break;case 5:ht=k.stateNode,ua=!1;break e;case 3:case 4:ht=k.stateNode.containerInfo,ua=!0;break e}k=k.return}if(ht===null)throw Error(c(160));tp(x,j,o),ht=null,ua=!1,x=o.alternate,x!==null&&(x.return=null),o.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)np(t,s),t=t.sibling}var Za=null;function np(s,t){var l=s.alternate,i=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ma(t,s),xa(s),i&4&&(Zl(3,s,s.return),Ti(3,s),Zl(5,s,s.return));break;case 1:ma(t,s),xa(s),i&512&&(Rt||l===null||il(l,l.return)),i&64&&Sl&&(s=s.updateQueue,s!==null&&(i=s.callbacks,i!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?i:l.concat(i))));break;case 26:var o=Za;if(ma(t,s),xa(s),i&512&&(Rt||l===null||il(l,l.return)),i&4){var x=l!==null?l.memoizedState:null;if(i=s.memoizedState,l===null)if(i===null)if(s.stateNode===null){e:{i=s.type,l=s.memoizedProps,o=o.ownerDocument||o;s:switch(i){case"title":x=o.getElementsByTagName("title")[0],(!x||x[_n]||x[js]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=o.createElement(i),o.head.insertBefore(x,o.querySelector("head > title"))),Kt(x,i,l),x[js]=s,Pt(x),i=x;break e;case"link":var j=ng("link","href",o).get(i+(l.href||""));if(j){for(var k=0;k<j.length;k++)if(x=j[k],x.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&x.getAttribute("rel")===(l.rel==null?null:l.rel)&&x.getAttribute("title")===(l.title==null?null:l.title)&&x.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){j.splice(k,1);break s}}x=o.createElement(i),Kt(x,i,l),o.head.appendChild(x);break;case"meta":if(j=ng("meta","content",o).get(i+(l.content||""))){for(k=0;k<j.length;k++)if(x=j[k],x.getAttribute("content")===(l.content==null?null:""+l.content)&&x.getAttribute("name")===(l.name==null?null:l.name)&&x.getAttribute("property")===(l.property==null?null:l.property)&&x.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&x.getAttribute("charset")===(l.charSet==null?null:l.charSet)){j.splice(k,1);break s}}x=o.createElement(i),Kt(x,i,l),o.head.appendChild(x);break;default:throw Error(c(468,i))}x[js]=s,Pt(x),i=x}s.stateNode=i}else rg(o,s.type,s.stateNode);else s.stateNode=lg(o,i,s.memoizedProps);else x!==i?(x===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):x.count--,i===null?rg(o,s.type,s.stateNode):lg(o,i,s.memoizedProps)):i===null&&s.stateNode!==null&&Iu(s,s.memoizedProps,l.memoizedProps)}break;case 27:ma(t,s),xa(s),i&512&&(Rt||l===null||il(l,l.return)),l!==null&&i&4&&Iu(s,s.memoizedProps,l.memoizedProps);break;case 5:if(ma(t,s),xa(s),i&512&&(Rt||l===null||il(l,l.return)),s.flags&32){o=s.stateNode;try{cr(o,"")}catch(He){Gs(s,s.return,He)}}i&4&&s.stateNode!=null&&(o=s.memoizedProps,Iu(s,o,l!==null?l.memoizedProps:o)),i&1024&&(Vu=!0);break;case 6:if(ma(t,s),xa(s),i&4){if(s.stateNode===null)throw Error(c(162));i=s.memoizedProps,l=s.stateNode;try{l.nodeValue=i}catch(He){Gs(s,s.return,He)}}break;case 3:if(yo=null,o=Za,Za=No(t.containerInfo),ma(t,s),Za=o,xa(s),i&4&&l!==null&&l.memoizedState.isDehydrated)try{Br(t.containerInfo)}catch(He){Gs(s,s.return,He)}Vu&&(Vu=!1,rp(s));break;case 4:i=Za,Za=No(s.stateNode.containerInfo),ma(t,s),xa(s),Za=i;break;case 12:ma(t,s),xa(s);break;case 31:ma(t,s),xa(s),i&4&&(i=s.updateQueue,i!==null&&(s.updateQueue=null,no(s,i)));break;case 13:ma(t,s),xa(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(io=mt()),i&4&&(i=s.updateQueue,i!==null&&(s.updateQueue=null,no(s,i)));break;case 22:o=s.memoizedState!==null;var $=l!==null&&l.memoizedState!==null,le=Sl,ve=Rt;if(Sl=le||o,Rt=ve||$,ma(t,s),Rt=ve,Sl=le,xa(s),i&8192)e:for(t=s.stateNode,t._visibility=o?t._visibility&-2:t._visibility|1,o&&(l===null||$||Sl||Rt||Pn(s)),l=null,t=s;;){if(t.tag===5||t.tag===26){if(l===null){$=l=t;try{if(x=$.stateNode,o)j=x.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none";else{k=$.stateNode;var ye=$.memoizedProps.style,ce=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;k.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(He){Gs($,$.return,He)}}}else if(t.tag===6){if(l===null){$=t;try{$.stateNode.nodeValue=o?"":$.memoizedProps}catch(He){Gs($,$.return,He)}}}else if(t.tag===18){if(l===null){$=t;try{var xe=$.stateNode;o?Yp(xe,!0):Yp($.stateNode,!1)}catch(He){Gs($,$.return,He)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===s)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;l===t&&(l=null),t=t.return}l===t&&(l=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=s.updateQueue,i!==null&&(l=i.retryQueue,l!==null&&(i.retryQueue=null,no(s,l))));break;case 19:ma(t,s),xa(s),i&4&&(i=s.updateQueue,i!==null&&(s.updateQueue=null,no(s,i)));break;case 30:break;case 21:break;default:ma(t,s),xa(s)}}function xa(s){var t=s.flags;if(t&2){try{for(var l,i=s.return;i!==null;){if(Xf(i)){l=i;break}i=i.return}if(l==null)throw Error(c(160));switch(l.tag){case 27:var o=l.stateNode,x=Fu(s);lo(s,x,o);break;case 5:var j=l.stateNode;l.flags&32&&(cr(j,""),l.flags&=-33);var k=Fu(s);lo(s,k,j);break;case 3:case 4:var $=l.stateNode.containerInfo,le=Fu(s);Hu(s,le,$);break;default:throw Error(c(161))}}catch(ve){Gs(s,s.return,ve)}s.flags&=-3}t&4096&&(s.flags&=-4097)}function rp(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var t=s;rp(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),s=s.sibling}}function Cl(s,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)ep(s,t.alternate,t),t=t.sibling}function Pn(s){for(s=s.child;s!==null;){var t=s;switch(t.tag){case 0:case 11:case 14:case 15:Zl(4,t,t.return),Pn(t);break;case 1:il(t,t.return);var l=t.stateNode;typeof l.componentWillUnmount=="function"&&Yf(t,t.return,l),Pn(t);break;case 27:$i(t.stateNode);case 26:case 5:il(t,t.return),Pn(t);break;case 22:t.memoizedState===null&&Pn(t);break;case 30:Pn(t);break;default:Pn(t)}s=s.sibling}}function Tl(s,t,l){for(l=l&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,o=s,x=t,j=x.flags;switch(x.tag){case 0:case 11:case 15:Tl(o,x,l),Ti(4,x);break;case 1:if(Tl(o,x,l),i=x,o=i.stateNode,typeof o.componentDidMount=="function")try{o.componentDidMount()}catch(le){Gs(i,i.return,le)}if(i=x,o=i.updateQueue,o!==null){var k=i.stateNode;try{var $=o.shared.hiddenCallbacks;if($!==null)for(o.shared.hiddenCallbacks=null,o=0;o<$.length;o++)Lh($[o],k)}catch(le){Gs(i,i.return,le)}}l&&j&64&&Qf(x),Ei(x,x.return);break;case 27:Zf(x);case 26:case 5:Tl(o,x,l),l&&i===null&&j&4&&Jf(x),Ei(x,x.return);break;case 12:Tl(o,x,l);break;case 31:Tl(o,x,l),l&&j&4&&ap(o,x);break;case 13:Tl(o,x,l),l&&j&4&&lp(o,x);break;case 22:x.memoizedState===null&&Tl(o,x,l),Ei(x,x.return);break;case 30:break;default:Tl(o,x,l)}t=t.sibling}}function Gu(s,t){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&fi(l))}function qu(s,t){s=null,t.alternate!==null&&(s=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==s&&(t.refCount++,s!=null&&fi(s))}function Wa(s,t,l,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)ip(s,t,l,i),t=t.sibling}function ip(s,t,l,i){var o=t.flags;switch(t.tag){case 0:case 11:case 15:Wa(s,t,l,i),o&2048&&Ti(9,t);break;case 1:Wa(s,t,l,i);break;case 3:Wa(s,t,l,i),o&2048&&(s=null,t.alternate!==null&&(s=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==s&&(t.refCount++,s!=null&&fi(s)));break;case 12:if(o&2048){Wa(s,t,l,i),s=t.stateNode;try{var x=t.memoizedProps,j=x.id,k=x.onPostCommit;typeof k=="function"&&k(j,t.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch($){Gs(t,t.return,$)}}else Wa(s,t,l,i);break;case 31:Wa(s,t,l,i);break;case 13:Wa(s,t,l,i);break;case 23:break;case 22:x=t.stateNode,j=t.alternate,t.memoizedState!==null?x._visibility&2?Wa(s,t,l,i):Mi(s,t):x._visibility&2?Wa(s,t,l,i):(x._visibility|=2,Tr(s,t,l,i,(t.subtreeFlags&10256)!==0||!1)),o&2048&&Gu(j,t);break;case 24:Wa(s,t,l,i),o&2048&&qu(t.alternate,t);break;default:Wa(s,t,l,i)}}function Tr(s,t,l,i,o){for(o=o&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var x=s,j=t,k=l,$=i,le=j.flags;switch(j.tag){case 0:case 11:case 15:Tr(x,j,k,$,o),Ti(8,j);break;case 23:break;case 22:var ve=j.stateNode;j.memoizedState!==null?ve._visibility&2?Tr(x,j,k,$,o):Mi(x,j):(ve._visibility|=2,Tr(x,j,k,$,o)),o&&le&2048&&Gu(j.alternate,j);break;case 24:Tr(x,j,k,$,o),o&&le&2048&&qu(j.alternate,j);break;default:Tr(x,j,k,$,o)}t=t.sibling}}function Mi(s,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var l=s,i=t,o=i.flags;switch(i.tag){case 22:Mi(l,i),o&2048&&Gu(i.alternate,i);break;case 24:Mi(l,i),o&2048&&qu(i.alternate,i);break;default:Mi(l,i)}t=t.sibling}}var Ai=8192;function Er(s,t,l){if(s.subtreeFlags&Ai)for(s=s.child;s!==null;)cp(s,t,l),s=s.sibling}function cp(s,t,l){switch(s.tag){case 26:Er(s,t,l),s.flags&Ai&&s.memoizedState!==null&&U0(l,Za,s.memoizedState,s.memoizedProps);break;case 5:Er(s,t,l);break;case 3:case 4:var i=Za;Za=No(s.stateNode.containerInfo),Er(s,t,l),Za=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=Ai,Ai=16777216,Er(s,t,l),Ai=i):Er(s,t,l));break;default:Er(s,t,l)}}function op(s){var t=s.alternate;if(t!==null&&(s=t.child,s!==null)){t.child=null;do t=s.sibling,s.sibling=null,s=t;while(s!==null)}}function zi(s){var t=s.deletions;if((s.flags&16)!==0){if(t!==null)for(var l=0;l<t.length;l++){var i=t[l];It=i,up(i,s)}op(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)dp(s),s=s.sibling}function dp(s){switch(s.tag){case 0:case 11:case 15:zi(s),s.flags&2048&&Zl(9,s,s.return);break;case 3:zi(s);break;case 12:zi(s);break;case 22:var t=s.stateNode;s.memoizedState!==null&&t._visibility&2&&(s.return===null||s.return.tag!==13)?(t._visibility&=-3,ro(s)):zi(s);break;default:zi(s)}}function ro(s){var t=s.deletions;if((s.flags&16)!==0){if(t!==null)for(var l=0;l<t.length;l++){var i=t[l];It=i,up(i,s)}op(s)}for(s=s.child;s!==null;){switch(t=s,t.tag){case 0:case 11:case 15:Zl(8,t,t.return),ro(t);break;case 22:l=t.stateNode,l._visibility&2&&(l._visibility&=-3,ro(t));break;default:ro(t)}s=s.sibling}}function up(s,t){for(;It!==null;){var l=It;switch(l.tag){case 0:case 11:case 15:Zl(8,l,t);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var i=l.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:fi(l.memoizedState.cache)}if(i=l.child,i!==null)i.return=l,It=i;else e:for(l=s;It!==null;){i=It;var o=i.sibling,x=i.return;if(sp(i),i===l){It=null;break e}if(o!==null){o.return=x,It=o;break e}It=x}}}var Zy={getCacheForType:function(s){var t=Gt(Mt),l=t.data.get(s);return l===void 0&&(l=s(),t.data.set(s,l)),l},cacheSignal:function(){return Gt(Mt).controller.signal}},Wy=typeof WeakMap=="function"?WeakMap:Map,Is=0,Ws=null,_s=null,Ts=0,Vs=0,_a=null,Wl=!1,Mr=!1,Ku=!1,El=0,Nt=0,en=0,In=0,Qu=0,Sa=0,Ar=0,Ri=null,ha=null,Yu=!1,io=0,mp=0,co=1/0,oo=null,sn=null,Ot=0,tn=null,zr=null,Ml=0,Ju=0,Xu=null,xp=null,Di=0,Zu=null;function ka(){return(Is&2)!==0&&Ts!==0?Ts&-Ts:M.T!==null?lm():ne()}function hp(){if(Sa===0)if((Ts&536870912)===0||As){var s=Et;Et<<=1,(Et&3932160)===0&&(Et=262144),Sa=s}else Sa=536870912;return s=ya.current,s!==null&&(s.flags|=32),Sa}function fa(s,t,l){(s===Ws&&(Vs===2||Vs===9)||s.cancelPendingCommit!==null)&&(Rr(s,0),an(s,Ts,Sa,!1)),Le(s,l),((Is&2)===0||s!==Ws)&&(s===Ws&&((Is&2)===0&&(In|=l),Nt===4&&an(s,Ts,Sa,!1)),cl(s))}function fp(s,t,l){if((Is&6)!==0)throw Error(c(327));var i=!l&&(t&127)===0&&(t&s.expiredLanes)===0||xl(s,t),o=i?t0(s,t):em(s,t,!0),x=i;do{if(o===0){Mr&&!i&&an(s,t,0,!1);break}else{if(l=s.current.alternate,x&&!e0(l)){o=em(s,t,!1),x=!1;continue}if(o===2){if(x=t,s.errorRecoveryDisabledLanes&x)var j=0;else j=s.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){t=j;e:{var k=s;o=Ri;var $=k.current.memoizedState.isDehydrated;if($&&(Rr(k,j).flags|=256),j=em(k,j,!1),j!==2){if(Ku&&!$){k.errorRecoveryDisabledLanes|=x,In|=x,o=4;break e}x=ha,ha=o,x!==null&&(ha===null?ha=x:ha.push.apply(ha,x))}o=j}if(x=!1,o!==2)continue}}if(o===1){Rr(s,0),an(s,t,0,!0);break}e:{switch(i=s,x=o,x){case 0:case 1:throw Error(c(345));case 4:if((t&4194048)!==t)break;case 6:an(i,t,Sa,!Wl);break e;case 2:ha=null;break;case 3:case 5:break;default:throw Error(c(329))}if((t&62914560)===t&&(o=io+300-mt(),10<o)){if(an(i,t,Sa,!Wl),ll(i,0,!0)!==0)break e;Ml=t,i.timeoutHandle=qp(pp.bind(null,i,l,ha,oo,Yu,t,Sa,In,Ar,Wl,x,"Throttled",-0,0),o);break e}pp(i,l,ha,oo,Yu,t,Sa,In,Ar,Wl,x,null,-0,0)}}break}while(!0);cl(s)}function pp(s,t,l,i,o,x,j,k,$,le,ve,ye,ce,xe){if(s.timeoutHandle=-1,ye=t.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:fl},cp(t,x,ye);var He=(x&62914560)===x?io-mt():(x&4194048)===x?mp-mt():0;if(He=$0(ye,He),He!==null){Ml=x,s.cancelPendingCommit=He(_p.bind(null,s,t,x,l,i,o,j,k,$,ve,ye,null,ce,xe)),an(s,x,j,!le);return}}_p(s,t,x,l,i,o,j,k,$)}function e0(s){for(var t=s;;){var l=t.tag;if((l===0||l===11||l===15)&&t.flags&16384&&(l=t.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var i=0;i<l.length;i++){var o=l[i],x=o.getSnapshot;o=o.value;try{if(!Na(x(),o))return!1}catch{return!1}}if(l=t.child,t.subtreeFlags&16384&&l!==null)l.return=t,t=l;else{if(t===s)break;for(;t.sibling===null;){if(t.return===null||t.return===s)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function an(s,t,l,i){t&=~Qu,t&=~In,s.suspendedLanes|=t,s.pingedLanes&=~t,i&&(s.warmLanes|=t),i=s.expirationTimes;for(var o=t;0<o;){var x=31-ys(o),j=1<<x;i[x]=-1,o&=~j}l!==0&&Dt(s,l,t)}function uo(){return(Is&6)===0?(Oi(0),!1):!0}function Wu(){if(_s!==null){if(Vs===0)var s=_s.return;else s=_s,vl=zn=null,fu(s),wr=null,gi=0,s=_s;for(;s!==null;)Kf(s.alternate,s),s=s.return;_s=null}}function Rr(s,t){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,N0(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Ml=0,Wu(),Ws=s,_s=l=gl(s.current,null),Ts=t,Vs=0,_a=null,Wl=!1,Mr=xl(s,t),Ku=!1,Ar=Sa=Qu=In=en=Nt=0,ha=Ri=null,Yu=!1,(t&8)!==0&&(t|=t&32);var i=s.entangledLanes;if(i!==0)for(s=s.entanglements,i&=t;0<i;){var o=31-ys(i),x=1<<o;t|=s[o],i&=~x}return El=t,Ac(),l}function gp(s,t){cs=null,M.H=Si,t===yr||t===Bc?(t=zh(),Vs=3):t===au?(t=zh(),Vs=4):Vs=t===Au?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,_a=t,_s===null&&(Nt=1,Wc(s,Ba(t,s.current)))}function jp(){var s=ya.current;return s===null?!0:(Ts&4194048)===Ts?Ha===null:(Ts&62914560)===Ts||(Ts&536870912)!==0?s===Ha:!1}function vp(){var s=M.H;return M.H=Si,s===null?Si:s}function Np(){var s=M.A;return M.A=Zy,s}function mo(){Nt=4,Wl||(Ts&4194048)!==Ts&&ya.current!==null||(Mr=!0),(en&134217727)===0&&(In&134217727)===0||Ws===null||an(Ws,Ts,Sa,!1)}function em(s,t,l){var i=Is;Is|=2;var o=vp(),x=Np();(Ws!==s||Ts!==t)&&(oo=null,Rr(s,t)),t=!1;var j=Nt;e:do try{if(Vs!==0&&_s!==null){var k=_s,$=_a;switch(Vs){case 8:Wu(),j=6;break e;case 3:case 2:case 9:case 6:ya.current===null&&(t=!0);var le=Vs;if(Vs=0,_a=null,Dr(s,k,$,le),l&&Mr){j=0;break e}break;default:le=Vs,Vs=0,_a=null,Dr(s,k,$,le)}}s0(),j=Nt;break}catch(ve){gp(s,ve)}while(!0);return t&&s.shellSuspendCounter++,vl=zn=null,Is=i,M.H=o,M.A=x,_s===null&&(Ws=null,Ts=0,Ac()),j}function s0(){for(;_s!==null;)bp(_s)}function t0(s,t){var l=Is;Is|=2;var i=vp(),o=Np();Ws!==s||Ts!==t?(oo=null,co=mt()+500,Rr(s,t)):Mr=xl(s,t);e:do try{if(Vs!==0&&_s!==null){t=_s;var x=_a;s:switch(Vs){case 1:Vs=0,_a=null,Dr(s,t,x,1);break;case 2:case 9:if(Mh(x)){Vs=0,_a=null,yp(t);break}t=function(){Vs!==2&&Vs!==9||Ws!==s||(Vs=7),cl(s)},x.then(t,t);break e;case 3:Vs=7;break e;case 4:Vs=5;break e;case 7:Mh(x)?(Vs=0,_a=null,yp(t)):(Vs=0,_a=null,Dr(s,t,x,7));break;case 5:var j=null;switch(_s.tag){case 26:j=_s.memoizedState;case 5:case 27:var k=_s;if(j?ig(j):k.stateNode.complete){Vs=0,_a=null;var $=k.sibling;if($!==null)_s=$;else{var le=k.return;le!==null?(_s=le,xo(le)):_s=null}break s}}Vs=0,_a=null,Dr(s,t,x,5);break;case 6:Vs=0,_a=null,Dr(s,t,x,6);break;case 8:Wu(),Nt=6;break e;default:throw Error(c(462))}}a0();break}catch(ve){gp(s,ve)}while(!0);return vl=zn=null,M.H=i,M.A=o,Is=l,_s!==null?0:(Ws=null,Ts=0,Ac(),Nt)}function a0(){for(;_s!==null&&!Ja();)bp(_s)}function bp(s){var t=Gf(s.alternate,s,El);s.memoizedProps=s.pendingProps,t===null?xo(s):_s=t}function yp(s){var t=s,l=t.alternate;switch(t.tag){case 15:case 0:t=Bf(l,t,t.pendingProps,t.type,void 0,Ts);break;case 11:t=Bf(l,t,t.pendingProps,t.type.render,t.ref,Ts);break;case 5:fu(t);default:Kf(l,t),t=_s=vh(t,El),t=Gf(l,t,El)}s.memoizedProps=s.pendingProps,t===null?xo(s):_s=t}function Dr(s,t,l,i){vl=zn=null,fu(t),wr=null,gi=0;var o=t.return;try{if(Gy(s,o,t,l,Ts)){Nt=1,Wc(s,Ba(l,s.current)),_s=null;return}}catch(x){if(o!==null)throw _s=o,x;Nt=1,Wc(s,Ba(l,s.current)),_s=null;return}t.flags&32768?(As||i===1?s=!0:Mr||(Ts&536870912)!==0?s=!1:(Wl=s=!0,(i===2||i===9||i===3||i===6)&&(i=ya.current,i!==null&&i.tag===13&&(i.flags|=16384))),wp(t,s)):xo(t)}function xo(s){var t=s;do{if((t.flags&32768)!==0){wp(t,Wl);return}s=t.return;var l=Qy(t.alternate,t,El);if(l!==null){_s=l;return}if(t=t.sibling,t!==null){_s=t;return}_s=t=s}while(t!==null);Nt===0&&(Nt=5)}function wp(s,t){do{var l=Yy(s.alternate,s);if(l!==null){l.flags&=32767,_s=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!t&&(s=s.sibling,s!==null)){_s=s;return}_s=s=l}while(s!==null);Nt=6,_s=null}function _p(s,t,l,i,o,x,j,k,$){s.cancelPendingCommit=null;do ho();while(Ot!==0);if((Is&6)!==0)throw Error(c(327));if(t!==null){if(t===s.current)throw Error(c(177));if(x=t.lanes|t.childLanes,x|=Fd,Fs(s,l,x,j,k,$),s===Ws&&(_s=Ws=null,Ts=0),zr=t,tn=s,Ml=l,Ju=x,Xu=o,xp=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,i0(es,function(){return Ep(),null})):(s.callbackNode=null,s.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=M.T,M.T=null,o=K.p,K.p=2,j=Is,Is|=4;try{Jy(s,t,l)}finally{Is=j,K.p=o,M.T=i}}Ot=1,Sp(),kp(),Cp()}}function Sp(){if(Ot===1){Ot=0;var s=tn,t=zr,l=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||l){l=M.T,M.T=null;var i=K.p;K.p=2;var o=Is;Is|=4;try{np(t,s);var x=mm,j=dh(s.containerInfo),k=x.focusedElem,$=x.selectionRange;if(j!==k&&k&&k.ownerDocument&&oh(k.ownerDocument.documentElement,k)){if($!==null&&Ud(k)){var le=$.start,ve=$.end;if(ve===void 0&&(ve=le),"selectionStart"in k)k.selectionStart=le,k.selectionEnd=Math.min(ve,k.value.length);else{var ye=k.ownerDocument||document,ce=ye&&ye.defaultView||window;if(ce.getSelection){var xe=ce.getSelection(),He=k.textContent.length,Ze=Math.min($.start,He),Zs=$.end===void 0?Ze:Math.min($.end,He);!xe.extend&&Ze>Zs&&(j=Zs,Zs=Ze,Ze=j);var X=ch(k,Ze),V=ch(k,Zs);if(X&&V&&(xe.rangeCount!==1||xe.anchorNode!==X.node||xe.anchorOffset!==X.offset||xe.focusNode!==V.node||xe.focusOffset!==V.offset)){var te=ye.createRange();te.setStart(X.node,X.offset),xe.removeAllRanges(),Ze>Zs?(xe.addRange(te),xe.extend(V.node,V.offset)):(te.setEnd(V.node,V.offset),xe.addRange(te))}}}}for(ye=[],xe=k;xe=xe.parentNode;)xe.nodeType===1&&ye.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<ye.length;k++){var be=ye[k];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}ko=!!um,mm=um=null}finally{Is=o,K.p=i,M.T=l}}s.current=t,Ot=2}}function kp(){if(Ot===2){Ot=0;var s=tn,t=zr,l=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||l){l=M.T,M.T=null;var i=K.p;K.p=2;var o=Is;Is|=4;try{ep(s,t.alternate,t)}finally{Is=o,K.p=i,M.T=l}}Ot=3}}function Cp(){if(Ot===4||Ot===3){Ot=0,Ht();var s=tn,t=zr,l=Ml,i=xp;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Ot=5:(Ot=0,zr=tn=null,Tp(s,s.pendingLanes));var o=s.pendingLanes;if(o===0&&(sn=null),xt(l),t=t.stateNode,ls&&typeof ls.onCommitFiberRoot=="function")try{ls.onCommitFiberRoot(bs,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=M.T,o=K.p,K.p=2,M.T=null;try{for(var x=s.onRecoverableError,j=0;j<i.length;j++){var k=i[j];x(k.value,{componentStack:k.stack})}}finally{M.T=t,K.p=o}}(Ml&3)!==0&&ho(),cl(s),o=s.pendingLanes,(l&261930)!==0&&(o&42)!==0?s===Zu?Di++:(Di=0,Zu=s):Di=0,Oi(0)}}function Tp(s,t){(s.pooledCacheLanes&=t)===0&&(t=s.pooledCache,t!=null&&(s.pooledCache=null,fi(t)))}function ho(){return Sp(),kp(),Cp(),Ep()}function Ep(){if(Ot!==5)return!1;var s=tn,t=Ju;Ju=0;var l=xt(Ml),i=M.T,o=K.p;try{K.p=32>l?32:l,M.T=null,l=Xu,Xu=null;var x=tn,j=Ml;if(Ot=0,zr=tn=null,Ml=0,(Is&6)!==0)throw Error(c(331));var k=Is;if(Is|=4,dp(x.current),ip(x,x.current,j,l),Is=k,Oi(0,!1),ls&&typeof ls.onPostCommitFiberRoot=="function")try{ls.onPostCommitFiberRoot(bs,x)}catch{}return!0}finally{K.p=o,M.T=i,Tp(s,t)}}function Mp(s,t,l){t=Ba(l,t),t=Mu(s.stateNode,t,2),s=Yl(s,t,2),s!==null&&(Le(s,2),cl(s))}function Gs(s,t,l){if(s.tag===3)Mp(s,s,l);else for(;t!==null;){if(t.tag===3){Mp(t,s,l);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(sn===null||!sn.has(i))){s=Ba(l,s),l=Af(2),i=Yl(t,l,2),i!==null&&(zf(l,i,t,s),Le(i,2),cl(i));break}}t=t.return}}function sm(s,t,l){var i=s.pingCache;if(i===null){i=s.pingCache=new Wy;var o=new Set;i.set(t,o)}else o=i.get(t),o===void 0&&(o=new Set,i.set(t,o));o.has(l)||(Ku=!0,o.add(l),s=l0.bind(null,s,t,l),t.then(s,s))}function l0(s,t,l){var i=s.pingCache;i!==null&&i.delete(t),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,Ws===s&&(Ts&l)===l&&(Nt===4||Nt===3&&(Ts&62914560)===Ts&&300>mt()-io?(Is&2)===0&&Rr(s,0):Qu|=l,Ar===Ts&&(Ar=0)),cl(s)}function Ap(s,t){t===0&&(t=se()),s=En(s,t),s!==null&&(Le(s,t),cl(s))}function n0(s){var t=s.memoizedState,l=0;t!==null&&(l=t.retryLane),Ap(s,l)}function r0(s,t){var l=0;switch(s.tag){case 31:case 13:var i=s.stateNode,o=s.memoizedState;o!==null&&(l=o.retryLane);break;case 19:i=s.stateNode;break;case 22:i=s.stateNode._retryCache;break;default:throw Error(c(314))}i!==null&&i.delete(t),Ap(s,l)}function i0(s,t){return Ut(s,t)}var fo=null,Or=null,tm=!1,po=!1,am=!1,ln=0;function cl(s){s!==Or&&s.next===null&&(Or===null?fo=Or=s:Or=Or.next=s),po=!0,tm||(tm=!0,o0())}function Oi(s,t){if(!am&&po){am=!0;do for(var l=!1,i=fo;i!==null;){if(s!==0){var o=i.pendingLanes;if(o===0)var x=0;else{var j=i.suspendedLanes,k=i.pingedLanes;x=(1<<31-ys(42|s)+1)-1,x&=o&~(j&~k),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(l=!0,Op(i,x))}else x=Ts,x=ll(i,i===Ws?x:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(x&3)===0||xl(i,x)||(l=!0,Op(i,x));i=i.next}while(l);am=!1}}function c0(){zp()}function zp(){po=tm=!1;var s=0;ln!==0&&v0()&&(s=ln);for(var t=mt(),l=null,i=fo;i!==null;){var o=i.next,x=Rp(i,t);x===0?(i.next=null,l===null?fo=o:l.next=o,o===null&&(Or=l)):(l=i,(s!==0||(x&3)!==0)&&(po=!0)),i=o}Ot!==0&&Ot!==5||Oi(s),ln!==0&&(ln=0)}function Rp(s,t){for(var l=s.suspendedLanes,i=s.pingedLanes,o=s.expirationTimes,x=s.pendingLanes&-62914561;0<x;){var j=31-ys(x),k=1<<j,$=o[j];$===-1?((k&l)===0||(k&i)!==0)&&(o[j]=sr(k,t)):$<=t&&(s.expiredLanes|=k),x&=~k}if(t=Ws,l=Ts,l=ll(s,s===t?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),i=s.callbackNode,l===0||s===t&&(Vs===2||Vs===9)||s.cancelPendingCommit!==null)return i!==null&&i!==null&&aa(i),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||xl(s,l)){if(t=l&-l,t===s.callbackPriority)return t;switch(i!==null&&aa(i),xt(l)){case 2:case 8:l=Qe;break;case 32:l=es;break;case 268435456:l=as;break;default:l=es}return i=Dp.bind(null,s),l=Ut(l,i),s.callbackPriority=t,s.callbackNode=l,t}return i!==null&&i!==null&&aa(i),s.callbackPriority=2,s.callbackNode=null,2}function Dp(s,t){if(Ot!==0&&Ot!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(ho()&&s.callbackNode!==l)return null;var i=Ts;return i=ll(s,s===Ws?i:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),i===0?null:(fp(s,i,t),Rp(s,mt()),s.callbackNode!=null&&s.callbackNode===l?Dp.bind(null,s):null)}function Op(s,t){if(ho())return null;fp(s,t,!0)}function o0(){b0(function(){(Is&6)!==0?Ut(qe,c0):zp()})}function lm(){if(ln===0){var s=Nr;s===0&&(s=Ms,Ms<<=1,(Ms&261888)===0&&(Ms=256)),ln=s}return ln}function Lp(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:wc(""+s)}function Up(s,t){var l=t.ownerDocument.createElement("input");return l.name=t.name,l.value=t.value,s.id&&l.setAttribute("form",s.id),t.parentNode.insertBefore(l,t),s=new FormData(s),l.parentNode.removeChild(l),s}function d0(s,t,l,i,o){if(t==="submit"&&l&&l.stateNode===o){var x=Lp((o[is]||null).action),j=i.submitter;j&&(t=(t=j[is]||null)?Lp(t.formAction):j.getAttribute("formAction"),t!==null&&(x=t,j=null));var k=new Cc("action","action",null,i,o);s.push({event:k,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(ln!==0){var $=j?Up(o,j):new FormData(o);_u(l,{pending:!0,data:$,method:o.method,action:x},null,$)}}else typeof x=="function"&&(k.preventDefault(),$=j?Up(o,j):new FormData(o),_u(l,{pending:!0,data:$,method:o.method,action:x},x,$))},currentTarget:o}]})}}for(var nm=0;nm<Id.length;nm++){var rm=Id[nm],u0=rm.toLowerCase(),m0=rm[0].toUpperCase()+rm.slice(1);Xa(u0,"on"+m0)}Xa(xh,"onAnimationEnd"),Xa(hh,"onAnimationIteration"),Xa(fh,"onAnimationStart"),Xa("dblclick","onDoubleClick"),Xa("focusin","onFocus"),Xa("focusout","onBlur"),Xa(Ty,"onTransitionRun"),Xa(Ey,"onTransitionStart"),Xa(My,"onTransitionCancel"),Xa(ph,"onTransitionEnd"),rr("onMouseEnter",["mouseout","mouseover"]),rr("onMouseLeave",["mouseout","mouseover"]),rr("onPointerEnter",["pointerout","pointerover"]),rr("onPointerLeave",["pointerout","pointerover"]),Sn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Sn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Sn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Sn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Sn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Sn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Li="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),x0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Li));function $p(s,t){t=(t&4)!==0;for(var l=0;l<s.length;l++){var i=s[l],o=i.event;i=i.listeners;e:{var x=void 0;if(t)for(var j=i.length-1;0<=j;j--){var k=i[j],$=k.instance,le=k.currentTarget;if(k=k.listener,$!==x&&o.isPropagationStopped())break e;x=k,o.currentTarget=le;try{x(o)}catch(ve){Mc(ve)}o.currentTarget=null,x=$}else for(j=0;j<i.length;j++){if(k=i[j],$=k.instance,le=k.currentTarget,k=k.listener,$!==x&&o.isPropagationStopped())break e;x=k,o.currentTarget=le;try{x(o)}catch(ve){Mc(ve)}o.currentTarget=null,x=$}}}}function Ss(s,t){var l=t[va];l===void 0&&(l=t[va]=new Set);var i=s+"__bubble";l.has(i)||(Bp(t,s,2,!1),l.add(i))}function im(s,t,l){var i=0;t&&(i|=4),Bp(l,s,i,t)}var go="_reactListening"+Math.random().toString(36).slice(2);function cm(s){if(!s[go]){s[go]=!0,Ax.forEach(function(l){l!=="selectionchange"&&(x0.has(l)||im(l,!1,s),im(l,!0,s))});var t=s.nodeType===9?s:s.ownerDocument;t===null||t[go]||(t[go]=!0,im("selectionchange",!1,t))}}function Bp(s,t,l,i){switch(hg(t)){case 2:var o=I0;break;case 8:o=F0;break;default:o=wm}l=o.bind(null,t,l,s),o=void 0,!Td||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),i?o!==void 0?s.addEventListener(t,l,{capture:!0,passive:o}):s.addEventListener(t,l,!0):o!==void 0?s.addEventListener(t,l,{passive:o}):s.addEventListener(t,l,!1)}function om(s,t,l,i,o){var x=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var j=i.tag;if(j===3||j===4){var k=i.stateNode.containerInfo;if(k===o)break;if(j===4)for(j=i.return;j!==null;){var $=j.tag;if(($===3||$===4)&&j.stateNode.containerInfo===o)return;j=j.return}for(;k!==null;){if(j=ar(k),j===null)return;if($=j.tag,$===5||$===6||$===26||$===27){i=x=j;continue e}k=k.parentNode}}i=i.return}Hx(function(){var le=x,ve=kd(l),ye=[];e:{var ce=gh.get(s);if(ce!==void 0){var xe=Cc,He=s;switch(s){case"keypress":if(Sc(l)===0)break e;case"keydown":case"keyup":xe=ry;break;case"focusin":He="focus",xe=zd;break;case"focusout":He="blur",xe=zd;break;case"beforeblur":case"afterblur":xe=zd;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=qx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=Qb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=oy;break;case xh:case hh:case fh:xe=Xb;break;case ph:xe=uy;break;case"scroll":case"scrollend":xe=qb;break;case"wheel":xe=xy;break;case"copy":case"cut":case"paste":xe=Wb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=Qx;break;case"toggle":case"beforetoggle":xe=fy}var Ze=(t&4)!==0,Zs=!Ze&&(s==="scroll"||s==="scrollend"),X=Ze?ce!==null?ce+"Capture":null:ce;Ze=[];for(var V=le,te;V!==null;){var be=V;if(te=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||te===null||X===null||(be=li(V,X),be!=null&&Ze.push(Ui(V,be,te))),Zs)break;V=V.return}0<Ze.length&&(ce=new xe(ce,He,null,l,ve),ye.push({event:ce,listeners:Ze}))}}if((t&7)===0){e:{if(ce=s==="mouseover"||s==="pointerover",xe=s==="mouseout"||s==="pointerout",ce&&l!==Sd&&(He=l.relatedTarget||l.fromElement)&&(ar(He)||He[jt]))break e;if((xe||ce)&&(ce=ve.window===ve?ve:(ce=ve.ownerDocument)?ce.defaultView||ce.parentWindow:window,xe?(He=l.relatedTarget||l.toElement,xe=le,He=He?ar(He):null,He!==null&&(Zs=u(He),Ze=He.tag,He!==Zs||Ze!==5&&Ze!==27&&Ze!==6)&&(He=null)):(xe=null,He=le),xe!==He)){if(Ze=qx,be="onMouseLeave",X="onMouseEnter",V="mouse",(s==="pointerout"||s==="pointerover")&&(Ze=Qx,be="onPointerLeave",X="onPointerEnter",V="pointer"),Zs=xe==null?ce:ai(xe),te=He==null?ce:ai(He),ce=new Ze(be,V+"leave",xe,l,ve),ce.target=Zs,ce.relatedTarget=te,be=null,ar(ve)===le&&(Ze=new Ze(X,V+"enter",He,l,ve),Ze.target=te,Ze.relatedTarget=Zs,be=Ze),Zs=be,xe&&He)s:{for(Ze=h0,X=xe,V=He,te=0,be=X;be;be=Ze(be))te++;be=0;for(var Ye=V;Ye;Ye=Ze(Ye))be++;for(;0<te-be;)X=Ze(X),te--;for(;0<be-te;)V=Ze(V),be--;for(;te--;){if(X===V||V!==null&&X===V.alternate){Ze=X;break s}X=Ze(X),V=Ze(V)}Ze=null}else Ze=null;xe!==null&&Pp(ye,ce,xe,Ze,!1),He!==null&&Zs!==null&&Pp(ye,Zs,He,Ze,!0)}}e:{if(ce=le?ai(le):window,xe=ce.nodeName&&ce.nodeName.toLowerCase(),xe==="select"||xe==="input"&&ce.type==="file")var $s=th;else if(eh(ce))if(ah)$s=Sy;else{$s=wy;var Ge=yy}else xe=ce.nodeName,!xe||xe.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?le&&_d(le.elementType)&&($s=th):$s=_y;if($s&&($s=$s(s,le))){sh(ye,$s,l,ve);break e}Ge&&Ge(s,ce,le),s==="focusout"&&le&&ce.type==="number"&&le.memoizedProps.value!=null&&wd(ce,"number",ce.value)}switch(Ge=le?ai(le):window,s){case"focusin":(eh(Ge)||Ge.contentEditable==="true")&&(mr=Ge,$d=le,mi=null);break;case"focusout":mi=$d=mr=null;break;case"mousedown":Bd=!0;break;case"contextmenu":case"mouseup":case"dragend":Bd=!1,uh(ye,l,ve);break;case"selectionchange":if(Cy)break;case"keydown":case"keyup":uh(ye,l,ve)}var ds;if(Dd)e:{switch(s){case"compositionstart":var Es="onCompositionStart";break e;case"compositionend":Es="onCompositionEnd";break e;case"compositionupdate":Es="onCompositionUpdate";break e}Es=void 0}else ur?Zx(s,l)&&(Es="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Es="onCompositionStart");Es&&(Yx&&l.locale!=="ko"&&(ur||Es!=="onCompositionStart"?Es==="onCompositionEnd"&&ur&&(ds=Vx()):(Fl=ve,Ed="value"in Fl?Fl.value:Fl.textContent,ur=!0)),Ge=jo(le,Es),0<Ge.length&&(Es=new Kx(Es,s,null,l,ve),ye.push({event:Es,listeners:Ge}),ds?Es.data=ds:(ds=Wx(l),ds!==null&&(Es.data=ds)))),(ds=gy?jy(s,l):vy(s,l))&&(Es=jo(le,"onBeforeInput"),0<Es.length&&(Ge=new Kx("onBeforeInput","beforeinput",null,l,ve),ye.push({event:Ge,listeners:Es}),Ge.data=ds)),d0(ye,s,le,l,ve)}$p(ye,t)})}function Ui(s,t,l){return{instance:s,listener:t,currentTarget:l}}function jo(s,t){for(var l=t+"Capture",i=[];s!==null;){var o=s,x=o.stateNode;if(o=o.tag,o!==5&&o!==26&&o!==27||x===null||(o=li(s,l),o!=null&&i.unshift(Ui(s,o,x)),o=li(s,t),o!=null&&i.push(Ui(s,o,x))),s.tag===3)return i;s=s.return}return[]}function h0(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Pp(s,t,l,i,o){for(var x=t._reactName,j=[];l!==null&&l!==i;){var k=l,$=k.alternate,le=k.stateNode;if(k=k.tag,$!==null&&$===i)break;k!==5&&k!==26&&k!==27||le===null||($=le,o?(le=li(l,x),le!=null&&j.unshift(Ui(l,le,$))):o||(le=li(l,x),le!=null&&j.push(Ui(l,le,$)))),l=l.return}j.length!==0&&s.push({event:t,listeners:j})}var f0=/\r\n?/g,p0=/\u0000|\uFFFD/g;function Ip(s){return(typeof s=="string"?s:""+s).replace(f0,`
`).replace(p0,"")}function Fp(s,t){return t=Ip(t),Ip(s)===t}function Xs(s,t,l,i,o,x){switch(l){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||cr(s,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&cr(s,""+i);break;case"className":bc(s,"class",i);break;case"tabIndex":bc(s,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":bc(s,l,i);break;case"style":Ix(s,i,x);break;case"data":if(t!=="object"){bc(s,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||l!=="href")){s.removeAttribute(l);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){s.removeAttribute(l);break}i=wc(""+i),s.setAttribute(l,i);break;case"action":case"formAction":if(typeof i=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(l==="formAction"?(t!=="input"&&Xs(s,t,"name",o.name,o,null),Xs(s,t,"formEncType",o.formEncType,o,null),Xs(s,t,"formMethod",o.formMethod,o,null),Xs(s,t,"formTarget",o.formTarget,o,null)):(Xs(s,t,"encType",o.encType,o,null),Xs(s,t,"method",o.method,o,null),Xs(s,t,"target",o.target,o,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){s.removeAttribute(l);break}i=wc(""+i),s.setAttribute(l,i);break;case"onClick":i!=null&&(s.onclick=fl);break;case"onScroll":i!=null&&Ss("scroll",s);break;case"onScrollEnd":i!=null&&Ss("scrollend",s);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(c(61));if(l=i.__html,l!=null){if(o.children!=null)throw Error(c(60));s.innerHTML=l}}break;case"multiple":s.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":s.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){s.removeAttribute("xlink:href");break}l=wc(""+i),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?s.setAttribute(l,""+i):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":i===!0?s.setAttribute(l,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?s.setAttribute(l,i):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?s.setAttribute(l,i):s.removeAttribute(l);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?s.removeAttribute(l):s.setAttribute(l,i);break;case"popover":Ss("beforetoggle",s),Ss("toggle",s),Nc(s,"popover",i);break;case"xlinkActuate":hl(s,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":hl(s,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":hl(s,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":hl(s,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":hl(s,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":hl(s,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":hl(s,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":hl(s,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":hl(s,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Nc(s,"is",i);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Vb.get(l)||l,Nc(s,l,i))}}function dm(s,t,l,i,o,x){switch(l){case"style":Ix(s,i,x);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(c(61));if(l=i.__html,l!=null){if(o.children!=null)throw Error(c(60));s.innerHTML=l}}break;case"children":typeof i=="string"?cr(s,i):(typeof i=="number"||typeof i=="bigint")&&cr(s,""+i);break;case"onScroll":i!=null&&Ss("scroll",s);break;case"onScrollEnd":i!=null&&Ss("scrollend",s);break;case"onClick":i!=null&&(s.onclick=fl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zx.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(o=l.endsWith("Capture"),t=l.slice(2,o?l.length-7:void 0),x=s[is]||null,x=x!=null?x[l]:null,typeof x=="function"&&s.removeEventListener(t,x,o),typeof i=="function")){typeof x!="function"&&x!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(t,i,o);break e}l in s?s[l]=i:i===!0?s.setAttribute(l,""):Nc(s,l,i)}}}function Kt(s,t,l){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ss("error",s),Ss("load",s);var i=!1,o=!1,x;for(x in l)if(l.hasOwnProperty(x)){var j=l[x];if(j!=null)switch(x){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:Xs(s,t,x,j,l,null)}}o&&Xs(s,t,"srcSet",l.srcSet,l,null),i&&Xs(s,t,"src",l.src,l,null);return;case"input":Ss("invalid",s);var k=x=j=o=null,$=null,le=null;for(i in l)if(l.hasOwnProperty(i)){var ve=l[i];if(ve!=null)switch(i){case"name":o=ve;break;case"type":j=ve;break;case"checked":$=ve;break;case"defaultChecked":le=ve;break;case"value":x=ve;break;case"defaultValue":k=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(c(137,t));break;default:Xs(s,t,i,ve,l,null)}}Ux(s,x,k,$,le,j,o,!1);return;case"select":Ss("invalid",s),i=j=x=null;for(o in l)if(l.hasOwnProperty(o)&&(k=l[o],k!=null))switch(o){case"value":x=k;break;case"defaultValue":j=k;break;case"multiple":i=k;default:Xs(s,t,o,k,l,null)}t=x,l=j,s.multiple=!!i,t!=null?ir(s,!!i,t,!1):l!=null&&ir(s,!!i,l,!0);return;case"textarea":Ss("invalid",s),x=o=i=null;for(j in l)if(l.hasOwnProperty(j)&&(k=l[j],k!=null))switch(j){case"value":i=k;break;case"defaultValue":o=k;break;case"children":x=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(c(91));break;default:Xs(s,t,j,k,l,null)}Bx(s,i,o,x);return;case"option":for($ in l)if(l.hasOwnProperty($)&&(i=l[$],i!=null))switch($){case"selected":s.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:Xs(s,t,$,i,l,null)}return;case"dialog":Ss("beforetoggle",s),Ss("toggle",s),Ss("cancel",s),Ss("close",s);break;case"iframe":case"object":Ss("load",s);break;case"video":case"audio":for(i=0;i<Li.length;i++)Ss(Li[i],s);break;case"image":Ss("error",s),Ss("load",s);break;case"details":Ss("toggle",s);break;case"embed":case"source":case"link":Ss("error",s),Ss("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in l)if(l.hasOwnProperty(le)&&(i=l[le],i!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:Xs(s,t,le,i,l,null)}return;default:if(_d(t)){for(ve in l)l.hasOwnProperty(ve)&&(i=l[ve],i!==void 0&&dm(s,t,ve,i,l,void 0));return}}for(k in l)l.hasOwnProperty(k)&&(i=l[k],i!=null&&Xs(s,t,k,i,l,null))}function g0(s,t,l,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var o=null,x=null,j=null,k=null,$=null,le=null,ve=null;for(xe in l){var ye=l[xe];if(l.hasOwnProperty(xe)&&ye!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":$=ye;default:i.hasOwnProperty(xe)||Xs(s,t,xe,null,i,ye)}}for(var ce in i){var xe=i[ce];if(ye=l[ce],i.hasOwnProperty(ce)&&(xe!=null||ye!=null))switch(ce){case"type":x=xe;break;case"name":o=xe;break;case"checked":le=xe;break;case"defaultChecked":ve=xe;break;case"value":j=xe;break;case"defaultValue":k=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(c(137,t));break;default:xe!==ye&&Xs(s,t,ce,xe,i,ye)}}yd(s,j,k,$,le,ve,x,o);return;case"select":xe=j=k=ce=null;for(x in l)if($=l[x],l.hasOwnProperty(x)&&$!=null)switch(x){case"value":break;case"multiple":xe=$;default:i.hasOwnProperty(x)||Xs(s,t,x,null,i,$)}for(o in i)if(x=i[o],$=l[o],i.hasOwnProperty(o)&&(x!=null||$!=null))switch(o){case"value":ce=x;break;case"defaultValue":k=x;break;case"multiple":j=x;default:x!==$&&Xs(s,t,o,x,i,$)}t=k,l=j,i=xe,ce!=null?ir(s,!!l,ce,!1):!!i!=!!l&&(t!=null?ir(s,!!l,t,!0):ir(s,!!l,l?[]:"",!1));return;case"textarea":xe=ce=null;for(k in l)if(o=l[k],l.hasOwnProperty(k)&&o!=null&&!i.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:Xs(s,t,k,null,i,o)}for(j in i)if(o=i[j],x=l[j],i.hasOwnProperty(j)&&(o!=null||x!=null))switch(j){case"value":ce=o;break;case"defaultValue":xe=o;break;case"children":break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(c(91));break;default:o!==x&&Xs(s,t,j,o,i,x)}$x(s,ce,xe);return;case"option":for(var He in l)if(ce=l[He],l.hasOwnProperty(He)&&ce!=null&&!i.hasOwnProperty(He))switch(He){case"selected":s.selected=!1;break;default:Xs(s,t,He,null,i,ce)}for($ in i)if(ce=i[$],xe=l[$],i.hasOwnProperty($)&&ce!==xe&&(ce!=null||xe!=null))switch($){case"selected":s.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:Xs(s,t,$,ce,i,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ze in l)ce=l[Ze],l.hasOwnProperty(Ze)&&ce!=null&&!i.hasOwnProperty(Ze)&&Xs(s,t,Ze,null,i,ce);for(le in i)if(ce=i[le],xe=l[le],i.hasOwnProperty(le)&&ce!==xe&&(ce!=null||xe!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(c(137,t));break;default:Xs(s,t,le,ce,i,xe)}return;default:if(_d(t)){for(var Zs in l)ce=l[Zs],l.hasOwnProperty(Zs)&&ce!==void 0&&!i.hasOwnProperty(Zs)&&dm(s,t,Zs,void 0,i,ce);for(ve in i)ce=i[ve],xe=l[ve],!i.hasOwnProperty(ve)||ce===xe||ce===void 0&&xe===void 0||dm(s,t,ve,ce,i,xe);return}}for(var X in l)ce=l[X],l.hasOwnProperty(X)&&ce!=null&&!i.hasOwnProperty(X)&&Xs(s,t,X,null,i,ce);for(ye in i)ce=i[ye],xe=l[ye],!i.hasOwnProperty(ye)||ce===xe||ce==null&&xe==null||Xs(s,t,ye,ce,i,xe)}function Hp(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function j0(){if(typeof performance.getEntriesByType=="function"){for(var s=0,t=0,l=performance.getEntriesByType("resource"),i=0;i<l.length;i++){var o=l[i],x=o.transferSize,j=o.initiatorType,k=o.duration;if(x&&k&&Hp(j)){for(j=0,k=o.responseEnd,i+=1;i<l.length;i++){var $=l[i],le=$.startTime;if(le>k)break;var ve=$.transferSize,ye=$.initiatorType;ve&&Hp(ye)&&($=$.responseEnd,j+=ve*($<k?1:(k-le)/($-le)))}if(--i,t+=8*(x+j)/(o.duration/1e3),s++,10<s)break}}if(0<s)return t/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var um=null,mm=null;function vo(s){return s.nodeType===9?s:s.ownerDocument}function Vp(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gp(s,t){if(s===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&t==="foreignObject"?0:s}function xm(s,t){return s==="textarea"||s==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var hm=null;function v0(){var s=window.event;return s&&s.type==="popstate"?s===hm?!1:(hm=s,!0):(hm=null,!1)}var qp=typeof setTimeout=="function"?setTimeout:void 0,N0=typeof clearTimeout=="function"?clearTimeout:void 0,Kp=typeof Promise=="function"?Promise:void 0,b0=typeof queueMicrotask=="function"?queueMicrotask:typeof Kp<"u"?function(s){return Kp.resolve(null).then(s).catch(y0)}:qp;function y0(s){setTimeout(function(){throw s})}function nn(s){return s==="head"}function Qp(s,t){var l=t,i=0;do{var o=l.nextSibling;if(s.removeChild(l),o&&o.nodeType===8)if(l=o.data,l==="/$"||l==="/&"){if(i===0){s.removeChild(o),Br(t);return}i--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")i++;else if(l==="html")$i(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,$i(l);for(var x=l.firstChild;x;){var j=x.nextSibling,k=x.nodeName;x[_n]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&x.rel.toLowerCase()==="stylesheet"||l.removeChild(x),x=j}}else l==="body"&&$i(s.ownerDocument.body);l=o}while(l);Br(t)}function Yp(s,t){var l=s;s=0;do{var i=l.nextSibling;if(l.nodeType===1?t?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(t?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),i&&i.nodeType===8)if(l=i.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=i}while(l)}function fm(s){var t=s.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var l=t;switch(t=t.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":fm(l),Nd(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function w0(s,t,l,i){for(;s.nodeType===1;){var o=l;if(s.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(i){if(!s[_n])switch(t){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(x=s.getAttribute("rel"),x==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(x!==o.rel||s.getAttribute("href")!==(o.href==null||o.href===""?null:o.href)||s.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin)||s.getAttribute("title")!==(o.title==null?null:o.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(x=s.getAttribute("src"),(x!==(o.src==null?null:o.src)||s.getAttribute("type")!==(o.type==null?null:o.type)||s.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin))&&x&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(t==="input"&&s.type==="hidden"){var x=o.name==null?null:""+o.name;if(o.type==="hidden"&&s.getAttribute("name")===x)return s}else return s;if(s=Va(s.nextSibling),s===null)break}return null}function _0(s,t,l){if(t==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Va(s.nextSibling),s===null))return null;return s}function Jp(s,t){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!t||(s=Va(s.nextSibling),s===null))return null;return s}function pm(s){return s.data==="$?"||s.data==="$~"}function gm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function S0(s,t){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=t;else if(s.data!=="$?"||l.readyState!=="loading")t();else{var i=function(){t(),l.removeEventListener("DOMContentLoaded",i)};l.addEventListener("DOMContentLoaded",i),s._reactRetry=i}}function Va(s){for(;s!=null;s=s.nextSibling){var t=s.nodeType;if(t===1||t===3)break;if(t===8){if(t=s.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return s}var jm=null;function Xp(s){s=s.nextSibling;for(var t=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(t===0)return Va(s.nextSibling);t--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||t++}s=s.nextSibling}return null}function Zp(s){s=s.previousSibling;for(var t=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(t===0)return s;t--}else l!=="/$"&&l!=="/&"||t++}s=s.previousSibling}return null}function Wp(s,t,l){switch(t=vo(l),s){case"html":if(s=t.documentElement,!s)throw Error(c(452));return s;case"head":if(s=t.head,!s)throw Error(c(453));return s;case"body":if(s=t.body,!s)throw Error(c(454));return s;default:throw Error(c(451))}}function $i(s){for(var t=s.attributes;t.length;)s.removeAttributeNode(t[0]);Nd(s)}var Ga=new Map,eg=new Set;function No(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Al=K.d;K.d={f:k0,r:C0,D:T0,C:E0,L:M0,m:A0,X:R0,S:z0,M:D0};function k0(){var s=Al.f(),t=uo();return s||t}function C0(s){var t=lr(s);t!==null&&t.tag===5&&t.type==="form"?gf(t):Al.r(s)}var Lr=typeof document>"u"?null:document;function sg(s,t,l){var i=Lr;if(i&&typeof t=="string"&&t){var o=Ua(t);o='link[rel="'+s+'"][href="'+o+'"]',typeof l=="string"&&(o+='[crossorigin="'+l+'"]'),eg.has(o)||(eg.add(o),s={rel:s,crossOrigin:l,href:t},i.querySelector(o)===null&&(t=i.createElement("link"),Kt(t,"link",s),Pt(t),i.head.appendChild(t)))}}function T0(s){Al.D(s),sg("dns-prefetch",s,null)}function E0(s,t){Al.C(s,t),sg("preconnect",s,t)}function M0(s,t,l){Al.L(s,t,l);var i=Lr;if(i&&s&&t){var o='link[rel="preload"][as="'+Ua(t)+'"]';t==="image"&&l&&l.imageSrcSet?(o+='[imagesrcset="'+Ua(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(o+='[imagesizes="'+Ua(l.imageSizes)+'"]')):o+='[href="'+Ua(s)+'"]';var x=o;switch(t){case"style":x=Ur(s);break;case"script":x=$r(s)}Ga.has(x)||(s=v({rel:"preload",href:t==="image"&&l&&l.imageSrcSet?void 0:s,as:t},l),Ga.set(x,s),i.querySelector(o)!==null||t==="style"&&i.querySelector(Bi(x))||t==="script"&&i.querySelector(Pi(x))||(t=i.createElement("link"),Kt(t,"link",s),Pt(t),i.head.appendChild(t)))}}function A0(s,t){Al.m(s,t);var l=Lr;if(l&&s){var i=t&&typeof t.as=="string"?t.as:"script",o='link[rel="modulepreload"][as="'+Ua(i)+'"][href="'+Ua(s)+'"]',x=o;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=$r(s)}if(!Ga.has(x)&&(s=v({rel:"modulepreload",href:s},t),Ga.set(x,s),l.querySelector(o)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Pi(x)))return}i=l.createElement("link"),Kt(i,"link",s),Pt(i),l.head.appendChild(i)}}}function z0(s,t,l){Al.S(s,t,l);var i=Lr;if(i&&s){var o=nr(i).hoistableStyles,x=Ur(s);t=t||"default";var j=o.get(x);if(!j){var k={loading:0,preload:null};if(j=i.querySelector(Bi(x)))k.loading=5;else{s=v({rel:"stylesheet",href:s,"data-precedence":t},l),(l=Ga.get(x))&&vm(s,l);var $=j=i.createElement("link");Pt($),Kt($,"link",s),$._p=new Promise(function(le,ve){$.onload=le,$.onerror=ve}),$.addEventListener("load",function(){k.loading|=1}),$.addEventListener("error",function(){k.loading|=2}),k.loading|=4,bo(j,t,i)}j={type:"stylesheet",instance:j,count:1,state:k},o.set(x,j)}}}function R0(s,t){Al.X(s,t);var l=Lr;if(l&&s){var i=nr(l).hoistableScripts,o=$r(s),x=i.get(o);x||(x=l.querySelector(Pi(o)),x||(s=v({src:s,async:!0},t),(t=Ga.get(o))&&Nm(s,t),x=l.createElement("script"),Pt(x),Kt(x,"link",s),l.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},i.set(o,x))}}function D0(s,t){Al.M(s,t);var l=Lr;if(l&&s){var i=nr(l).hoistableScripts,o=$r(s),x=i.get(o);x||(x=l.querySelector(Pi(o)),x||(s=v({src:s,async:!0,type:"module"},t),(t=Ga.get(o))&&Nm(s,t),x=l.createElement("script"),Pt(x),Kt(x,"link",s),l.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},i.set(o,x))}}function tg(s,t,l,i){var o=(o=G.current)?No(o):null;if(!o)throw Error(c(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(t=Ur(l.href),l=nr(o).hoistableStyles,i=l.get(t),i||(i={type:"style",instance:null,count:0,state:null},l.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Ur(l.href);var x=nr(o).hoistableStyles,j=x.get(s);if(j||(o=o.ownerDocument||o,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(s,j),(x=o.querySelector(Bi(s)))&&!x._p&&(j.instance=x,j.state.loading=5),Ga.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Ga.set(s,l),x||O0(o,s,l,j.state))),t&&i===null)throw Error(c(528,""));return j}if(t&&i!==null)throw Error(c(529,""));return null;case"script":return t=l.async,l=l.src,typeof l=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=$r(l),l=nr(o).hoistableScripts,i=l.get(t),i||(i={type:"script",instance:null,count:0,state:null},l.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(c(444,s))}}function Ur(s){return'href="'+Ua(s)+'"'}function Bi(s){return'link[rel="stylesheet"]['+s+"]"}function ag(s){return v({},s,{"data-precedence":s.precedence,precedence:null})}function O0(s,t,l,i){s.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=s.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),Kt(t,"link",l),Pt(t),s.head.appendChild(t))}function $r(s){return'[src="'+Ua(s)+'"]'}function Pi(s){return"script[async]"+s}function lg(s,t,l){if(t.count++,t.instance===null)switch(t.type){case"style":var i=s.querySelector('style[data-href~="'+Ua(l.href)+'"]');if(i)return t.instance=i,Pt(i),i;var o=v({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return i=(s.ownerDocument||s).createElement("style"),Pt(i),Kt(i,"style",o),bo(i,l.precedence,s),t.instance=i;case"stylesheet":o=Ur(l.href);var x=s.querySelector(Bi(o));if(x)return t.state.loading|=4,t.instance=x,Pt(x),x;i=ag(l),(o=Ga.get(o))&&vm(i,o),x=(s.ownerDocument||s).createElement("link"),Pt(x);var j=x;return j._p=new Promise(function(k,$){j.onload=k,j.onerror=$}),Kt(x,"link",i),t.state.loading|=4,bo(x,l.precedence,s),t.instance=x;case"script":return x=$r(l.src),(o=s.querySelector(Pi(x)))?(t.instance=o,Pt(o),o):(i=l,(o=Ga.get(x))&&(i=v({},l),Nm(i,o)),s=s.ownerDocument||s,o=s.createElement("script"),Pt(o),Kt(o,"link",i),s.head.appendChild(o),t.instance=o);case"void":return null;default:throw Error(c(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,bo(i,l.precedence,s));return t.instance}function bo(s,t,l){for(var i=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),o=i.length?i[i.length-1]:null,x=o,j=0;j<i.length;j++){var k=i[j];if(k.dataset.precedence===t)x=k;else if(x!==o)break}x?x.parentNode.insertBefore(s,x.nextSibling):(t=l.nodeType===9?l.head:l,t.insertBefore(s,t.firstChild))}function vm(s,t){s.crossOrigin==null&&(s.crossOrigin=t.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=t.referrerPolicy),s.title==null&&(s.title=t.title)}function Nm(s,t){s.crossOrigin==null&&(s.crossOrigin=t.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=t.referrerPolicy),s.integrity==null&&(s.integrity=t.integrity)}var yo=null;function ng(s,t,l){if(yo===null){var i=new Map,o=yo=new Map;o.set(l,i)}else o=yo,i=o.get(l),i||(i=new Map,o.set(l,i));if(i.has(s))return i;for(i.set(s,null),l=l.getElementsByTagName(s),o=0;o<l.length;o++){var x=l[o];if(!(x[_n]||x[js]||s==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var j=x.getAttribute(t)||"";j=s+j;var k=i.get(j);k?k.push(x):i.set(j,[x])}}return i}function rg(s,t,l){s=s.ownerDocument||s,s.head.insertBefore(l,t==="title"?s.querySelector("head > title"):null)}function L0(s,t,l){if(l===1||t.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return s=t.disabled,typeof t.precedence=="string"&&s==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function ig(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function U0(s,t,l,i){if(l.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var o=Ur(i.href),x=t.querySelector(Bi(o));if(x){t=x._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(s.count++,s=wo.bind(s),t.then(s,s)),l.state.loading|=4,l.instance=x,Pt(x);return}x=t.ownerDocument||t,i=ag(i),(o=Ga.get(o))&&vm(i,o),x=x.createElement("link"),Pt(x);var j=x;j._p=new Promise(function(k,$){j.onload=k,j.onerror=$}),Kt(x,"link",i),l.instance=x}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,t),(t=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=wo.bind(s),t.addEventListener("load",l),t.addEventListener("error",l))}}var bm=0;function $0(s,t){return s.stylesheets&&s.count===0&&So(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var i=setTimeout(function(){if(s.stylesheets&&So(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4+t);0<s.imgBytes&&bm===0&&(bm=62500*j0());var o=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&So(s,s.stylesheets),s.unsuspend)){var x=s.unsuspend;s.unsuspend=null,x()}},(s.imgBytes>bm?50:800)+t);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(i),clearTimeout(o)}}:null}function wo(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)So(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var _o=null;function So(s,t){s.stylesheets=null,s.unsuspend!==null&&(s.count++,_o=new Map,t.forEach(B0,s),_o=null,wo.call(s))}function B0(s,t){if(!(t.state.loading&4)){var l=_o.get(s);if(l)var i=l.get(null);else{l=new Map,_o.set(s,l);for(var o=s.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<o.length;x++){var j=o[x];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(l.set(j.dataset.precedence,j),i=j)}i&&l.set(null,i)}o=t.instance,j=o.getAttribute("data-precedence"),x=l.get(j)||i,x===i&&l.set(null,o),l.set(j,o),this.count++,i=wo.bind(this),o.addEventListener("load",i),o.addEventListener("error",i),x?x.parentNode.insertBefore(o,x.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(o,s.firstChild)),t.state.loading|=4}}var Ii={$$typeof:E,Provider:null,Consumer:null,_currentValue:P,_currentValue2:P,_threadCount:0};function P0(s,t,l,i,o,x,j,k,$){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=we(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=we(0),this.hiddenUpdates=we(null),this.identifierPrefix=i,this.onUncaughtError=o,this.onCaughtError=x,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=$,this.incompleteTransitions=new Map}function cg(s,t,l,i,o,x,j,k,$,le,ve,ye){return s=new P0(s,t,l,j,$,le,ve,ye,k),t=1,x===!0&&(t|=24),x=ba(3,null,null,t),s.current=x,x.stateNode=s,t=eu(),t.refCount++,s.pooledCache=t,t.refCount++,x.memoizedState={element:i,isDehydrated:l,cache:t},lu(x),s}function og(s){return s?(s=fr,s):fr}function dg(s,t,l,i,o,x){o=og(o),i.context===null?i.context=o:i.pendingContext=o,i=Ql(t),i.payload={element:l},x=x===void 0?null:x,x!==null&&(i.callback=x),l=Yl(s,i,t),l!==null&&(fa(l,s,t),vi(l,s,t))}function ug(s,t){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<t?l:t}}function ym(s,t){ug(s,t),(s=s.alternate)&&ug(s,t)}function mg(s){if(s.tag===13||s.tag===31){var t=En(s,67108864);t!==null&&fa(t,s,67108864),ym(s,67108864)}}function xg(s){if(s.tag===13||s.tag===31){var t=ka();t=sa(t);var l=En(s,t);l!==null&&fa(l,s,t),ym(s,t)}}var ko=!0;function I0(s,t,l,i){var o=M.T;M.T=null;var x=K.p;try{K.p=2,wm(s,t,l,i)}finally{K.p=x,M.T=o}}function F0(s,t,l,i){var o=M.T;M.T=null;var x=K.p;try{K.p=8,wm(s,t,l,i)}finally{K.p=x,M.T=o}}function wm(s,t,l,i){if(ko){var o=_m(i);if(o===null)om(s,t,i,Co,l),fg(s,i);else if(V0(o,s,t,l,i))i.stopPropagation();else if(fg(s,i),t&4&&-1<H0.indexOf(s)){for(;o!==null;){var x=lr(o);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var j=Oa(x.pendingLanes);if(j!==0){var k=x;for(k.pendingLanes|=2,k.entangledLanes|=2;j;){var $=1<<31-ys(j);k.entanglements[1]|=$,j&=~$}cl(x),(Is&6)===0&&(co=mt()+500,Oi(0))}}break;case 31:case 13:k=En(x,2),k!==null&&fa(k,x,2),uo(),ym(x,2)}if(x=_m(i),x===null&&om(s,t,i,Co,l),x===o)break;o=x}o!==null&&i.stopPropagation()}else om(s,t,i,null,l)}}function _m(s){return s=kd(s),Sm(s)}var Co=null;function Sm(s){if(Co=null,s=ar(s),s!==null){var t=u(s);if(t===null)s=null;else{var l=t.tag;if(l===13){if(s=h(t),s!==null)return s;s=null}else if(l===31){if(s=f(t),s!==null)return s;s=null}else if(l===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;s=null}else t!==s&&(s=null)}}return Co=s,null}function hg(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(q()){case qe:return 2;case Qe:return 8;case es:case Us:return 32;case as:return 268435456;default:return 32}default:return 32}}var km=!1,rn=null,cn=null,on=null,Fi=new Map,Hi=new Map,dn=[],H0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function fg(s,t){switch(s){case"focusin":case"focusout":rn=null;break;case"dragenter":case"dragleave":cn=null;break;case"mouseover":case"mouseout":on=null;break;case"pointerover":case"pointerout":Fi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hi.delete(t.pointerId)}}function Vi(s,t,l,i,o,x){return s===null||s.nativeEvent!==x?(s={blockedOn:t,domEventName:l,eventSystemFlags:i,nativeEvent:x,targetContainers:[o]},t!==null&&(t=lr(t),t!==null&&mg(t)),s):(s.eventSystemFlags|=i,t=s.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),s)}function V0(s,t,l,i,o){switch(t){case"focusin":return rn=Vi(rn,s,t,l,i,o),!0;case"dragenter":return cn=Vi(cn,s,t,l,i,o),!0;case"mouseover":return on=Vi(on,s,t,l,i,o),!0;case"pointerover":var x=o.pointerId;return Fi.set(x,Vi(Fi.get(x)||null,s,t,l,i,o)),!0;case"gotpointercapture":return x=o.pointerId,Hi.set(x,Vi(Hi.get(x)||null,s,t,l,i,o)),!0}return!1}function pg(s){var t=ar(s.target);if(t!==null){var l=u(t);if(l!==null){if(t=l.tag,t===13){if(t=h(l),t!==null){s.blockedOn=t,he(s.priority,function(){xg(l)});return}}else if(t===31){if(t=f(l),t!==null){s.blockedOn=t,he(s.priority,function(){xg(l)});return}}else if(t===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function To(s){if(s.blockedOn!==null)return!1;for(var t=s.targetContainers;0<t.length;){var l=_m(s.nativeEvent);if(l===null){l=s.nativeEvent;var i=new l.constructor(l.type,l);Sd=i,l.target.dispatchEvent(i),Sd=null}else return t=lr(l),t!==null&&mg(t),s.blockedOn=l,!1;t.shift()}return!0}function gg(s,t,l){To(s)&&l.delete(t)}function G0(){km=!1,rn!==null&&To(rn)&&(rn=null),cn!==null&&To(cn)&&(cn=null),on!==null&&To(on)&&(on=null),Fi.forEach(gg),Hi.forEach(gg)}function Eo(s,t){s.blockedOn===t&&(s.blockedOn=null,km||(km=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,G0)))}var Mo=null;function jg(s){Mo!==s&&(Mo=s,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Mo===s&&(Mo=null);for(var t=0;t<s.length;t+=3){var l=s[t],i=s[t+1],o=s[t+2];if(typeof i!="function"){if(Sm(i||l)===null)continue;break}var x=lr(l);x!==null&&(s.splice(t,3),t-=3,_u(x,{pending:!0,data:o,method:l.method,action:i},i,o))}}))}function Br(s){function t($){return Eo($,s)}rn!==null&&Eo(rn,s),cn!==null&&Eo(cn,s),on!==null&&Eo(on,s),Fi.forEach(t),Hi.forEach(t);for(var l=0;l<dn.length;l++){var i=dn[l];i.blockedOn===s&&(i.blockedOn=null)}for(;0<dn.length&&(l=dn[0],l.blockedOn===null);)pg(l),l.blockedOn===null&&dn.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(i=0;i<l.length;i+=3){var o=l[i],x=l[i+1],j=o[is]||null;if(typeof x=="function")j||jg(l);else if(j){var k=null;if(x&&x.hasAttribute("formAction")){if(o=x,j=x[is]||null)k=j.formAction;else if(Sm(o)!==null)continue}else k=j.action;typeof k=="function"?l[i+1]=k:(l.splice(i,3),i-=3),jg(l)}}}function vg(){function s(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(j){return o=j})},focusReset:"manual",scroll:"manual"})}function t(){o!==null&&(o(),o=null),i||setTimeout(l,20)}function l(){if(!i&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,o=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(l,100),function(){i=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),o!==null&&(o(),o=null)}}}function Cm(s){this._internalRoot=s}Ao.prototype.render=Cm.prototype.render=function(s){var t=this._internalRoot;if(t===null)throw Error(c(409));var l=t.current,i=ka();dg(l,i,s,t,null,null)},Ao.prototype.unmount=Cm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var t=s.containerInfo;dg(s.current,2,null,s,null,null),uo(),t[jt]=null}};function Ao(s){this._internalRoot=s}Ao.prototype.unstable_scheduleHydration=function(s){if(s){var t=ne();s={blockedOn:null,target:s,priority:t};for(var l=0;l<dn.length&&t!==0&&t<dn[l].priority;l++);dn.splice(l,0,s),l===0&&pg(s)}};var Ng=n.version;if(Ng!=="19.2.1")throw Error(c(527,Ng,"19.2.1"));K.findDOMNode=function(s){var t=s._reactInternals;if(t===void 0)throw typeof s.render=="function"?Error(c(188)):(s=Object.keys(s).join(","),Error(c(268,s)));return s=g(t),s=s!==null?N(s):null,s=s===null?null:s.stateNode,s};var q0={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:M,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zo.isDisabled&&zo.supportsFiber)try{bs=zo.inject(q0),ls=zo}catch{}}return Gi.createRoot=function(s,t){if(!d(s))throw Error(c(299));var l=!1,i="",o=Cf,x=Tf,j=Ef;return t!=null&&(t.unstable_strictMode===!0&&(l=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(o=t.onUncaughtError),t.onCaughtError!==void 0&&(x=t.onCaughtError),t.onRecoverableError!==void 0&&(j=t.onRecoverableError)),t=cg(s,1,!1,null,null,l,i,null,o,x,j,vg),s[jt]=t.current,cm(s),new Cm(t)},Gi.hydrateRoot=function(s,t,l){if(!d(s))throw Error(c(299));var i=!1,o="",x=Cf,j=Tf,k=Ef,$=null;return l!=null&&(l.unstable_strictMode===!0&&(i=!0),l.identifierPrefix!==void 0&&(o=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(j=l.onCaughtError),l.onRecoverableError!==void 0&&(k=l.onRecoverableError),l.formState!==void 0&&($=l.formState)),t=cg(s,1,!0,t,l??null,i,o,$,x,j,k,vg),t.context=og(null),l=t.current,i=ka(),i=sa(i),o=Ql(i),o.callback=null,Yl(l,o,i),l=i,t.current.lanes=l,Le(t,l),cl(t),s[jt]=t.current,cm(s),new Ao(t)},Gi.version="19.2.1",Gi}var Eg;function M1(){if(Eg)return Am.exports;Eg=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(n){console.error(n)}}return a(),Am.exports=E1(),Am.exports}var A1=M1();function I(...a){return nw(rw(a))}const Ce=m.forwardRef(({className:a,...n},r)=>e.jsx("div",{ref:r,className:I("rounded-xl border bg-card text-card-foreground shadow",a),...n}));Ce.displayName="Card";const De=m.forwardRef(({className:a,...n},r)=>e.jsx("div",{ref:r,className:I("flex flex-col space-y-1.5 p-6",a),...n}));De.displayName="CardHeader";const Oe=m.forwardRef(({className:a,...n},r)=>e.jsx("div",{ref:r,className:I("font-semibold leading-none tracking-tight",a),...n}));Oe.displayName="CardTitle";const os=m.forwardRef(({className:a,...n},r)=>e.jsx("div",{ref:r,className:I("text-sm text-muted-foreground",a),...n}));os.displayName="CardDescription";const Me=m.forwardRef(({className:a,...n},r)=>e.jsx("div",{ref:r,className:I("p-6 pt-0",a),...n}));Me.displayName="CardContent";const id=m.forwardRef(({className:a,...n},r)=>e.jsx("div",{ref:r,className:I("flex items-center p-6 pt-0",a),...n}));id.displayName="CardFooter";const ta=cw,Zt=m.forwardRef(({className:a,...n},r)=>e.jsx(ij,{ref:r,className:I("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...n}));Zt.displayName=ij.displayName;const Xe=m.forwardRef(({className:a,...n},r)=>e.jsx(cj,{ref:r,className:I("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...n}));Xe.displayName=cj.displayName;const ws=m.forwardRef(({className:a,...n},r)=>e.jsx(oj,{ref:r,className:I("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 data-[state=active]:animate-in data-[state=active]:fade-in data-[state=active]:duration-300",a),...n}));ws.displayName=oj.displayName;const Je=m.forwardRef(({className:a,children:n,viewportRef:r,...c},d)=>e.jsxs(dj,{ref:d,className:I("relative overflow-hidden",a),...c,children:[e.jsx(ow,{ref:r,className:"h-full w-full rounded-[inherit]",children:n}),e.jsx(Km,{}),e.jsx(Km,{orientation:"horizontal"}),e.jsx(dw,{})]}));Je.displayName=dj.displayName;const Km=m.forwardRef(({className:a,orientation:n="vertical",...r},c)=>e.jsx(uj,{ref:c,orientation:n,className:I("flex touch-none select-none transition-colors",n==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...r,children:e.jsx(uw,{className:"relative flex-1 rounded-full bg-border"})}));Km.displayName=uj.displayName;function vs({className:a,...n}){return e.jsx("div",{className:I("animate-pulse rounded-md bg-primary/10",a),...n})}const Xn=m.forwardRef(({className:a,value:n,...r},c)=>e.jsx(mj,{ref:c,className:I("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",a),...r,children:e.jsx(mw,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));Xn.displayName=mj.displayName;async function _e(a,n){const c=n?.body instanceof FormData?{...n?.headers}:{"Content-Type":"application/json",...n?.headers},d={...n,credentials:"include",headers:c},u=await fetch(a,d);if(u.status===401)throw window.location.href="/auth",new Error("");return u}function Hs(){return{"Content-Type":"application/json"}}async function z1(){try{await fetch("/api/webui/auth/logout",{method:"POST",credentials:"include"})}catch(a){console.error(":",a)}window.location.href="/auth"}async function cc(){try{return(await(await fetch("/api/webui/auth/check",{method:"GET",credentials:"include"})).json()).authenticated===!0}catch{return!1}}const R1={light:"",dark:".dark"},wv=m.createContext(null);function _v(){const a=m.useContext(wv);if(!a)throw new Error("useChart must be used within a <ChartContainer />");return a}const Vr=m.forwardRef(({id:a,className:n,children:r,config:c,...d},u)=>{const h=m.useId(),f=`chart-${a||h.replace(/:/g,"")}`;return e.jsx(wv.Provider,{value:{config:c},children:e.jsxs("div",{"data-chart":f,ref:u,className:I("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",n),...d,children:[e.jsx(D1,{id:f,config:c}),e.jsx(Mj,{children:r})]})})});Vr.displayName="Chart";const D1=({id:a,config:n})=>{const r=Object.entries(n).filter(([,c])=>c.theme||c.color);return r.length?e.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(R1).map(([c,d])=>`
${d} [data-chart=${a}] {
${r.map(([u,h])=>{const f=h.theme?.[c]||h.color;return f?`  --color-${u}: ${f};`:null}).join(`
`)}
}
`).join(`
`)}}):null},qi=Aj,Gr=m.forwardRef(({active:a,payload:n,className:r,indicator:c="dot",hideLabel:d=!1,hideIndicator:u=!1,label:h,labelFormatter:f,labelClassName:p,formatter:g,color:N,nameKey:v,labelKey:w},b)=>{const{config:y}=_v(),O=m.useMemo(()=>{if(d||!n?.length)return null;const[S]=n,B=`${w||S?.dataKey||S?.name||"value"}`,E=Qm(y,S,B),C=!w&&typeof h=="string"?y[h]?.label||h:E?.label;return f?e.jsx("div",{className:I("font-medium",p),children:f(C,n)}):C?e.jsx("div",{className:I("font-medium",p),children:C}):null},[h,f,n,d,p,y,w]);if(!a||!n?.length)return null;const R=n.length===1&&c!=="dot";return e.jsxs("div",{ref:b,className:I("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[R?null:O,e.jsx("div",{className:"grid gap-1.5",children:n.filter(S=>S.type!=="none").map((S,B)=>{const E=`${v||S.name||S.dataKey||"value"}`,C=Qm(y,S,E),A=N||S.payload.fill||S.color;return e.jsx("div",{className:I("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",c==="dot"&&"items-center"),children:g&&S?.value!==void 0&&S.name?g(S.value,S.name,S,B,S.payload):e.jsxs(e.Fragment,{children:[C?.icon?e.jsx(C.icon,{}):!u&&e.jsx("div",{className:I("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":c==="dot","w-1":c==="line","w-0 border-[1.5px] border-dashed bg-transparent":c==="dashed","my-0.5":R&&c==="dashed"}),style:{"--color-bg":A,"--color-border":A}}),e.jsxs("div",{className:I("flex flex-1 justify-between leading-none",R?"items-end":"items-center"),children:[e.jsxs("div",{className:"grid gap-1.5",children:[R?O:null,e.jsx("span",{className:"text-muted-foreground",children:C?.label||S.name})]}),S.value&&e.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:S.value.toLocaleString()})]})]})},S.dataKey)})})]})});Gr.displayName="ChartTooltip";const O1=Vw,Sv=m.forwardRef(({className:a,hideIcon:n=!1,payload:r,verticalAlign:c="bottom",nameKey:d},u)=>{const{config:h}=_v();return r?.length?e.jsx("div",{ref:u,className:I("flex items-center justify-center gap-4",c==="top"?"pb-3":"pt-3",a),children:r.filter(f=>f.type!=="none").map(f=>{const p=`${d||f.dataKey||"value"}`,g=Qm(h,f,p);return e.jsxs("div",{className:I("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[g?.icon&&!n?e.jsx(g.icon,{}):e.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:f.color}}),g?.label]},f.value)})}):null});Sv.displayName="ChartLegend";function Qm(a,n,r){if(typeof n!="object"||n===null)return;const c="payload"in n&&typeof n.payload=="object"&&n.payload!==null?n.payload:void 0;let d=r;return r in n&&typeof n[r]=="string"?d=n[r]:c&&r in c&&typeof c[r]=="string"&&(d=c[r]),d in a?a[d]:a[r]}const Zr=Wr("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),_=m.forwardRef(({className:a,variant:n,size:r,asChild:c=!1,...d},u)=>{const h=c?Jw:"button";return e.jsx(h,{className:I(Zr({variant:n,size:r,className:a})),ref:u,...d})});_.displayName="Button";const L1=Wr("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ke({className:a,variant:n,...r}){return e.jsx("div",{className:I(L1({variant:n}),a),...r})}async function U1(){const a=await _e("/api/webui/system/restart",{method:"POST",headers:Hs()});if(!a.ok){const n=await a.json();throw new Error(n.detail||"")}return await a.json()}async function $1(){const a=await _e("/api/webui/system/status",{method:"GET",headers:Hs()});if(!a.ok){const n=await a.json();throw new Error(n.detail||"")}return await a.json()}const Pr={INITIAL_DELAY:3e3,CHECK_INTERVAL:2e3,CHECK_TIMEOUT:3e3,MAX_ATTEMPTS:60,PROGRESS_INTERVAL:200,SUCCESS_REDIRECT_DELAY:1500},kv=m.createContext(null);function Wn({children:a,onRestartComplete:n,onRestartFailed:r,healthCheckUrl:c="/api/webui/system/status",maxAttempts:d=Pr.MAX_ATTEMPTS}){const[u,h]=m.useState({status:"idle",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:d}),[f,p]=m.useState({}),g=m.useCallback(()=>{f.progress&&clearInterval(f.progress),f.elapsed&&clearInterval(f.elapsed),f.check&&clearTimeout(f.check),p({})},[f]),N=m.useCallback(()=>{g(),h({status:"idle",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:d})},[g,d]),v=m.useCallback(async()=>{try{const R=new AbortController,S=setTimeout(()=>R.abort(),Pr.CHECK_TIMEOUT),B=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include",signal:R.signal});return clearTimeout(S),B.ok}catch{return!1}},[c]),w=m.useCallback(()=>{let R=0;const S=async()=>{if(R++,h(E=>({...E,status:"checking",checkAttempts:R})),await v())g(),h(E=>({...E,status:"success",progress:100})),setTimeout(()=>{n?.(),window.location.href="/auth"},Pr.SUCCESS_REDIRECT_DELAY);else if(R>=d){g();const E=` (${R}/${d})`;h(C=>({...C,status:"failed",error:E})),r?.(E)}else{const E=setTimeout(S,Pr.CHECK_INTERVAL);p(C=>({...C,check:E}))}};S()},[v,g,d,n,r]),b=m.useCallback(()=>{h(R=>({...R,status:"checking",checkAttempts:0,error:void 0})),w()},[w]),y=m.useCallback(async R=>{const{delay:S=0,skipApiCall:B=!1}=R??{};if(u.status!=="idle"&&u.status!=="failed")return;if(g(),h({status:"requesting",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:d}),S>0&&await new Promise(A=>setTimeout(A,S)),B)h(A=>({...A,status:"restarting"}));else try{h(A=>({...A,status:"restarting"})),await Promise.race([U1(),new Promise(A=>setTimeout(A,5e3))])}catch{}const E=setInterval(()=>{h(A=>({...A,progress:A.progress>=90?A.progress:A.progress+1}))},Pr.PROGRESS_INTERVAL),C=setInterval(()=>{h(A=>({...A,elapsedTime:A.elapsedTime+1}))},1e3);p({progress:E,elapsed:C}),setTimeout(()=>{w()},Pr.INITIAL_DELAY)},[u.status,g,d,w]),O={state:u,isRestarting:u.status!=="idle",triggerRestart:y,resetState:N,retryHealthCheck:b};return e.jsx(kv.Provider,{value:O,children:a})}function yn(){const a=m.useContext(kv);if(!a)throw new Error("useRestart must be used within a RestartProvider");return a}function B1(){try{return yn()}catch{return null}}const P1=(a,n,r,c,d)=>({idle:{icon:null,title:"",description:"",tip:""},requesting:{icon:e.jsx(zs,{className:"h-16 w-16 text-primary animate-spin"}),title:c??"",description:d??"...",tip:" ..."},restarting:{icon:e.jsx(zs,{className:"h-16 w-16 text-primary animate-spin"}),title:c??"",description:d??"...",tip:" ..."},checking:{icon:e.jsx(zs,{className:"h-16 w-16 text-primary animate-spin"}),title:"",description:`... (${n}/${r})`,tip:" ..."},success:{icon:e.jsx(pt,{className:"h-16 w-16 text-green-500"}),title:"",description:"...",tip:" "},failed:{icon:e.jsx(_t,{className:"h-16 w-16 text-destructive"}),title:"",description:"",tip:" "}})[a];function er({visible:a,onComplete:n,onFailed:r,title:c,description:d,showAnimation:u=!0,className:h}){const f=B1();return(f?f.isRestarting:a)?f?e.jsx(Cv,{state:f.state,onRetry:f.retryHealthCheck,onComplete:n,onFailed:r,title:c,description:d,showAnimation:u,className:h}):e.jsx(I1,{onComplete:n,onFailed:r,title:c,description:d,showAnimation:u,className:h}):null}function Cv({state:a,onRetry:n,onComplete:r,onFailed:c,title:d,description:u,showAnimation:h,className:f}){const{status:p,progress:g,elapsedTime:N,checkAttempts:v,maxAttempts:w}=a;m.useEffect(()=>{p==="success"&&r?r():p==="failed"&&c&&c()},[p,r,c]);const b=P1(p,v,w,d,u),y=O=>{const R=Math.floor(O/60),S=O%60;return`${R}:${S.toString().padStart(2,"0")}`};return e.jsxs("div",{className:I("fixed inset-0 bg-background/95 backdrop-blur-sm z-50 flex items-center justify-center",f),children:[h&&e.jsx(F1,{}),e.jsxs("div",{className:"max-w-md w-full mx-4 space-y-8 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[b.icon,(p==="restarting"||p==="checking")&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary/20 animate-ping"})]}),e.jsx("h2",{className:"text-2xl font-bold",children:b.title}),e.jsx("p",{className:"text-muted-foreground text-center",children:b.description})]}),p!=="failed"&&p!=="idle"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Xn,{value:g,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:[g,"%"]}),e.jsxs("span",{children:[": ",y(N)]})]})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:b.tip})}),p==="failed"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{onClick:()=>window.location.reload(),variant:"default",className:"flex-1",children:[e.jsx(dt,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:n,variant:"secondary",className:"flex-1",children:[e.jsx(lc,{className:"mr-2 h-4 w-4"}),""]})]})]})]})}function I1({onComplete:a,onFailed:n,title:r,description:c,showAnimation:d,className:u}){const[h,f]=m.useState({status:"restarting",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:60}),p=m.useCallback(()=>{let g=0;const N=60,v=async()=>{g++,f(w=>({...w,status:"checking",checkAttempts:g}));try{if((await fetch("/api/webui/system/status",{method:"GET",signal:AbortSignal.timeout(3e3)})).ok){f(b=>({...b,status:"success",progress:100})),setTimeout(()=>{a?.(),window.location.href="/auth"},1500);return}}catch{}g>=N?(f(w=>({...w,status:"failed"})),n?.()):setTimeout(v,2e3)};v()},[a,n]);return m.useEffect(()=>{const g=setInterval(()=>{f(w=>({...w,progress:w.progress>=90?w.progress:w.progress+1}))},200),N=setInterval(()=>{f(w=>({...w,elapsedTime:w.elapsedTime+1}))},1e3),v=setTimeout(()=>{p()},3e3);return()=>{clearInterval(g),clearInterval(N),clearTimeout(v)}},[p]),e.jsx(Cv,{state:h,onRetry:p,onComplete:a,onFailed:n,title:r,description:c,showAnimation:d,className:u})}function F1(){return e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px]",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite]"}),e.jsx("div",{className:"absolute inset-8 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite_0.5s]"}),e.jsx("div",{className:"absolute inset-16 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite_1s]"})]}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-bounce"}),e.jsx("div",{className:"absolute top-3/4 right-1/4 w-3 h-3 bg-primary/15 rounded-full animate-bounce delay-150"}),e.jsx("div",{className:"absolute top-1/2 right-1/3 w-2 h-2 bg-primary/20 rounded-full animate-bounce delay-300"})]})}const Ps=Ww,cd=e_,H1=Xw,Tv=m.forwardRef(({className:a,...n},r)=>e.jsx(zj,{ref:r,className:I("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n}));Tv.displayName=zj.displayName;const Ds=m.forwardRef(({className:a,children:n,preventOutsideClose:r=!1,...c},d)=>e.jsxs(H1,{children:[e.jsx(Tv,{}),e.jsxs(Rj,{ref:d,className:I("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),onPointerDownOutside:r?u=>u.preventDefault():void 0,onInteractOutside:r?u=>u.preventDefault():void 0,...c,children:[n,e.jsxs(Zw,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Aa,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ds.displayName=Rj.displayName;const Os=({className:a,...n})=>e.jsx("div",{className:I("flex flex-col space-y-1.5 text-center sm:text-left",a),...n});Os.displayName="DialogHeader";const st=({className:a,...n})=>e.jsx("div",{className:I("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...n});st.displayName="DialogFooter";const Ls=m.forwardRef(({className:a,...n},r)=>e.jsx(Dj,{ref:r,className:I("text-lg font-semibold leading-none tracking-tight",a),...n}));Ls.displayName=Dj.displayName;const Ks=m.forwardRef(({className:a,...n},r)=>e.jsx(Oj,{ref:r,className:I("text-sm text-muted-foreground",a),...n}));Ks.displayName=Oj.displayName;const ae=m.forwardRef(({className:a,type:n,...r},c)=>e.jsx("input",{type:n,className:I("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:c,...r}));ae.displayName="Input";const qs=m.forwardRef(({className:a,...n},r)=>e.jsx(Lj,{ref:r,className:I("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...n,children:e.jsx(s_,{className:I("grid place-content-center text-current"),children:e.jsx(Ct,{className:"h-4 w-4"})})}));qs.displayName=Lj.displayName;const Pe=i_,Ie=c_,$e=m.forwardRef(({className:a,children:n,...r},c)=>e.jsxs(Uj,{ref:c,className:I("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...r,children:[n,e.jsx(t_,{asChild:!0,children:e.jsx(za,{className:"h-4 w-4 opacity-50"})})]}));$e.displayName=Uj.displayName;const Ev=m.forwardRef(({className:a,...n},r)=>e.jsx($j,{ref:r,className:I("flex cursor-default items-center justify-center py-1",a),...n,children:e.jsx(Qr,{className:"h-4 w-4"})}));Ev.displayName=$j.displayName;const Mv=m.forwardRef(({className:a,...n},r)=>e.jsx(Bj,{ref:r,className:I("flex cursor-default items-center justify-center py-1",a),...n,children:e.jsx(za,{className:"h-4 w-4"})}));Mv.displayName=Bj.displayName;const Be=m.forwardRef(({className:a,children:n,position:r="popper",...c},d)=>e.jsx(a_,{children:e.jsxs(Pj,{ref:d,className:I("relative z-[100] max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-hidden rounded-md border border-border bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...c,children:[e.jsx(Ev,{}),e.jsx(l_,{className:I("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),e.jsx(Mv,{})]})}));Be.displayName=Pj.displayName;const V1=m.forwardRef(({className:a,...n},r)=>e.jsx(Ij,{ref:r,className:I("px-2 py-1.5 text-sm font-semibold",a),...n}));V1.displayName=Ij.displayName;const Z=m.forwardRef(({className:a,children:n,...r},c)=>e.jsxs(Fj,{ref:c,className:I("relative flex w-full cursor-default select-none items-center rounded-sm py-2 pl-2 pr-8 text-sm outline-none bg-white dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 focus:bg-gray-100 dark:focus:bg-gray-800 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(n_,{children:e.jsx(Ct,{className:"h-4 w-4"})})}),e.jsx(r_,{children:n})]}));Z.displayName=Fj.displayName;const G1=m.forwardRef(({className:a,...n},r)=>e.jsx(Hj,{ref:r,className:I("-mx-1 my-1 h-px bg-muted",a),...n}));G1.displayName=Hj.displayName;const ox=({className:a,...n})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:I("mx-auto flex w-full justify-center",a),...n});ox.displayName="Pagination";const dx=m.forwardRef(({className:a,...n},r)=>e.jsx("ul",{ref:r,className:I("flex flex-row items-center gap-1",a),...n}));dx.displayName="PaginationContent";const qn=m.forwardRef(({className:a,...n},r)=>e.jsx("li",{ref:r,className:I("",a),...n}));qn.displayName="PaginationItem";const pc=({className:a,isActive:n,size:r="icon",...c})=>e.jsx("a",{"aria-current":n?"page":void 0,className:I(Zr({variant:n?"outline":"ghost",size:r}),a),...c});pc.displayName="PaginationLink";const Av=({className:a,...n})=>e.jsxs(pc,{"aria-label":"Go to previous page",size:"default",className:I("gap-1 pl-2.5",a),...n,children:[e.jsx(Da,{className:"h-4 w-4"}),e.jsx("span",{children:""})]});Av.displayName="PaginationPrevious";const zv=({className:a,...n})=>e.jsxs(pc,{"aria-label":"Go to next page",size:"default",className:I("gap-1 pr-2.5",a),...n,children:[e.jsx("span",{children:""}),e.jsx(Wt,{className:"h-4 w-4"})]});zv.displayName="PaginationNext";const Rv=({className:a,...n})=>e.jsxs("span",{"aria-hidden":!0,className:I("flex h-9 w-9 items-center justify-center",a),...n,children:[e.jsx(v_,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"More pages"})]});Rv.displayName="PaginationEllipsis";const q1=5,K1=5e3;let Dm=0;function Q1(){return Dm=(Dm+1)%Number.MAX_SAFE_INTEGER,Dm.toString()}const Om=new Map,Mg=a=>{if(Om.has(a))return;const n=setTimeout(()=>{Om.delete(a),sc({type:"REMOVE_TOAST",toastId:a})},K1);Om.set(a,n)},Y1=(a,n)=>{switch(n.type){case"ADD_TOAST":return{...a,toasts:[n.toast,...a.toasts].slice(0,q1)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(r=>r.id===n.toast.id?{...r,...n.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=n;return r?Mg(r):a.toasts.forEach(c=>{Mg(c.id)}),{...a,toasts:a.toasts.map(c=>c.id===r||r===void 0?{...c,open:!1}:c)}}case"REMOVE_TOAST":return n.toastId===void 0?{...a,toasts:[]}:{...a,toasts:a.toasts.filter(r=>r.id!==n.toastId)}}},Po=[];let Io={toasts:[]};function sc(a){Io=Y1(Io,a),Po.forEach(n=>{n(Io)})}function Qt({...a}){const n=Q1(),r=d=>sc({type:"UPDATE_TOAST",toast:{...d,id:n}}),c=()=>sc({type:"DISMISS_TOAST",toastId:n});return sc({type:"ADD_TOAST",toast:{...a,id:n,open:!0,onOpenChange:d=>{d||c()}}}),{id:n,dismiss:c,update:r}}function Ys(){const[a,n]=m.useState(Io);return m.useEffect(()=>(Po.push(n),()=>{const r=Po.indexOf(n);r>-1&&Po.splice(r,1)}),[a]),{...a,toast:Qt,dismiss:r=>sc({type:"DISMISS_TOAST",toastId:r})}}const tl="/api/webui/expression";async function ux(){const a=await _e(`${tl}/chats`,{});if(!a.ok){const n=await a.json();throw new Error(n.detail||"")}return a.json()}async function J1(a){const n=new URLSearchParams;a.page&&n.append("page",a.page.toString()),a.page_size&&n.append("page_size",a.page_size.toString()),a.search&&n.append("search",a.search),a.chat_id&&n.append("chat_id",a.chat_id);const r=await _e(`${tl}/list?${n}`,{});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function X1(a){const n=await _e(`${tl}/${a}`,{});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}async function Z1(a){const n=await _e(`${tl}/`,{method:"POST",body:JSON.stringify(a)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}async function W1(a,n){const r=await _e(`${tl}/${a}`,{method:"PATCH",body:JSON.stringify(n)});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function e2(a){const n=await _e(`${tl}/${a}`,{method:"DELETE"});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}async function s2(a){const n=await _e(`${tl}/batch/delete`,{method:"POST",body:JSON.stringify({ids:a})});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}async function t2(){const a=await _e(`${tl}/stats/summary`,{});if(!a.ok){const n=await a.json();throw new Error(n.detail||"")}return a.json()}async function mx(){const a=await _e(`${tl}/review/stats`);if(!a.ok){const n=await a.json();throw new Error(n.detail||"")}return a.json()}async function a2(a){const n=new URLSearchParams;a.page&&n.append("page",a.page.toString()),a.page_size&&n.append("page_size",a.page_size.toString()),a.filter_type&&n.append("filter_type",a.filter_type),a.search&&n.append("search",a.search),a.chat_id&&n.append("chat_id",a.chat_id);const r=await _e(`${tl}/review/list?${n}`);if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function Ag(a){const n=await _e(`${tl}/review/batch`,{method:"POST",body:JSON.stringify({items:a})});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}function Dv({open:a,onOpenChange:n}){const[r,c]=m.useState(null),[d,u]=m.useState([]),[h,f]=m.useState(!1),[p,g]=m.useState(!1),[N,v]=m.useState(0),[w,b]=m.useState(1),[y,O]=m.useState(20),[R,S]=m.useState(""),[B,E]=m.useState("unchecked"),[C,A]=m.useState(""),[F,L]=m.useState(""),[J,U]=m.useState(new Set),[oe,Ne]=m.useState(new Set),[je,re]=m.useState(new Map),{toast:fe}=Ys(),ge=m.useCallback(async()=>{try{g(!0);const Y=await mx();c(Y)}catch(Y){console.error(":",Y)}finally{g(!1)}},[]),M=m.useCallback(async()=>{try{f(!0);const Y=await a2({page:w,page_size:y,filter_type:B,search:C||void 0});u(Y.data),v(Y.total)}catch(Y){fe({title:"",description:Y instanceof Error?Y.message:"",variant:"destructive"})}finally{f(!1)}},[w,y,B,C,fe]),K=m.useCallback(async()=>{try{const Y=await ux();if(Y?.data){const Fe=new Map;Y.data.forEach(H=>{Fe.set(H.chat_id,H.chat_name)}),re(Fe)}}catch(Y){console.error(":",Y)}},[]);m.useEffect(()=>{a&&(ge(),M(),K())},[a,ge,M,K]),m.useEffect(()=>{b(1),U(new Set)},[B,C]);const P=()=>{A(F),b(1)},ue=Y=>je.get(Y)||Y,Q=async(Y,Fe)=>{try{Ne(ee=>new Set(ee).add(Y));const H=await Ag([{id:Y,rejected:Fe,require_unchecked:B==="unchecked"}]);H.results[0]?.success?(fe({title:Fe?"":"",description:` #${Y} ${Fe?"":""}`}),M(),ge()):fe({title:"",description:H.results[0]?.message||"",variant:"destructive"})}catch(H){fe({title:"",description:H instanceof Error?H.message:"",variant:"destructive"})}finally{Ne(H=>{const ee=new Set(H);return ee.delete(Y),ee})}},Se=async Y=>{if(J.size===0){fe({title:"",description:"",variant:"destructive"});return}try{f(!0);const Fe=Array.from(J).map(ee=>({id:ee,rejected:Y,require_unchecked:B==="unchecked"})),H=await Ag(Fe);fe({title:"",description:` ${H.succeeded}  ${H.failed} `,variant:H.failed>0?"destructive":"default"}),U(new Set),M(),ge()}catch(Fe){fe({title:"",description:Fe instanceof Error?Fe.message:"",variant:"destructive"})}finally{f(!1)}},pe=()=>{J.size===d.length?U(new Set):U(new Set(d.map(Y=>Y.id)))},Te=Y=>{U(Fe=>{const H=new Set(Fe);return H.has(Y)?H.delete(Y):H.add(Y),H})},z=Y=>Y?new Date(Y*1e3).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",D=Y=>Y.checked?Y.rejected?e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(Ka,{className:"h-3 w-3"}),""]}):e.jsxs(ke,{variant:"default",className:"gap-1 bg-green-600",children:[e.jsx(pt,{className:"h-3 w-3"}),""]}):e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(na,{className:"h-3 w-3"}),""]}),G=Y=>Y?Y==="ai"?e.jsxs(ke,{variant:"secondary",className:"gap-1 text-xs",children:[e.jsx(Vn,{className:"h-3 w-3"}),"AI"]}):e.jsxs(ke,{variant:"secondary",className:"gap-1 text-xs",children:[e.jsx(jn,{className:"h-3 w-3"}),""]}):null,de=Math.ceil(N/y),Re=()=>{const Y=[];if(de<=7)for(let Fe=1;Fe<=de;Fe++)Y.push(Fe);else{Y.push(1),w>3&&Y.push("ellipsis");const Fe=Math.max(2,w-1),H=Math.min(de-1,w+1);for(let ee=Fe;ee<=H;ee++)Y.push(ee);w<de-2&&Y.push("ellipsis"),de>1&&Y.push(de)}return Y},W=()=>{const Y=parseInt(R,10);!isNaN(Y)&&Y>=1&&Y<=de&&(b(Y),S(""))};return e.jsx(Ps,{open:a,onOpenChange:n,children:e.jsxs(Ds,{className:"max-w-5xl w-[95vw] sm:w-full h-[90vh] sm:h-[85vh] flex flex-col p-0",children:[e.jsxs(Os,{className:"px-4 sm:px-6 pt-4 sm:pt-6 pb-4 border-b shrink-0",children:[e.jsx(Ls,{className:"text-lg sm:text-xl",children:""}),e.jsx(Ks,{className:"text-xs sm:text-sm",children:""}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 mt-4",children:[e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-orange-500",children:p?"-":r?.unchecked??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-500",children:p?"-":r?.passed??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-red-500",children:p?"-":r?.rejected??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-500",children:p?"-":r?.total??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]})]})]}),e.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b shrink-0 space-y-3",children:[e.jsx(ta,{value:B,onValueChange:Y=>E(Y),className:"w-full",children:e.jsxs(Zt,{className:"grid w-full grid-cols-4",children:[e.jsxs(Xe,{value:"unchecked",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx(na,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r?.unchecked??0,")"]})]}),e.jsxs(Xe,{value:"passed",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx(pt,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r?.passed??0,")"]})]}),e.jsxs(Xe,{value:"rejected",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx(Ka,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r?.rejected??0,")"]})]}),e.jsxs(Xe,{value:"all",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx("span",{children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r?.total??0,")"]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:F,onChange:Y=>L(Y.target.value),onKeyDown:Y=>Y.key==="Enter"&&P(),className:"pl-9"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"icon",onClick:P,children:e.jsx(Tt,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"icon",onClick:()=>{M(),ge()},disabled:h,children:e.jsx(dt,{className:I("h-4 w-4",h&&"animate-spin")})})]}),B==="unchecked"&&J.size>0&&e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsxs(_,{variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700 flex-1 sm:flex-none",onClick:()=>Se(!1),disabled:h,children:[e.jsx(pt,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",J.size,")"]}),e.jsxs(_,{variant:"destructive",size:"sm",className:"flex-1 sm:flex-none",onClick:()=>Se(!0),disabled:h,children:[e.jsx(Ka,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",J.size,")"]})]})]})]}),e.jsx(Je,{className:"flex-1 px-4 sm:px-6",children:h&&d.length===0?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(dt,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):d.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-muted-foreground",children:[e.jsx(_t,{className:"h-8 w-8 mb-2"}),e.jsx("p",{children:""})]}):e.jsxs("div",{className:"space-y-2 py-2",children:[B==="unchecked"&&d.length>0&&e.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 rounded-lg bg-muted/50",children:[e.jsx(qs,{checked:J.size===d.length&&d.length>0,onCheckedChange:pe}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" (",d.length," )"]})]}),d.map(Y=>e.jsx("div",{className:I("rounded-lg border p-3 sm:p-4 space-y-2 sm:space-y-3 transition-colors",J.has(Y.id)&&"bg-accent border-primary",oe.has(Y.id)&&"opacity-50"),children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[B==="unchecked"&&e.jsx(qs,{checked:J.has(Y.id),onCheckedChange:()=>Te(Y.id),disabled:oe.has(Y.id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"text-sm font-medium break-words",children:Y.situation})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground break-words",children:Y.style})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["#",Y.id]}),e.jsx("span",{children:""}),e.jsx("span",{title:ue(Y.chat_id),className:"truncate max-w-24 sm:max-w-32",children:ue(Y.chat_id)}),e.jsx("span",{children:""}),e.jsx("span",{children:z(Y.create_date)}),e.jsxs("div",{className:"flex items-center gap-1",children:[D(Y),G(Y.modified_by)]})]})]}),e.jsx("div",{className:"flex flex-col gap-1 sm:gap-2 shrink-0",children:B==="unchecked"?e.jsxs(e.Fragment,{children:[e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Q(Y.id,!1),disabled:oe.has(Y.id),children:[e.jsx(pt,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Q(Y.id,!0),disabled:oe.has(Y.id),children:[e.jsx(Ka,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]}):B==="passed"?e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Q(Y.id,!0),disabled:oe.has(Y.id),children:[e.jsx(Ka,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):B==="rejected"?e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Q(Y.id,!1),disabled:oe.has(Y.id),children:[e.jsx(pt,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):e.jsx(e.Fragment,{children:Y.rejected?e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Q(Y.id,!1),disabled:oe.has(Y.id),children:[e.jsx(pt,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):Y.checked?e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Q(Y.id,!0),disabled:oe.has(Y.id),children:[e.jsx(Ka,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Q(Y.id,!1),disabled:oe.has(Y.id),children:[e.jsx(pt,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Q(Y.id,!0),disabled:oe.has(Y.id),children:[e.jsx(Ka,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]})})})]})},Y.id))]})}),e.jsxs("div",{className:"px-4 sm:px-6 py-3 border-t shrink-0 flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsxs(Pe,{value:y.toString(),onValueChange:Y=>{O(parseInt(Y,10)),b(1)},children:[e.jsx($e,{className:"w-[70px] h-8",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"10",children:"10"}),e.jsx(Z,{value:"20",children:"20"}),e.jsx(Z,{value:"50",children:"50"}),e.jsx(Z,{value:"100",children:"100"})]})]}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsxs("span",{className:"text-muted-foreground",children:[" ",N," "]})]}),e.jsx(ox,{className:"mx-0 w-auto",children:e.jsxs(dx,{children:[e.jsx(qn,{children:e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>b(Y=>Math.max(1,Y-1)),disabled:w<=1||h,children:e.jsx(Da,{className:"h-4 w-4"})})}),Re().map((Y,Fe)=>e.jsx(qn,{children:Y==="ellipsis"?e.jsx(Rv,{}):e.jsx(pc,{href:"#",isActive:Y===w,onClick:H=>{H.preventDefault(),b(Y)},className:"h-8 w-8 cursor-pointer",children:Y})},Fe)),e.jsx(qn,{children:e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>b(Y=>Math.min(de,Y+1)),disabled:w>=de||h,children:e.jsx(Wt,{className:"h-4 w-4"})})})]})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(ae,{type:"number",min:1,max:de,value:R,onChange:Y=>S(Y.target.value),onKeyDown:Y=>Y.key==="Enter"&&W(),className:"w-16 h-8 text-center",placeholder:w.toString()}),e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(_,{variant:"outline",size:"sm",className:"h-8",onClick:W,disabled:h,children:""})]})]})]})})}function l2(){return e.jsx(Wn,{children:e.jsx(r2,{})})}const n2=a=>{const n=[];for(let r=0;r<a;r++){const c=r*137.508%360;n.push(`hsl(${c}, 70%, 55%)`)}return n};function r2(){const[a,n]=m.useState(null),[r,c]=m.useState(!0),[d,u]=m.useState(0),[h,f]=m.useState(24),[p,g]=m.useState(!0),[N,v]=m.useState(null),[w,b]=m.useState(!0),[y,O]=m.useState(null),[R,S]=m.useState(!1),[B,E]=m.useState(0),{triggerRestart:C,isRestarting:A}=yn(),F=m.useCallback(async()=>{try{const z=await mx();E(z.unchecked)}catch(z){console.error(":",z)}},[]),L=m.useCallback(async()=>{try{b(!0);const z=await iw.get("https://v1.hitokoto.cn/?c=a&c=b&c=c&c=d&c=h&c=i&c=k");v({hitokoto:z.data.hitokoto,from:z.data.from||z.data.from_who||""})}catch(z){console.error(":",z),v({hitokoto:"",from:""})}finally{b(!1)}},[]),J=m.useCallback(async()=>{try{const z=await _e("/api/webui/system/status");if(z.ok){const D=await z.json();O(D)}else O(null)}catch(z){console.error(":",z),O(null)}},[]),U=async()=>{await C()},oe=m.useCallback(async()=>{try{const z=await _e(`/api/webui/statistics/dashboard?hours=${h}`);if(z.ok){const D=await z.json();n(D)}c(!1),u(100)}catch(z){console.error("Failed to fetch dashboard data:",z),c(!1),u(100)}},[h]);if(m.useEffect(()=>{if(!r)return;u(0);const z=setTimeout(()=>u(15),200),D=setTimeout(()=>u(30),800),G=setTimeout(()=>u(45),2e3),de=setTimeout(()=>u(60),4e3),Re=setTimeout(()=>u(75),6500),W=setTimeout(()=>u(85),9e3),Y=setTimeout(()=>u(92),11e3);return()=>{clearTimeout(z),clearTimeout(D),clearTimeout(G),clearTimeout(de),clearTimeout(Re),clearTimeout(W),clearTimeout(Y)}},[r]),m.useEffect(()=>{oe(),L(),J(),F()},[oe,L,J,F]),m.useEffect(()=>{if(!p)return;const z=setInterval(()=>{oe(),J()},3e4);return()=>clearInterval(z)},[p,oe,J]),r||!a)return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsxs("div",{className:"text-center space-y-6 w-full max-w-md px-4",children:[e.jsx(dt,{className:"h-12 w-12 animate-spin mx-auto text-primary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium",children:"..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Xn,{value:d,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[d,"%"]})]})]})});const{summary:Ne,model_stats:je=[],hourly_data:re=[],daily_data:fe=[],recent_activity:ge=[]}=a,M=Ne??{total_requests:0,total_cost:0,total_tokens:0,online_time:0,total_messages:0,total_replies:0,avg_response_time:0,cost_per_hour:0,tokens_per_hour:0},K=z=>{const D=Math.floor(z/3600),G=Math.floor(z%3600/60);return`${D}${G}`},P=z=>{const D=z.toLocaleString("zh-CN");return z>=1e9?{display:`${(z/1e9).toFixed(2)}B`,exact:D,needsExact:!0}:z>=1e6?{display:`${(z/1e6).toFixed(2)}M`,exact:D,needsExact:!0}:z>=1e4?{display:`${(z/1e3).toFixed(1)}K`,exact:D,needsExact:!0}:z>=1e3?{display:`${(z/1e3).toFixed(2)}K`,exact:D,needsExact:!0}:{display:D,exact:D,needsExact:!1}},ue=z=>{const D=`${z.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return z>=1e6?{display:`${(z/1e6).toFixed(2)}M`,exact:D,needsExact:!0}:z>=1e4?{display:`${(z/1e3).toFixed(1)}K`,exact:D,needsExact:!0}:z>=1e3?{display:`${(z/1e3).toFixed(2)}K`,exact:D,needsExact:!0}:{display:D,exact:D,needsExact:!1}},Q=z=>new Date(z).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),Se=n2(je.length),pe=je.map((z,D)=>({name:z.model_name,value:z.request_count,fill:Se[D]})),Te={requests:{label:"",color:"hsl(var(--chart-1))"},cost:{label:"()",color:"hsl(var(--chart-2))"},tokens:{label:"Tokens",color:"hsl(var(--chart-3))"}};return e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ta,{value:h.toString(),onValueChange:z=>f(Number(z)),children:e.jsxs(Zt,{className:"grid grid-cols-3 w-full sm:w-auto",children:[e.jsx(Xe,{value:"24",children:"24"}),e.jsx(Xe,{value:"168",children:"7"}),e.jsx(Xe,{value:"720",children:"30"})]})}),e.jsxs(_,{variant:p?"default":"outline",size:"sm",onClick:()=>g(!p),className:"gap-2",children:[e.jsx(dt,{className:`h-4 w-4 ${p?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:oe,children:e.jsx(dt,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg border border-dashed border-muted-foreground/30 bg-muted/20",children:[w?e.jsx(vs,{className:"h-5 flex-1"}):N?e.jsxs("p",{className:"flex-1 text-sm text-muted-foreground italic truncate",children:['"',N.hitokoto,'"  ',N.from]}):null,e.jsx(_,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:L,disabled:w,children:e.jsx(dt,{className:`h-3.5 w-3.5 ${w?"animate-spin":""}`})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-3",children:[e.jsxs(Ce,{className:"lg:col-span-1",children:[e.jsx(De,{className:"pb-3",children:e.jsxs(Oe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(hc,{className:"h-4 w-4"}),""]})}),e.jsx(Me,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:y?.running?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-green-500 animate-pulse"}),e.jsxs(ke,{variant:"outline",className:"text-green-600 border-green-300 bg-green-50",children:[e.jsx(pt,{className:"h-3 w-3 mr-1"}),""]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-red-500"}),e.jsxs(ke,{variant:"outline",className:"text-red-600 border-red-300 bg-red-50",children:[e.jsx(_t,{className:"h-3 w-3 mr-1"}),""]})]})}),y&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("span",{children:["v",y.version]}),e.jsx("span",{className:"mx-2",children:"|"}),e.jsxs("span",{children:[" ",K(y.uptime)]})]})]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"pb-3",children:e.jsxs(Oe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(el,{className:"h-4 w-4"}),""]})}),e.jsx(Me,{children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:U,disabled:A,className:"gap-2",children:[e.jsx(lc,{className:`h-4 w-4 ${A?"animate-spin":""}`}),A?"...":""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>S(!0),className:"gap-2",children:[e.jsx(Wj,{className:"h-4 w-4"}),"",B>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs rounded-full bg-orange-500 text-white",children:B>99?"99+":B})]}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Fn,{to:"/logs",children:[e.jsx(Ea,{className:"h-4 w-4"}),""]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Fn,{to:"/plugins",children:[e.jsx(N_,{className:"h-4 w-4"}),""]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Fn,{to:"/settings",children:[e.jsx(vn,{className:"h-4 w-4"}),""]})})]})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"pb-3",children:[e.jsxs(Oe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(b_,{className:"h-4 w-4"}),""]}),e.jsx(os,{className:"text-xs",children:""})]}),e.jsx(Me,{children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Fn,{to:"/survey/webui-feedback",children:[e.jsx(Ea,{className:"h-4 w-4"}),"WebUI "]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Fn,{to:"/survey/maibot-feedback",children:[e.jsx(Ra,{className:"h-4 w-4"}),""]})})]})})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 xs:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(sx,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[P(M.total_requests).display,P(M.total_requests).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",P(M.total_requests).exact,")"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["",h<48?h+"":Math.floor(h/24)+""]})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(y_,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[ue(M.total_cost).display,ue(M.total_cost).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",ue(M.total_cost).exact,")"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:M.cost_per_hour>0?`${M.cost_per_hour.toFixed(2)}/`:""})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:"Token"}),e.jsx(Yr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[P(M.total_tokens).display,P(M.total_tokens).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",P(M.total_tokens).exact,")"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:M.tokens_per_hour>0?`${P(M.tokens_per_hour).display}/`:""})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(el,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[M.avg_response_time.toFixed(2),"s"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"API"})]})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-3",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(na,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:e.jsxs("div",{className:"text-xl font-bold",children:[K(M.online_time),e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",M.online_time.toLocaleString(),")"]})]})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(Ra,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-xl font-bold",children:[P(M.total_messages).display,P(M.total_messages).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",P(M.total_messages).exact,")"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",P(M.total_replies).display,P(M.total_replies).needsExact&&e.jsxs("span",{children:["(",P(M.total_replies).exact,")"]})," "]})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(tx,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-xl font-bold",children:M.total_messages>0?`${(M.total_cost/M.total_messages*100).toFixed(2)}`:"0.00"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"100"})]})]})]}),e.jsxs(ta,{defaultValue:"trends",className:"space-y-4",children:[e.jsxs(Zt,{className:"grid w-full grid-cols-2 sm:grid-cols-4",children:[e.jsx(Xe,{value:"trends",children:""}),e.jsx(Xe,{value:"models",children:""}),e.jsx(Xe,{value:"activity",children:""}),e.jsx(Xe,{value:"daily",children:""})]}),e.jsxs(ws,{value:"trends",className:"space-y-4",children:[e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsxs(os,{children:["",h,""]})]}),e.jsx(Me,{children:e.jsx(Vr,{config:Te,className:"h-[300px] sm:h-[400px] w-full aspect-auto",children:e.jsxs(Gw,{data:re,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>Q(z),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Hr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qi,{content:e.jsx(Gr,{labelFormatter:z=>Q(z)})}),e.jsx(qw,{type:"monotone",dataKey:"requests",stroke:"var(--color-requests)",strokeWidth:2})]})})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsx(os,{children:"API"})]}),e.jsx(Me,{children:e.jsx(Vr,{config:Te,className:"h-[250px] sm:h-[300px] w-full aspect-auto",children:e.jsxs(Uo,{data:re,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>Q(z),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Hr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qi,{content:e.jsx(Gr,{labelFormatter:z=>Q(z)})}),e.jsx(Ji,{dataKey:"cost",fill:"var(--color-cost)"})]})})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:"Token"}),e.jsx(os,{children:"Token"})]}),e.jsx(Me,{children:e.jsx(Vr,{config:Te,className:"h-[250px] sm:h-[300px] w-full aspect-auto",children:e.jsxs(Uo,{data:re,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>Q(z),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Hr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qi,{content:e.jsx(Gr,{labelFormatter:z=>Q(z)})}),e.jsx(Ji,{dataKey:"tokens",fill:"var(--color-tokens)"})]})})})]})]})]}),e.jsx(ws,{value:"models",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsxs(os,{children:[" ( ",je.length," )"]})]}),e.jsx(Me,{children:e.jsx(Vr,{config:Object.fromEntries(je.map((z,D)=>[z.model_name,{label:z.model_name,color:Se[D]}])),className:"h-[300px] sm:h-[400px] w-full aspect-auto",children:e.jsxs(Kw,{children:[e.jsx(qi,{content:e.jsx(Gr,{})}),e.jsx(Qw,{data:pe,cx:"50%",cy:"50%",labelLine:!1,label:({name:z,percent:D})=>D&&D<.05?"":`${z} ${D?(D*100).toFixed(0):0}%`,outerRadius:100,dataKey:"value",children:pe.map((z,D)=>e.jsx(Yw,{fill:z.fill},`cell-${D}`))})]})})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsx(os,{children:""})]}),e.jsx(Me,{children:e.jsx(Je,{className:"h-[300px] sm:h-[400px]",children:e.jsx("div",{className:"space-y-3",children:je.map((z,D)=>e.jsxs("div",{className:"p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-sm truncate flex-1 min-w-0",children:z.model_name}),e.jsx("div",{className:"w-3 h-3 rounded-full ml-2 flex-shrink-0",style:{backgroundColor:`hsl(var(--chart-${D%5+1}))`}})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"ml-1 font-medium",children:z.request_count.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1 font-medium",children:["",z.total_cost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[(z.total_tokens/1e3).toFixed(1),"K"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1 font-medium",children:[z.avg_response_time.toFixed(2),"s"]})]})]})]},D))})})})]})]})}),e.jsx(ws,{value:"activity",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsx(os,{children:"API"})]}),e.jsx(Me,{children:e.jsx(Je,{className:"h-[400px] sm:h-[500px]",children:e.jsx("div",{className:"space-y-2",children:ge.map((z,D)=>e.jsxs("div",{className:"p-3 sm:p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:z.model}),e.jsx("div",{className:"text-xs text-muted-foreground",children:z.request_type})]}),e.jsx("div",{className:"text-xs text-muted-foreground flex-shrink-0",children:Q(z.timestamp)})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsx("span",{className:"ml-1",children:z.tokens})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1",children:["",z.cost.toFixed(4)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1",children:[z.time_cost.toFixed(2),"s"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:`ml-1 ${z.status==="success"?"text-green-600":"text-red-600"}`,children:z.status})]})]})]},D))})})})]})}),e.jsx(ws,{value:"daily",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsx(os,{children:"7"})]}),e.jsx(Me,{children:e.jsx(Vr,{config:{requests:{label:"",color:"hsl(var(--chart-1))"},cost:{label:"()",color:"hsl(var(--chart-2))"}},className:"h-[400px] sm:h-[500px] w-full aspect-auto",children:e.jsxs(Uo,{data:fe,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>{const D=new Date(z);return`${D.getMonth()+1}/${D.getDate()}`},stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Hr,{yAxisId:"left",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Hr,{yAxisId:"right",orientation:"right",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qi,{content:e.jsx(Gr,{labelFormatter:z=>new Date(z).toLocaleDateString("zh-CN")})}),e.jsx(O1,{content:e.jsx(Sv,{})}),e.jsx(Ji,{yAxisId:"left",dataKey:"requests",fill:"var(--color-requests)"}),e.jsx(Ji,{yAxisId:"right",dataKey:"cost",fill:"var(--color-cost)"})]})})})]})})]}),e.jsx(er,{}),e.jsx(Dv,{open:R,onOpenChange:z=>{S(z),z||F()}})]})})}const i2={theme:"system",setTheme:()=>null},Ov=m.createContext(i2),xx=()=>{const a=m.useContext(Ov);if(a===void 0)throw new Error("useTheme must be used within a ThemeProvider");return a},c2=(a,n,r)=>{const c=document.documentElement.classList.contains("no-animations");if(!document.startViewTransition||c){n(a);return}const d=r.clientX,u=r.clientY,h=Math.hypot(Math.max(d,innerWidth-d),Math.max(u,innerHeight-u));document.startViewTransition(()=>{n(a)}).ready.then(()=>{document.documentElement.animate({clipPath:[`circle(0px at ${d}px ${u}px)`,`circle(${h}px at ${d}px ${u}px)`]},{duration:500,easing:"ease-in-out",pseudoElement:"::view-transition-new(root)"})})},Lv=m.createContext(void 0),Uv=()=>{const a=m.useContext(Lv);if(a===void 0)throw new Error("useAnimation must be used within an AnimationProvider");return a},Ve=m.forwardRef(({className:a,...n},r)=>e.jsx(xj,{className:I("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...n,ref:r,children:e.jsx(xw,{className:I("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Ve.displayName=xj.displayName;const o2=Wr("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),T=m.forwardRef(({className:a,...n},r)=>e.jsx(Vj,{ref:r,className:I(o2(),a),...n}));T.displayName=Vj.displayName;const d2=[{id:"minLength",label:" 10 ",description:"Token  10 ",validate:a=>a.length>=10},{id:"hasUppercase",label:"",description:" (A-Z)",validate:a=>/[A-Z]/.test(a)},{id:"hasLowercase",label:"",description:" (a-z)",validate:a=>/[a-z]/.test(a)},{id:"hasSpecialChar",label:"",description:" (!@#$%^&*()_+-=[]{}|;:,.<>?/)",validate:a=>/[!@#$%^&*()_+\-=[\]{}|;:,.<>?/]/.test(a)}];function u2(a){const n=d2.map(c=>({id:c.id,label:c.label,description:c.description,passed:c.validate(a)}));return{isValid:n.every(c=>c.passed),rules:n}}const od="0.12.1",hx="MaiBot Dashboard",m2=`${hx} v${od}`,x2=(a="v")=>`${a}${od}`,pa={THEME:"maibot-ui-theme",ACCENT_COLOR:"accent-color",ENABLE_ANIMATIONS:"maibot-animations",ENABLE_WAVES_BACKGROUND:"maibot-waves-background",LOG_CACHE_SIZE:"maibot-log-cache-size",LOG_AUTO_SCROLL:"maibot-log-auto-scroll",LOG_FONT_SIZE:"maibot-log-font-size",LOG_LINE_SPACING:"maibot-log-line-spacing",DATA_SYNC_INTERVAL:"maibot-data-sync-interval",WS_RECONNECT_INTERVAL:"maibot-ws-reconnect-interval",WS_MAX_RECONNECT_ATTEMPTS:"maibot-ws-max-reconnect-attempts",COMPLETED_TOURS:"maibot-completed-tours"},dl={theme:"system",accentColor:"blue",enableAnimations:!0,enableWavesBackground:!0,logCacheSize:1e3,logAutoScroll:!0,logFontSize:"xs",logLineSpacing:4,dataSyncInterval:30,wsReconnectInterval:3e3,wsMaxReconnectAttempts:10};function yt(a){const n=$v(a),r=localStorage.getItem(n);if(r===null)return dl[a];const c=dl[a];if(typeof c=="boolean")return r==="true";if(typeof c=="number"){const d=parseFloat(r);return isNaN(d)?c:d}return r}function qr(a,n){const r=$v(a);localStorage.setItem(r,String(n)),window.dispatchEvent(new CustomEvent("maibot-settings-change",{detail:{key:a,value:n}}))}function h2(){return{theme:yt("theme"),accentColor:yt("accentColor"),enableAnimations:yt("enableAnimations"),enableWavesBackground:yt("enableWavesBackground"),logCacheSize:yt("logCacheSize"),logAutoScroll:yt("logAutoScroll"),logFontSize:yt("logFontSize"),logLineSpacing:yt("logLineSpacing"),dataSyncInterval:yt("dataSyncInterval"),wsReconnectInterval:yt("wsReconnectInterval"),wsMaxReconnectAttempts:yt("wsMaxReconnectAttempts")}}function f2(){const a=h2(),n=localStorage.getItem(pa.COMPLETED_TOURS),r=n?JSON.parse(n):[];return{...a,completedTours:r}}function p2(a){const n=[],r=[];for(const[c,d]of Object.entries(a)){if(c==="completedTours"){Array.isArray(d)?(localStorage.setItem(pa.COMPLETED_TOURS,JSON.stringify(d)),n.push("completedTours")):r.push("completedTours");continue}if(c in dl){const u=c,h=dl[u];if(typeof d==typeof h){if(u==="theme"&&!["light","dark","system"].includes(d)){r.push(c);continue}if(u==="logFontSize"&&!["xs","sm","base"].includes(d)){r.push(c);continue}qr(u,d),n.push(c)}else r.push(c)}else r.push(c)}return{success:n.length>0,imported:n,skipped:r}}function g2(){for(const a of Object.keys(dl))qr(a,dl[a]);localStorage.removeItem(pa.COMPLETED_TOURS),window.dispatchEvent(new CustomEvent("maibot-settings-reset"))}function j2(){const a=[],n=[],r=[];for(let c=0;c<localStorage.length;c++){const d=localStorage.key(c);d&&(d.startsWith("maibot")||d.startsWith("accent-color")||d==="access-token")&&r.push(d)}for(const c of r)localStorage.removeItem(c),a.push(c);return{clearedKeys:a,preservedKeys:n}}function zg(){let a=0;const n=[];for(let r=0;r<localStorage.length;r++){const c=localStorage.key(r);if(c){const d=localStorage.getItem(c)||"",u=(c.length+d.length)*2;a+=u,n.push({key:c,size:u})}}return n.sort((r,c)=>c.size-r.size),{used:a,items:localStorage.length,details:n}}function v2(a){if(a===0)return"0 B";const n=1024,r=["B","KB","MB"],c=Math.floor(Math.log(a)/Math.log(n));return parseFloat((a/Math.pow(n,c)).toFixed(2))+" "+r[c]}function $v(a){return{theme:pa.THEME,accentColor:pa.ACCENT_COLOR,enableAnimations:pa.ENABLE_ANIMATIONS,enableWavesBackground:pa.ENABLE_WAVES_BACKGROUND,logCacheSize:pa.LOG_CACHE_SIZE,logAutoScroll:pa.LOG_AUTO_SCROLL,logFontSize:pa.LOG_FONT_SIZE,logLineSpacing:pa.LOG_LINE_SPACING,dataSyncInterval:pa.DATA_SYNC_INTERVAL,wsReconnectInterval:pa.WS_RECONNECT_INTERVAL,wsMaxReconnectAttempts:pa.WS_MAX_RECONNECT_ATTEMPTS}[a]}const Qa=m.forwardRef(({className:a,...n},r)=>e.jsxs(hj,{ref:r,className:I("relative flex w-full touch-none select-none items-center",a),...n,children:[e.jsx(hw,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(fw,{className:"absolute h-full bg-primary"})}),e.jsx(pw,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Qa.displayName=hj.displayName;class N2{ws=null;reconnectTimeout=null;reconnectAttempts=0;heartbeatInterval=null;logCallbacks=new Set;connectionCallbacks=new Set;isConnected=!1;logCache=[];getMaxCacheSize(){return yt("logCacheSize")}getMaxReconnectAttempts(){return yt("wsMaxReconnectAttempts")}getReconnectInterval(){return yt("wsReconnectInterval")}getWebSocketUrl(n){let r;{const c=window.location.protocol==="https:"?"wss:":"ws:",d=window.location.host;r=`${c}//${d}/ws/logs`}return n?`${r}?token=${encodeURIComponent(n)}`:r}async getWsToken(){try{const n=await _e("/api/webui/ws-token",{method:"GET",credentials:"include"});if(!n.ok)return console.error(" WebSocket token :",n.status),null;const r=await n.json();return r.success&&r.token?r.token:null}catch(n){return console.error(" WebSocket token :",n),null}}async connect(){if(this.ws?.readyState===WebSocket.OPEN||this.ws?.readyState===WebSocket.CONNECTING)return;if(window.location.pathname==="/auth"){console.log("  WebSocket ");return}if(!await cc()){console.log("  WebSocket ");return}const r=await this.getWsToken();if(!r){console.log("  WebSocket token");return}const c=this.getWebSocketUrl(r);try{this.ws=new WebSocket(c),this.ws.onopen=()=>{this.isConnected=!0,this.reconnectAttempts=0,this.notifyConnection(!0),this.startHeartbeat()},this.ws.onmessage=d=>{try{if(d.data==="pong")return;const u=JSON.parse(d.data);this.notifyLog(u)}catch(u){console.error(":",u)}},this.ws.onerror=d=>{console.error(" WebSocket :",d),this.isConnected=!1,this.notifyConnection(!1)},this.ws.onclose=()=>{this.isConnected=!1,this.notifyConnection(!1),this.stopHeartbeat(),this.attemptReconnect()}}catch(d){console.error(" WebSocket :",d),this.attemptReconnect()}}attemptReconnect(){const n=this.getMaxReconnectAttempts();if(this.reconnectAttempts>=n)return;this.reconnectAttempts+=1;const r=this.getReconnectInterval(),c=Math.min(r*this.reconnectAttempts,3e4);this.reconnectTimeout=window.setTimeout(()=>{this.connect()},c)}startHeartbeat(){this.heartbeatInterval=window.setInterval(()=>{this.ws?.readyState===WebSocket.OPEN&&this.ws.send("ping")},3e4)}stopHeartbeat(){this.heartbeatInterval!==null&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}disconnect(){this.reconnectTimeout!==null&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.stopHeartbeat(),this.ws&&(this.ws.close(),this.ws=null),this.isConnected=!1,this.reconnectAttempts=0}onLog(n){return this.logCallbacks.add(n),()=>this.logCallbacks.delete(n)}onConnectionChange(n){return this.connectionCallbacks.add(n),n(this.isConnected),()=>this.connectionCallbacks.delete(n)}notifyLog(n){if(!this.logCache.some(c=>c.id===n.id)){this.logCache.push(n);const c=this.getMaxCacheSize();this.logCache.length>c&&(this.logCache=this.logCache.slice(-c)),this.logCallbacks.forEach(d=>{try{d(n)}catch(u){console.error(":",u)}})}}notifyConnection(n){this.connectionCallbacks.forEach(r=>{try{r(n)}catch(c){console.error(":",c)}})}getAllLogs(){return[...this.logCache]}clearLogs(){this.logCache=[]}getConnectionStatus(){return this.isConnected}}const Hn=new N2;typeof window<"u"&&setTimeout(()=>{Hn.connect()},100);const Ns=jw,wt=vw,b2=gw,Bv=m.forwardRef(({className:a,...n},r)=>e.jsx(fj,{className:I("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n,ref:r}));Bv.displayName=fj.displayName;const us=m.forwardRef(({className:a,...n},r)=>e.jsxs(b2,{children:[e.jsx(Bv,{}),e.jsx(pj,{ref:r,className:I("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...n})]}));us.displayName=pj.displayName;const ms=({className:a,...n})=>e.jsx("div",{className:I("flex flex-col space-y-2 text-center sm:text-left",a),...n});ms.displayName="AlertDialogHeader";const xs=({className:a,...n})=>e.jsx("div",{className:I("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...n});xs.displayName="AlertDialogFooter";const hs=m.forwardRef(({className:a,...n},r)=>e.jsx(gj,{ref:r,className:I("text-lg font-semibold",a),...n}));hs.displayName=gj.displayName;const fs=m.forwardRef(({className:a,...n},r)=>e.jsx(jj,{ref:r,className:I("text-sm text-muted-foreground",a),...n}));fs.displayName=jj.displayName;const ps=m.forwardRef(({className:a,variant:n,...r},c)=>e.jsx(vj,{ref:c,className:I(Zr({variant:n}),a),...r}));ps.displayName=vj.displayName;const gs=m.forwardRef(({className:a,...n},r)=>e.jsx(Nj,{ref:r,className:I(Zr({variant:"outline"}),"mt-2 sm:mt-0",a),...n}));gs.displayName=Nj.displayName;function y2(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]})}),e.jsxs(ta,{defaultValue:"appearance",className:"w-full",children:[e.jsxs(Zt,{className:"grid w-full grid-cols-2 sm:grid-cols-4 gap-0.5 sm:gap-1 h-auto p-1",children:[e.jsxs(Xe,{value:"appearance",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(w_,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Xe,{value:"security",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(ev,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Xe,{value:"other",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(vn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Xe,{value:"about",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(Ft,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]})]}),e.jsxs(Je,{className:"h-[calc(100vh-240px)] sm:h-[calc(100vh-280px)] mt-4 sm:mt-6",children:[e.jsx(ws,{value:"appearance",className:"mt-0",children:e.jsx(w2,{})}),e.jsx(ws,{value:"security",className:"mt-0",children:e.jsx(_2,{})}),e.jsx(ws,{value:"other",className:"mt-0",children:e.jsx(S2,{})}),e.jsx(ws,{value:"about",className:"mt-0",children:e.jsx(k2,{})})]})]})]})}function Rg(a){const n=document.documentElement,c={blue:{hsl:"221.2 83.2% 53.3%",darkHsl:"217.2 91.2% 59.8%",gradient:null},purple:{hsl:"271 91% 65%",darkHsl:"270 95% 75%",gradient:null},green:{hsl:"142 71% 45%",darkHsl:"142 76% 36%",gradient:null},orange:{hsl:"25 95% 53%",darkHsl:"20 90% 48%",gradient:null},pink:{hsl:"330 81% 60%",darkHsl:"330 85% 70%",gradient:null},red:{hsl:"0 84% 60%",darkHsl:"0 90% 70%",gradient:null},"gradient-sunset":{hsl:"15 95% 60%",darkHsl:"15 95% 65%",gradient:"linear-gradient(135deg, hsl(25 95% 53%) 0%, hsl(330 81% 60%) 100%)"},"gradient-ocean":{hsl:"200 90% 55%",darkHsl:"200 90% 60%",gradient:"linear-gradient(135deg, hsl(221.2 83.2% 53.3%) 0%, hsl(189 94% 43%) 100%)"},"gradient-forest":{hsl:"150 70% 45%",darkHsl:"150 75% 40%",gradient:"linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%)"},"gradient-aurora":{hsl:"310 85% 65%",darkHsl:"310 90% 70%",gradient:"linear-gradient(135deg, hsl(271 91% 65%) 0%, hsl(330 81% 60%) 100%)"},"gradient-fire":{hsl:"15 95% 55%",darkHsl:"15 95% 60%",gradient:"linear-gradient(135deg, hsl(0 84% 60%) 0%, hsl(25 95% 53%) 100%)"},"gradient-twilight":{hsl:"250 90% 60%",darkHsl:"250 95% 65%",gradient:"linear-gradient(135deg, hsl(239 84% 67%) 0%, hsl(271 91% 65%) 100%)"}}[a];if(c)n.style.setProperty("--primary",c.hsl),c.gradient?(n.style.setProperty("--primary-gradient",c.gradient),n.classList.add("has-gradient")):(n.style.removeProperty("--primary-gradient"),n.classList.remove("has-gradient"));else if(a.startsWith("#")){const d=u=>{u=u.replace("#","");const h=parseInt(u.substring(0,2),16)/255,f=parseInt(u.substring(2,4),16)/255,p=parseInt(u.substring(4,6),16)/255,g=Math.max(h,f,p),N=Math.min(h,f,p);let v=0,w=0;const b=(g+N)/2;if(g!==N){const y=g-N;switch(w=b>.5?y/(2-g-N):y/(g+N),g){case h:v=((f-p)/y+(f<p?6:0))/6;break;case f:v=((p-h)/y+2)/6;break;case p:v=((h-f)/y+4)/6;break}}return`${Math.round(v*360)} ${Math.round(w*100)}% ${Math.round(b*100)}%`};n.style.setProperty("--primary",d(a)),n.style.removeProperty("--primary-gradient"),n.classList.remove("has-gradient")}}function w2(){const{theme:a,setTheme:n}=xx(),{enableAnimations:r,setEnableAnimations:c,enableWavesBackground:d,setEnableWavesBackground:u}=Uv(),[h,f]=m.useState(()=>localStorage.getItem("accent-color")||"blue");m.useEffect(()=>{const g=localStorage.getItem("accent-color")||"blue";Rg(g)},[]);const p=g=>{f(g),localStorage.setItem("accent-color",g),Rg(g)};return e.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsx(Lm,{value:"light",current:a,onChange:n,label:"",description:""}),e.jsx(Lm,{value:"dark",current:a,onChange:n,label:"",description:""}),e.jsx(Lm,{value:"system",current:a,onChange:n,label:"",description:""})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3",children:[e.jsx(qa,{value:"blue",current:h,onChange:p,label:"",colorClass:"bg-blue-500"}),e.jsx(qa,{value:"purple",current:h,onChange:p,label:"",colorClass:"bg-purple-500"}),e.jsx(qa,{value:"green",current:h,onChange:p,label:"",colorClass:"bg-green-500"}),e.jsx(qa,{value:"orange",current:h,onChange:p,label:"",colorClass:"bg-orange-500"}),e.jsx(qa,{value:"pink",current:h,onChange:p,label:"",colorClass:"bg-pink-500"}),e.jsx(qa,{value:"red",current:h,onChange:p,label:"",colorClass:"bg-red-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3",children:[e.jsx(qa,{value:"gradient-sunset",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-orange-500 to-pink-500"}),e.jsx(qa,{value:"gradient-ocean",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-blue-500 to-cyan-500"}),e.jsx(qa,{value:"gradient-forest",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-green-500 to-emerald-500"}),e.jsx(qa,{value:"gradient-aurora",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-purple-500 to-pink-500"}),e.jsx(qa,{value:"gradient-fire",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-red-500 to-orange-500"}),e.jsx(qa,{value:"gradient-twilight",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-indigo-500 to-purple-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"color",value:h.startsWith("#")?h:"#3b82f6",onChange:g=>p(g.target.value),className:"h-10 sm:h-12 w-full rounded-lg border-2 border-border cursor-pointer",title:""})}),e.jsx("div",{className:"flex-1",children:e.jsx(ae,{type:"text",value:h,onChange:g=>p(g.target.value),placeholder:"#3b82f6",className:"font-mono text-sm"})})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-2",children:" HEX "})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5 flex-1",children:[e.jsx(T,{htmlFor:"animations",className:"text-base font-medium cursor-pointer",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"animations",checked:r,onCheckedChange:c})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5 flex-1",children:[e.jsx(T,{htmlFor:"waves-background",className:"text-base font-medium cursor-pointer",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"waves-background",checked:d,onCheckedChange:u})]})})]})]})]})}function _2(){const a=ca(),[n,r]=m.useState(""),[c,d]=m.useState(""),[u,h]=m.useState(!1),[f,p]=m.useState(!1),[g,N]=m.useState(!1),[v,w]=m.useState(!1),[b,y]=m.useState(!1),[O,R]=m.useState(!1),[S,B]=m.useState(""),[E,C]=m.useState(!1),{toast:A}=Ys(),F=m.useMemo(()=>u2(c),[c]),L=async re=>{if(!n){A({title:"",description:"Token  Cookie  Token",variant:"destructive"});return}try{await navigator.clipboard.writeText(re),y(!0),A({title:"",description:"Token "}),setTimeout(()=>y(!1),2e3)}catch{A({title:"",description:" Token",variant:"destructive"})}},J=async()=>{if(!c.trim()){A({title:"",description:" Token",variant:"destructive"});return}if(!F.isValid){const re=F.rules.filter(fe=>!fe.passed).map(fe=>fe.label).join(", ");A({title:"",description:`Token : ${re}`,variant:"destructive"});return}N(!0);try{const re=await fetch("/api/webui/auth/update",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({new_token:c.trim()})}),fe=await re.json();re.ok&&fe.success?(d(""),r(c.trim()),A({title:"",description:"Access Token "}),setTimeout(()=>{a({to:"/auth"})},1500)):A({title:"",description:fe.message||" Token",variant:"destructive"})}catch(re){console.error(" Token :",re),A({title:"",description:"",variant:"destructive"})}finally{N(!1)}},U=async()=>{w(!0);try{const re=await fetch("/api/webui/auth/regenerate",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),fe=await re.json();re.ok&&fe.success?(r(fe.token),B(fe.token),R(!0),C(!1),A({title:"",description:" Access Token "})):A({title:"",description:fe.message||" Token",variant:"destructive"})}catch(re){console.error(" Token :",re),A({title:"",description:"",variant:"destructive"})}finally{w(!1)}},oe=async()=>{try{await navigator.clipboard.writeText(S),C(!0),A({title:"",description:"Token "})}catch{A({title:"",description:" Token",variant:"destructive"})}},Ne=()=>{R(!1),setTimeout(()=>{B(""),C(!1)},300),setTimeout(()=>{a({to:"/auth"})},500)},je=re=>{re||Ne()};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(Ps,{open:O,onOpenChange:je,children:e.jsxs(Ds,{className:"sm:max-w-md",children:[e.jsxs(Os,{children:[e.jsxs(Ls,{className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5 text-yellow-500"})," Access Token"]}),e.jsx(Ks,{children:" Token"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-2 border-primary/20 bg-primary/5 p-4",children:[e.jsx(T,{className:"text-xs text-muted-foreground mb-2 block",children:" Token (64)"}),e.jsx("div",{className:"font-mono text-sm break-all select-all bg-background p-3 rounded border",children:S})]}),e.jsx("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Jt,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsx("li",{children:" Token "}),e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:" Token "})]})]})]})})]}),e.jsxs(st,{className:"gap-2 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:oe,className:"gap-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx(Ct,{className:"h-4 w-4 text-green-500"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Fo,{className:"h-4 w-4"})," Token"]})}),e.jsx(_,{onClick:Ne,children:""})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:" Access Token"}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"current-token",className:"text-sm",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ae,{id:"current-token",type:u?"text":"password",value:n||"",readOnly:!0,className:"pr-10 font-mono text-sm",placeholder:"Token  Cookie "}),e.jsx("button",{onClick:()=>{n?h(!u):A({title:"",description:'Token  Cookie  Token ""'})},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 hover:bg-accent rounded",title:u?"":"",children:u?e.jsx(nc,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ia,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(_,{variant:"outline",size:"icon",onClick:()=>L(n),title:"",className:"flex-shrink-0",disabled:!n,children:b?e.jsx(Ct,{className:"h-4 w-4 text-green-500"}):e.jsx(Fo,{className:"h-4 w-4"})}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{variant:"outline",disabled:v,className:"gap-2 flex-1 sm:flex-none",children:[e.jsx(dt,{className:I("h-4 w-4",v&&"animate-spin")}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:" Token"}),e.jsx(fs,{children:" 64  Token   Token "})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:U,children:""})]})]})]})]})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:" Access Token"})]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:" Access Token"}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"new-token",className:"text-sm",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(ae,{id:"new-token",type:f?"text":"password",value:c,onChange:re=>d(re.target.value),className:"pr-10 font-mono text-sm",placeholder:" Token"}),e.jsx("button",{onClick:()=>p(!f),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 hover:bg-accent rounded",title:f?"":"",children:f?e.jsx(nc,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ia,{className:"h-4 w-4 text-muted-foreground"})})]}),c&&e.jsxs("div",{className:"mt-3 space-y-2 p-3 rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Token :"}),e.jsx("div",{className:"space-y-1.5",children:F.rules.map(re=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[re.passed?e.jsx(pt,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):e.jsx(Ka,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:I(re.passed?"text-green-600 dark:text-green-400":"text-muted-foreground"),children:re.label})]},re.id))}),F.isValid&&e.jsx("div",{className:"mt-2 pt-2 border-t border-border",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Token "})]})})]})]}),e.jsx(_,{onClick:J,disabled:g||!F.isValid||!c,className:"w-full sm:w-auto",children:g?"...":" Token"})]})]}),e.jsxs("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3 sm:p-4",children:[e.jsx("h4",{className:"text-sm sm:text-base font-semibold text-yellow-900 dark:text-yellow-200 mb-2",children:""}),e.jsxs("ul",{className:"text-xs sm:text-sm text-yellow-800 dark:text-yellow-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:" Token  64 "}),e.jsx("li",{children:" Token "}),e.jsx("li",{children:" Token  Token "}),e.jsx("li",{children:" Token"}),e.jsx("li",{children:" Token "}),e.jsx("li",{children:" Token "})]})]})]})}function S2(){const a=ca(),{toast:n}=Ys(),[r,c]=m.useState(!1),[d,u]=m.useState(!1),[h,f]=m.useState(()=>yt("logCacheSize")),[p,g]=m.useState(()=>yt("wsReconnectInterval")),[N,v]=m.useState(()=>yt("wsMaxReconnectAttempts")),[w,b]=m.useState(()=>yt("dataSyncInterval")),[y,O]=m.useState(()=>zg()),[R,S]=m.useState(!1),[B,E]=m.useState(!1),C=m.useRef(null);if(d)throw new Error("");const A=()=>{O(zg())},F=M=>{const K=M[0];f(K),qr("logCacheSize",K)},L=M=>{const K=M[0];g(K),qr("wsReconnectInterval",K)},J=M=>{const K=M[0];v(K),qr("wsMaxReconnectAttempts",K)},U=M=>{const K=M[0];b(K),qr("dataSyncInterval",K)},oe=()=>{Hn.clearLogs(),n({title:"",description:""})},Ne=()=>{const M=j2();A(),n({title:"",description:` ${M.clearedKeys.length} `})},je=()=>{S(!0);try{const M=f2(),K=JSON.stringify(M,null,2),P=new Blob([K],{type:"application/json"}),ue=URL.createObjectURL(P),Q=document.createElement("a");Q.href=ue,Q.download=`maibot-webui-settings-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),URL.revokeObjectURL(ue),n({title:"",description:" JSON "})}catch(M){console.error(":",M),n({title:"",description:"",variant:"destructive"})}finally{S(!1)}},re=M=>{const K=M.target.files?.[0];if(!K)return;E(!0);const P=new FileReader;P.onload=ue=>{try{const Q=ue.target?.result,Se=JSON.parse(Q),pe=p2(Se);pe.success?(f(yt("logCacheSize")),g(yt("wsReconnectInterval")),v(yt("wsMaxReconnectAttempts")),b(yt("dataSyncInterval")),A(),n({title:"",description:` ${pe.imported.length} ${pe.skipped.length>0?` ${pe.skipped.length} `:""}`}),(pe.imported.includes("theme")||pe.imported.includes("accentColor"))&&n({title:"",description:""})):n({title:"",description:"",variant:"destructive"})}catch(Q){console.error(":",Q),n({title:"",description:"",variant:"destructive"})}finally{E(!1),C.current&&(C.current.value="")}},P.readAsText(K)},fe=()=>{g2(),f(dl.logCacheSize),g(dl.wsReconnectInterval),v(dl.wsMaxReconnectAttempts),b(dl.dataSyncInterval),A(),n({title:"",description:""})},ge=async()=>{c(!0);try{const M=await _e("/api/webui/setup/reset",{method:"POST"}),K=await M.json();M.ok&&K.success?(n({title:"",description:""}),setTimeout(()=>{a({to:"/setup"})},1e3)):n({title:"",description:K.message||"",variant:"destructive"})}catch(M){console.error(":",M),n({title:"",description:"",variant:"destructive"})}finally{c(!1)}};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Yr,{className:"h-5 w-5"}),""]}),e.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(__,{className:"h-4 w-4"}),""]}),e.jsx(_,{variant:"ghost",size:"sm",onClick:A,className:"h-7 px-2",children:e.jsx(dt,{className:"h-3 w-3"})})]}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:v2(y.used)}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[y.items," "]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h," "]})]}),e.jsx(Qa,{value:[h],onValueChange:F,min:100,max:5e3,step:100,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[w," "]})]}),e.jsx(Qa,{value:[w],onValueChange:U,min:10,max:120,step:5,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"WebSocket "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[p/1e3," "]})]}),e.jsx(Qa,{value:[p],onValueChange:L,min:1e3,max:1e4,step:500,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" WebSocket "})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"WebSocket "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[N," "]})]}),e.jsx(Qa,{value:[N],onValueChange:J,min:3,max:30,step:1,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:oe,className:"gap-2",children:[e.jsx(ns,{className:"h-4 w-4"}),""]}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(ns,{className:"h-4 w-4"}),""]})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsx(fs,{children:" "})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:Ne,children:""})]})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Xt,{className:"h-5 w-5"}),"/"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(_,{variant:"outline",onClick:je,disabled:R,className:"gap-2",children:[e.jsx(Xt,{className:"h-4 w-4"}),R?"...":""]}),e.jsx("input",{ref:C,type:"file",accept:".json",onChange:re,className:"hidden"}),e.jsxs(_,{variant:"outline",onClick:()=>C.current?.click(),disabled:B,className:"gap-2",children:[e.jsx(rc,{className:"h-4 w-4"}),B?"...":""]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"gap-2 text-destructive hover:text-destructive",children:[e.jsx(lc,{className:"h-4 w-4"}),""]})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsx(fs,{children:" "})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:fe,children:""})]})]})]})})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""})}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{variant:"outline",disabled:r,className:"gap-2",children:[e.jsx(lc,{className:I("h-4 w-4",r&&"animate-spin")}),""]})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsx(fs,{children:""})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:ge,children:""})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border border-dashed border-yellow-500/50 bg-yellow-500/5 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5 text-yellow-500"}),""]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""})}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{variant:"destructive",className:"gap-2",children:[e.jsx(Jt,{className:"h-4 w-4"}),""]})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsx(fs,{children:" React  "})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>u(!0),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})]})]})]})]})}function k2(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("div",{className:"rounded-lg border-2 border-primary/30 bg-gradient-to-r from-primary/5 to-primary/10 p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-shrink-0 rounded-lg bg-primary/10 p-2 sm:p-3",children:e.jsx("svg",{className:"h-6 w-6 sm:h-8 sm:w-8 text-primary",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-foreground mb-2",children:""}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mb-3",children:" GitHub  Star  "}),e.jsxs("a",{href:"https://github.com/Mai-with-u/MaiBot-Dashboard",target:"_blank",rel:"noopener noreferrer",className:I("inline-flex items-center gap-2 px-4 py-2 rounded-lg","bg-primary text-primary-foreground font-medium text-sm","hover:bg-primary/90 transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"),children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})," GitHub",e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:[" ",hx]}),e.jsxs("div",{className:"space-y-2 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("p",{children:[": ",od]}),e.jsx("p",{children:"MaiBot Web "})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"MaiBot "}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Mai-with-u"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"WebUI"}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:["Mai-with-u ",e.jsx("a",{href:"https://github.com/DrSmoothl",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:"@MotricSeven"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"React 19.2.0"}),e.jsx("li",{children:"TypeScript 5.7.2"}),e.jsx("li",{children:"Vite 6.0.7"}),e.jsx("li",{children:"TanStack Router 1.94.2"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:"UI "}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"shadcn/ui"}),e.jsx("li",{children:"Radix UI"}),e.jsx("li",{children:"Tailwind CSS 3.4.17"}),e.jsx("li",{children:"Lucide Icons"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Python 3.12+"}),e.jsx("li",{children:"FastAPI"}),e.jsx("li",{children:"Uvicorn"}),e.jsx("li",{children:"WebSocket"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Bun / npm"}),e.jsx("li",{children:"ESLint 9.17.0"}),e.jsx("li",{children:"PostCSS"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-3",children:""}),e.jsx(Je,{className:"h-[300px] sm:h-[400px]",children:e.jsxs("div",{className:"space-y-4 pr-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"UI "}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"React",description:"",license:"MIT"}),e.jsx(ft,{name:"shadcn/ui",description:" React ",license:"MIT"}),e.jsx(ft,{name:"Radix UI",description:"",license:"MIT"}),e.jsx(ft,{name:"Tailwind CSS",description:" CSS ",license:"MIT"}),e.jsx(ft,{name:"Lucide React",description:"",license:"ISC"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"TanStack Router",description:"",license:"MIT"}),e.jsx(ft,{name:"Zustand",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"React Hook Form",description:"",license:"MIT"}),e.jsx(ft,{name:"Zod",description:"TypeScript  schema ",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"clsx",description:" className ",license:"MIT"}),e.jsx(ft,{name:"tailwind-merge",description:"Tailwind ",license:"MIT"}),e.jsx(ft,{name:"class-variance-authority",description:"",license:"Apache-2.0"}),e.jsx(ft,{name:"date-fns",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"Framer Motion",description:"React ",license:"MIT"}),e.jsx(ft,{name:"vaul",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"FastAPI",description:" Python Web ",license:"MIT"}),e.jsx(ft,{name:"Uvicorn",description:"ASGI ",license:"BSD-3-Clause"}),e.jsx(ft,{name:"Pydantic",description:"",license:"MIT"}),e.jsx(ft,{name:"python-multipart",description:"",license:"Apache-2.0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"TypeScript",description:"JavaScript ",license:"Apache-2.0"}),e.jsx(ft,{name:"Vite",description:"",license:"MIT"}),e.jsx(ft,{name:"ESLint",description:"JavaScript ",license:"MIT"}),e.jsx(ft,{name:"PostCSS",description:"CSS ",license:"MIT"})]})]})]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-lg bg-primary/5 border border-primary/20 p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("div",{className:"rounded-md bg-primary/10 px-2 py-1",children:e.jsx("span",{className:"text-xs sm:text-sm font-bold text-primary",children:"GPLv3"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm sm:text-base font-semibold text-foreground mb-1",children:"MaiBot WebUI"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" GNU General Public License v3.0  "})]})]})}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"MITApache-2.0BSD  "})]})]})]})}function ft({name:a,description:n,license:r}){return e.jsxs("div",{className:"flex items-start justify-between gap-2 rounded-lg border bg-muted/30 p-2.5 sm:p-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground truncate",children:a}),e.jsx("p",{className:"text-muted-foreground text-xs mt-0.5",children:n})]}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-primary/10 px-2 py-0.5 text-[10px] font-medium text-primary flex-shrink-0",children:r})]})}function Lm({value:a,current:n,onChange:r,label:c,description:d}){const u=n===a;return e.jsxs("button",{onClick:()=>r(a),className:I("relative rounded-lg border-2 p-3 sm:p-4 text-left transition-all","hover:border-primary/50 hover:bg-accent/50",u?"border-primary bg-accent":"border-border"),children:[u&&e.jsx("div",{className:"absolute top-2 right-2 sm:top-3 sm:right-3 h-2 w-2 rounded-full bg-primary"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm sm:text-base font-medium",children:c}),e.jsx("div",{className:"text-[10px] sm:text-xs text-muted-foreground",children:d})]}),e.jsxs("div",{className:"mt-2 sm:mt-3 flex gap-1",children:[a==="light"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-200"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-400"})]}),a==="dark"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-700"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-800"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-900"})]}),a==="system"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-200 to-slate-700"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-300 to-slate-800"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-400 to-slate-900"})]})]})]})}function qa({value:a,current:n,onChange:r,label:c,colorClass:d}){const u=n===a;return e.jsxs("button",{onClick:()=>r(a),className:I("relative rounded-lg border-2 p-2 sm:p-3 text-left transition-all","hover:border-primary/50 hover:bg-accent/50",u?"border-primary bg-accent":"border-border"),children:[u&&e.jsx("div",{className:"absolute top-1.5 right-1.5 sm:top-2 sm:right-2 h-1.5 w-1.5 sm:h-2 sm:w-2 rounded-full bg-primary"}),e.jsxs("div",{className:"flex flex-col items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:I("h-8 w-8 sm:h-10 sm:w-10 rounded-full",d)}),e.jsx("div",{className:"text-[10px] sm:text-xs font-medium text-center",children:c})]})]})}const C2=Date.now()%1e6;class T2{grad3;p;perm;constructor(n=0){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.p=[];for(let r=0;r<256;r++)this.p[r]=Math.floor(Math.random()*256);this.perm=[];for(let r=0;r<512;r++)this.perm[r]=this.p[r&255]}dot(n,r,c){return n[0]*r+n[1]*c}mix(n,r,c){return(1-c)*n+c*r}fade(n){return n*n*n*(n*(n*6-15)+10)}perlin2(n,r){const c=Math.floor(n)&255,d=Math.floor(r)&255;n-=Math.floor(n),r-=Math.floor(r);const u=this.fade(n),h=this.fade(r),f=this.perm[c]+d,p=this.perm[f],g=this.perm[f+1],N=this.perm[c+1]+d,v=this.perm[N],w=this.perm[N+1];return this.mix(this.mix(this.dot(this.grad3[p%12],n,r),this.dot(this.grad3[v%12],n-1,r),u),this.mix(this.dot(this.grad3[g%12],n,r-1),this.dot(this.grad3[w%12],n-1,r-1),u),h)}}function Dg(){const a=m.useRef(null),n=m.useRef(null),r=m.useRef(void 0),[c]=m.useState(()=>new T2(C2)),d=m.useRef({mouse:{x:-10,y:0,lx:0,ly:0,sx:0,sy:0,v:0,vs:0,a:0,set:!1},lines:[],paths:[],noise:c,bounding:null});return m.useEffect(()=>{const u=n.current,h=a.current;if(!u||!h)return;const f=d.current;f.noise=c;const p=()=>{const R=u.getBoundingClientRect();f.bounding=R,h.style.width=`${R.width}px`,h.style.height=`${R.height}px`},g=()=>{if(!f.bounding)return;const{width:R,height:S}=f.bounding;f.lines=[],f.paths.forEach(oe=>oe.remove()),f.paths=[];const B=10,E=32,C=R+200,A=S+30,F=Math.ceil(C/B),L=Math.ceil(A/E),J=(R-B*F)/2,U=(S-E*L)/2;for(let oe=0;oe<=F;oe++){const Ne=[];for(let re=0;re<=L;re++){const fe={x:J+B*oe,y:U+E*re,wave:{x:0,y:0},cursor:{x:0,y:0,vx:0,vy:0}};Ne.push(fe)}const je=document.createElementNS("http://www.w3.org/2000/svg","path");h.appendChild(je),f.paths.push(je),f.lines.push(Ne)}},N=R=>{const{lines:S,mouse:B,noise:E}=f;S.forEach(C=>{C.forEach(A=>{const F=E.perlin2((A.x+R*.0125)*.002,(A.y+R*.005)*.0015)*12;A.wave.x=Math.cos(F)*32,A.wave.y=Math.sin(F)*16;const L=A.x-B.sx,J=A.y-B.sy,U=Math.hypot(L,J),oe=Math.max(175,B.vs);if(U<oe){const Ne=1-U/oe,je=Math.cos(U*.001)*Ne;A.cursor.vx+=Math.cos(B.a)*je*oe*B.vs*65e-5,A.cursor.vy+=Math.sin(B.a)*je*oe*B.vs*65e-5}A.cursor.vx+=(0-A.cursor.x)*.005,A.cursor.vy+=(0-A.cursor.y)*.005,A.cursor.vx*=.925,A.cursor.vy*=.925,A.cursor.x+=A.cursor.vx*2,A.cursor.y+=A.cursor.vy*2,A.cursor.x=Math.min(100,Math.max(-100,A.cursor.x)),A.cursor.y=Math.min(100,Math.max(-100,A.cursor.y))})})},v=(R,S=!0)=>{const B={x:R.x+R.wave.x+(S?R.cursor.x:0),y:R.y+R.wave.y+(S?R.cursor.y:0)};return B.x=Math.round(B.x*10)/10,B.y=Math.round(B.y*10)/10,B},w=()=>{const{lines:R,paths:S}=f;R.forEach((B,E)=>{let C=v(B[0],!1),A=`M ${C.x} ${C.y}`;B.forEach((F,L)=>{const J=L===B.length-1;C=v(F,!J),A+=`L ${C.x} ${C.y}`}),S[E].setAttribute("d",A)})},b=R=>{const{mouse:S}=f;S.sx+=(S.x-S.sx)*.1,S.sy+=(S.y-S.sy)*.1;const B=S.x-S.lx,E=S.y-S.ly,C=Math.hypot(B,E);S.v=C,S.vs+=(C-S.vs)*.1,S.vs=Math.min(100,S.vs),S.lx=S.x,S.ly=S.y,S.a=Math.atan2(E,B),u&&(u.style.setProperty("--x",`${S.sx}px`),u.style.setProperty("--y",`${S.sy}px`)),N(R),w(),r.current=requestAnimationFrame(b)},y=R=>{if(!f.bounding)return;const{mouse:S}=f;S.x=R.pageX-f.bounding.left,S.y=R.pageY-f.bounding.top+window.scrollY,S.set||(S.sx=S.x,S.sy=S.y,S.lx=S.x,S.ly=S.y,S.set=!0)},O=()=>{p(),g()};return p(),g(),window.addEventListener("resize",O),window.addEventListener("mousemove",y),r.current=requestAnimationFrame(b),()=>{window.removeEventListener("resize",O),window.removeEventListener("mousemove",y),r.current&&cancelAnimationFrame(r.current)}},[c]),e.jsxs("div",{ref:n,className:"waves-background",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none"},children:[e.jsx("div",{className:"waves-cursor",style:{position:"absolute",top:0,left:0,width:"0.5rem",height:"0.5rem",background:"hsl(var(--primary) / 0.3)",borderRadius:"50%",transform:"translate3d(calc(var(--x, -0.5rem) - 50%), calc(var(--y, 50%) - 50%), 0)",willChange:"transform",pointerEvents:"none"}}),e.jsx("svg",{ref:a,style:{display:"block",width:"100%",height:"100%"},children:e.jsx("style",{children:`
          path {
            fill: none;
            stroke: hsl(var(--primary) / 0.20);
            stroke-width: 1px;
          }
        `})})]})}function E2(){const[a,n]=m.useState(""),[r,c]=m.useState(!1),[d,u]=m.useState(""),[h,f]=m.useState(!0),p=ca(),{enableWavesBackground:g,setEnableWavesBackground:N}=Uv(),{theme:v,setTheme:w}=xx();m.useEffect(()=>{(async()=>{try{await cc()&&p({to:"/"})}catch{}finally{f(!1)}})()},[p]);const y=v==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":v,O=()=>{w(y==="dark"?"light":"dark")},R=async S=>{if(S.preventDefault(),u(""),!a.trim()){u(" Access Token");return}c(!0),console.log(" token...");try{const B=await fetch("/api/webui/auth/verify",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:a.trim()})});console.log("Token :",B.status);const E=await B.json();if(console.log("Token :",E),B.ok&&E.valid){console.log("Token ..."),console.log("is_first_setup:",E.is_first_setup),await new Promise(A=>setTimeout(A,100));const C=await cc();console.log(":",C),E.is_first_setup?(console.log(""),p({to:"/setup"})):(console.log(""),p({to:"/"}))}else console.error("Token :",E.message),u(E.message||"Token ")}catch(B){console.error("Token :",B),u("")}finally{c(!1)}};return h?e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-background p-4",children:[g&&e.jsx(Dg,{}),e.jsx("div",{className:"text-muted-foreground",children:"..."})]}):e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-background p-4",children:[g&&e.jsx(Dg,{}),e.jsxs(Ce,{className:"relative z-10 w-full max-w-md shadow-2xl backdrop-blur-xl bg-card/80 border-border/50",children:[e.jsx("button",{onClick:O,className:"absolute right-4 top-4 rounded-lg p-2 hover:bg-accent transition-colors z-10 text-foreground",title:y==="dark"?"":"",children:y==="dark"?e.jsx(ax,{className:"h-5 w-5",strokeWidth:2.5,fill:"none"}):e.jsx(ec,{className:"h-5 w-5",strokeWidth:2.5,fill:"none"})}),e.jsxs(De,{className:"space-y-4 text-center",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(bg,{className:"h-8 w-8 text-primary",strokeWidth:2,fill:"none"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Oe,{className:"text-2xl font-bold",children:" MaiBot"}),e.jsx(os,{className:"text-base",children:" Access Token "})]})]}),e.jsx(Me,{children:e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"token",className:"text-sm font-medium",children:"Access Token"}),e.jsxs("div",{className:"relative",children:[e.jsx(lx,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground",strokeWidth:2,fill:"none"}),e.jsx(ae,{id:"token",type:"password",placeholder:" Access Token",value:a,onChange:S=>n(S.target.value),className:I("pl-10",d&&"border-red-500 focus-visible:ring-red-500"),disabled:r,autoFocus:!0,autoComplete:"off"})]})]}),d&&e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-red-50 p-3 text-sm text-red-600 dark:bg-red-950/50 dark:text-red-400",children:[e.jsx(_t,{className:"h-4 w-4 flex-shrink-0",strokeWidth:2,fill:"none"}),e.jsx("span",{children:d})]}),e.jsx(_,{type:"submit",className:"w-full",disabled:r,children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"..."]}):""}),e.jsxs(Ps,{children:[e.jsx(cd,{asChild:!0,children:e.jsxs("button",{className:"w-full text-center text-sm text-primary hover:text-primary/80 transition-colors underline-offset-4 hover:underline flex items-center justify-center gap-1",children:[e.jsx(sv,{className:"h-4 w-4",strokeWidth:2,fill:"none"})," Token Token"]})}),e.jsxs(Ds,{className:"sm:max-w-md",children:[e.jsxs(Os,{children:[e.jsxs(Ls,{className:"flex items-center gap-2",children:[e.jsx(bg,{className:"h-5 w-5 text-primary",strokeWidth:2,fill:"none"})," Access Token"]}),e.jsx(Ks,{children:"Access Token  MaiBot WebUI "})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(S_,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" MaiBot  WebUI Access Token"}),e.jsxs("div",{className:"rounded bg-background p-2 font-mono text-xs",children:[e.jsx("p",{className:"text-muted-foreground",children:" WebUI Access Token: abc123..."}),e.jsx("p",{className:"text-muted-foreground",children:"  Token  WebUI"})]})]})]})}),e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ea,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Token "}),e.jsx("div",{className:"rounded bg-background p-2 font-mono text-xs break-all",children:e.jsx("code",{className:"text-primary",children:"data/webui.json"})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",e.jsx("code",{className:"px-1 py-0.5 bg-background rounded",children:"access_token"})," "]})]})]})}),e.jsx("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_t,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsx("li",{children:" Token"}),e.jsx("li",{children:" Token"})]})]})]})})]})]})]}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs("button",{className:"w-full text-center text-sm text-muted-foreground hover:text-foreground transition-colors underline-offset-4 hover:underline flex items-center justify-center gap-1",children:[e.jsx(el,{className:"h-4 w-4",strokeWidth:2,fill:"none"}),""]})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsxs(hs,{className:"flex items-center gap-2",children:[e.jsx(el,{className:"h-5 w-5 text-primary",strokeWidth:2,fill:"none"}),""]}),e.jsx(fs,{children:""})]}),e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>N(!1),children:""})]})]})]})]})})]}),e.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center text-xs text-muted-foreground",children:e.jsx("p",{children:m2})})]})}const ot=m.forwardRef(({className:a,...n},r)=>e.jsx("textarea",{className:I("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","custom-scrollbar",a),ref:r,...n}));ot.displayName="Textarea";const Yt=m.forwardRef(({className:a,orientation:n="horizontal",decorative:r=!0,...c},d)=>e.jsx(bj,{ref:d,decorative:r,orientation:n,className:I("shrink-0 bg-border",n==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",a),...c}));Yt.displayName=bj.displayName;function M2({config:a,onChange:n}){const r=d=>{d.trim()&&!a.alias_names.includes(d.trim())&&n({...a,alias_names:[...a.alias_names,d.trim()]})},c=d=>{n({...a,alias_names:a.alias_names.filter((u,h)=>h!==d)})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"qq_account",children:"QQ *"}),e.jsx(ae,{id:"qq_account",type:"number",placeholder:"QQ",value:a.qq_account||"",onChange:d=>n({...a,qq_account:Number(d.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"QQ"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"nickname",children:" *"}),e.jsx(ae,{id:"nickname",placeholder:"",value:a.nickname,onChange:d=>n({...a,nickname:d.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{children:""}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:a.alias_names.map((d,u)=>e.jsxs(ke,{variant:"secondary",className:"gap-1",children:[d,e.jsx("button",{type:"button",onClick:()=>c(u),className:"ml-1 hover:text-destructive",children:e.jsx(Aa,{className:"h-3 w-3"})})]},u))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{id:"alias_input",placeholder:"",onKeyPress:d=>{d.key==="Enter"&&(r(d.target.value),d.target.value="")}}),e.jsx(_,{type:"button",variant:"outline",onClick:()=>{const d=document.getElementById("alias_input");d&&(r(d.value),d.value="")},children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function A2({config:a,onChange:n}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"personality",children:" *"}),e.jsx(ot,{id:"personality",placeholder:"120",value:a.personality,onChange:r=>n({...a,personality:r.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"reply_style",children:" *"}),e.jsx(ot,{id:"reply_style",placeholder:"",value:a.reply_style,onChange:r=>n({...a,reply_style:r.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"interest",children:" *"}),e.jsx(ot,{id:"interest",placeholder:"",value:a.interest,onChange:r=>n({...a,interest:r.target.value}),rows:2}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"plan_style",children:" *"}),e.jsx(ot,{id:"plan_style",placeholder:"",value:a.plan_style,onChange:r=>n({...a,plan_style:r.target.value}),rows:4}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"private_plan_style",children:" *"}),e.jsx(ot,{id:"private_plan_style",placeholder:"",value:a.private_plan_style,onChange:r=>n({...a,private_plan_style:r.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function z2({config:a,onChange:n}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"emoji_chance",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[(a.emoji_chance*100).toFixed(0),"%"]})]}),e.jsx(ae,{id:"emoji_chance",type:"range",min:"0",max:"1",step:"0.1",value:a.emoji_chance,onChange:r=>n({...a,emoji_chance:Number(r.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"max_reg_num",children:""}),e.jsx(ae,{id:"max_reg_num",type:"number",min:"1",max:"200",value:a.max_reg_num,onChange:r=>n({...a,max_reg_num:Number(r.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"do_replace",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"do_replace",checked:a.do_replace,onCheckedChange:r=>n({...a,do_replace:r})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"check_interval",children:""}),e.jsx(ae,{id:"check_interval",type:"number",min:"1",max:"120",value:a.check_interval,onChange:r=>n({...a,check_interval:Number(r.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"steal_emoji",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"steal_emoji",checked:a.steal_emoji,onCheckedChange:r=>n({...a,steal_emoji:r})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"content_filtration",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"content_filtration",checked:a.content_filtration,onCheckedChange:r=>n({...a,content_filtration:r})})]}),a.content_filtration&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"filtration_prompt",children:""}),e.jsx(ae,{id:"filtration_prompt",placeholder:"",value:a.filtration_prompt,onChange:r=>n({...a,filtration_prompt:r.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function R2({config:a,onChange:n}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"enable_tool",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"enable_tool",checked:a.enable_tool,onCheckedChange:r=>n({...a,enable_tool:r})})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"all_global",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"all_global",checked:a.all_global,onCheckedChange:r=>n({...a,all_global:r})})]})]})}function D2({config:a,onChange:n}){const[r,c]=m.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx("svg",{className:"h-5 w-5 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1 text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100 mb-1",children:" (SiliconFlow)"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300 mb-2",children:" DeepSeek V3Qwen  API Key "}),e.jsxs("a",{href:"https://cloud.siliconflow.cn",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 dark:text-blue-400 hover:underline font-medium",children:[" API Key",e.jsx($o,{className:"h-3 w-3"})]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"siliconflow_api_key",children:"SiliconFlow API Key *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ae,{id:"siliconflow_api_key",type:r?"text":"password",placeholder:"sk-...",value:a.api_key,onChange:d=>n({api_key:d.target.value}),className:"font-mono pr-10"}),e.jsx(_,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>c(!r),children:r?e.jsx(nc,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ia,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" API "})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-4 text-sm space-y-2",children:[e.jsx("p",{className:"font-medium",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground ml-2",children:[e.jsx("li",{children:"DeepSeek V3 - "}),e.jsx("li",{children:"Qwen3 30B - "}),e.jsx("li",{children:"Qwen3 VL 30B - "}),e.jsx("li",{children:"SenseVoice - "}),e.jsx("li",{children:"BGE-M3 - "}),e.jsx("li",{children:" (LPMM)"})]})]}),e.jsx("div",{className:"rounded-lg border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/30 p-4",children:e.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-100",children:[e.jsx("span",{className:"font-medium",children:" "}),'"  " API ']})})]})}async function O2(){const a=await _e("/api/webui/config/bot",{method:"GET",headers:Hs()});if(!a.ok)throw new Error("Bot");const r=(await a.json()).config.bot||{};return{qq_account:r.qq_account||0,nickname:r.nickname||"",alias_names:r.alias_names||[]}}async function L2(){const a=await _e("/api/webui/config/bot",{method:"GET",headers:Hs()});if(!a.ok)throw new Error("");const r=(await a.json()).config.personality||{};return{personality:r.personality||"",reply_style:r.reply_style||"",interest:r.interest||"",plan_style:r.plan_style||"",private_plan_style:r.private_plan_style||""}}async function U2(){const a=await _e("/api/webui/config/bot",{method:"GET",headers:Hs()});if(!a.ok)throw new Error("");const r=(await a.json()).config.emoji||{};return{emoji_chance:r.emoji_chance??.4,max_reg_num:r.max_reg_num??40,do_replace:r.do_replace??!0,check_interval:r.check_interval??10,steal_emoji:r.steal_emoji??!0,content_filtration:r.content_filtration??!1,filtration_prompt:r.filtration_prompt||""}}async function $2(){const a=await _e("/api/webui/config/bot",{method:"GET",headers:Hs()});if(!a.ok)throw new Error("");const r=(await a.json()).config,c=r.tool||{},d=r.expression||{};return{enable_tool:c.enable_tool??!0,all_global:d.all_global_jargon??!0}}async function B2(){const a=await _e("/api/webui/config/model",{method:"GET",headers:Hs()});if(!a.ok)throw new Error("");return{api_key:((await a.json()).config.api_providers||[]).find(u=>u.name==="SiliconFlow")?.api_key||""}}async function P2(a){const n=await _e("/api/webui/config/bot/section/bot",{method:"POST",headers:Hs(),body:JSON.stringify(a)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Bot")}return await n.json()}async function I2(a){const n=await _e("/api/webui/config/bot/section/personality",{method:"POST",headers:Hs(),body:JSON.stringify(a)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return await n.json()}async function F2(a){const n=await _e("/api/webui/config/bot/section/emoji",{method:"POST",headers:Hs(),body:JSON.stringify(a)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return await n.json()}async function H2(a){const n=[];n.push(_e("/api/webui/config/bot/section/tool",{method:"POST",headers:Hs(),body:JSON.stringify({enable_tool:a.enable_tool})})),n.push(_e("/api/webui/config/bot/section/expression",{method:"POST",headers:Hs(),body:JSON.stringify({all_global_jargon:a.all_global})}));const r=await Promise.all(n);for(const c of r)if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return{success:!0}}async function V2(a){const n=await _e("/api/webui/config/model",{method:"GET",headers:Hs()});if(!n.ok)throw new Error("");const c=(await n.json()).config,d=c.api_providers||[],u=d.findIndex(p=>p.name==="SiliconFlow");u>=0?d[u]={...d[u],api_key:a.api_key}:d.push({name:"SiliconFlow",base_url:"https://api.siliconflow.cn/v1",api_key:a.api_key,client_type:"openai",max_retry:3,timeout:120,retry_interval:5});const h={...c,api_providers:d},f=await _e("/api/webui/config/model",{method:"POST",headers:Hs(),body:JSON.stringify(h)});if(!f.ok){const p=await f.json();throw new Error(p.detail||"")}return await f.json()}async function Og(){const a=await _e("/api/webui/setup/complete",{method:"POST"});if(!a.ok){const n=await a.json();throw new Error(n.message||"")}return await a.json()}function G2(){return e.jsx(Wn,{children:e.jsx(q2,{})})}function q2(){const a=ca(),{toast:n}=Ys(),{triggerRestart:r}=yn(),[c,d]=m.useState(0),[u,h]=m.useState(!1),[f,p]=m.useState(!1),[g,N]=m.useState(!0),[v,w]=m.useState({qq_account:0,nickname:"",alias_names:[]}),[b,y]=m.useState({personality:"",reply_style:"",interest:"",plan_style:`1.****action****
2.
3.
4.
5.`,private_plan_style:`1.****action****
2.
3.`}),[O,R]=m.useState({emoji_chance:.4,max_reg_num:40,do_replace:!0,check_interval:10,steal_emoji:!0,content_filtration:!1,filtration_prompt:""}),[S,B]=m.useState({enable_tool:!0,all_global:!0}),[E,C]=m.useState({api_key:""}),A=[{id:"bot-basic",title:"Bot",description:"",icon:Vn},{id:"personality",title:"",description:"",icon:jn},{id:"emoji",title:"",description:"",icon:ld},{id:"other",title:"",description:"",icon:vn},{id:"siliconflow",title:"API",description:"API",icon:lx}],F=(c+1)/A.length*100;m.useEffect(()=>{(async()=>{try{N(!0);const[fe,ge,M,K,P]=await Promise.all([O2(),L2(),U2(),$2(),B2()]);w(fe),y(ge),R(M),B(K),C(P)}catch(fe){n({title:"",description:fe instanceof Error?fe.message:"",variant:"destructive"})}finally{N(!1)}})()},[n]);const L=async()=>{p(!0);try{switch(c){case 0:await P2(v);break;case 1:await I2(b);break;case 2:await F2(O);break;case 3:await H2(S);break;case 4:await V2(E);break}return n({title:"",description:`${A[c].title}`}),!0}catch(re){return n({title:"",description:re instanceof Error?re.message:"",variant:"destructive"}),!1}finally{p(!1)}},J=async()=>{await L()&&c<A.length-1&&d(c+1)},U=()=>{c>0&&d(c-1)},oe=async()=>{h(!0);try{if(!await L()){h(!1);return}await Og(),n({title:"",description:"..."}),await r()}catch(re){n({title:"",description:re instanceof Error?re.message:"",variant:"destructive"})}finally{h(!1)}},Ne=async()=>{try{await Og(),a({to:"/"})}catch(re){n({title:"",description:re instanceof Error?re.message:"",variant:"destructive"})}},je=()=>{switch(c){case 0:return e.jsx(M2,{config:v,onChange:w});case 1:return e.jsx(A2,{config:b,onChange:y});case 2:return e.jsx(z2,{config:O,onChange:R});case 3:return e.jsx(R2,{config:S,onChange:B});case 4:return e.jsx(D2,{config:E,onChange:C});default:return null}};return e.jsxs("div",{className:"relative flex min-h-screen flex-col items-center justify-center overflow-hidden bg-gradient-to-br from-primary/5 via-background to-secondary/5 p-4 md:p-6",children:[e.jsx(er,{}),e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute left-1/4 top-1/4 h-64 w-64 md:h-96 md:w-96 rounded-full bg-primary/5 blur-3xl"}),e.jsx("div",{className:"absolute right-1/4 bottom-1/4 h-64 w-64 md:h-96 md:w-96 rounded-full bg-secondary/5 blur-3xl"})]}),g?e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center",children:e.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent"})}),e.jsx("p",{className:"text-lg font-medium",children:"..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative z-10 w-full max-w-4xl",children:[e.jsxs("div",{className:"mb-6 md:mb-8 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-12 w-12 md:h-16 md:w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(k_,{className:"h-6 w-6 md:h-8 md:w-8 text-primary",strokeWidth:2,fill:"none"})}),e.jsx("h1",{className:"mb-2 text-2xl md:text-3xl font-bold",children:""}),e.jsxs("p",{className:"text-sm md:text-base text-muted-foreground",children:[" ",hx," "]})]}),e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between text-xs md:text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[" ",c+1," / ",A.length]}),e.jsxs("span",{className:"font-medium text-primary",children:[Math.round(F),"%"]})]}),e.jsx(Xn,{value:F,className:"h-2"})]}),e.jsx("div",{className:"mb-6 md:mb-8 flex justify-between",children:A.map((re,fe)=>{const ge=re.icon;return e.jsxs("div",{className:I("flex flex-1 flex-col items-center gap-1 md:gap-2",fe<A.length-1&&"relative"),children:[fe<A.length-1&&e.jsx("div",{className:I("absolute left-1/2 top-3 md:top-4 h-0.5 w-full",fe<c?"bg-primary":"bg-border")}),e.jsx("div",{className:I("relative z-10 flex h-6 w-6 md:h-8 md:w-8 items-center justify-center rounded-full border-2 transition-all",fe===c||fe<c?"border-primary bg-primary text-primary-foreground":"border-border bg-background text-muted-foreground"),children:fe<c?e.jsx(pt,{className:"h-3 w-3 md:h-4 md:w-4",strokeWidth:2.5,fill:"none"}):e.jsx(ge,{className:"h-3 w-3 md:h-4 md:w-4"})}),e.jsx("span",{className:I("text-[10px] md:text-xs text-center max-w-[60px] md:max-w-none truncate md:whitespace-normal",fe===c?"font-medium text-foreground":"text-muted-foreground"),title:re.title,children:re.title})]},re.id)})}),e.jsx(Ce,{className:"mb-6 md:mb-8 shadow-lg",children:e.jsx(Me,{className:"p-4 md:p-8",children:e.jsxs("div",{className:"min-h-[300px] md:min-h-[400px]",children:[e.jsxs("div",{className:"mb-4 md:mb-6",children:[e.jsx("h2",{className:"mb-2 text-xl md:text-2xl font-semibold",children:A[c].title}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:A[c].description})]}),e.jsx(Je,{className:"h-[400px] md:h-[500px]",children:e.jsx("div",{className:"pr-2",children:je()})})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:U,disabled:c===0||f,className:"w-full sm:w-auto order-2 sm:order-1",children:""}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto order-1 sm:order-2",children:[e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"flex-1 sm:flex-none gap-2",disabled:f||u,children:[e.jsx(C_,{className:"h-4 w-4",strokeWidth:2,fill:"none"}),""]})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsx(fs,{children:""})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:Ne,children:""})]})]})]}),c===A.length-1?e.jsx(_,{onClick:oe,disabled:u||f,className:"flex-1 sm:flex-none",children:u||f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),f?"...":"..."]}):e.jsxs(e.Fragment,{children:["",e.jsx(pt,{className:"ml-2 h-4 w-4",strokeWidth:2,fill:"none"})]})}):e.jsx(_,{onClick:J,disabled:f,className:"flex-1 sm:flex-none",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"..."]}):e.jsxs(e.Fragment,{children:["",e.jsx(T_,{className:"ml-2 h-4 w-4",strokeWidth:2,fill:"none"})]})})]})]})]}),e.jsx("div",{className:"relative z-10 mt-6 md:mt-8 text-center text-xs text-muted-foreground",children:e.jsx("p",{children:""})})]})]})}function Pv(){const a=ca();return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background p-4",children:e.jsxs("div",{className:"w-full max-w-2xl text-center",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("h1",{className:"text-[150px] font-black leading-none text-primary/10 select-none sm:text-[200px]",children:"404"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(Tt,{className:"h-20 w-20 text-primary/30 sm:h-24 sm:w-24"})})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground sm:text-3xl",children:""}),e.jsx("p",{className:"text-base text-muted-foreground sm:text-lg max-w-md mx-auto",children:" URL "})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs(_,{size:"lg",onClick:()=>a({to:"/"}),className:"gap-2 w-full sm:w-auto",children:[e.jsx(nd,{className:"h-4 w-4"}),""]}),e.jsxs(_,{size:"lg",variant:"outline",onClick:()=>window.history.back(),className:"gap-2 w-full sm:w-auto",children:[e.jsx(Ma,{className:"h-4 w-4"}),""]})]}),e.jsx("div",{className:"mt-12 pt-8 border-t border-border",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})})]})})}const K2=Rs.memo(function({config:n,onChange:r}){const c=n.platforms||[],d=n.alias_names||[],u=()=>{r({...n,platforms:[...c,""]})},h=v=>{r({...n,platforms:c.filter((w,b)=>b!==v)})},f=(v,w)=>{const b=[...c];b[v]=w,r({...n,platforms:b})},p=()=>{r({...n,alias_names:[...d,""]})},g=v=>{r({...n,alias_names:d.filter((w,b)=>b!==v)})},N=(v,w)=>{const b=[...d];b[v]=w,r({...n,alias_names:b})};return e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"platform",children:""}),e.jsx(ae,{id:"platform",value:n.platform,onChange:v=>r({...n,platform:v.target.value}),placeholder:"qq"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"qq_account",children:"QQ"}),e.jsx(ae,{id:"qq_account",value:n.qq_account,onChange:v=>r({...n,qq_account:v.target.value}),placeholder:"123456789"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"nickname",children:""}),e.jsx(ae,{id:"nickname",value:n.nickname,onChange:v=>r({...n,nickname:v.target.value}),placeholder:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:p,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[d.map((v,w)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{value:v,onChange:b=>N(w,b.target.value),placeholder:""}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[' "',v||"()",'" ']})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>g(w),children:""})]})]})]})]},w)),d.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:u,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[c.map((v,w)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{value:v,onChange:b=>f(w,b.target.value),placeholder:"wx:114514"}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[' "',v||"()",'" ']})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>h(w),children:""})]})]})]})]},w)),c.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})]})]})})}),Q2=Rs.memo(function({config:n,onChange:r}){const c=()=>{r({...n,states:[...n.states,""]})},d=h=>{r({...n,states:n.states.filter((f,p)=>p!==h)})},u=(h,f)=>{const p=[...n.states];p[h]=f,r({...n,states:p})};return e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"personality",children:""}),e.jsx(ot,{id:"personality",value:n.personality,onChange:h=>r({...n,personality:h.target.value}),placeholder:"120",rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"120"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:c,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"space-y-2",children:n.states.map((h,f)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ot,{value:h,onChange:p=>u(f,p.target.value),placeholder:"",rows:2}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsx(fs,{children:""})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>d(f),children:""})]})]})]})]},f))})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"state_probability",children:""}),e.jsx(ae,{id:"state_probability",type:"number",step:"0.1",min:"0",max:"1",value:n.state_probability,onChange:h=>r({...n,state_probability:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0.0-1.0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"reply_style",children:""}),e.jsx(ot,{id:"reply_style",value:n.reply_style,onChange:h=>r({...n,reply_style:h.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"plan_style",children:""}),e.jsx(ot,{id:"plan_style",value:n.plan_style,onChange:h=>r({...n,plan_style:h.target.value}),placeholder:"",rows:5})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"visual_style",children:""}),e.jsx(ot,{id:"visual_style",value:n.visual_style,onChange:h=>r({...n,visual_style:h.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"private_plan_style",children:""}),e.jsx(ot,{id:"private_plan_style",value:n.private_plan_style,onChange:h=>r({...n,private_plan_style:h.target.value}),placeholder:"",rows:4})]})]})]})})}),ul=bw,ml=yw,sl=m.forwardRef(({className:a,align:n="center",sideOffset:r=4,...c},d)=>e.jsx(Nw,{children:e.jsx(yj,{ref:d,align:n,sideOffset:r,className:I("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",a),...c})}));sl.displayName=yj.displayName;const Y2=Rs.memo(function({value:n,onChange:r}){const c=m.useMemo(()=>{const b=n.split("-");if(b.length===2){const[y,O]=b,[R,S]=y.split(":"),[B,E]=O.split(":");return{startHour:R?R.padStart(2,"0"):"00",startMinute:S?S.padStart(2,"0"):"00",endHour:B?B.padStart(2,"0"):"23",endMinute:E?E.padStart(2,"0"):"59"}}return{startHour:"00",startMinute:"00",endHour:"23",endMinute:"59"}},[n]),[d,u]=m.useState(c.startHour),[h,f]=m.useState(c.startMinute),[p,g]=m.useState(c.endHour),[N,v]=m.useState(c.endMinute);m.useEffect(()=>{u(c.startHour),f(c.startMinute),g(c.endHour),v(c.endMinute)},[c]);const w=(b,y,O,R)=>{const S=`${b}:${y}-${O}:${R}`;r(S)};return e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",className:"w-full justify-start font-mono text-sm",children:[e.jsx(na,{className:"h-4 w-4 mr-2"}),n||""]})}),e.jsx(sl,{className:"w-72 sm:w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Pe,{value:d,onValueChange:b=>{u(b),w(b,h,p,N)},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsx(Be,{children:Array.from({length:24},(b,y)=>y).map(b=>e.jsx(Z,{value:b.toString().padStart(2,"0"),children:b.toString().padStart(2,"0")},b))})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Pe,{value:h,onValueChange:b=>{f(b),w(d,b,p,N)},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsx(Be,{children:Array.from({length:60},(b,y)=>y).map(b=>e.jsx(Z,{value:b.toString().padStart(2,"0"),children:b.toString().padStart(2,"0")},b))})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Pe,{value:p,onValueChange:b=>{g(b),w(d,h,b,N)},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsx(Be,{children:Array.from({length:24},(b,y)=>y).map(b=>e.jsx(Z,{value:b.toString().padStart(2,"0"),children:b.toString().padStart(2,"0")},b))})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Pe,{value:N,onValueChange:b=>{v(b),w(d,h,p,b)},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsx(Be,{children:Array.from({length:60},(b,y)=>y).map(b=>e.jsx(Z,{value:b.toString().padStart(2,"0"),children:b.toString().padStart(2,"0")},b))})]})]})]})]})]})})]})}),J2=Rs.memo(function({rule:n}){const r=`{ target = "${n.target}", time = "${n.time}", value = ${n.value.toFixed(1)} }`;return e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:r}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})}),X2=Rs.memo(function({config:n,onChange:r}){const c=()=>{r({...n,talk_value_rules:[...n.talk_value_rules,{target:"",time:"00:00-23:59",value:1}]})},d=h=>{r({...n,talk_value_rules:n.talk_value_rules.filter((f,p)=>p!==h)})},u=(h,f,p)=>{const g=[...n.talk_value_rules];g[h]={...g[h],[f]:p},r({...n,talk_value_rules:g})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"talk_value",children:""}),e.jsx(ae,{id:"talk_value",type:"number",step:"0.1",min:"0",max:"1",value:n.talk_value,onChange:h=>r({...n,talk_value:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 0-1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"think_mode",children:""}),e.jsxs(Pe,{value:n.think_mode||"classic",onValueChange:h=>r({...n,think_mode:h}),children:[e.jsx($e,{id:"think_mode",children:e.jsx(Ie,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"classic",children:" - "}),e.jsx(Z,{value:"deep",children:" - "}),e.jsx(Z,{value:"dynamic",children:" - "})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"mentioned_bot_reply",checked:n.mentioned_bot_reply,onCheckedChange:h=>r({...n,mentioned_bot_reply:h})}),e.jsx(T,{htmlFor:"mentioned_bot_reply",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_context_size",children:""}),e.jsx(ae,{id:"max_context_size",type:"number",min:"1",value:n.max_context_size,onChange:h=>r({...n,max_context_size:parseInt(h.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"planner_smooth",children:""}),e.jsx(ae,{id:"planner_smooth",type:"number",step:"1",min:"0",value:n.planner_smooth,onChange:h=>r({...n,planner_smooth:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" planner  1-50 "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"plan_reply_log_max_per_chat",children:""}),e.jsx(ae,{id:"plan_reply_log_max_per_chat",type:"number",step:"1",min:"100",value:n.plan_reply_log_max_per_chat??1024,onChange:h=>r({...n,plan_reply_log_max_per_chat:parseInt(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Plan/Reply "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"llm_quote",checked:n.llm_quote??!1,onCheckedChange:h=>r({...n,llm_quote:h})}),e.jsx(T,{htmlFor:"llm_quote",className:"cursor-pointer",children:" LLM "})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2 ml-10",children:"LLM "}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_talk_value_rules",checked:n.enable_talk_value_rules,onCheckedChange:h=>r({...n,enable_talk_value_rules:h})}),e.jsx(T,{htmlFor:"enable_talk_value_rules",className:"cursor-pointer",children:""})]})]})]}),n.enable_talk_value_rules&&e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ID"})]}),e.jsxs(_,{onClick:c,size:"sm",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),n.talk_value_rules&&n.talk_value_rules.length>0?e.jsx("div",{className:"space-y-4",children:n.talk_value_rules.map((h,f)=>e.jsxs("div",{className:"rounded-lg border p-4 bg-muted/50 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[" #",f+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J2,{rule:h}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"sm",children:e.jsx(ns,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" #",f+1," "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>d(f),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:h.target===""?"global":"specific",onValueChange:p=>{p==="global"?u(f,"target",""):u(f,"target","qq::group")},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"global",children:""}),e.jsx(Z,{value:"specific",children:""})]})]})]}),h.target!==""&&(()=>{const p=h.target.split(":"),g=p[0]||"qq",N=p[1]||"",v=p[2]||"group";return e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:g,onValueChange:w=>{u(f,"target",`${w}:${N}:${v}`)},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"qq",children:"QQ"}),e.jsx(Z,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" ID"}),e.jsx(ae,{value:N,onChange:w=>{u(f,"target",`${g}:${w.target.value}:${v}`)},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:v,onValueChange:w=>{u(f,"target",`${g}:${N}:${w}`)},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"group",children:"group"}),e.jsx(Z,{value:"private",children:"private"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",h.target||""]})]})})(),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" (Time)"}),e.jsx(Y2,{value:h.time,onChange:p=>u(f,"time",p)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 23:00-02:00"})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:`rule-value-${f}`,className:"text-xs font-medium",children:" (Value)"}),e.jsx(ae,{id:`rule-value-${f}`,type:"number",step:"0.01",min:"0.01",max:"1",value:h.value,onChange:p=>{const g=parseFloat(p.target.value);isNaN(g)||u(f,"value",Math.max(.01,Math.min(1,g)))},className:"w-20 h-8 text-xs"})]}),e.jsx(Qa,{value:[h.value],onValueChange:p=>u(f,"value",p[0]),min:.01,max:1,step:.01,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"0.01 ()"}),e.jsx("span",{children:"0.5"}),e.jsx("span",{children:"1.0 ()"})]})]})]})]},f))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{className:"text-sm",children:'""'})}),e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-1",children:[e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Target "}),""]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Target "}),"platform:id:type"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""}),""]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""})," 23:00-02:00 112"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""})," 0-10 1 "]})]})]})]})]})}),Z2=Rs.memo(function({config:n,onChange:r}){const c=S=>{if(!S||!S.includes(":"))return{platform:"qq",userId:""};const[B,E]=S.split(":");return{platform:B,userId:E}},{platform:d,userId:u}=c(n.dream_send),[h,f]=m.useState(d),[p,g]=m.useState(u),N=S=>{const[B,E]=S.split("-");return{startTime:B||"09:00",endTime:E||"22:00"}},v=(S,B)=>{const E=B?`${S}:${B}`:"";r({...n,dream_send:E})},w=S=>{f(S),v(S,p)},b=S=>{g(S),v(h,S)},y=()=>{r({...n,dream_time_ranges:[...n.dream_time_ranges,"09:00-22:00"]})},O=S=>{r({...n,dream_time_ranges:n.dream_time_ranges.filter((B,E)=>E!==S)})},R=(S,B,E)=>{const C=[...n.dream_time_ranges],A=N(C[S]);B==="startTime"?A.startTime=E:A.endTime=E,C[S]=`${A.startTime}-${A.endTime}`,r({...n,dream_time_ranges:C})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"interval_minutes",children:""}),e.jsx(ae,{id:"interval_minutes",type:"number",min:"1",value:n.interval_minutes,onChange:S=>r({...n,interval_minutes:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"30"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"max_iterations",children:""}),e.jsx(ae,{id:"max_iterations",type:"number",min:"1",value:n.max_iterations,onChange:S=>r({...n,max_iterations:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"first_delay_seconds",children:""}),e.jsx(ae,{id:"first_delay_seconds",type:"number",min:"0",value:n.first_delay_seconds,onChange:S=>r({...n,first_delay_seconds:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"60"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Pe,{value:h,onValueChange:w,children:[e.jsx($e,{className:"w-[120px]",children:e.jsx(Ie,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"qq",children:"QQ"}),e.jsx(Z,{value:"wx",children:""}),e.jsx(Z,{value:"webui",children:"WebUI"})]})]}),e.jsx(ae,{type:"text",placeholder:"ID (: 123456)",value:p,onChange:S=>b(S.target.value),className:"flex-1"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IDID"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsx(_,{type:"button",size:"sm",onClick:y,children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 23:00  02:00"}),e.jsxs("div",{className:"space-y-2",children:[n.dream_time_ranges.map((S,B)=>{const{startTime:E,endTime:C}=N(S);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"time",value:E,onChange:A=>R(B,"startTime",A.target.value),className:"w-[140px]"}),e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(ae,{type:"time",value:C,onChange:A=>R(B,"endTime",A.target.value),className:"w-[140px]"}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",onClick:()=>O(B),children:e.jsx(Aa,{className:"h-4 w-4"})})]},B)}),n.dream_time_ranges.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})]})}),W2=Rs.memo(function({config:n,onChange:r}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LPMM "}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{checked:n.enable,onCheckedChange:c=>r({...n,enable:c})}),e.jsx(T,{className:"cursor-pointer",children:" LPMM "})]}),n.enable&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"LPMM "}),e.jsxs(Pe,{value:n.lpmm_mode,onValueChange:c=>r({...n,lpmm_mode:c}),children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:" LPMM "})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"classic",children:""}),e.jsx(Z,{value:"agent",children:"Agent "})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:" TopK"}),e.jsx(ae,{type:"number",min:"1",value:n.rag_synonym_search_top_k,onChange:c=>r({...n,rag_synonym_search_top_k:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",step:"0.1",min:"0",max:"1",value:n.rag_synonym_threshold,onChange:c=>r({...n,rag_synonym_threshold:parseFloat(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",min:"1",value:n.info_extraction_workers,onChange:c=>r({...n,info_extraction_workers:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",min:"1",value:n.embedding_dimension,onChange:c=>r({...n,embedding_dimension:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",min:"1",value:n.max_embedding_workers,onChange:c=>r({...n,max_embedding_workers:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",min:"1",value:n.embedding_chunk_size,onChange:c=>r({...n,embedding_chunk_size:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",min:"1",value:n.max_synonym_entities,onChange:c=>r({...n,max_synonym_entities:parseInt(c.target.value)})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{checked:n.enable_ppr,onCheckedChange:c=>r({...n,enable_ppr:c})}),e.jsx(T,{className:"cursor-pointer",children:" PPR ()"})]})]})]})]})}),eS=Rs.memo(function({config:n,onChange:r}){const[c,d]=m.useState(""),[u,h]=m.useState("WARNING"),f=()=>{c&&!n.suppress_libraries.includes(c)&&(r({...n,suppress_libraries:[...n.suppress_libraries,c]}),d(""))},p=y=>{r({...n,suppress_libraries:n.suppress_libraries.filter(O=>O!==y)})},g=()=>{c&&!n.library_log_levels[c]&&(r({...n,library_log_levels:{...n.library_log_levels,[c]:u}}),d(""),h("WARNING"))},N=y=>{const O={...n.library_log_levels};delete O[y],r({...n,library_log_levels:O})},v=["DEBUG","INFO","WARNING","ERROR","CRITICAL"],w=["FULL","compact","lite"],b=["none","title","full"];return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{value:n.date_style,onChange:y=>r({...n,date_style:y.target.value}),placeholder:": m-d H:i:s"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"m=, d=, H=, i=, s="})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:n.log_level_style,onValueChange:y=>r({...n,log_level_style:y}),children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsx(Be,{children:w.map(y=>e.jsx(Z,{value:y,children:y},y))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:n.color_text,onValueChange:y=>r({...n,color_text:y}),children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsx(Be,{children:b.map(y=>e.jsx(Z,{value:y,children:y},y))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:n.log_level,onValueChange:y=>r({...n,log_level:y}),children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsx(Be,{children:v.map(y=>e.jsx(Z,{value:y,children:y},y))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:n.console_log_level,onValueChange:y=>r({...n,console_log_level:y}),children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsx(Be,{children:v.map(y=>e.jsx(Z,{value:y,children:y},y))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:n.file_log_level,onValueChange:y=>r({...n,file_log_level:y}),children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsx(Be,{children:v.map(y=>e.jsx(Z,{value:y,children:y},y))})]})]})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ae,{value:c,onChange:y=>d(y.target.value),placeholder:"",className:"flex-1",onKeyDown:y=>{y.key==="Enter"&&(y.preventDefault(),f())}}),e.jsx(_,{onClick:f,size:"sm",className:"flex-shrink-0",children:e.jsx(et,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.suppress_libraries.map(y=>e.jsxs("div",{className:"flex items-center gap-1 bg-secondary px-3 py-1 rounded-md",children:[e.jsx("span",{className:"text-sm",children:y}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0",onClick:()=>p(y),children:e.jsx(ns,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},y))})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ae,{value:c,onChange:y=>d(y.target.value),placeholder:"",className:"flex-1"}),e.jsxs(Pe,{value:u,onValueChange:h,children:[e.jsx($e,{className:"w-32",children:e.jsx(Ie,{})}),e.jsx(Be,{children:v.map(y=>e.jsx(Z,{value:y,children:y},y))})]}),e.jsx(_,{onClick:g,size:"sm",children:e.jsx(et,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(n.library_log_levels).map(([y,O])=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-medium",children:y}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:O}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>N(y),children:e.jsx(ns,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]})]},y))})]})]})}),sS=Rs.memo(function({config:n,onChange:r}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{checked:n.show_prompt,onCheckedChange:c=>r({...n,show_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{checked:n.show_replyer_prompt,onCheckedChange:c=>r({...n,show_replyer_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{checked:n.show_replyer_reasoning,onCheckedChange:c=>r({...n,show_replyer_reasoning:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Jargon Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{checked:n.show_jargon_prompt,onCheckedChange:c=>r({...n,show_jargon_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{checked:n.show_memory_prompt,onCheckedChange:c=>r({...n,show_memory_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Planner Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" Planner "})]}),e.jsx(Ve,{checked:n.show_planner_prompt,onCheckedChange:c=>r({...n,show_planner_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" LPMM "}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" LPMM "})]}),e.jsx(Ve,{checked:n.show_lpmm_paragraph,onCheckedChange:c=>r({...n,show_lpmm_paragraph:c})})]})]})]})}),tS=Rs.memo(function({config:n,onChange:r}){const[c,d]=m.useState(""),[u,h]=m.useState(""),f=()=>{c&&!n.auth_token.includes(c)&&(r({...n,auth_token:[...n.auth_token,c]}),d(""))},p=v=>{r({...n,auth_token:n.auth_token.filter((w,b)=>b!==v)})},g=()=>{u&&!n.api_server_allowed_api_keys.includes(u)&&(r({...n,api_server_allowed_api_keys:[...n.api_server_allowed_api_keys,u]}),h(""))},N=v=>{r({...n,api_server_allowed_api_keys:n.api_server_allowed_api_keys.filter((w,b)=>b!==v)})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:" API "}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:" API "}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ae,{value:c,onChange:v=>d(v.target.value),placeholder:"",onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),f())}}),e.jsx(_,{onClick:f,size:"sm",children:e.jsx(et,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:n.auth_token.map((v,w)=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-mono",children:v}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>p(w),children:e.jsx(ns,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},w))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:" API Server "}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" API Server"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" API Server"})]}),e.jsx(Ve,{checked:n.enable_api_server,onCheckedChange:v=>r({...n,enable_api_server:v})})]}),n.enable_api_server&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{value:n.api_server_host,onChange:v=>r({...n,api_server_host:v.target.value}),placeholder:"0.0.0.0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",value:n.api_server_port,onChange:v=>r({...n,api_server_port:parseInt(v.target.value)}),placeholder:"8090"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{checked:n.api_server_use_wss,onCheckedChange:v=>r({...n,api_server_use_wss:v})}),e.jsx(T,{children:" WSS "})]}),n.api_server_use_wss&&e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"SSL "}),e.jsx(ae,{value:n.api_server_cert_file,onChange:v=>r({...n,api_server_cert_file:v.target.value}),placeholder:"cert.pem"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"SSL "}),e.jsx(ae,{value:n.api_server_key_file,onChange:v=>r({...n,api_server_key_file:v.target.value}),placeholder:"key.pem"})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:" API Key "}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ae,{value:u,onChange:v=>h(v.target.value),placeholder:" API Key",onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),g())}}),e.jsx(_,{onClick:g,size:"sm",children:e.jsx(et,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:n.api_server_allowed_api_keys.map((v,w)=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-mono",children:v}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>N(w),children:e.jsx(ns,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},w))})]})]})]})]})]})}),aS=Rs.memo(function({config:n,onChange:r}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{checked:n.enable,onCheckedChange:c=>r({...n,enable:c})})]})]})}),lS=Rs.memo(function({emojiConfig:n,memoryConfig:r,toolConfig:c,voiceConfig:d,onEmojiChange:u,onMemoryChange:h,onToolChange:f,onVoiceChange:p}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_tool",checked:c.enable_tool,onCheckedChange:g=>f({...c,enable_tool:g})}),e.jsx(T,{htmlFor:"enable_tool",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(Ve,{id:"enable_asr",checked:d.enable_asr,onCheckedChange:g=>p({...d,enable_asr:g})}),e.jsx(T,{htmlFor:"enable_asr",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_agent_iterations",children:""}),e.jsx(ae,{id:"max_agent_iterations",type:"number",min:"1",value:r.max_agent_iterations,onChange:g=>h({...r,max_agent_iterations:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"agent_timeout_seconds",children:""}),e.jsx(ae,{id:"agent_timeout_seconds",type:"number",min:"1",step:"0.1",value:r.agent_timeout_seconds??120,onChange:g=>h({...r,agent_timeout_seconds:parseFloat(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_jargon_detection",checked:r.enable_jargon_detection??!0,onCheckedChange:g=>h({...r,enable_jargon_detection:g})}),e.jsx(T,{htmlFor:"enable_jargon_detection",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"global_memory",checked:r.global_memory??!1,onCheckedChange:g=>h({...r,global_memory:g})}),e.jsx(T,{htmlFor:"global_memory",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"emoji_chance",children:""}),e.jsx(ae,{id:"emoji_chance",type:"number",step:"0.1",min:"0",max:"1",value:n.emoji_chance,onChange:g=>u({...n,emoji_chance:parseFloat(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 0-1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_reg_num",children:""}),e.jsx(ae,{id:"max_reg_num",type:"number",min:"1",value:n.max_reg_num,onChange:g=>u({...n,max_reg_num:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"check_interval",children:""}),e.jsx(ae,{id:"check_interval",type:"number",min:"1",value:n.check_interval,onChange:g=>u({...n,check_interval:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"do_replace",checked:n.do_replace,onCheckedChange:g=>u({...n,do_replace:g})}),e.jsx(T,{htmlFor:"do_replace",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"steal_emoji",checked:n.steal_emoji,onCheckedChange:g=>u({...n,steal_emoji:g})}),e.jsx(T,{htmlFor:"steal_emoji",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"content_filtration",checked:n.content_filtration,onCheckedChange:g=>u({...n,content_filtration:g})}),e.jsx(T,{htmlFor:"content_filtration",className:"cursor-pointer",children:""})]}),n.content_filtration&&e.jsxs("div",{className:"grid gap-2 pl-6 border-l-2 border-primary/20",children:[e.jsx(T,{htmlFor:"filtration_prompt",children:""}),e.jsx(ae,{id:"filtration_prompt",value:n.filtration_prompt,onChange:g=>u({...n,filtration_prompt:g.target.value}),placeholder:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]})})]})}),nS=Rs.memo(function({member:n,groupIndex:r,memberIndex:c,availableChatIds:d,onUpdate:u,onRemove:h}){const f=d.includes(n)||n==="*",[p,g]=m.useState(!f);return e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 flex gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx(ae,{value:n,onChange:N=>u(r,c,N.target.value),placeholder:' "*"  "qq:123456:group"',className:"flex-1"}),d.length>0&&e.jsx(_,{size:"sm",variant:"outline",onClick:()=>g(!1),title:"",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{value:n,onValueChange:N=>u(r,c,N),children:[e.jsx($e,{className:"flex-1",children:e.jsx(Ie,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"*",children:"* ()"}),d.map((N,v)=>e.jsx(Z,{value:N,children:N},v))]})]}),e.jsx(_,{size:"sm",variant:"outline",onClick:()=>g(!0),title:"",children:""})]})}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[' "',n||"()",'" ']})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>h(r,c),children:""})]})]})]})]})}),rS=Rs.memo(function({config:n,onChange:r}){const c=()=>{r({...n,learning_list:[...n.learning_list,["","enable","enable","1.0"]]})},d=w=>{r({...n,learning_list:n.learning_list.filter((b,y)=>y!==w)})},u=(w,b,y)=>{const O=[...n.learning_list];O[w][b]=y,r({...n,learning_list:O})},h=({rule:w})=>{const b=`["${w[0]}", "${w[1]}", "${w[2]}", "${w[3]}"]`;return e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:b}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})},f=()=>{r({...n,expression_groups:[...n.expression_groups,[]]})},p=w=>{r({...n,expression_groups:n.expression_groups.filter((b,y)=>y!==w)})},g=w=>{const b=[...n.expression_groups];b[w]=[...b[w],""],r({...n,expression_groups:b})},N=(w,b)=>{const y=[...n.expression_groups];y[w]=y[w].filter((O,R)=>R!==b),r({...n,expression_groups:y})},v=(w,b,y)=>{const O=[...n.expression_groups];O[w][b]=y,r({...n,expression_groups:O})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"all_global_jargon",checked:n.all_global_jargon??!1,onCheckedChange:w=>r({...n,all_global_jargon:w})}),e.jsx(T,{htmlFor:"all_global_jargon",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:""})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_jargon_explanation",checked:n.enable_jargon_explanation??!0,onCheckedChange:w=>r({...n,enable_jargon_explanation:w})}),e.jsx(T,{htmlFor:"enable_jargon_explanation",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"LLM"})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"jargon_mode",children:""}),e.jsxs(Pe,{value:n.jargon_mode??"context",onValueChange:w=>r({...n,jargon_mode:w}),children:[e.jsx($e,{id:"jargon_mode",className:"mt-2",children:e.jsx(Ie,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"context",children:""}),e.jsx(Z,{value:"planner",children:"Plannerunknown_words"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["",e.jsx("br",{}),"PlannerPlannerreplyunknown_words"]})]})]}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:c,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[n.learning_list.map((w,b)=>{const y=n.learning_list.some((C,A)=>A!==b&&C[0]===""),O=w[0]==="",R=w[0].split(":"),S=R[0]||"qq",B=R[1]||"",E=R[2]||"group";return e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",b+1," ",O&&""]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{rule:w}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",b+1," "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>d(b),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:O?"global":"specific",onValueChange:C=>{C==="global"?u(b,0,""):u(b,0,"qq::group")},disabled:y&&!O,children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"global",children:""}),e.jsx(Z,{value:"specific",disabled:y&&!O,children:""})]})]}),y&&!O&&e.jsx("p",{className:"text-xs text-amber-600",children:""})]}),!O&&e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:S,onValueChange:C=>{u(b,0,`${C}:${B}:${E}`)},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"qq",children:"QQ"}),e.jsx(Z,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" ID"}),e.jsx(ae,{value:B,onChange:C=>{u(b,0,`${S}:${C.target.value}:${E}`)},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:E,onValueChange:C=>{u(b,0,`${S}:${B}:${C}`)},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"group",children:"group"}),e.jsx(Z,{value:"private",children:"private"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",w[0]||""]})]}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ve,{checked:w[1]==="enable",onCheckedChange:C=>u(b,1,C?"enable":"disable")})]})}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ve,{checked:w[2]==="enable",onCheckedChange:C=>u(b,2,C?"enable":"disable")})]})}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ve,{checked:w[3]==="true"||w[3]==="enable",onCheckedChange:C=>u(b,3,C?"true":"false")})]})})]})]},b)}),n.learning_list.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_self_reflect",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"expression_self_reflect",checked:n.expression_self_reflect??!1,onCheckedChange:w=>r({...n,expression_self_reflect:w})})]}),n.expression_self_reflect&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"expression_auto_check_interval",children:""}),e.jsx(ae,{id:"expression_auto_check_interval",type:"number",min:"60",value:n.expression_auto_check_interval??3600,onChange:w=>r({...n,expression_auto_check_interval:parseInt(w.target.value)||3600})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"36001"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"expression_auto_check_count",children:""}),e.jsx(ae,{id:"expression_auto_check_count",type:"number",min:"1",max:"100",value:n.expression_auto_check_count??10,onChange:w=>r({...n,expression_auto_check_count:parseInt(w.target.value)||10})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"10"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:()=>{r({...n,expression_auto_check_custom_criteria:[...n.expression_auto_check_custom_criteria||[],""]})},size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(n.expression_auto_check_custom_criteria||[]).map((w,b)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{value:w,onChange:y=>{const O=[...n.expression_auto_check_custom_criteria||[]];O[b]=y.target.value,r({...n,expression_auto_check_custom_criteria:O})},placeholder:"",className:"flex-1"}),e.jsx(_,{onClick:()=>{r({...n,expression_auto_check_custom_criteria:(n.expression_auto_check_custom_criteria||[]).filter((y,O)=>O!==b)})},size:"icon",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})]},b)),(!n.expression_auto_check_custom_criteria||n.expression_auto_check_custom_criteria.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:'""'})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_checked_only",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"expression_checked_only",checked:n.expression_checked_only??!1,onCheckedChange:w=>r({...n,expression_checked_only:w})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_manual_reflect",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"expression_manual_reflect",checked:n.expression_manual_reflect??!1,onCheckedChange:w=>r({...n,expression_manual_reflect:w})})]}),n.expression_manual_reflect&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"text-sm font-medium",children:""})}),e.jsx("div",{className:"space-y-4",children:(()=>{const b=(n.manual_reflect_operator_id||"").split(":"),y=b[0]||"qq",O=b[1]||"",R=b[2]||"private";return e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:y,onValueChange:S=>{r({...n,manual_reflect_operator_id:`${S}:${O}:${R}`})},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"qq",children:"QQ"}),e.jsx(Z,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:"/ ID"}),e.jsx(ae,{value:O,onChange:S=>{r({...n,manual_reflect_operator_id:`${y}:${S.target.value}:${R}`})},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:R,onValueChange:S=>{r({...n,manual_reflect_operator_id:`${y}:${O}:${S}`})},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"private",children:"private"}),e.jsx(Z,{value:"group",children:"group"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",n.manual_reflect_operator_id||""]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'IDplatform:id:type ( "qq:123456:private"  "qq:654321:group")'})]})})()})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>{r({...n,allow_reflect:[...n.allow_reflect||[],"qq::group"]})},size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(n.allow_reflect||[]).map((w,b)=>{const y=w.split(":"),O=y[0]||"qq",R=y[1]||"",S=y[2]||"group";return e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-muted/50",children:[e.jsxs(Pe,{value:O,onValueChange:B=>{const E=[...n.allow_reflect];E[b]=`${B}:${R}:${S}`,r({...n,allow_reflect:E})},children:[e.jsx($e,{className:"w-24",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"qq",children:"QQ"}),e.jsx(Z,{value:"wx",children:""})]})]}),e.jsx(ae,{value:R,onChange:B=>{const E=[...n.allow_reflect];E[b]=`${O}:${B.target.value}:${S}`,r({...n,allow_reflect:E})},placeholder:"ID",className:"flex-1 font-mono text-sm"}),e.jsxs(Pe,{value:S,onValueChange:B=>{const E=[...n.allow_reflect];E[b]=`${O}:${R}:${B}`,r({...n,allow_reflect:E})},children:[e.jsx($e,{className:"w-32",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"group",children:""}),e.jsx(Z,{value:"private",children:""})]})]}),e.jsx(_,{onClick:()=>{r({...n,allow_reflect:n.allow_reflect.filter((B,E)=>E!==b)})},size:"sm",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})]},b)}),(!n.allow_reflect||n.allow_reflect.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:""})]})]})]})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:f,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[n.expression_groups.map((w,b)=>{const y=n.learning_list.map(O=>O[0]).filter(O=>O!=="");return e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",b+1,w.length===1&&w[0]==="*"&&""]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{onClick:()=>g(b),size:"sm",variant:"outline",children:e.jsx(et,{className:"h-4 w-4"})}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",b+1," "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>p(b),children:""})]})]})]})]})]}),e.jsx("div",{className:"space-y-2",children:w.map((O,R)=>e.jsx(nS,{member:O,groupIndex:b,memberIndex:R,availableChatIds:y,onUpdate:v,onRemove:N},`${b}-${R}`))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:' "*" '})]},b)}),n.expression_groups.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})})]})});function iS({regex:a,reaction:n,onRegexChange:r,onReactionChange:c}){const[d,u]=m.useState(!1),[h,f]=m.useState(""),[p,g]=m.useState(null),[N,v]=m.useState(""),[w,b]=m.useState({}),[y,O]=m.useState(""),R=m.useRef(null),[S,B]=m.useState("build"),E=L=>L.replace(/\(\?P<([^>]+)>/g,"(?<$1>"),C=(L,J=0)=>{const U=R.current;if(!U)return;const oe=U.selectionStart||0,Ne=U.selectionEnd||0,je=a.substring(0,oe)+L+a.substring(Ne);r(je),setTimeout(()=>{const re=oe+L.length+J;U.setSelectionRange(re,re),U.focus()},0)};m.useEffect(()=>{if(!a||!h){p!==null&&g(null),Object.keys(w).length>0&&b({}),y!==n&&O(n),N!==""&&v("");return}try{const L=E(a),J=new RegExp(L,"g"),U=h.match(J);g(U),v("");const Ne=new RegExp(L).exec(h);if(Ne&&Ne.groups){b(Ne.groups);let je=n;Object.entries(Ne.groups).forEach(([re,fe])=>{je=je.replace(new RegExp(`\\[${re}\\]`,"g"),fe||"")}),O(je)}else b({}),O(n)}catch(L){v(L.message),g(null),b({}),O(n)}},[a,h,n,p,w,y,N]);const A=()=>{if(!h||!p||p.length===0)return e.jsx("span",{className:"text-muted-foreground",children:h||""});try{const L=E(a),J=new RegExp(L,"g");let U=0;const oe=[];let Ne;for(;(Ne=J.exec(h))!==null;)Ne.index>U&&oe.push(e.jsx("span",{children:h.substring(U,Ne.index)},`text-${U}`)),oe.push(e.jsx("span",{className:"bg-yellow-200 dark:bg-yellow-900 font-semibold",children:Ne[0]},`match-${Ne.index}`)),U=Ne.index+Ne[0].length;return U<h.length&&oe.push(e.jsx("span",{children:h.substring(U)},`text-${U}`)),e.jsx(e.Fragment,{children:oe})}catch{return e.jsx("span",{children:h})}},F=[{category:"",items:[{label:"",pattern:".",desc:""},{label:"",pattern:"\\d",desc:" 0-9"},{label:"",pattern:"\\D",desc:""},{label:"",pattern:"\\w",desc:""},{label:"",pattern:"\\W",desc:""},{label:"",pattern:"\\s",desc:""},{label:"",pattern:"\\S",desc:""}]},{category:"",items:[{label:"",pattern:"^",desc:""},{label:"",pattern:"$",desc:""},{label:"",pattern:"\\b",desc:""}]},{category:"",items:[{label:"0",pattern:"*",desc:"0"},{label:"1",pattern:"+",desc:"1"},{label:"01",pattern:"?",desc:"01"},{label:"",pattern:"{n}",desc:"nn"},{label:"",pattern:"{m,n}",desc:"mn"}]},{category:"",items:[{label:"",pattern:"()",desc:"",moveCursor:-1},{label:"",pattern:"(?P<name>)",desc:"Python",moveCursor:-1},{label:"",pattern:"(?:)",desc:"",moveCursor:-1}]},{category:"",items:[{label:"",pattern:"[]",desc:"",moveCursor:-1},{label:"",pattern:"[^]",desc:"",moveCursor:-1},{label:"",pattern:"[a-z]",desc:"az"},{label:"",pattern:"[\\u4e00-\\u9fa5]",desc:""}]},{category:"",items:[{label:"",pattern:"(?P<word>\\S+)",desc:""},{label:"",pattern:"(?P<sentence>.+)",desc:""},{label:"",pattern:"(?P<num>\\d+)",desc:""},{label:"",pattern:"(?:1|2)",desc:""}]}];return e.jsxs(Ps,{open:d,onOpenChange:u,children:[e.jsx(cd,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(nx,{className:"h-4 w-4 mr-1"}),""]})}),e.jsxs(Ds,{className:"max-w-[95vw] sm:max-w-[900px] max-h-[90vh]",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{className:"text-sm",children:""})]}),e.jsx(Je,{className:"max-h-[calc(90vh-120px)]",children:e.jsxs(ta,{value:S,onValueChange:L=>B(L),className:"w-full",children:[e.jsxs(Zt,{className:"grid w-full grid-cols-2",children:[e.jsx(Xe,{value:"build",children:" "}),e.jsx(Xe,{value:"test",children:" "})]}),e.jsxs(ws,{value:"build",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(ae,{ref:R,value:a,onChange:L=>r(L.target.value),className:"font-mono text-sm",placeholder:"..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Reaction "}),e.jsx(ot,{value:n,onChange:L=>c(L.target.value),placeholder:" [] ...",rows:3,className:"text-sm"})]}),e.jsxs("div",{className:"space-y-4 border-t pt-4",children:[F.map(L=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-semibold text-primary",children:L.category}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:L.items.map(J=>e.jsx(_,{variant:"outline",size:"sm",className:"justify-start h-auto py-2 px-3",onClick:()=>C(J.pattern,J.moveCursor||0),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("span",{className:"text-xs font-medium",children:J.label}),e.jsx("code",{className:"ml-auto text-xs bg-muted px-1.5 py-0.5 rounded font-mono",children:J.pattern})]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:J.desc})]})},J.label))})]},L.category)),e.jsxs("div",{className:"space-y-2 border-t pt-4",children:[e.jsx("h5",{className:"text-xs font-semibold text-primary",children:""}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>r("^(?P<n>\\S{1,20})$"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:["^(?P<n>\\S","{1,20}",")$"]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})}),e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>r("(?:[^.\\s]+\\s*)?(?:)?[]\\s*(?P<action>.+?)[.,]?$"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:"(?:[^.\\s]+\\s*)?(?:)?[]\\s*(?P<action>.+?)[.,]?$"}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})}),e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>r("(?P<subject>.+?)(?:||)"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:"(?P<subject>.+?)(?:||)"}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})})]})]})]}),e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsxs("li",{children:["",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-900 px-1 rounded",children:"(?P<>)"})]}),e.jsxs("li",{children:[" reaction  ",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-900 px-1 rounded",children:"[]"})," "]}),e.jsx("li",{children:""})]})]})]}),e.jsxs(ws,{value:"test",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:a||"()"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"test-text",className:"text-sm font-medium",children:""}),e.jsx(ot,{id:"test-text",value:h,onChange:L=>f(L.target.value),placeholder:`...
`,className:"min-h-[100px] text-sm"})]}),N&&e.jsxs("div",{className:"rounded-md bg-destructive/10 border border-destructive/20 p-3",children:[e.jsx("p",{className:"text-sm text-destructive font-medium",children:""}),e.jsx("p",{className:"text-xs text-destructive/80 mt-1",children:N})]}),!N&&h&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:p&&p.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:[" (",p.length," )"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:""})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(Je,{className:"h-40 rounded-md bg-muted p-3",children:e.jsx("div",{className:"text-sm break-words",children:A()})})]}),Object.keys(w).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(Je,{className:"h-32 rounded-md border p-3",children:e.jsx("div",{className:"space-y-2",children:Object.entries(w).map(([L,J])=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsxs("span",{className:"font-mono font-semibold text-primary min-w-[80px]",children:["[",L,"]"]}),e.jsx("span",{className:"text-muted-foreground",children:"="}),e.jsx("span",{className:"font-mono bg-muted px-2 py-0.5 rounded",children:J})]},L))})})]}),Object.keys(w).length>0&&n&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Reaction "}),e.jsx(Je,{className:"h-48 rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3",children:e.jsx("div",{className:"text-sm break-words",children:y})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"reaction  [name] "})]})]}),e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:"Reaction "}),e.jsx("li",{children:""})]})]})]})]})})]})]})}const cS=Rs.memo(function({keywordReactionConfig:n,responsePostProcessConfig:r,chineseTypoConfig:c,responseSplitterConfig:d,onKeywordReactionChange:u,onResponsePostProcessChange:h,onChineseTypoChange:f,onResponseSplitterChange:p}){const g=()=>{u({...n,regex_rules:[...n.regex_rules,{regex:[""],reaction:""}]})},N=C=>{u({...n,regex_rules:n.regex_rules.filter((A,F)=>F!==C)})},v=(C,A,F)=>{const L=[...n.regex_rules];A==="regex"&&typeof F=="string"?L[C]={...L[C],regex:[F]}:A==="reaction"&&typeof F=="string"&&(L[C]={...L[C],reaction:F}),u({...n,regex_rules:L})},w=()=>{u({...n,keyword_rules:[...n.keyword_rules,{keywords:[],reaction:""}]})},b=C=>{u({...n,keyword_rules:n.keyword_rules.filter((A,F)=>F!==C)})},y=(C,A,F)=>{const L=[...n.keyword_rules];typeof F=="string"&&(L[C]={...L[C],reaction:F}),u({...n,keyword_rules:L})},O=C=>{const A=[...n.keyword_rules];A[C]={...A[C],keywords:[...A[C].keywords||[],""]},u({...n,keyword_rules:A})},R=(C,A)=>{const F=[...n.keyword_rules];F[C]={...F[C],keywords:(F[C].keywords||[]).filter((L,J)=>J!==A)},u({...n,keyword_rules:F})},S=(C,A,F)=>{const L=[...n.keyword_rules],J=[...L[C].keywords||[]];J[A]=F,L[C]={...L[C],keywords:J},u({...n,keyword_rules:L})},B=({rule:C})=>{const A=`{ regex = [${(C.regex||[]).map(F=>`"${F}"`).join(", ")}], reaction = "${C.reaction}" }`;return e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-[95vw] sm:w-[500px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx(Je,{className:"h-60 rounded-md bg-muted p-3",children:e.jsx("pre",{className:"font-mono text-xs break-all",children:A})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})},E=({rule:C})=>{const A=`[[keyword_reaction.keyword_rules]]
keywords = [${(C.keywords||[]).map(F=>`"${F}"`).join(", ")}]
reaction = "${C.reaction}"`;return e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-[95vw] sm:w-[500px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx(Je,{className:"h-60 rounded-md bg-muted p-3",children:e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-all",children:A})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:g,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-3",children:[n.regex_rules.map((C,A)=>e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",A+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(iS,{regex:C.regex&&C.regex[0]||"",reaction:C.reaction,onRegexChange:F=>v(A,"regex",F),onReactionChange:F=>v(A,"reaction",F)}),e.jsx(B,{rule:C}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",A+1," "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>N(A),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:"Python "}),e.jsx(ae,{value:C.regex&&C.regex[0]||"",onChange:F=>v(A,"regex",F.target.value),placeholder:"^(?P<n>\\\\S{1,20})$ ",className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:' (?P<name>pattern) reaction  [name] ""'})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx(ot,{value:C.reaction,onChange:F=>v(A,"reaction",F.target.value),placeholder:`...
 [] `,rows:3,className:"text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" []  [n] "})]})]})]},A)),n.regex_rules.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]}),e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:w,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-3",children:[n.keyword_rules.map((C,A)=>e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",A+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{rule:C}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",A+1," "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>b(A),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(_,{onClick:()=>O(A),size:"sm",variant:"ghost",children:[e.jsx(et,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(C.keywords||[]).map((F,L)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{value:F,onChange:J=>S(A,L,J.target.value),placeholder:"",className:"flex-1"}),e.jsx(_,{onClick:()=>R(A,L),size:"sm",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})]},L)),(!C.keywords||C.keywords.length===0)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-2",children:'""'})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx(ot,{value:C.reaction,onChange:F=>y(A,"reaction",F.target.value),placeholder:"...",rows:3,className:"text-sm"})]})]})]},A)),n.keyword_rules.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_response_post_process",checked:r.enable_response_post_process,onCheckedChange:C=>h({...r,enable_response_post_process:C})}),e.jsx(T,{htmlFor:"enable_response_post_process",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:""})]}),r.enable_response_post_process&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t pt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ve,{id:"enable_chinese_typo",checked:c.enable,onCheckedChange:C=>f({...c,enable:C})}),e.jsx(T,{htmlFor:"enable_chinese_typo",className:"cursor-pointer font-semibold",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),c.enable&&e.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"error_rate",className:"text-xs font-medium",children:""}),e.jsx(ae,{id:"error_rate",type:"number",step:"0.001",min:"0",max:"1",value:c.error_rate,onChange:C=>f({...c,error_rate:parseFloat(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"min_freq",className:"text-xs font-medium",children:""}),e.jsx(ae,{id:"min_freq",type:"number",min:"0",value:c.min_freq,onChange:C=>f({...c,min_freq:parseInt(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"tone_error_rate",className:"text-xs font-medium",children:""}),e.jsx(ae,{id:"tone_error_rate",type:"number",step:"0.01",min:"0",max:"1",value:c.tone_error_rate,onChange:C=>f({...c,tone_error_rate:parseFloat(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"word_replace_rate",className:"text-xs font-medium",children:""}),e.jsx(ae,{id:"word_replace_rate",type:"number",step:"0.001",min:"0",max:"1",value:c.word_replace_rate,onChange:C=>f({...c,word_replace_rate:parseFloat(C.target.value)})})]})]})]})}),e.jsx("div",{className:"border-t pt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ve,{id:"enable_response_splitter",checked:d.enable,onCheckedChange:C=>p({...d,enable:C})}),e.jsx(T,{htmlFor:"enable_response_splitter",className:"cursor-pointer font-semibold",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),d.enable&&e.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_length",className:"text-xs font-medium",children:""}),e.jsx(ae,{id:"max_length",type:"number",min:"1",value:d.max_length,onChange:C=>p({...d,max_length:parseInt(C.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_sentence_num",className:"text-xs font-medium",children:""}),e.jsx(ae,{id:"max_sentence_num",type:"number",min:"1",value:d.max_sentence_num,onChange:C=>p({...d,max_sentence_num:parseInt(C.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_kaomoji_protection",checked:d.enable_kaomoji_protection,onCheckedChange:C=>p({...d,enable_kaomoji_protection:C})}),e.jsx(T,{htmlFor:"enable_kaomoji_protection",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_overflow_return_all",checked:d.enable_overflow_return_all,onCheckedChange:C=>p({...d,enable_overflow_return_all:C})}),e.jsx(T,{htmlFor:"enable_overflow_return_all",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})})]})]})]})}),oS=Rs.memo(function({config:n,onChange:r}){const[c,d]=m.useState(""),[u,h]=m.useState(""),[f,p]=m.useState(!1),g=n.allowed_ips?n.allowed_ips.split(",").map(S=>S.trim()).filter(S=>S):[],N=n.trusted_proxies?n.trusted_proxies.split(",").map(S=>S.trim()).filter(S=>S):[],v=()=>{if(!c.trim())return;const S=[...g,c.trim()];r({...n,allowed_ips:S.join(",")}),d("")},w=S=>{const B=g.filter((E,C)=>C!==S);r({...n,allowed_ips:B.join(",")})},b=()=>{if(!u.trim())return;const S=[...N,u.trim()];r({...n,trusted_proxies:S.join(",")}),h("")},y=S=>{const B=N.filter((E,C)=>C!==S);r({...n,trusted_proxies:B.join(",")})},O=S=>{!S&&n.enabled?p(!0):r({...n,enabled:S})},R=()=>{r({...n,enabled:!1}),p(!1)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"WebUI "}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{checked:n.enabled,onCheckedChange:O}),e.jsx(T,{className:"cursor-pointer",children:" WebUI"})]}),n.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:n.mode,onValueChange:S=>r({...n,mode:S}),children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"development",children:""}),e.jsx(Z,{value:"production",children:""})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:": WebUI  .env  WEBUI_HOST  WEBUI_PORT"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:n.anti_crawler_mode,onValueChange:S=>r({...n,anti_crawler_mode:S}),children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"false",children:""}),e.jsx(Z,{value:"basic",children:""}),e.jsx(Z,{value:"loose",children:""}),e.jsx(Z,{value:"strict",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2 sm:col-span-2",children:[e.jsx(T,{children:"IP "}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{value:c,onChange:S=>d(S.target.value),onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),v())},placeholder:"IP"}),e.jsx(_,{type:"button",size:"sm",onClick:v,disabled:!c.trim(),children:e.jsx(et,{className:"h-4 w-4"})})]}),g.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:g.map((S,B)=>e.jsxs(ke,{variant:"secondary",className:"flex items-center gap-1",children:[S,e.jsx("button",{type:"button",onClick:()=>w(B),className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5",children:e.jsx(Aa,{className:"h-3 w-3"})})]},B))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IPCIDR127.0.0.1192.168.1.0/24"})]}),e.jsxs("div",{className:"grid gap-2 sm:col-span-2",children:[e.jsx(T,{children:" IP"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{value:u,onChange:S=>h(S.target.value),onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),b())},placeholder:"IP"}),e.jsx(_,{type:"button",size:"sm",onClick:b,disabled:!u.trim(),children:e.jsx(et,{className:"h-4 w-4"})})]}),N.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:N.map((S,B)=>e.jsxs(ke,{variant:"secondary",className:"flex items-center gap-1",children:[S,e.jsx("button",{type:"button",onClick:()=>y(B),className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5",children:e.jsx(Aa,{className:"h-3 w-3"})})]},B))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IPX-Forwarded-For"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{checked:n.trust_xff,onCheckedChange:S=>r({...n,trust_xff:S})}),e.jsx(T,{className:"cursor-pointer",children:" X-Forwarded-For "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{checked:n.secure_cookie,onCheckedChange:S=>r({...n,secure_cookie:S})}),e.jsx(T,{className:"cursor-pointer",children:" Cookie HTTPS"})]})]})]}),e.jsx(Ns,{open:f,onOpenChange:p,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:" WebUI"}),e.jsxs(fs,{children:[" WebUI WebUI ",e.jsx("br",{}),e.jsx("br",{})," WebUI ",e.jsx("br",{}),e.jsx("br",{})," WebUI "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{variant:"destructive",onClick:R,children:""})]})]})})]})}),wn="/api/webui/config";async function Lg(){const n=await(await _e(`${wn}/bot`)).json();if(!n.success)throw new Error("");return n.config}async function xn(){const n=await(await _e(`${wn}/model`)).json();if(!n.success)throw new Error("");return n.config}async function Ug(a){const r=await(await _e(`${wn}/bot`,{method:"POST",body:JSON.stringify(a)})).json();if(!r.success)throw new Error(r.message||"")}async function dS(){const n=await(await _e(`${wn}/bot/raw`)).json();if(!n.success)throw new Error("");return n.content}async function uS(a){const r=await(await _e(`${wn}/bot/raw`,{method:"POST",body:JSON.stringify({raw_content:a})})).json();if(!r.success)throw new Error(r.message||"")}async function tc(a){const r=await(await _e(`${wn}/model`,{method:"POST",body:JSON.stringify(a)})).json();if(!r.success)throw new Error(r.message||"")}async function mS(a,n){const c=await(await _e(`${wn}/bot/section/${a}`,{method:"POST",body:JSON.stringify(n)})).json();if(!c.success)throw new Error(c.message||` ${a} `)}async function Ym(a,n){const c=await(await _e(`${wn}/model/section/${a}`,{method:"POST",body:JSON.stringify(n)})).json();if(!c.success)throw new Error(c.message||` ${a} `)}async function xS(a,n="openai",r="/models"){const c=new URLSearchParams({provider_name:a,parser:n,endpoint:r}),d=await _e(`/api/webui/models/list?${c}`);if(!d.ok){const h=await d.json().catch(()=>({}));throw new Error(h.detail||` (${d.status})`)}const u=await d.json();if(!u.success)throw new Error("");return u.models}async function hS(a){const n=new URLSearchParams({provider_name:a}),r=await _e(`/api/webui/models/test-connection-by-name?${n}`,{method:"POST"});if(!r.ok){const c=await r.json().catch(()=>({}));throw new Error(c.detail||` (${r.status})`)}return await r.json()}const fS=Wr("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),at=m.forwardRef(({className:a,variant:n,...r},c)=>e.jsx("div",{ref:c,role:"alert",className:I(fS({variant:n}),a),...r}));at.displayName="Alert";const Gn=m.forwardRef(({className:a,...n},r)=>e.jsx("h5",{ref:r,className:I("mb-1 font-medium leading-none tracking-tight",a),...n}));Gn.displayName="AlertTitle";const lt=m.forwardRef(({className:a,...n},r)=>e.jsx("div",{ref:r,className:I("text-sm [&_p]:leading-relaxed",a),...n}));lt.displayName="AlertDescription";const pS={name:"toml",startState:function(){return{inString:!1,stringType:"",lhs:!0,inArray:0}},token:function(a,n){let r;if(!n.inString&&(r=a.match(/^('''|"""|'|")/))&&(n.stringType=r[0],n.inString=!0),a.sol()&&!n.inString&&n.inArray===0&&(n.lhs=!0),n.inString){for(;n.inString;)if(a.match(n.stringType))n.inString=!1;else if(a.peek()==="\\")a.next(),a.next();else{if(a.eol())break;a.match(/^.[^\\\"\']*/)}return n.lhs?"property":"string"}else{if(n.inArray&&a.peek()==="]")return a.next(),n.inArray--,"bracket";if(n.lhs&&a.peek()==="["&&a.skipTo("]"))return a.next(),a.peek()==="]"&&a.next(),"atom";if(a.peek()==="#")return a.skipToEnd(),"comment";if(a.eatSpace())return null;if(n.lhs&&a.eatWhile(function(c){return c!="="&&c!=" "}))return"property";if(n.lhs&&a.peek()==="=")return a.next(),n.lhs=!1,null;if(!n.lhs&&a.match(/^\d\d\d\d[\d\-\:\.T]*Z/))return"atom";if(!n.lhs&&(a.match("true")||a.match("false")))return"atom";if(!n.lhs&&a.peek()==="[")return n.inArray++,a.next(),"bracket";if(!n.lhs&&a.match(/^\-?\d+(?:\.\d+)?/))return"number";a.eatSpace()||a.next()}return null},languageData:{commentTokens:{line:"#"}}},gS={python:[a1()],json:[l1(),n1()],toml:[t1.define(pS)],text:[]};function Iv({value:a,onChange:n,language:r="text",readOnly:c=!1,height:d="400px",minHeight:u,maxHeight:h,placeholder:f,theme:p="dark",className:g=""}){const[N,v]=m.useState(!1);if(m.useEffect(()=>{v(!0)},[]),!N)return e.jsx("div",{className:`rounded-md border bg-muted animate-pulse ${g}`,style:{height:d,minHeight:u,maxHeight:h}});const w=[...gS[r]||[],Sg.lineWrapping];return c&&w.push(Sg.editable.of(!1)),e.jsx("div",{className:`rounded-md overflow-hidden border ${g}`,children:e.jsx(r1,{value:a,height:d,minHeight:u,maxHeight:h,theme:p==="dark"?i1:void 0,extensions:w,onChange:n,placeholder:f,basicSetup:{lineNumbers:!0,highlightActiveLineGutter:!0,highlightSpecialChars:!0,history:!0,foldGutter:!0,drawSelection:!0,dropCursor:!0,allowMultipleSelections:!0,indentOnInput:!0,syntaxHighlighting:!0,bracketMatching:!0,closeBrackets:!0,autocompletion:!0,rectangularSelection:!0,crosshairCursor:!0,highlightActiveLine:!0,highlightSelectionMatches:!0,closeBracketsKeymap:!0,defaultKeymap:!0,searchKeymap:!0,historyKeymap:!0,foldKeymap:!0,completionKeymap:!0,lintKeymap:!0}})})}function jS({id:a,index:n,itemType:r,itemFields:c,value:d,onChange:u,onRemove:h,disabled:f,canRemove:p,placeholder:g}){const{attributes:N,listeners:v,setNodeRef:w,transform:b,transition:y,isDragging:O}=Nv({id:a,disabled:f}),R={transform:bv.Transform.toString(b),transition:y};return e.jsxs("div",{ref:w,style:R,className:I("flex items-start gap-2 group",O&&"opacity-50 z-50"),children:[e.jsx("button",{type:"button",className:I("flex-shrink-0 p-2 cursor-grab active:cursor-grabbing","text-muted-foreground hover:text-foreground transition-colors","opacity-0 group-hover:opacity-100 focus:opacity-100",f&&"cursor-not-allowed opacity-30"),...N,...v,children:e.jsx(tv,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex-1 min-w-0",children:r==="object"&&c?e.jsx(vS,{value:d,onChange:u,fields:c,disabled:f}):r==="number"?e.jsx(ae,{type:"number",value:d??"",onChange:S=>u(parseFloat(S.target.value)||0),placeholder:g??` ${n+1} `,disabled:f,className:"font-mono"}):e.jsx(ae,{type:"text",value:d??"",onChange:S=>u(S.target.value),placeholder:g??` ${n+1} `,disabled:f})}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",onClick:h,disabled:f||!p,className:I("flex-shrink-0 text-muted-foreground hover:text-destructive","opacity-0 group-hover:opacity-100 focus:opacity-100 transition-opacity"),children:e.jsx(ns,{className:"h-4 w-4"})})]})}function vS({value:a,onChange:n,fields:r,disabled:c}){const d=m.useCallback((h,f)=>{n({...a,[h]:f})},[a,n]),u=(h,f)=>{const p=a?.[h];if(f.type==="boolean"||f.type==="switch")return e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(Ve,{checked:!!(p??f.default),onCheckedChange:g=>d(h,g),disabled:c})]});if(f.type==="slider"||f.type==="number"&&f.min!=null&&f.max!=null){const g=p??f.default??f.min??0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx("span",{className:"text-xs text-muted-foreground",children:g})]}),e.jsx(Qa,{value:[g],onValueChange:N=>d(h,N[0]),min:f.min??0,max:f.max??100,step:f.step??1,disabled:c,className:"py-1"})]})}return f.type==="select"&&f.choices?e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsxs(Pe,{value:String(p??f.default??""),onValueChange:g=>d(h,g),disabled:c,children:[e.jsx($e,{className:"h-8 text-sm",children:e.jsx(Ie,{placeholder:f.placeholder??""})}),e.jsx(Be,{children:f.choices.map(g=>e.jsx(Z,{value:String(g),children:String(g)},String(g)))})]})]}):f.type==="number"?e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(ae,{type:"number",value:p??f.default??"",onChange:g=>d(h,parseFloat(g.target.value)||0),placeholder:f.placeholder,disabled:c,className:"h-8 text-sm"})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(ae,{type:"text",value:p??f.default??"",onChange:g=>d(h,g.target.value),placeholder:f.placeholder,disabled:c,className:"h-8 text-sm"})]})};return e.jsx(Ce,{className:"p-3 space-y-2 bg-muted/30",children:Object.entries(r).map(([h,f])=>e.jsx("div",{children:u(h,f)},h))})}function NS({value:a,onChange:n,itemType:r="string",itemFields:c,minItems:d,maxItems:u,disabled:h,placeholder:f}){const p=m.useMemo(()=>Array.isArray(a)?a:typeof a=="string"&&a.trim()?a.split(",").map(E=>E.trim()):[],[a]),[g]=m.useState(()=>new Map),N=m.useCallback(E=>(g.has(E)||g.set(E,`item-${Date.now()}-${E}-${Math.random().toString(36).slice(2)}`),g.get(E)),[g]),v=m.useMemo(()=>{const E=[];for(let C=0;C<p.length;C++)E.push(N(C));return E},[p.length,N]),w=mv(qo(fv,{activationConstraint:{distance:8}}),qo(hv,{coordinateGetter:xv})),b=m.useCallback(E=>{const{active:C,over:A}=E;if(A&&C.id!==A.id){const F=v.indexOf(C.id),L=v.indexOf(A.id),J=pv(p,F,L);n(J)}},[p,v,n]),y=m.useCallback(()=>{if(u!=null&&p.length>=u)return;let E;r==="object"&&c?E=Object.fromEntries(Object.entries(c).map(([C,A])=>[C,A.default??""])):r==="number"?E=0:E="",n([...p,E])},[p,u,r,c,n]),O=m.useCallback((E,C)=>{const A=[...p];A[E]=C,n(A)},[p,n]),R=m.useCallback(E=>{if(d!=null&&p.length<=d)return;const C=p.filter((A,F)=>F!==E);g.delete(E),n(C)},[p,d,g,n]),S=u==null||p.length<u,B=d==null||p.length>d;return e.jsxs("div",{className:"space-y-2",children:[p.length===0?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground py-4 justify-center border border-dashed rounded-md",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx("span",{children:""})]}):e.jsx(gv,{sensors:w,collisionDetection:jv,onDragEnd:b,children:e.jsx(vv,{items:v,strategy:c1,children:e.jsx("div",{className:"space-y-2",children:p.map((E,C)=>e.jsx(jS,{id:v[C],index:C,itemType:r,itemFields:c,value:E,onChange:A=>O(C,A),onRemove:()=>R(C),disabled:h,canRemove:B,placeholder:f},v[C]))})})}),e.jsxs(_,{type:"button",variant:"outline",size:"sm",onClick:y,disabled:h||!S,className:"w-full",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),"",u!==void 0&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",p.length,"/",u,")"]})]}),(d!=null||u!=null)&&(d!==null||u!==null)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:d!=null&&u!=null?` ${d} - ${u} `:d!=null?` ${d} `:` ${u} `})]})}function fx({content:a,className:n=""}){return e.jsx("div",{className:`prose prose-sm dark:prose-invert max-w-none ${n}`,children:e.jsx(h1,{remarkPlugins:[p1,g1],rehypePlugins:[f1],components:{code({inline:r,className:c,children:d,...u}){return r?e.jsx("code",{className:"bg-muted px-1.5 py-0.5 rounded text-sm font-mono",...u,children:d}):e.jsx("code",{className:`${c} block bg-muted p-4 rounded-lg overflow-x-auto`,...u,children:d})},table({children:r,...c}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"border-collapse border border-border",...c,children:r})})},th({children:r,...c}){return e.jsx("th",{className:"border border-border bg-muted px-4 py-2 text-left font-semibold",...c,children:r})},td({children:r,...c}){return e.jsx("td",{className:"border border-border px-4 py-2",...c,children:r})},a({children:r,...c}){return e.jsx("a",{className:"text-primary hover:underline",target:"_blank",rel:"noopener noreferrer",...c,children:r})},blockquote({children:r,...c}){return e.jsx("blockquote",{className:"border-l-4 border-primary pl-4 italic text-muted-foreground",...c,children:r})},h1({children:r,...c}){return e.jsx("h1",{className:"text-3xl font-bold mt-6 mb-4",...c,children:r})},h2({children:r,...c}){return e.jsx("h2",{className:"text-2xl font-bold mt-5 mb-3",...c,children:r})},h3({children:r,...c}){return e.jsx("h3",{className:"text-xl font-bold mt-4 mb-2",...c,children:r})},h4({children:r,...c}){return e.jsx("h4",{className:"text-lg font-semibold mt-3 mb-2",...c,children:r})},ul({children:r,...c}){return e.jsx("ul",{className:"list-disc list-inside space-y-1 my-2",...c,children:r})},ol({children:r,...c}){return e.jsx("ol",{className:"list-decimal list-inside space-y-1 my-2",...c,children:r})},p({children:r,...c}){return e.jsx("p",{className:"my-2 leading-relaxed",...c,children:r})},hr({...r}){return e.jsx("hr",{className:"my-4 border-border",...r})}},children:a})})}function bS(a,n,r,c={}){const{debounceMs:d=2e3,onSaveSuccess:u,onSaveError:h}=c,f=m.useRef(null),p=m.useCallback(async(w,b)=>{try{n(!0),await mS(w,b),r(!1),u?.()}catch(y){console.error(` ${w} :`,y),r(!0),h?.(y instanceof Error?y:new Error(String(y)))}finally{n(!1)}},[n,r,u,h]),g=m.useCallback((w,b)=>{a||(r(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{p(w,b)},d))},[a,r,p,d]),N=m.useCallback(async(w,b)=>{f.current&&(clearTimeout(f.current),f.current=null),await p(w,b)},[p]),v=m.useCallback(()=>{f.current&&(clearTimeout(f.current),f.current=null)},[]);return m.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]),{triggerAutoSave:g,saveNow:N,cancelPendingAutoSave:v}}function Lt(a,n,r,c){m.useEffect(()=>{a&&!r&&c(n,a)},[a])}const yS=500;function wS(){return e.jsx(Wn,{children:e.jsx(_S,{})})}function _S(){const[a,n]=m.useState(!0),[r,c]=m.useState(!1),[d,u]=m.useState(!1),[h,f]=m.useState(!1),[p,g]=m.useState("visual"),[N,v]=m.useState(""),[w,b]=m.useState(!1),{toast:y}=Ys(),{triggerRestart:O,isRestarting:R}=yn(),[S,B]=m.useState(null),[E,C]=m.useState(null),[A,F]=m.useState(null),[L,J]=m.useState(null),[U,oe]=m.useState(null),[Ne,je]=m.useState(null),[re,fe]=m.useState(null),[ge,M]=m.useState(null),[K,P]=m.useState(null),[ue,Q]=m.useState(null),[Se,pe]=m.useState(null),[Te,z]=m.useState(null),[D,G]=m.useState(null),[de,Re]=m.useState(null),[W,Y]=m.useState(null),[Fe,H]=m.useState(null),[ee,Ue]=m.useState(null),[ie,Ee]=m.useState(null),[me,Ae]=m.useState(null),rs=m.useRef(!0),Ut=m.useRef({}),aa=m.useCallback(ze=>{Ut.current=ze,B(ze.bot),C(ze.personality);const bs=ze.chat;bs.talk_value_rules||(bs.talk_value_rules=[]),F(bs),J(ze.expression),oe(ze.emoji),je(ze.memory),fe(ze.tool),M(ze.voice),P(ze.dream),Q(ze.lpmm_knowledge),pe(ze.keyword_reaction),z(ze.response_post_process),G(ze.chinese_typo),Re(ze.response_splitter),Y(ze.log),H(ze.debug),Ue(ze.maim_message),Ee(ze.telemetry),Ae(ze.webui)},[]),Ja=m.useCallback(()=>({...Ut.current,bot:S,personality:E,chat:A,expression:L,emoji:U,memory:Ne,tool:re,voice:ge,dream:K,lpmm_knowledge:ue,keyword_reaction:Se,response_post_process:Te,chinese_typo:D,response_splitter:de,log:W,debug:Fe,maim_message:ee,telemetry:ie,webui:me}),[S,E,A,L,U,Ne,re,ge,K,ue,Se,Te,D,de,W,Fe,ee,ie,me]),Ht=m.useCallback(async()=>{try{const bs=(await dS()).replace(/"([^"]*)"/g,(ls,ss)=>`"${ss.replace(/\\n/g,`
`).replace(/\\t/g,"	").replace(/\\r/g,"\r").replace(/\\"/g,'"').replace(/\\\\/g,"\\")}"`);v(bs),b(!1)}catch(ze){y({variant:"destructive",title:"",description:ze instanceof Error?ze.message:""})}},[y]),mt=m.useCallback(async()=>{try{n(!0);const ze=await Lg();aa(ze),f(!1),rs.current=!1,await Ht()}catch(ze){console.error(":",ze),y({title:"",description:"",variant:"destructive"})}finally{n(!1)}},[y,Ht,aa]);m.useEffect(()=>{mt()},[mt]);const{triggerAutoSave:q,cancelPendingAutoSave:qe}=bS(rs.current,u,f);Lt(S,"bot",rs.current,q),Lt(E,"personality",rs.current,q),Lt(A,"chat",rs.current,q),Lt(L,"expression",rs.current,q),Lt(U,"emoji",rs.current,q),Lt(Ne,"memory",rs.current,q),Lt(re,"tool",rs.current,q),Lt(ge,"voice",rs.current,q),Lt(K,"dream",rs.current,q),Lt(ue,"lpmm_knowledge",rs.current,q),Lt(Se,"keyword_reaction",rs.current,q),Lt(Te,"response_post_process",rs.current,q),Lt(D,"chinese_typo",rs.current,q),Lt(de,"response_splitter",rs.current,q),Lt(W,"log",rs.current,q),Lt(Fe,"debug",rs.current,q),Lt(ee,"maim_message",rs.current,q),Lt(ie,"telemetry",rs.current,q),Lt(me,"webui",rs.current,q);const Qe=async()=>{try{c(!0);const ze=N.replace(/"([^"]*)"/g,(bs,ls)=>`"${ls.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}"`);await uS(ze),f(!1),b(!1),y({title:"",description:""}),await mt()}catch(ze){b(!0),y({variant:"destructive",title:"",description:ze instanceof Error?ze.message:""})}finally{c(!1)}},es=async ze=>{if(h){y({variant:"destructive",title:"",description:""});return}if(g(ze),ze==="source")await Ht();else try{const bs=await Lg();aa(bs),f(!1)}catch(bs){console.error(":",bs),y({title:"",description:"",variant:"destructive"})}},Us=async()=>{try{c(!0),qe(),await Ug(Ja()),f(!1),y({title:"",description:""})}catch(ze){console.error(":",ze),y({title:"",description:ze.message,variant:"destructive"})}finally{c(!1)}},as=async()=>{await O()},Cs=async()=>{try{c(!0),qe(),await Ug(Ja()),f(!1),y({title:"",description:"..."}),await new Promise(ze=>setTimeout(ze,yS)),await as()}catch(ze){console.error(":",ze),y({title:"",description:ze.message,variant:"destructive"})}finally{c(!1)}};return a?e.jsx(Je,{className:"h-full",children:e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})})}):e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs sm:text-sm",children:""})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs(_,{onClick:p==="visual"?Us:Qe,disabled:r||d||!h||R,size:"sm",variant:"outline",className:"w-20 sm:w-24",children:[e.jsx(fc,{className:"h-4 w-4 flex-shrink-0",strokeWidth:2,fill:"none"}),e.jsx("span",{className:"ml-1 truncate text-xs sm:text-sm",children:r?"":d?"":h?"":""})]}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{disabled:r||d||R,size:"sm",className:"w-20 sm:w-28",children:[e.jsx(hc,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"ml-1 truncate text-xs sm:text-sm",children:R?"":h?"":""})]})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsx(fs,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:h?",":","})})})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:h?Cs:as,children:h?"":""})]})]})]})]})]}),e.jsx("div",{className:"flex",children:e.jsx(ta,{value:p,onValueChange:ze=>es(ze),className:"w-full",children:e.jsxs(Zt,{className:"h-8 sm:h-9 w-full grid grid-cols-2",children:[e.jsxs(Xe,{value:"visual",className:"text-xs sm:text-sm",children:[e.jsx(av,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),""]}),e.jsxs(Xe,{value:"source",className:"text-xs sm:text-sm",children:[e.jsx(lv,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),""]})]})})})]}),e.jsxs(at,{children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsxs(lt,{children:["",e.jsx("strong",{children:""}),'""']})]}),p==="source"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(at,{children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsxs(lt,{children:[e.jsx("strong",{children:""})," TOML  TOML ",w&&e.jsx("span",{className:"text-destructive font-semibold ml-2",children:"  TOML "})]})]}),e.jsx(Iv,{value:N,onChange:ze=>{v(ze),f(!0),w&&b(!1)},language:"toml",theme:"dark",height:"calc(100vh - 280px)",minHeight:"500px",placeholder:"TOML "})]}),p==="visual"&&e.jsx(e.Fragment,{children:e.jsxs(ta,{defaultValue:"bot",className:"w-full",children:[e.jsxs(Zt,{className:"flex flex-wrap h-auto gap-1 p-1 sm:grid sm:grid-cols-5 lg:grid-cols-10",children:[e.jsx(Xe,{value:"bot",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"personality",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"chat",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"expression",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"features",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"processing",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"dream",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"lpmm",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"webui",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:"WebUI"}),e.jsx(Xe,{value:"other",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""})]}),e.jsx(ws,{value:"bot",className:"space-y-4",children:S&&e.jsx(K2,{config:S,onChange:B})}),e.jsx(ws,{value:"personality",className:"space-y-4",children:E&&e.jsx(Q2,{config:E,onChange:C})}),e.jsx(ws,{value:"chat",className:"space-y-4",children:A&&e.jsx(X2,{config:A,onChange:F})}),e.jsx(ws,{value:"expression",className:"space-y-4",children:L&&e.jsx(rS,{config:L,onChange:J})}),e.jsx(ws,{value:"features",className:"space-y-4",children:U&&Ne&&re&&ge&&e.jsx(lS,{emojiConfig:U,memoryConfig:Ne,toolConfig:re,voiceConfig:ge,onEmojiChange:oe,onMemoryChange:je,onToolChange:fe,onVoiceChange:M})}),e.jsx(ws,{value:"processing",className:"space-y-4",children:Se&&Te&&D&&de&&e.jsx(cS,{keywordReactionConfig:Se,responsePostProcessConfig:Te,chineseTypoConfig:D,responseSplitterConfig:de,onKeywordReactionChange:pe,onResponsePostProcessChange:z,onChineseTypoChange:G,onResponseSplitterChange:Re})}),e.jsx(ws,{value:"dream",className:"space-y-4",children:K&&e.jsx(Z2,{config:K,onChange:P})}),e.jsx(ws,{value:"lpmm",className:"space-y-4",children:ue&&e.jsx(W2,{config:ue,onChange:Q})}),e.jsx(ws,{value:"webui",className:"space-y-4",children:me&&e.jsx(oS,{config:me,onChange:Ae})}),e.jsxs(ws,{value:"other",className:"space-y-4",children:[W&&e.jsx(eS,{config:W,onChange:Y}),Fe&&e.jsx(sS,{config:Fe,onChange:H}),ee&&e.jsx(tS,{config:ee,onChange:Ue}),ie&&e.jsx(aS,{config:ie,onChange:Ee})]})]})}),e.jsx(er,{})]})})}const Ul=m.forwardRef(({className:a,...n},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:I("w-full caption-bottom text-sm",a),...n})}));Ul.displayName="Table";const $l=m.forwardRef(({className:a,...n},r)=>e.jsx("thead",{ref:r,className:I("[&_tr]:border-b",a),...n}));$l.displayName="TableHeader";const Bl=m.forwardRef(({className:a,...n},r)=>e.jsx("tbody",{ref:r,className:I("[&_tr:last-child]:border-0",a),...n}));Bl.displayName="TableBody";const SS=m.forwardRef(({className:a,...n},r)=>e.jsx("tfoot",{ref:r,className:I("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...n}));SS.displayName="TableFooter";const ut=m.forwardRef(({className:a,...n},r)=>e.jsx("tr",{ref:r,className:I("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...n}));ut.displayName="TableRow";const We=m.forwardRef(({className:a,...n},r)=>e.jsx("th",{ref:r,className:I("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...n}));We.displayName="TableHead";const Ke=m.forwardRef(({className:a,...n},r)=>e.jsx("td",{ref:r,className:I("px-4 py-3 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...n}));Ke.displayName="TableCell";const kS=m.forwardRef(({className:a,...n},r)=>e.jsx("caption",{ref:r,className:I("mt-4 text-sm text-muted-foreground",a),...n}));kS.displayName="TableCaption";const dd=m.forwardRef(({className:a,...n},r)=>e.jsx(ja,{ref:r,className:I("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...n}));dd.displayName=ja.displayName;const ud=m.forwardRef(({className:a,...n},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Tt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(ja.Input,{ref:r,className:I("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...n})]}));ud.displayName=ja.Input.displayName;const md=m.forwardRef(({className:a,...n},r)=>e.jsx(ja.List,{ref:r,className:I("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...n}));md.displayName=ja.List.displayName;const xd=m.forwardRef((a,n)=>e.jsx(ja.Empty,{ref:n,className:"py-6 text-center text-sm",...a}));xd.displayName=ja.Empty.displayName;const oc=m.forwardRef(({className:a,...n},r)=>e.jsx(ja.Group,{ref:r,className:I("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...n}));oc.displayName=ja.Group.displayName;const CS=m.forwardRef(({className:a,...n},r)=>e.jsx(ja.Separator,{ref:r,className:I("-mx-1 h-px bg-border",a),...n}));CS.displayName=ja.Separator.displayName;const dc=m.forwardRef(({className:a,...n},r)=>e.jsx(ja.Item,{ref:r,className:I("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a),...n}));dc.displayName=ja.Item.displayName;const Fv=m.createContext(null),Hv="maibot-completed-tours";function TS(){try{const a=localStorage.getItem(Hv);return a?new Set(JSON.parse(a)):new Set}catch{return new Set}}function $g(a){localStorage.setItem(Hv,JSON.stringify([...a]))}function ES({children:a}){const[n,r]=m.useState({activeTourId:null,stepIndex:0,isRunning:!1}),[c]=m.useState(()=>new Map),[d,u]=m.useState(TS),[,h]=m.useState(0),f=m.useCallback((E,C)=>{c.set(E,C),h(A=>A+1)},[c]),p=m.useCallback(E=>{c.delete(E),r(C=>C.activeTourId===E?{...C,activeTourId:null,isRunning:!1,stepIndex:0}:C)},[c]),g=m.useCallback((E,C=0)=>{c.has(E)&&r({activeTourId:E,stepIndex:C,isRunning:!0})},[c]),N=m.useCallback(()=>{r(E=>({...E,isRunning:!1}))},[]),v=m.useCallback(E=>{r(C=>({...C,stepIndex:E}))},[]),w=m.useCallback(()=>{r(E=>({...E,stepIndex:E.stepIndex+1}))},[]),b=m.useCallback(()=>{r(E=>({...E,stepIndex:Math.max(0,E.stepIndex-1)}))},[]),y=m.useCallback(()=>n.activeTourId?c.get(n.activeTourId)||[]:[],[n.activeTourId,c]),O=m.useCallback(E=>{u(C=>{const A=new Set(C);return A.add(E),$g(A),A})},[]),R=m.useCallback(E=>{const{action:C,index:A,status:F,type:L}=E,J=["finished","skipped"];if(C==="close"){r(U=>({...U,isRunning:!1,stepIndex:0}));return}J.includes(F)?r(U=>(F==="finished"&&U.activeTourId&&setTimeout(()=>O(U.activeTourId),0),{...U,isRunning:!1,stepIndex:0})):L==="step:after"&&(C==="next"?r(U=>({...U,stepIndex:A+1})):C==="prev"&&r(U=>({...U,stepIndex:A-1})))},[O]),S=m.useCallback(E=>d.has(E),[d]),B=m.useCallback(E=>{u(C=>{const A=new Set(C);return A.delete(E),$g(A),A})},[]);return e.jsx(Fv.Provider,{value:{state:n,tours:c,registerTour:f,unregisterTour:p,startTour:g,stopTour:N,goToStep:v,nextStep:w,prevStep:b,getCurrentSteps:y,handleJoyrideCallback:R,isTourCompleted:S,markTourCompleted:O,resetTourCompleted:B},children:a})}function px(){const a=m.useContext(Fv);if(!a)throw new Error("useTour must be used within a TourProvider");return a}const MS={options:{zIndex:1e4,primaryColor:"hsl(var(--primary))",textColor:"hsl(var(--foreground))",backgroundColor:"hsl(var(--background))",arrowColor:"hsl(var(--background))",overlayColor:"rgba(0, 0, 0, 0.5)"},tooltip:{borderRadius:"var(--radius)",padding:"1rem"},tooltipContainer:{textAlign:"left"},tooltipTitle:{fontSize:"1rem",fontWeight:600,marginBottom:"0.5rem"},tooltipContent:{fontSize:"0.875rem",padding:"0.5rem 0"},buttonNext:{backgroundColor:"hsl(var(--primary))",color:"hsl(var(--primary-foreground))",borderRadius:"calc(var(--radius) - 2px)",fontSize:"0.875rem",padding:"0.5rem 1rem"},buttonBack:{color:"hsl(var(--muted-foreground))",fontSize:"0.875rem",marginRight:"0.5rem"},buttonSkip:{color:"hsl(var(--muted-foreground))",fontSize:"0.875rem"},buttonClose:{color:"hsl(var(--muted-foreground))"},spotlight:{borderRadius:"var(--radius)"}},AS={back:"",close:"",last:"",next:"",nextLabelWithProgress:" ({step}/{steps})",open:"",skip:""};function zS(){const{state:a,getCurrentSteps:n,handleJoyrideCallback:r}=px(),c=n(),[d,u]=m.useState(!1),h=m.useRef(a.stepIndex),f=m.useRef(null);m.useEffect(()=>{h.current!==a.stepIndex&&(u(!1),h.current=a.stepIndex)},[a.stepIndex]),m.useEffect(()=>{if(!a.isRunning||c.length===0){u(!1);return}const v=c[a.stepIndex];if(!v){u(!1);return}const w=v.target;if(w==="body"){u(!0);return}u(!1);const b=setTimeout(()=>{const y=()=>{const B=document.querySelector(w);if(B){const E=B.getBoundingClientRect();if(E.width>0&&E.height>0)return!0}return!1};if(y()){setTimeout(()=>u(!0),100);return}const O=setInterval(()=>{y()&&(clearInterval(O),setTimeout(()=>u(!0),100))},100),R=setTimeout(()=>{clearInterval(O),u(!0)},5e3),S=()=>{clearInterval(O),clearTimeout(R)};f.current=S},150);return()=>{clearTimeout(b),f.current&&(f.current(),f.current=null)}},[a.isRunning,a.stepIndex,c]);const[p,g]=m.useState(null);if(m.useEffect(()=>{let v=document.getElementById("tour-portal-container");return v||(v=document.createElement("div"),v.id="tour-portal-container",v.style.cssText="position: fixed; top: 0; left: 0; z-index: 99999; pointer-events: none;",document.body.appendChild(v)),g(v),()=>{}},[]),!a.isRunning||c.length===0||!d)return null;const N=e.jsx(d1,{steps:c,stepIndex:a.stepIndex,run:a.isRunning,continuous:!0,showSkipButton:!0,showProgress:!0,disableOverlayClose:!0,disableScrolling:!1,disableScrollParentFix:!1,callback:r,styles:MS,locale:AS,scrollOffset:80,scrollToFirstStep:!0,floaterProps:{styles:{floater:{zIndex:99999}},disableAnimation:!0}},`tour-step-${a.stepIndex}`);return p?Q0.createPortal(N,p):N}const ol="model-assignment-tour",Vv=[{target:"body",content:"",placement:"center",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="sidebar-model-provider"]',content:' DeepSeek Siliconflow""',placement:"right",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="add-provider-button"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="provider-dialog"]',content:"",placement:"left",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-name-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-apikey-input"]',content:" API  API ",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-url-input"]',content:" API API ",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-template-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-save-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-cancel-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="sidebar-model-management"]',content:'""',placement:"right",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="add-model-button"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="model-dialog"]',content:"",placement:"left",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-name-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-provider-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-identifier-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-save-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-cancel-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="tasks-tab-trigger"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="task-model-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1}],Gv={0:"/config/model",1:"/config/model",2:"/config/modelProvider",3:"/config/modelProvider",4:"/config/modelProvider",5:"/config/modelProvider",6:"/config/modelProvider",7:"/config/modelProvider",8:"/config/modelProvider",9:"/config/modelProvider",10:"/config/modelProvider",11:"/config/model",12:"/config/model",13:"/config/model",14:"/config/model",15:"/config/model",16:"/config/model",17:"/config/model",18:"/config/model",19:"/config/model"},Xi=[{id:"siliconflow",name:"SiliconFlow",base_url:"https://api.siliconflow.cn/v1",client_type:"openai",display_name:" (SiliconFlow)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"deepseek",name:"DeepSeek",base_url:"https://api.deepseek.com",client_type:"openai",display_name:"DeepSeek",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"rinkoai",name:"RinkoAI",base_url:"https://rinkoai.com/v1",client_type:"openai",display_name:"RinkoAI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"zhipu",name:"ZhipuAI",base_url:"https://open.bigmodel.cn/api/paas/v4",client_type:"openai",display_name:" AI (ZhipuAI / GLM)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"moonshot",name:"Moonshot",base_url:"https://api.moonshot.cn/v1",client_type:"openai",display_name:" (Moonshot / Kimi)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"doubao",name:"Doubao",base_url:"https://ark.cn-beijing.volces.com/api/v3",client_type:"openai",display_name:" (Doubao)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"alibaba",name:"Alibaba",base_url:"https://dashscope.aliyuncs.com/compatible-mode/v1",client_type:"openai",display_name:" (Alibaba Qwen)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"baichuan",name:"Baichuan",base_url:"https://api.baichuan-ai.com/v1",client_type:"openai",display_name:" (Baichuan)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"minimax",name:"MiniMax",base_url:"https://api.minimax.chat/v1",client_type:"openai",display_name:"MiniMax ( AI)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"stepfun",name:"StepFun",base_url:"https://api.stepfun.com/v1",client_type:"openai",display_name:" (StepFun)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"lingyi",name:"Lingyi",base_url:"https://api.lingyiwanwu.com/v1",client_type:"openai",display_name:" (Lingyi / Yi)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"openai",name:"OpenAI",base_url:"https://api.openai.com/v1",client_type:"openai",display_name:"OpenAI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"xai",name:"xAI",base_url:"https://api.x.ai/v1",client_type:"openai",display_name:"xAI (Grok)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"anthropic",name:"Anthropic",base_url:"https://api.anthropic.com/v1",client_type:"openai",display_name:"Anthropic (Claude)"},{id:"gemini",name:"Gemini",base_url:"https://generativelanguage.googleapis.com/v1beta",client_type:"gemini",display_name:"Google Gemini",modelFetcher:{endpoint:"/models",parser:"gemini"}},{id:"cohere",name:"Cohere",base_url:"https://api.cohere.ai/v1",client_type:"openai",display_name:"Cohere"},{id:"groq",name:"Groq",base_url:"https://api.groq.com/openai/v1",client_type:"openai",display_name:"Groq",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"together",name:"Together AI",base_url:"https://api.together.xyz/v1",client_type:"openai",display_name:"Together AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"fireworks",name:"Fireworks",base_url:"https://api.fireworks.ai/inference/v1",client_type:"openai",display_name:"Fireworks AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"mistral",name:"Mistral",base_url:"https://api.mistral.ai/v1",client_type:"openai",display_name:"Mistral AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"perplexity",name:"Perplexity",base_url:"https://api.perplexity.ai",client_type:"openai",display_name:"Perplexity AI"},{id:"custom",name:"",base_url:"",client_type:"openai",display_name:""}];function Bg(a){return a?a.replace(/\/+$/,"").toLowerCase():""}function RS(a){if(!a)return null;const n=Bg(a);return Xi.find(r=>r.id!=="custom"&&Bg(r.base_url)===n)||null}const Do=a=>({...a,max_retry:a.max_retry??2,timeout:a.timeout??30,retry_interval:a.retry_interval??10}),DS=(a,n=[],r=null)=>{const c={};return a?(a.name?.trim()?n.some((u,h)=>r!==null&&h===r?!1:u.name.trim().toLowerCase()===a.name.trim().toLowerCase())&&(c.name=""):c.name="",a.base_url?.trim()||(c.base_url=" URL"),a.api_key?.trim()||(c.api_key=" API Key"),{isValid:Object.keys(c).length===0,errors:c}):{isValid:!1,errors:{name:""}}};function OS(){return e.jsx(Wn,{children:e.jsx(LS,{})})}function LS(){const[a,n]=m.useState([]),[r,c]=m.useState(!0),[d,u]=m.useState(!1),[h,f]=m.useState(!1),[p,g]=m.useState(!1),[N,v]=m.useState(!1),[w,b]=m.useState(null),[y,O]=m.useState(null),[R,S]=m.useState("custom"),[B,E]=m.useState(!1),[C,A]=m.useState(!1),[F,L]=m.useState(null),[J,U]=m.useState(!1),[oe,Ne]=m.useState(""),[je,re]=m.useState(new Set),[fe,ge]=m.useState(!1),[M,K]=m.useState(1),[P,ue]=m.useState(20),[Q,Se]=m.useState(""),[pe,Te]=m.useState({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),[z,D]=m.useState({}),[G,de]=m.useState(new Set),[Re,W]=m.useState(new Map),{toast:Y}=Ys(),Fe=ca(),{state:H,goToStep:ee,registerTour:Ue}=px(),{triggerRestart:ie,isRestarting:Ee}=yn(),me=m.useRef(null),Ae=m.useRef(!0);m.useEffect(()=>{Ue(ol,Vv)},[Ue]),m.useEffect(()=>{if(H.activeTourId===ol&&H.isRunning){const se=Gv[H.stepIndex];se&&!window.location.pathname.endsWith(se.replace("/config/",""))&&Fe({to:se})}},[H.stepIndex,H.activeTourId,H.isRunning,Fe]);const rs=m.useRef(H.stepIndex);m.useEffect(()=>{if(H.activeTourId===ol&&H.isRunning){const se=rs.current,we=H.stepIndex;se>=3&&se<=9&&we<3&&v(!1),se>=10&&we>=3&&we<=9&&(D({}),S("custom"),b({name:"",base_url:"",api_key:"",client_type:"openai",max_retry:2,timeout:30,retry_interval:10}),O(null),U(!1),v(!0)),rs.current=we}},[H.stepIndex,H.activeTourId,H.isRunning]),m.useEffect(()=>{if(H.activeTourId!==ol||!H.isRunning)return;const se=we=>{const Le=we.target,Fs=H.stepIndex;Fs===2&&Le.closest('[data-tour="add-provider-button"]')?setTimeout(()=>ee(3),300):Fs===9&&Le.closest('[data-tour="provider-cancel-button"]')&&setTimeout(()=>ee(10),300)};return document.addEventListener("click",se,!0),()=>document.removeEventListener("click",se,!0)},[H,ee]),m.useEffect(()=>{Ut()},[]);const Ut=async()=>{try{c(!0);const se=await xn();n(se.api_providers||[]),g(!1),Ae.current=!1}catch(se){console.error(":",se)}finally{c(!1)}},aa=async()=>{await ie()},Ja=async()=>{try{u(!0),me.current&&clearTimeout(me.current);const se=a.map(rt=>({...rt,max_retry:rt.max_retry??2,timeout:rt.timeout??30,retry_interval:rt.retry_interval??10})),{shouldProceed:we}=await Ht(se,"restart");if(!we){u(!1);return}const Le=await xn(),Fs=new Set(se.map(rt=>rt.name)),ea=(Le.models||[]).filter(rt=>Fs.has(rt.api_provider));Le.api_providers=se,Le.models=ea,await tc(Le),g(!1),Y({title:"",description:"..."}),await aa()}catch(se){console.error(":",se),Y({title:"",description:se.message,variant:"destructive"}),u(!1)}},Ht=m.useCallback(async(se,we="auto")=>{try{const Le=await xn(),Fs=new Set(a.map(xt=>xt.name)),Dt=new Set(se.map(xt=>xt.name)),ea=Array.from(Fs).filter(xt=>!Dt.has(xt));if(ea.length===0)return{shouldProceed:!0,providers:se};const sa=(Le.models||[]).filter(xt=>ea.includes(xt.api_provider));return sa.length===0?{shouldProceed:!0,providers:se}:(Te({isOpen:!0,providersToDelete:ea,affectedModels:sa,pendingProviders:se,context:we,oldProviders:[...a]}),{shouldProceed:!1,providers:se})}catch(Le){return console.error(":",Le),{shouldProceed:!0,providers:se}}},[a]),mt=async()=>{try{(pe.context==="auto"?f:u)(!0),Te(xt=>({...xt,isOpen:!1}));const we=await xn(),Le=pe.pendingProviders.map(Do),Fs=new Set(Le.map(xt=>xt.name)),ea=(we.models||[]).filter(xt=>Fs.has(xt.api_provider)),rt=new Set(pe.affectedModels.map(xt=>xt.name)),sa=we.model_task_config;sa&&Object.keys(sa).forEach(xt=>{const ne=sa[xt];ne&&Array.isArray(ne.model_list)&&(ne.model_list=ne.model_list.filter(he=>!rt.has(he)))}),we.api_providers=Le,we.models=ea,we.model_task_config=sa,await tc(we),n(pe.pendingProviders),g(!1),Y({title:"",description:` ${pe.providersToDelete.length}  ${pe.affectedModels.length} `}),Te({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),re(new Set),pe.context==="restart"&&await aa()}catch(se){console.error(":",se),Y({title:"",description:se.message,variant:"destructive"})}finally{pe.context==="auto"?f(!1):u(!1)}},q=()=>{pe.oldProviders.length>0&&n(pe.oldProviders),Te({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),g(!1)},qe=m.useCallback(async se=>{if(Ae.current)return;const{shouldProceed:we}=await Ht(se,"auto");if(!we){g(!0);return}try{f(!0);const Le=se.map(Do);await Ym("api_providers",Le),g(!1)}catch(Le){console.error(":",Le),Y({title:"",description:Le.message,variant:"destructive"}),g(!0)}finally{f(!1)}},[a,Ht]);m.useEffect(()=>{if(!Ae.current)return g(!0),me.current&&clearTimeout(me.current),me.current=setTimeout(()=>{qe(a)},2e3),()=>{me.current&&clearTimeout(me.current)}},[a,qe]);const Qe=async()=>{try{u(!0),me.current&&clearTimeout(me.current);const se=a.map(Do),{shouldProceed:we}=await Ht(se,"manual");if(!we){u(!1);return}const Le=await xn(),Fs=new Set(se.map(rt=>rt.name)),Dt=Le.models||[],ea=Dt.filter(rt=>{const sa=Fs.has(rt.api_provider);return sa||console.warn(` "${rt.name}"  "${rt.api_provider}"`),sa});if(Dt.length!==ea.length){const rt=Dt.length-ea.length;Y({title:"",description:` ${rt} `,variant:"default"})}console.log(" providers :",se),Le.api_providers=se,Le.models=ea,console.log(":",Le),await tc(Le),g(!1),Y({title:"",description:""})}catch(se){console.error(":",se),Y({title:"",description:se.message,variant:"destructive"})}finally{u(!1)}},es=(se,we)=>{if(D({}),se){const Le=Xi.find(Fs=>Fs.base_url===se.base_url&&Fs.client_type===se.client_type);S(Le?.id||"custom"),b(se)}else S("custom"),b({name:"",base_url:"",api_key:"",client_type:"openai",max_retry:2,timeout:30,retry_interval:10});O(we),U(!1),v(!0)},Us=m.useCallback(se=>{S(se),E(!1);const we=Xi.find(Le=>Le.id===se);we&&we.id!=="custom"?b(Le=>({...Le,name:we.name,base_url:we.base_url,client_type:we.client_type})):we?.id==="custom"&&b(Le=>({...Le,name:"",base_url:"",client_type:"openai"}))},[]),as=m.useMemo(()=>R!=="custom",[R]),Cs=m.useCallback(async()=>{if(w?.api_key)try{await navigator.clipboard.writeText(w.api_key),Y({title:"",description:"API Key "})}catch{Y({title:"",description:"",variant:"destructive"})}},[w?.api_key,Y]),ze=()=>{if(!w)return;const{isValid:se,errors:we}=DS(w,a,y);if(!se){D(we);return}D({});const Le=Do(w);if(y!==null){const Fs=[...a];Fs[y]=Le,n(Fs)}else n([...a,Le]);v(!1),b(null),O(null)},bs=se=>{if(!se&&w){const we={...w,max_retry:w.max_retry??2,timeout:w.timeout??30,retry_interval:w.retry_interval??10};b(we)}v(se)},ls=se=>{L(se),A(!0)},ss=async()=>{if(F!==null){const se=a.filter((Le,Fs)=>Fs!==F),{shouldProceed:we}=await Ht(se,"manual");we&&(n(se),Y({title:"",description:""}))}A(!1),L(null)},ys=se=>{const we=new Set(je);we.has(se)?we.delete(se):we.add(se),re(we)},gt=()=>{if(je.size===Ms.length)re(new Set);else{const se=Ms.map((we,Le)=>a.findIndex(Fs=>Fs===Ms[Le]));re(new Set(se))}},$t=()=>{if(je.size===0){Y({title:"",description:"",variant:"default"});return}ge(!0)},tt=async()=>{const se=a.filter((Le,Fs)=>!je.has(Fs)),{shouldProceed:we}=await Ht(se,"manual");we&&(n(se),re(new Set),Y({title:"",description:` ${je.size} `})),ge(!1)},Ms=m.useMemo(()=>{if(!oe)return a;const se=oe.toLowerCase();return a.filter(we=>we.name.toLowerCase().includes(se)||we.base_url.toLowerCase().includes(se)||we.client_type.toLowerCase().includes(se))},[a,oe]),{totalPages:Et,paginatedProviders:Bt}=m.useMemo(()=>{const se=Math.ceil(Ms.length/P),we=Ms.slice((M-1)*P,M*P);return{totalPages:se,paginatedProviders:we}},[Ms,M,P]),Oa=m.useCallback(()=>{const se=parseInt(Q);se>=1&&se<=Et&&(K(se),Se(""))},[Q,Et]),ll=async se=>{de(we=>new Set(we).add(se));try{const we=await hS(se);W(Le=>new Map(Le).set(se,we)),we.network_ok?we.api_key_valid===!0?Y({title:"",description:`${se} API Key  (${we.latency_ms}ms)`}):we.api_key_valid===!1?Y({title:" Key ",description:`${se}  API Key `,variant:"destructive"}):Y({title:"",description:`${se}  (${we.latency_ms}ms)`}):Y({title:"",description:we.error||"",variant:"destructive"})}catch(we){Y({title:"",description:we.message,variant:"destructive"})}finally{de(we=>{const Le=new Set(we);return Le.delete(se),Le})}},xl=async()=>{for(const se of a)await ll(se.name)},sr=se=>{const we=G.has(se),Le=Re.get(se);return we?e.jsxs(ke,{variant:"secondary",className:"gap-1",children:[e.jsx(zs,{className:"h-3 w-3 animate-spin"}),""]}):Le?Le.network_ok?Le.api_key_valid===!0?e.jsxs(ke,{className:"gap-1 bg-green-600 hover:bg-green-700",children:[e.jsx(pt,{className:"h-3 w-3"}),""]}):Le.api_key_valid===!1?e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(_t,{className:"h-3 w-3"}),"Key"]}):e.jsxs(ke,{className:"gap-1 bg-blue-600 hover:bg-blue-700",children:[e.jsx(pt,{className:"h-3 w-3"}),""]}):e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(Ka,{className:"h-3 w-3"}),""]}):null};return r?e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"AI"}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:" AI  API "})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[je.size>0&&e.jsxs(_,{onClick:$t,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(ns,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"})," (",je.size,")"]}),e.jsxs(_,{onClick:xl,size:"sm",variant:"outline",className:"w-full sm:w-auto",disabled:a.length===0||G.size>0,children:[e.jsx(el,{className:"mr-2 h-4 w-4"}),G.size>0?` (${G.size})`:""]}),e.jsxs(_,{onClick:()=>es(null,null),size:"sm",className:"w-full sm:w-auto","data-tour":"add-provider-button",children:[e.jsx(et,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{onClick:Qe,disabled:d||h||!p||Ee,size:"sm",variant:"outline",className:"w-full sm:w-auto sm:min-w-[120px]",children:[e.jsx(fc,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),d?"...":h?"...":p?"":""]}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{disabled:d||h||Ee,size:"sm",className:"w-full sm:w-auto sm:min-w-[120px]",children:[e.jsx(hc,{className:"mr-2 h-4 w-4"}),Ee?"...":p?"":""]})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsx(fs,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:p?",":","})})})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:p?Ja:aa,children:p?"":""})]})]})]})]})]}),e.jsxs(at,{children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsxs(lt,{children:["",e.jsx("strong",{children:""}),'""']})]}),e.jsxs(Je,{className:"h-[calc(100vh-260px)]",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 mb-4",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:max-w-sm",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"URL ...",value:oe,onChange:se=>Ne(se.target.value),className:"pl-9"})]}),oe&&e.jsxs("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[" ",Ms.length," "]})]}),e.jsx("div",{className:"md:hidden space-y-3",children:Ms.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-8 rounded-lg border bg-card",children:oe?"":'""'}):Bt.map((se,we)=>{const Le=a.findIndex(Fs=>Fs===se);return e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-base truncate",children:se.name}),sr(se.name)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 break-all",children:se.base_url})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>ll(se.name),disabled:G.has(se.name),title:"",children:G.has(se.name)?e.jsx(zs,{className:"h-4 w-4 animate-spin"}):e.jsx(el,{className:"h-4 w-4"})}),e.jsx(_,{variant:"default",size:"sm",onClick:()=>es(se,Le),children:e.jsx(Kn,{className:"h-4 w-4",strokeWidth:2,fill:"none"})}),e.jsx(_,{size:"sm",onClick:()=>ls(Le),className:"bg-red-600 hover:bg-red-700 text-white",children:e.jsx(ns,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:se.client_type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:se.max_retry})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"()"}),e.jsx("p",{className:"font-medium",children:se.timeout})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"()"}),e.jsx("p",{className:"font-medium",children:se.retry_interval})]})]})]},we)})}),e.jsx("div",{className:"hidden md:block rounded-lg border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ut,{children:[e.jsx(We,{className:"w-12",children:e.jsx(qs,{checked:je.size===Ms.length&&Ms.length>0,onCheckedChange:gt})}),e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{children:"URL"}),e.jsx(We,{children:""}),e.jsx(We,{className:"text-right",children:""}),e.jsx(We,{className:"text-right",children:"()"}),e.jsx(We,{className:"text-right",children:"()"}),e.jsx(We,{className:"text-right",children:""})]})}),e.jsx(Bl,{children:Bt.length===0?e.jsx(ut,{children:e.jsx(Ke,{colSpan:9,className:"text-center text-muted-foreground py-8",children:oe?"":'""'})}):Bt.map((se,we)=>{const Le=a.findIndex(Fs=>Fs===se);return e.jsxs(ut,{children:[e.jsx(Ke,{children:e.jsx(qs,{checked:je.has(Le),onCheckedChange:()=>ys(Le)})}),e.jsx(Ke,{children:sr(se.name)||e.jsx(ke,{variant:"outline",className:"text-muted-foreground",children:""})}),e.jsx(Ke,{className:"font-medium",children:se.name}),e.jsx(Ke,{className:"max-w-xs truncate",title:se.base_url,children:se.base_url}),e.jsx(Ke,{children:se.client_type}),e.jsx(Ke,{className:"text-right",children:se.max_retry}),e.jsx(Ke,{className:"text-right",children:se.timeout}),e.jsx(Ke,{className:"text-right",children:se.retry_interval}),e.jsx(Ke,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>ll(se.name),disabled:G.has(se.name),title:"",children:G.has(se.name)?e.jsx(zs,{className:"h-4 w-4 animate-spin"}):e.jsx(el,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"default",size:"sm",onClick:()=>es(se,Le),children:[e.jsx(Kn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>ls(Le),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ns,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})})]},we)})})]})})}),Ms.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size-provider",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:P.toString(),onValueChange:se=>{ue(parseInt(se)),K(1),re(new Set)},children:[e.jsx($e,{id:"page-size-provider",className:"w-20",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"10",children:"10"}),e.jsx(Z,{value:"20",children:"20"}),e.jsx(Z,{value:"50",children:"50"}),e.jsx(Z,{value:"100",children:"100"})]})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",(M-1)*P+1," "," ",Math.min(M*P,Ms.length),"  ",Ms.length," "]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>K(1),disabled:M===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>K(se=>Math.max(1,se-1)),disabled:M===1,children:[e.jsx(Da,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"number",value:Q,onChange:se=>Se(se.target.value),onKeyDown:se=>se.key==="Enter"&&Oa(),placeholder:M.toString(),className:"w-16 h-8 text-center",min:1,max:Et}),e.jsx(_,{variant:"outline",size:"sm",onClick:Oa,disabled:!Q,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>K(se=>se+1),disabled:M>=Et,children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(Wt,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>K(Et),disabled:M>=Et,className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]}),e.jsx(Ps,{open:N,onOpenChange:bs,children:e.jsxs(Ds,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto","data-tour":"provider-dialog",preventOutsideClose:H.isRunning,children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:y!==null?"":""}),e.jsx(Ks,{children:" API "})]}),e.jsxs("form",{onSubmit:se=>{se.preventDefault(),ze()},autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":"provider-template-select",children:[e.jsx(T,{htmlFor:"template",children:""}),e.jsxs(ul,{open:B,onOpenChange:E,children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":B,className:"w-full justify-between",children:[R?Xi.find(se=>se.id===R)?.display_name:"...",e.jsx(rx,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(sl,{className:"p-0",align:"start",style:{width:"var(--radix-popover-trigger-width)"},children:e.jsxs(dd,{children:[e.jsx(ud,{placeholder:"..."}),e.jsx(Je,{className:"h-[300px]",children:e.jsxs(md,{className:"max-h-none overflow-visible",children:[e.jsx(xd,{children:""}),e.jsx(oc,{children:Xi.map(se=>e.jsxs(dc,{value:se.display_name,onSelect:()=>Us(se.id),children:[e.jsx(Ct,{className:`mr-2 h-4 w-4 ${R===se.id?"opacity-100":"opacity-0"}`}),se.display_name]},se.id))})]})})]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" URL ,"})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-name-input",children:[e.jsx(T,{htmlFor:"name",className:z.name?"text-destructive":"",children:" *"}),e.jsx(ae,{id:"name",value:w?.name||"",onChange:se=>{b(we=>we?{...we,name:se.target.value}:null),z.name&&D(we=>({...we,name:void 0}))},placeholder:": DeepSeek, SiliconFlow",className:z.name?"border-destructive focus-visible:ring-destructive":""}),z.name&&e.jsx("p",{className:"text-xs text-destructive",children:z.name})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-url-input",children:[e.jsx(T,{htmlFor:"base_url",className:z.base_url?"text-destructive":"",children:" URL *"}),e.jsx(ae,{id:"base_url",value:w?.base_url||"",onChange:se=>{b(we=>we?{...we,base_url:se.target.value}:null),z.base_url&&D(we=>({...we,base_url:void 0}))},placeholder:"https://api.example.com/v1",disabled:as,className:`${as?"bg-muted cursor-not-allowed":""} ${z.base_url?"border-destructive focus-visible:ring-destructive":""}`}),z.base_url&&e.jsx("p",{className:"text-xs text-destructive",children:z.base_url}),as&&!z.base_url&&e.jsx("p",{className:"text-xs text-muted-foreground",children:' URL ,""'})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-apikey-input",children:[e.jsx(T,{htmlFor:"api_key",className:z.api_key?"text-destructive":"",children:"API Key *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{id:"api_key",type:J?"text":"password",value:w?.api_key||"",onChange:se=>{b(we=>we?{...we,api_key:se.target.value}:null),z.api_key&&D(we=>({...we,api_key:void 0}))},placeholder:"sk-...",className:`flex-1 ${z.api_key?"border-destructive focus-visible:ring-destructive":""}`}),e.jsx(_,{type:"button",variant:"outline",size:"icon",onClick:()=>U(!J),title:J?"":"",children:J?e.jsx(nc,{className:"h-4 w-4"}):e.jsx(ia,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"outline",size:"icon",onClick:Cs,title:"",children:e.jsx(Fo,{className:"h-4 w-4"})})]}),z.api_key&&e.jsx("p",{className:"text-xs text-destructive",children:z.api_key})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"client_type",children:""}),e.jsxs(Pe,{value:w?.client_type||"openai",onValueChange:se=>b(we=>we?{...we,client_type:se}:null),disabled:as,children:[e.jsx($e,{id:"client_type",className:as?"bg-muted cursor-not-allowed":"",children:e.jsx(Ie,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"openai",children:"OpenAI"}),e.jsx(Z,{value:"gemini",children:"Gemini"})]})]}),as&&e.jsx("p",{className:"text-xs text-muted-foreground",children:',""'})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_retry",children:""}),e.jsx(ae,{id:"max_retry",type:"number",min:"0",value:w?.max_retry??"",onChange:se=>{const we=se.target.value===""?null:parseInt(se.target.value);b(Le=>Le?{...Le,max_retry:we}:null)},placeholder:": 2"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"timeout",children:"()"}),e.jsx(ae,{id:"timeout",type:"number",min:"1",value:w?.timeout??"",onChange:se=>{const we=se.target.value===""?null:parseInt(se.target.value);b(Le=>Le?{...Le,timeout:we}:null)},placeholder:": 30"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"retry_interval",children:"()"}),e.jsx(ae,{id:"retry_interval",type:"number",min:"1",value:w?.retry_interval??"",onChange:se=>{const we=se.target.value===""?null:parseInt(se.target.value);b(Le=>Le?{...Le,retry_interval:we}:null)},placeholder:": 10"})]})]})]}),e.jsxs(st,{children:[e.jsx(_,{type:"button",variant:"outline",onClick:()=>v(!1),"data-tour":"provider-cancel-button",children:""}),e.jsx(_,{type:"submit","data-tour":"provider-save-button",children:""})]})]})]})}),e.jsx(Ns,{open:C,onOpenChange:A,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[' "',F!==null?a[F]?.name:"",'"  ']})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:ss,children:""})]})]})}),e.jsx(Ns,{open:fe,onOpenChange:ge,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",je.size,"  "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:tt,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(Ns,{open:pe.isOpen,onOpenChange:se=>Te(we=>({...we,isOpen:se})),children:e.jsxs(us,{className:"max-w-2xl",children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsx(fs,{asChild:!0,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{children:["",e.jsx("strong",{className:"text-foreground ml-1",children:pe.providersToDelete.join(", ")})]}),e.jsxs("p",{className:"text-yellow-600 dark:text-yellow-500 font-medium",children:["  ",pe.affectedModels.length," "]}),e.jsx(Je,{className:"h-32 w-full rounded border p-3",children:e.jsx("div",{className:"space-y-1",children:pe.affectedModels.map((se,we)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-mono text-muted-foreground",children:""}),e.jsx("span",{className:"ml-2 font-medium",children:se.name}),e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",se.model_identifier,")"]})]},we))})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})})]}),e.jsxs(xs,{children:[e.jsx(gs,{onClick:q,children:""}),e.jsx(ps,{onClick:mt,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(er,{})]})}function ac(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).substring(2,11)}`}function Um(a){return a===null?"null":Array.isArray(a)?"array":typeof a=="object"?"object":typeof a=="boolean"?"boolean":typeof a=="number"?"number":"string"}function Jm(a){return Object.entries(a).map(([n,r])=>{const c=Um(r),d={id:ac(),key:n,value:r,type:c,expanded:!0};return c==="object"&&r&&typeof r=="object"?d.children=Jm(r):c==="array"&&Array.isArray(r)&&(d.children=r.map((u,h)=>{const f=Um(u),p={id:ac(),key:String(h),value:u,type:f,expanded:!0};return f==="object"&&u&&typeof u=="object"?p.children=Jm(u):f==="array"&&Array.isArray(u)&&(p.children=u.map((g,N)=>({id:ac(),key:String(N),value:g,type:Um(g),expanded:!0}))),p})),d})}function Xm(a){const n={};for(const r of a)r.key.trim()&&(r.type==="object"&&r.children?n[r.key]=Xm(r.children):r.type==="array"&&r.children?n[r.key]=r.children.map(c=>c.type==="object"&&c.children?Xm(c.children):c.type==="array"&&c.children?c.children.map(d=>d.value):c.value):r.type==="null"?n[r.key]=null:n[r.key]=r.value);return n}function Pg(a,n){switch(n){case"boolean":return a==="true";case"number":{const r=parseFloat(a);return isNaN(r)?0:r}case"null":return null;default:return a}}function qv({node:a,level:n,onUpdate:r,onRemove:c,onAddChild:d,onToggleExpand:u}){const h=a.type==="object"||a.type==="array",f=a.children&&a.children.length>0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-2 items-center",style:{gridTemplateColumns:h?"32px 1fr 90px 64px":"32px 1fr 1fr 90px 32px",paddingLeft:`${n*20}px`},children:[e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>u(a.id),disabled:!h||!f,children:h&&f?a.expanded?e.jsx(za,{className:"h-4 w-4"}):e.jsx(Wt,{className:"h-4 w-4"}):e.jsx("span",{className:"w-4"})}),e.jsx(ae,{value:a.key,onChange:p=>r(a.id,"key",p.target.value),placeholder:"key",className:"h-8 text-sm"}),!h&&e.jsx(e.Fragment,{children:a.type==="boolean"?e.jsxs("div",{className:"flex items-center h-8 px-3 border rounded-md bg-background",children:[e.jsx(Ve,{checked:a.value===!0,onCheckedChange:p=>r(a.id,"value",p)}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:a.value?"true":"false"})]}):a.type==="null"?e.jsx("div",{className:"flex items-center h-8 px-3 border rounded-md bg-muted text-sm text-muted-foreground",children:"null"}):e.jsx(ae,{type:a.type==="number"?"number":"text",value:a.value,onChange:p=>r(a.id,"value",p.target.value),placeholder:"value",className:"h-8 text-sm",step:a.type==="number"?"any":void 0})}),e.jsxs(Pe,{value:a.type,onValueChange:p=>r(a.id,"type",p),children:[e.jsx($e,{className:"h-8 text-xs",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"string",children:""}),e.jsx(Z,{value:"number",children:""}),e.jsx(Z,{value:"boolean",children:""}),e.jsx(Z,{value:"null",children:"Null"}),e.jsx(Z,{value:"object",children:""}),e.jsx(Z,{value:"array",children:""})]})]}),e.jsxs("div",{className:"flex gap-1 justify-end",children:[h&&e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary",onClick:()=>d(a.id),title:"",children:e.jsx(et,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:()=>c(a.id),title:"",children:e.jsx(ns,{className:"h-4 w-4"})})]})]}),h&&a.expanded&&a.children&&a.children.length>0&&e.jsx("div",{className:"space-y-1",children:a.children.map(p=>e.jsx(qv,{node:p,level:n+1,onUpdate:r,onRemove:c,onAddChild:d,onToggleExpand:u},p.id))})]})}function US({value:a,onChange:n,placeholder:r="..."}){const[c,d]=m.useState(()=>Jm(a||{})),u=m.useCallback(v=>{d(v),n(Xm(v))},[n]),h=m.useCallback(()=>{const v={id:ac(),key:"",value:"",type:"string",expanded:!1};u([...c,v])},[c,u]),f=m.useCallback((v,w,b)=>{const y=O=>O.map(R=>{if(R.id===v)if(w==="type"){const S=b;if(S==="object")return{...R,type:S,value:{},children:[]};if(S==="array")return{...R,type:S,value:[],children:[]};if(S==="null")return{...R,type:S,value:null};{const B=Pg(String(R.value),S);return{...R,type:S,value:B,children:void 0}}}else if(w==="value"){const S=Pg(String(b),R.type);return{...R,value:S}}else return{...R,[w]:String(b)};return R.children?{...R,children:y(R.children)}:R});u(y(c))},[c,u]),p=m.useCallback(v=>{const w=b=>b.filter(y=>y.id!==v).map(y=>y.children?{...y,children:w(y.children)}:y);u(w(c))},[c,u]),g=m.useCallback(v=>{const w=b=>b.map(y=>{if(y.id===v){const O={id:ac(),key:y.type==="array"?String(y.children?.length||0):"",value:"",type:"string",expanded:!0};return{...y,children:[...y.children||[],O]}}return y.children?{...y,children:w(y.children)}:y});u(w(c))},[c,u]),N=m.useCallback(v=>{const w=b=>b.map(y=>y.id===v?{...y,expanded:!y.expanded}:y.children?{...y,children:w(y.children)}:y);d(w(c))},[c]);return e.jsxs("div",{className:"h-full flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[c.length," "]}),e.jsxs(_,{type:"button",size:"sm",variant:"outline",onClick:h,className:"h-7 text-xs",children:[e.jsx(et,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-1",children:c.length===0?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4 border border-dashed rounded-md",children:r}):e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-2 text-xs text-muted-foreground px-1 sticky top-0 bg-background z-10",style:{gridTemplateColumns:"32px 1fr 1fr 90px 32px"},children:[e.jsx("span",{}),e.jsx("span",{children:""}),e.jsx("span",{children:""}),e.jsx("span",{children:""}),e.jsx("span",{})]}),c.map(v=>e.jsx(qv,{node:v,level:0,onUpdate:f,onRemove:p,onAddChild:g,onToggleExpand:N},v.id))]})})]})}function Ig(a){if(!a.trim())return{valid:!0,parsed:{}};try{const n=JSON.parse(a);return typeof n!="object"||n===null||Array.isArray(n)?{valid:!1,error:" JSON  {}"}:{valid:!0,parsed:n}}catch{return{valid:!1,error:"JSON "}}}function $S({value:a,onChange:n,className:r,placeholder:c="..."}){const[d,u]=m.useState("list"),h=m.useMemo(()=>Object.keys(a||{}).length>0?JSON.stringify(a,null,2):"",[a]),[f,p]=m.useState(h),[g,N]=m.useState(null);m.useEffect(()=>{p(h)},[h]);const v=m.useMemo(()=>{const y=Ig(f);return y.valid&&y.parsed?{success:!0,data:y.parsed}:{success:!1,data:{}}},[f]),w=m.useCallback(y=>{const O=y;O==="json"&&d==="list"&&(p(Object.keys(a).length>0?JSON.stringify(a,null,2):""),N(null)),u(O)},[d,a]),b=m.useCallback(y=>{p(y);const O=Ig(y);O.valid&&O.parsed?(N(null),n(O.parsed)):N(O.error||"JSON ")},[n]);return e.jsx("div",{className:I("h-full flex flex-col",r),children:e.jsxs(ta,{value:d,onValueChange:w,className:"w-full flex-1 flex flex-col",children:[e.jsxs(Zt,{className:"h-8 p-0.5 bg-muted/60 w-fit",children:[e.jsx(Xe,{value:"list",className:"h-7 px-3 text-xs data-[state=active]:bg-background data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"json",className:"h-7 px-3 text-xs data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"JSON "})]}),e.jsx(ws,{value:"list",className:"mt-2 flex-1 flex flex-col overflow-hidden data-[state=inactive]:hidden data-[state=inactive]:h-0",children:e.jsx(US,{value:a,onChange:n,placeholder:c})}),e.jsx(ws,{value:"json",className:"mt-2 flex-1 flex flex-col overflow-hidden data-[state=inactive]:hidden data-[state=inactive]:h-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),g?e.jsxs("div",{className:"flex items-center gap-1 text-xs text-destructive",children:[e.jsx(_t,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[150px]",children:g})]}):f.trim()&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 dark:text-green-400",children:[e.jsx(Ct,{className:"h-3 w-3"}),e.jsx("span",{children:""})]})]}),e.jsx(ot,{value:f,onChange:y=>b(y.target.value),placeholder:`{
  "key": "value"
}`,className:I("font-mono text-sm flex-1 resize-none",g&&"border-destructive focus-visible:ring-destructive")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" JSON "})]}),e.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"flex-1 rounded-md border bg-muted/30 p-3 overflow-auto",children:v.success&&Object.keys(v.data).length>0?e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-words",children:JSON.stringify(v.data,null,2)}):v.success?e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:""}):e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-destructive",children:"JSON "})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})})]})})}function BS({open:a,onOpenChange:n,value:r,onChange:c}){const[d,u]=m.useState(r),h=g=>{g&&u(r),n(g)},f=()=>{c(d),n(!1)},p=()=>{u(r),n(!1)};return e.jsx(Ps,{open:a,onOpenChange:h,children:e.jsxs(Ds,{className:"max-w-3xl h-[70vh] flex flex-col",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:""})]}),e.jsx("div",{className:"flex-1 overflow-hidden min-h-0",children:e.jsx($S,{value:d,onChange:u,placeholder:" thinkingtop_p ..."})}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:p,children:""}),e.jsx(_,{onClick:f,children:""})]})]})})}const ei="https://maibot-plugin-stats.maibot-webui.workers.dev";async function PS(a){const n=new URLSearchParams;a?.status&&n.set("status",a.status),a?.page&&n.set("page",a.page.toString()),a?.page_size&&n.set("page_size",a.page_size.toString()),a?.search&&n.set("search",a.search),a?.sort_by&&n.set("sort_by",a.sort_by),a?.sort_order&&n.set("sort_order",a.sort_order);const r=await fetch(`${ei}/pack?${n.toString()}`);if(!r.ok)throw new Error(` Pack : ${r.status}`);return r.json()}async function IS(a){const n=await fetch(`${ei}/pack/${a}`);if(!n.ok)throw new Error(` Pack : ${n.status}`);const r=await n.json();if(!r.success)throw new Error(r.error||" Pack ");return r.pack}async function FS(a){const r=await(await fetch(`${ei}/pack`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();if(!r.success)throw new Error(r.error||" Pack ");return r}async function HS(a,n){await fetch(`${ei}/pack/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pack_id:a,user_id:n})})}async function Kv(a,n){const c=await(await fetch(`${ei}/pack/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pack_id:a,user_id:n})})).json();if(!c.success)throw new Error(c.error||"");return{likes:c.likes,liked:c.liked}}async function Qv(a,n){return(await(await fetch(`${ei}/pack/like/check?pack_id=${a}&user_id=${n}`)).json()).liked||!1}async function VS(a){const n=await _e("/api/webui/config/model");if(!n.ok)throw new Error("");const r=await n.json(),c=r.config||r;console.log("=== Pack Conflict Detection ==="),console.log("Pack providers:",a.providers),console.log("Local providers:",c.api_providers);const d={existing_providers:[],new_providers:[],conflicting_models:[]},u=c.api_providers||[];for(const f of a.providers){console.log(`
Checking pack provider: ${f.name}`),console.log(`  Pack URL: ${f.base_url}`),console.log(`  Normalized: ${$m(f.base_url)}`);const p=u.filter(g=>{const N=$m(g.base_url),v=$m(f.base_url);return console.log(`  Comparing with local "${g.name}": ${g.base_url}`),console.log(`    Local normalized: ${N}`),console.log(`    Match: ${N===v}`),N===v});p.length>0?(console.log(`   Matched with ${p.length} local provider(s):`,p.map(g=>g.name).join(", ")),d.existing_providers.push({pack_provider:f,local_providers:p.map(g=>({name:g.name,base_url:g.base_url}))})):(console.log("   No match found - will need API key"),d.new_providers.push(f))}const h=c.models||[];console.log(`
=== Model Conflict Detection ===`);for(const f of a.models){const p=h.find(g=>g.name===f.name);p&&(console.log(`Model conflict: ${f.name}`),d.conflicting_models.push({pack_model:f.name,local_model:p.name}))}return console.log(`
=== Detection Summary ===`),console.log(`Existing providers: ${d.existing_providers.length}`),console.log(`New providers: ${d.new_providers.length}`),console.log(`Conflicting models: ${d.conflicting_models.length}`),console.log(`===========================
`),d}async function GS(a,n,r,c){const d=await _e("/api/webui/config/model");if(!d.ok)throw new Error("");const u=await d.json(),h=u.config||u;if(n.apply_providers){const p=n.selected_providers?a.providers.filter(g=>n.selected_providers.includes(g.name)):a.providers;for(const g of p){if(r[g.name])continue;const N=c[g.name];if(!N)throw new Error(` "${g.name}"  API Key`);const v={...g,api_key:N},w=h.api_providers.findIndex(b=>b.name===g.name);w>=0?h.api_providers[w]=v:h.api_providers.push(v)}}if(n.apply_models){const p=n.selected_models?a.models.filter(g=>n.selected_models.includes(g.name)):a.models;for(const g of p){const N=r[g.api_provider]||g.api_provider,v={...g,api_provider:N},w=h.models.findIndex(b=>b.name===g.name);w>=0?h.models[w]=v:h.models.push(v)}}if(n.apply_task_config){const p=n.selected_tasks||Object.keys(a.task_config);for(const g of p){const N=a.task_config[g];if(!N)continue;const v=new Set(n.selected_models||a.models.map(y=>y.name)),w=N.model_list.filter(y=>v.has(y));if(w.length===0)continue;const b={...N,model_list:w};if(n.task_mode==="replace")h.model_task_config[g]=b;else{const y=h.model_task_config[g];if(y){const O=[...new Set([...y.model_list,...w])];h.model_task_config[g]={...y,model_list:O}}else h.model_task_config[g]=b}}}if(!(await _e("/api/webui/config/model",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).ok)throw new Error("")}async function qS(a){const n=await _e("/api/webui/config/model");if(!n.ok)throw new Error("");const r=await n.json();if(!r.success||!r.config)throw new Error("");const c=r.config;let d=(c.api_providers||[]).map(g=>({name:g.name,base_url:g.base_url,client_type:g.client_type,max_retry:g.max_retry,timeout:g.timeout,retry_interval:g.retry_interval}));a.selectedProviders&&(d=d.filter(g=>a.selectedProviders.includes(g.name)));let u=c.models||[];a.selectedModels&&(u=u.filter(g=>a.selectedModels.includes(g.name)));const h={},f=c.model_task_config||{},p=a.selectedTasks||Object.keys(f);for(const g of p)f[g]&&(h[g]=f[g]);return{providers:d,models:u,task_config:h}}function $m(a){try{const n=new URL(a);return`${n.protocol}//${n.host}${n.pathname}`.replace(/\/$/,"").toLowerCase()}catch{return a.toLowerCase().replace(/\/$/,"")}}function Yv(){const a="maibot_pack_user_id";let n=localStorage.getItem(a);return n||(n="pack_user_"+Math.random().toString(36).substring(2,15),localStorage.setItem(a,n)),n}const KS={utils:"",utils_small:"",tool_use:"",replyer:"",planner:"",vlm:"",voice:"",embedding:"",lpmm_entity_extract:"",lpmm_rdf_build:"RDF",lpmm_qa:""},QS=["","","","","","","OpenAI","Claude","Gemini","","",""];function YS({trigger:a}){const[n,r]=m.useState(!1),[c,d]=m.useState(1),[u,h]=m.useState(!1),[f,p]=m.useState(!1),[g,N]=m.useState([]),[v,w]=m.useState([]),[b,y]=m.useState({}),[O,R]=m.useState(new Set),[S,B]=m.useState(new Set),[E,C]=m.useState(new Set),[A,F]=m.useState(""),[L,J]=m.useState(""),[U,oe]=m.useState(""),[Ne,je]=m.useState([]);m.useEffect(()=>{n&&c===1&&re()},[n,c]);const re=async()=>{h(!0);try{const z=await qS({name:"",description:"",author:""});N(z.providers),w(z.models),y(z.task_config),R(new Set(z.providers.map(D=>D.name))),B(new Set(z.models.map(D=>D.name))),C(new Set(Object.keys(z.task_config)))}catch(z){console.error(":",z),Qt({title:"",variant:"destructive"})}finally{h(!1)}},fe=z=>{const D=new Set(O),G=new Set(S),de=new Set(E);D.has(z)?(D.delete(z),v.filter(W=>W.api_provider===z).forEach(W=>G.delete(W.name)),Object.entries(b).forEach(([W,Y])=>{Y.model_list&&(Y.model_list.some(H=>G.has(H))||de.delete(W))})):(D.add(z),v.filter(W=>W.api_provider===z).forEach(W=>G.add(W.name)),Object.entries(b).forEach(([W,Y])=>{Y.model_list&&Y.model_list.some(H=>{const ee=v.find(Ue=>Ue.name===H);return ee&&ee.api_provider===z})&&de.add(W)})),R(D),B(G),C(de)},ge=z=>{const D=new Set(S),G=new Set(E);D.has(z)?(D.delete(z),Object.entries(b).forEach(([de,Re])=>{Re.model_list&&(Re.model_list.some(Y=>D.has(Y))||G.delete(de))})):(D.add(z),Object.entries(b).forEach(([de,Re])=>{Re.model_list&&Re.model_list.includes(z)&&G.add(de)})),B(D),C(G)},M=z=>{const D=new Set(E);D.has(z)?D.delete(z):D.add(z),C(D)},K=z=>{Ne.includes(z)?je(Ne.filter(D=>D!==z)):Ne.length<5?je([...Ne,z]):Qt({title:" 5 ",variant:"destructive"})},P=()=>{O.size===g.length?R(new Set):R(new Set(g.map(z=>z.name)))},ue=()=>{S.size===v.length?B(new Set):B(new Set(v.map(z=>z.name)))},Q=()=>{const z=Object.keys(b);E.size===z.length?C(new Set):C(new Set(z))},Se=async()=>{if(!A.trim()){Qt({title:"",variant:"destructive"});return}if(!L.trim()){Qt({title:"",variant:"destructive"});return}if(!U.trim()){Qt({title:"",variant:"destructive"});return}if(O.size===0&&S.size===0&&E.size===0){Qt({title:"",variant:"destructive"});return}p(!0);try{const z=g.filter(de=>O.has(de.name)),D=v.filter(de=>S.has(de.name)),G={};for(const[de,Re]of Object.entries(b))E.has(de)&&(G[de]=Re);await FS({name:A.trim(),description:L.trim(),author:U.trim(),tags:Ne,providers:z,models:D,task_config:G}),Qt({title:""}),r(!1),pe()}catch(z){console.error(":",z),Qt({title:z instanceof Error?z.message:"",variant:"destructive"})}finally{p(!1)}},pe=()=>{d(1),F(""),J(""),oe(""),je([]),R(new Set),B(new Set),C(new Set)},Te=2;return e.jsxs(Ps,{open:n,onOpenChange:r,children:[e.jsx(cd,{asChild:!0,children:a||e.jsxs(_,{variant:"outline",children:[e.jsx(nv,{className:"w-4 h-4 mr-2"}),""]})}),e.jsxs(Ds,{className:"max-w-2xl max-h-[85vh] flex flex-col",children:[e.jsxs(Os,{children:[e.jsxs(Ls,{className:"flex items-center gap-2",children:[e.jsx(ra,{className:"w-5 h-5"}),""]}),e.jsxs(Ks,{children:[" ",c," / ",Te,"",c===1&&"",c===2&&""]})]}),e.jsx(Je,{className:"h-[calc(85vh-220px)] pr-4",children:u?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(zs,{className:"w-8 h-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"..."})]}):e.jsxs(e.Fragment,{children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(at,{children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsx(Gn,{children:""}),e.jsxs(lt,{children:["",e.jsx("strong",{children:""})," API Key"]})]}),e.jsxs(ta,{defaultValue:"providers",className:"w-full",children:[e.jsxs(Zt,{className:"grid w-full grid-cols-3",children:[e.jsxs(Xe,{value:"providers",children:[e.jsx(Ll,{className:"w-4 h-4 mr-2"}),"API ",e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[O.size,"/",g.length]})]}),e.jsxs(Xe,{value:"models",children:[e.jsx(Qn,{className:"w-4 h-4 mr-2"}),"",e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[S.size,"/",v.length]})]}),e.jsxs(Xe,{value:"tasks",children:[e.jsx(Yn,{className:"w-4 h-4 mr-2"}),"",e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[E.size,"/",Object.keys(b).length]})]})]}),e.jsx(ws,{value:"providers",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:P,children:O.size===g.length?"":""})}),g.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):g.map(z=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-muted",children:[e.jsx(qs,{id:`provider-${z.name}`,checked:O.has(z.name),onCheckedChange:()=>fe(z.name)}),e.jsxs(T,{htmlFor:`provider-${z.name}`,className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:z.name}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:z.base_url})]}),e.jsx(ke,{variant:"outline",className:"text-xs",children:z.client_type})]},z.name))]})}),e.jsx(ws,{value:"models",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:ue,children:S.size===v.length?"":""})}),v.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):v.map(z=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-muted",children:[e.jsx(qs,{id:`model-${z.name}`,checked:S.has(z.name),onCheckedChange:()=>ge(z.name)}),e.jsxs(T,{htmlFor:`model-${z.name}`,className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:z.name}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:z.model_identifier})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:z.api_provider})]},z.name))]})}),e.jsx(ws,{value:"tasks",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:Q,children:E.size===Object.keys(b).length?"":""})}),Object.keys(b).length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):Object.entries(b).map(([z,D])=>e.jsxs("div",{className:"space-y-2 p-2 rounded hover:bg-muted",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:`task-${z}`,checked:E.has(z),onCheckedChange:()=>M(z)}),e.jsx(T,{htmlFor:`task-${z}`,className:"flex-1 cursor-pointer",children:e.jsx("span",{className:"font-medium",children:KS[z]||z})}),e.jsxs(ke,{variant:"outline",className:"text-xs",children:[D.model_list.length," "]})]}),D.model_list&&D.model_list.length>0&&e.jsx("div",{className:"ml-6 flex flex-wrap gap-1",children:D.model_list.map(G=>{const de=v.find(W=>W.name===G),Re=S.has(G);return e.jsxs(ke,{variant:Re?"default":"outline",className:"text-xs cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>ge(G),children:[G,de&&e.jsxs("span",{className:"ml-1 opacity-70",children:["(",de.api_provider,")"]})]},G)})})]},z))]})})]})]}),c===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 text-sm p-3 bg-muted rounded-lg",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ll,{className:"w-4 h-4"}),O.size," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Qn,{className:"w-4 h-4"}),S.size," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Yn,{className:"w-4 h-4"}),E.size," "]})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-name",children:" *"}),e.jsx(ae,{id:"pack-name",placeholder:"",value:A,onChange:z=>F(z.target.value),maxLength:50}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[A.length,"/50"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-description",children:" *"}),e.jsx(ot,{id:"pack-description",placeholder:"...",value:L,onChange:z=>J(z.target.value),rows:4,maxLength:500}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[L.length,"/500"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-author",children:" *"}),e.jsx(ae,{id:"pack-author",placeholder:" ID",value:U,onChange:z=>oe(z.target.value),maxLength:30})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:" 5 "}),e.jsx("div",{className:"flex flex-wrap gap-2",children:QS.map(z=>e.jsxs(ke,{variant:Ne.includes(z)?"default":"outline",className:"cursor-pointer transition-colors",onClick:()=>K(z),children:[Ne.includes(z)&&e.jsx(Ct,{className:"w-3 h-3 mr-1"}),e.jsx(rd,{className:"w-3 h-3 mr-1"}),z]},z))})]})]}),e.jsxs(at,{children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsx(Gn,{children:""}),e.jsx(lt,{children:" 1-3 "})]})]})]})}),e.jsxs(st,{className:"flex justify-between pt-4 border-t",children:[e.jsx("div",{children:c>1&&e.jsx(_,{variant:"outline",onClick:()=>d(c-1),disabled:f,children:""})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>{r(!1),pe()},disabled:f,children:""}),c<Te?e.jsx(_,{onClick:()=>d(c+1),disabled:u||O.size===0&&S.size===0&&E.size===0,children:""}):e.jsxs(_,{onClick:Se,disabled:f,children:[f&&e.jsx(zs,{className:"w-4 h-4 mr-2 animate-spin"}),""]})]})]})]})]})}function JS({value:a,label:n,onRemove:r}){const{attributes:c,listeners:d,setNodeRef:u,transform:h,transition:f,isDragging:p}=Nv({id:a}),g={transform:bv.Transform.toString(h),transition:f,opacity:p?.5:1},N=w=>{w.preventDefault(),w.stopPropagation(),r(a)},v=w=>{w.stopPropagation()};return e.jsx("div",{ref:u,style:g,className:I("inline-flex items-center gap-1",p&&"shadow-lg"),children:e.jsxs(ke,{variant:"secondary",className:"cursor-move hover:bg-secondary/80 flex items-center gap-1",children:[e.jsx("div",{...c,...d,className:"cursor-grab active:cursor-grabbing flex items-center",children:e.jsx(tv,{className:"h-3 w-3 text-muted-foreground"})}),e.jsx("span",{children:n}),e.jsx("span",{role:"button",tabIndex:0,className:"ml-1 rounded-sm hover:bg-destructive/20 focus:outline-none focus:ring-1 focus:ring-destructive cursor-pointer",onClick:N,onPointerDown:v,onMouseDown:w=>w.stopPropagation(),onKeyDown:w=>{(w.key==="Enter"||w.key===" ")&&(w.preventDefault(),N(w))},children:e.jsx(Aa,{className:"h-3 w-3 hover:text-destructive",strokeWidth:2,fill:"none"})})]})})}function XS({options:a,selected:n,onChange:r,placeholder:c="...",emptyText:d="",className:u}){const[h,f]=m.useState(!1),p=mv(qo(fv,{activationConstraint:{distance:8}}),qo(hv,{coordinateGetter:xv})),g=w=>{n.includes(w)?r(n.filter(b=>b!==w)):r([...n,w])},N=w=>{r(n.filter(b=>b!==w))},v=w=>{const{active:b,over:y}=w;if(y&&b.id!==y.id){const O=n.indexOf(b.id),R=n.indexOf(y.id);r(pv(n,O,R))}};return e.jsxs(ul,{open:h,onOpenChange:f,children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":h,className:I("w-full justify-between min-h-10 h-auto",u),children:[e.jsx(gv,{sensors:p,collisionDetection:jv,onDragEnd:v,children:e.jsx(vv,{items:n,strategy:o1,children:e.jsx("div",{className:"flex gap-1 flex-wrap flex-1",children:n.length===0?e.jsx("span",{className:"text-muted-foreground",children:c}):n.map(w=>{const b=a.find(y=>y.value===w);return e.jsx(JS,{value:w,label:b?.label||w,onRemove:N},w)})})})}),e.jsx(rx,{className:"ml-2 h-4 w-4 shrink-0 opacity-50",strokeWidth:2,fill:"none"})]})}),e.jsx(sl,{className:"w-full p-0",align:"start",children:e.jsxs(dd,{children:[e.jsx(ud,{placeholder:"...",className:"h-9"}),e.jsxs(md,{children:[e.jsx(xd,{children:d}),e.jsx(oc,{children:a.map(w=>{const b=n.includes(w.value);return e.jsxs(dc,{value:w.value,onSelect:()=>g(w.value),children:[e.jsx("div",{className:I("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",b?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(Ct,{className:"h-3 w-3",strokeWidth:2,fill:"none"})}),e.jsx("span",{children:w.label})]},w.value)})})]})]})})]})}const zl=Rs.memo(function({title:n,description:r,taskConfig:c,modelNames:d,onChange:u,hideTemperature:h=!1,hideMaxTokens:f=!1,dataTour:p}){const g=N=>{u("model_list",N)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-base sm:text-lg",children:n}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:r})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":p,children:[e.jsx(T,{children:""}),e.jsx(XS,{options:d.map(N=>({label:N,value:N})),selected:c.model_list||[],onChange:g,placeholder:"...",emptyText:""})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[!h&&e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",step:"0.1",min:"0",max:"1",value:c.temperature??.3,onChange:N=>{const v=parseFloat(N.target.value);!isNaN(v)&&v>=0&&v<=1&&u("temperature",v)},className:"w-20 h-8 text-sm"})]}),e.jsx(Qa,{value:[c.temperature??.3],onValueChange:N=>u("temperature",N[0]),min:0,max:1,step:.1,className:"w-full"})]}),!f&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:" Token"}),e.jsx(ae,{type:"number",step:"1",min:"1",value:c.max_tokens??1024,onChange:N=>u("max_tokens",parseInt(N.target.value))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:" ()"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(ae,{type:"number",step:"1",min:"1",value:c.slow_threshold??15,onChange:N=>{const v=parseInt(N.target.value);!isNaN(v)&&v>=1&&u("slow_threshold",v)},placeholder:"15"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:c.selection_strategy??"balance",onValueChange:N=>u("selection_strategy",N),children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"balance",children:"balance"}),e.jsx(Z,{value:"random",children:"random"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]})}),ZS=Rs.memo(function({paginatedModels:n,allModels:r,onEdit:c,onDelete:d,isModelUsed:u,searchQuery:h}){return n.length===0?e.jsx("div",{className:"md:hidden text-center text-muted-foreground py-8 rounded-lg border bg-card",children:h?"":""}):e.jsx("div",{className:"md:hidden space-y-3",children:n.map((f,p)=>{const g=r.findIndex(v=>v===f),N=u(f.name);return e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-base",children:f.name}),e.jsx(ke,{variant:N?"default":"secondary",className:N?"bg-green-600 hover:bg-green-700":"",children:N?"":""})]}),e.jsx("p",{className:"text-xs text-muted-foreground break-all",title:f.model_identifier,children:f.model_identifier})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>c(f,g),children:[e.jsx(Kn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>d(g),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ns,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:f.api_provider})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:f.temperature!=null?f.temperature:e.jsx("span",{className:"text-muted-foreground",children:""})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsxs("p",{className:"font-medium",children:["",f.price_in,"/M"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsxs("p",{className:"font-medium",children:["",f.price_out,"/M"]})]})]})]},p)})})}),WS=Rs.memo(function({paginatedModels:n,allModels:r,filteredModels:c,selectedModels:d,onEdit:u,onDelete:h,onToggleSelection:f,onToggleSelectAll:p,isModelUsed:g,searchQuery:N}){return e.jsx("div",{className:"hidden md:block rounded-lg border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ut,{children:[e.jsx(We,{className:"w-12",children:e.jsx(qs,{checked:d.size===c.length&&c.length>0,onCheckedChange:p})}),e.jsx(We,{className:"w-24",children:""}),e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{className:"text-center",children:""}),e.jsx(We,{className:"text-right",children:""}),e.jsx(We,{className:"text-right",children:""}),e.jsx(We,{className:"text-right",children:""})]})}),e.jsx(Bl,{children:n.length===0?e.jsx(ut,{children:e.jsx(Ke,{colSpan:9,className:"text-center text-muted-foreground py-8",children:N?"":""})}):n.map((v,w)=>{const b=r.findIndex(O=>O===v),y=g(v.name);return e.jsxs(ut,{children:[e.jsx(Ke,{children:e.jsx(qs,{checked:d.has(b),onCheckedChange:()=>f(b)})}),e.jsx(Ke,{children:e.jsx(ke,{variant:y?"default":"secondary",className:y?"bg-green-600 hover:bg-green-700":"",children:y?"":""})}),e.jsx(Ke,{className:"font-medium",children:v.name}),e.jsx(Ke,{className:"max-w-xs truncate",title:v.model_identifier,children:v.model_identifier}),e.jsx(Ke,{children:v.api_provider}),e.jsx(Ke,{className:"text-center",children:v.temperature!=null?v.temperature:e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsxs(Ke,{className:"text-right",children:["",v.price_in,"/M"]}),e.jsxs(Ke,{className:"text-right",children:["",v.price_out,"/M"]}),e.jsx(Ke,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>u(v,b),children:[e.jsx(Kn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>h(b),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ns,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})})]},w)})})]})})})}),e4=300*1e3,Fg=new Map,s4=[10,20,50,100],t4=Rs.memo(function({page:n,pageSize:r,totalItems:c,jumpToPage:d,onPageChange:u,onPageSizeChange:h,onJumpToPageChange:f,onJumpToPage:p,onSelectionClear:g}){const N=Math.ceil(c/r),v=b=>{h(parseInt(b)),u(1),g?.()},w=b=>{b.key==="Enter"&&p()};return c===0?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size-model",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:r.toString(),onValueChange:v,children:[e.jsx($e,{id:"page-size-model",className:"w-20",children:e.jsx(Ie,{})}),e.jsx(Be,{children:s4.map(b=>e.jsx(Z,{value:b.toString(),children:b},b))})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",(n-1)*r+1," "," ",Math.min(n*r,c),"  ",c," "]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>u(1),disabled:n===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>u(Math.max(1,n-1)),disabled:n===1,children:[e.jsx(Da,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"number",value:d,onChange:b=>f(b.target.value),onKeyDown:w,placeholder:n.toString(),className:"w-16 h-8 text-center",min:1,max:N}),e.jsx(_,{variant:"outline",size:"sm",onClick:p,disabled:!d,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>u(n+1),disabled:n>=N,children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(Wt,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>u(N),disabled:n>=N,className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})});function a4(a){const{models:n,taskConfig:r,debounceMs:c=2e3,onSavingChange:d,onUnsavedChange:u}=a,h=m.useRef(null),f=m.useRef(null),p=m.useRef(!0),g=m.useCallback(()=>{h.current&&(clearTimeout(h.current),h.current=null),f.current&&(clearTimeout(f.current),f.current=null)},[]),N=m.useCallback(b=>{const y={model_identifier:b.model_identifier,name:b.name,api_provider:b.api_provider,price_in:b.price_in??0,price_out:b.price_out??0,force_stream_mode:b.force_stream_mode??!1,extra_params:b.extra_params??{}};return b.temperature!=null&&(y.temperature=b.temperature),b.max_tokens!=null&&(y.max_tokens=b.max_tokens),y},[]),v=m.useCallback(async b=>{try{d?.(!0);const y=b.map(N);await Ym("models",y),u?.(!1)}catch(y){console.error(":",y),u?.(!0)}finally{d?.(!1)}},[d,u,N]),w=m.useCallback(async b=>{try{d?.(!0),await Ym("model_task_config",b),u?.(!1)}catch(y){console.error(":",y),u?.(!0)}finally{d?.(!1)}},[d,u]);return m.useEffect(()=>{if(!p.current)return u?.(!0),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{v(n)},c),()=>{h.current&&clearTimeout(h.current)}},[n,v,c,u]),m.useEffect(()=>{if(!(p.current||!r))return u?.(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{w(r)},c),()=>{f.current&&clearTimeout(f.current)}},[r,w,c,u]),m.useEffect(()=>()=>{g()},[g]),{clearTimers:g,initialLoadRef:p}}function l4(a={}){const{onCloseEditDialog:n}=a,r=ca(),{registerTour:c,startTour:d,state:u,goToStep:h}=px(),f=m.useRef(u.stepIndex);return m.useEffect(()=>{c(ol,Vv)},[c]),m.useEffect(()=>{if(u.activeTourId===ol&&u.isRunning){const g=Gv[u.stepIndex];g&&!window.location.pathname.endsWith(g.replace("/config/",""))&&r({to:g})}},[u.stepIndex,u.activeTourId,u.isRunning,r]),m.useEffect(()=>{if(u.activeTourId===ol&&u.isRunning){const g=f.current,N=u.stepIndex;g>=12&&g<=17&&N<12&&n?.(),f.current=N}},[u.stepIndex,u.activeTourId,u.isRunning,n]),m.useEffect(()=>{if(u.activeTourId!==ol||!u.isRunning)return;const g=N=>{const v=N.target,w=u.stepIndex;w===2&&v.closest('[data-tour="add-provider-button"]')?setTimeout(()=>h(3),300):w===9&&v.closest('[data-tour="provider-cancel-button"]')?setTimeout(()=>h(10),300):w===11&&v.closest('[data-tour="add-model-button"]')?setTimeout(()=>h(12),300):w===17&&v.closest('[data-tour="model-cancel-button"]')?setTimeout(()=>h(18),300):w===18&&v.closest('[data-tour="tasks-tab-trigger"]')&&setTimeout(()=>h(19),300)};return document.addEventListener("click",g,!0),()=>document.removeEventListener("click",g,!0)},[u,h]),{startTour:m.useCallback(()=>{d(ol)},[d]),isRunning:u.isRunning&&u.activeTourId===ol,stepIndex:u.stepIndex}}function n4(a){const{getProviderConfig:n}=a,[r,c]=m.useState([]),[d,u]=m.useState(!1),[h,f]=m.useState(null),[p,g]=m.useState(null),N=m.useCallback(()=>{c([]),f(null),g(null)},[]),v=m.useCallback(async(w,b=!1)=>{const y=n(w);if(!y?.base_url){c([]),g(null),f('""');return}if(!y.api_key){c([]),g(null),f(' API Key""');return}const O=RS(y.base_url);if(g(O),!O?.modelFetcher){c([]),f(null);return}const R=`${w}:${y.base_url}`,S=Fg.get(R);if(!b&&S&&Date.now()-S.timestamp<e4){c(S.models),f(null);return}u(!0),f(null);try{const B=await xS(w,O.modelFetcher.parser,O.modelFetcher.endpoint);c(B),Fg.set(R,{models:B,timestamp:Date.now()})}catch(B){console.error(":",B);const E=B.message||"";E.includes("")||E.includes("")||E.includes("API Key")?f('API Key ""'):E.includes("")?f(" API Key "):E.includes("timeout")||E.includes("")?f(""):E.includes("")?f(""):f(E),c([])}finally{u(!1)}},[n]);return{availableModels:r,fetchingModels:d,modelFetchError:h,matchedTemplate:p,fetchModelsForProvider:v,clearModels:N}}function r4(){return e.jsx(Wn,{children:e.jsx(i4,{})})}function i4(){const[a,n]=m.useState([]),[r,c]=m.useState([]),[d,u]=m.useState([]),[h,f]=m.useState([]),[p,g]=m.useState(null),[N,v]=m.useState(!0),[w,b]=m.useState(!1),[y,O]=m.useState(!1),[R,S]=m.useState(!1),[B,E]=m.useState(!1),[C,A]=m.useState(null),[F,L]=m.useState(null),[J,U]=m.useState(!1),[oe,Ne]=m.useState(!1),[je,re]=m.useState(null),[fe,ge]=m.useState(""),[M,K]=m.useState(new Set),[P,ue]=m.useState(!1),[Q,Se]=m.useState(1),[pe,Te]=m.useState(20),[z,D]=m.useState(""),[G,de]=m.useState(!1),[Re,W]=m.useState(!1),Y=m.useRef([]),Fe=m.useRef(null),[H,ee]=m.useState([]),[Ue,ie]=m.useState([]),[Ee,me]=m.useState({}),{toast:Ae}=Ys(),{triggerRestart:rs,isRestarting:Ut}=yn(),{startTour:aa,isRunning:Ja}=l4({onCloseEditDialog:()=>E(!1)}),{clearTimers:Ht,initialLoadRef:mt}=a4({models:a,taskConfig:p,onSavingChange:O,onUnsavedChange:S}),q=m.useCallback((ne,he)=>{if(!ne)return;const ts=new Set(he.map(va=>va.name)),js=[],is=[],jt=[{key:"utils",label:""},{key:"tool_use",label:""},{key:"replyer",label:""},{key:"planner",label:""},{key:"vlm",label:""},{key:"voice",label:""},{key:"embedding",label:""},{key:"lpmm_entity_extract",label:"LPMM"},{key:"lpmm_rdf_build",label:"LPMM"}];for(const{key:va,label:Il}of jt){const tr=ne[va];if(!tr)continue;if(!tr.model_list||tr.model_list.length===0){is.push(Il);continue}const ti=tr.model_list.filter(_n=>!ts.has(_n));ti.length>0&&js.push({taskName:Il,invalidModels:ti})}ee(js),ie(is)},[]),qe=m.useCallback(async()=>{try{v(!0);const ne=await xn(),he=ne.models||[];n(he),f(he.map(jt=>jt.name));const ts=ne.api_providers||[];c(ts.map(jt=>jt.name)),u(ts);const js=ne.model_task_config||null;g(js),q(js,he);const is=js?.embedding?.model_list||[];Y.current=[...is],S(!1),mt.current=!1}catch(ne){console.error(":",ne)}finally{v(!1)}},[mt,q]);m.useEffect(()=>{qe()},[qe]);const Qe=m.useCallback(ne=>d.find(he=>he.name===ne),[d]),{availableModels:es,fetchingModels:Us,modelFetchError:as,matchedTemplate:Cs,fetchModelsForProvider:ze,clearModels:bs}=n4({getProviderConfig:Qe});m.useEffect(()=>{B&&C?.api_provider&&ze(C.api_provider)},[B,C?.api_provider,ze]);const ls=async()=>{await rs()},ss=m.useCallback(()=>{if(!p)return;const ne=new Set(a.map(js=>js.name)),he={...p},ts=Object.keys(he);for(const js of ts){const is=he[js];is&&is.model_list&&(is.model_list=is.model_list.filter(jt=>ne.has(jt)))}g(he),ee([]),Ae({title:"",description:""})},[p,a,Ae]),ys=ne=>{const he={model_identifier:ne.model_identifier,name:ne.name,api_provider:ne.api_provider,price_in:ne.price_in??0,price_out:ne.price_out??0,force_stream_mode:ne.force_stream_mode??!1,extra_params:ne.extra_params??{}};return ne.temperature!=null&&(he.temperature=ne.temperature),ne.max_tokens!=null&&(he.max_tokens=ne.max_tokens),he},gt=async()=>{try{b(!0),Ht();const ne=await xn();ne.models=a.map(ys),ne.model_task_config=p,await tc(ne),S(!1),Ae({title:"",description:"..."}),await ls()}catch(ne){console.error(":",ne),Ae({title:"",description:ne.message,variant:"destructive"}),b(!1)}},$t=async()=>{try{b(!0),Ht();const ne=await xn();ne.models=a.map(ys),ne.model_task_config=p,await tc(ne),S(!1),Ae({title:"",description:""}),await qe()}catch(ne){console.error(":",ne),Ae({title:"",description:ne.message,variant:"destructive"})}finally{b(!1)}},tt=(ne,he)=>{me({}),A(ne||{model_identifier:"",name:"",api_provider:r[0]||"",price_in:0,price_out:0,temperature:null,max_tokens:null,force_stream_mode:!1,extra_params:{}}),L(he),E(!0)},Ms=()=>{if(!C)return;const ne={};if(C.name?.trim()?a.some((jt,va)=>F!==null&&va===F?!1:jt.name.trim().toLowerCase()===C.name.trim().toLowerCase())&&(ne.name=""):ne.name="",C.api_provider?.trim()||(ne.api_provider=" API "),C.model_identifier?.trim()||(ne.model_identifier=""),Object.keys(ne).length>0){me(ne);return}me({});const he={model_identifier:C.model_identifier,name:C.name,api_provider:C.api_provider,price_in:C.price_in??0,price_out:C.price_out??0,force_stream_mode:C.force_stream_mode??!1,extra_params:C.extra_params??{}};C.temperature!=null&&(he.temperature=C.temperature),C.max_tokens!=null&&(he.max_tokens=C.max_tokens);let ts,js=null;if(F!==null?(js=a[F].name,ts=[...a],ts[F]=he):ts=[...a,he],n(ts),f(ts.map(is=>is.name)),js&&js!==he.name&&p){const is=jt=>jt.map(va=>va===js?he.name:va);g({...p,utils:{...p.utils,model_list:is(p.utils?.model_list||[])},tool_use:{...p.tool_use,model_list:is(p.tool_use?.model_list||[])},replyer:{...p.replyer,model_list:is(p.replyer?.model_list||[])},planner:{...p.planner,model_list:is(p.planner?.model_list||[])},vlm:{...p.vlm,model_list:is(p.vlm?.model_list||[])},voice:{...p.voice,model_list:is(p.voice?.model_list||[])},embedding:{...p.embedding,model_list:is(p.embedding?.model_list||[])},lpmm_entity_extract:{...p.lpmm_entity_extract,model_list:is(p.lpmm_entity_extract?.model_list||[])},lpmm_rdf_build:{...p.lpmm_rdf_build,model_list:is(p.lpmm_rdf_build?.model_list||[])}})}E(!1),A(null),L(null),Ae({title:F!==null?"":"",description:' 2 ""'})},Et=ne=>{if(!ne&&C){const he={...C,price_in:C.price_in??0,price_out:C.price_out??0};A(he)}E(ne)},Bt=ne=>{re(ne),Ne(!0)},Oa=()=>{if(je!==null){const ne=a.filter((he,ts)=>ts!==je);n(ne),f(ne.map(he=>he.name)),q(p,ne),Ae({title:"",description:' 2 ""'})}Ne(!1),re(null)},ll=ne=>{const he=new Set(M);he.has(ne)?he.delete(ne):he.add(ne),K(he)},xl=()=>{if(M.size===Dt.length)K(new Set);else{const ne=Dt.map((he,ts)=>a.findIndex(js=>js===Dt[ts]));K(new Set(ne))}},sr=()=>{if(M.size===0){Ae({title:"",description:"",variant:"default"});return}ue(!0)},se=()=>{const ne=M.size,he=a.filter((ts,js)=>!M.has(js));n(he),f(he.map(ts=>ts.name)),q(p,he),K(new Set),ue(!1),Ae({title:"",description:` ${ne}  2 `})},we=(ne,he,ts)=>{if(!p)return;if(ne==="embedding"&&he==="model_list"&&Array.isArray(ts)){const is=Y.current,jt=ts;if((is.length!==jt.length||is.some(Il=>!jt.includes(Il))||jt.some(Il=>!is.includes(Il)))&&is.length>0){Fe.current={field:he,value:ts},W(!0);return}}const js={...p,[ne]:{...p[ne],[he]:ts}};g(js),q(js,a),ne==="embedding"&&he==="model_list"&&Array.isArray(ts)&&(Y.current=[...ts])},Le=()=>{if(!p||!Fe.current)return;const{field:ne,value:he}=Fe.current,ts={...p,embedding:{...p.embedding,[ne]:he}};g(ts),q(ts,a),ne==="model_list"&&Array.isArray(he)&&(Y.current=[...he]),Fe.current=null,W(!1),Ae({title:"",description:""})},Fs=()=>{Fe.current=null,W(!1)},Dt=a.filter(ne=>{if(!fe)return!0;const he=fe.toLowerCase();return ne.name.toLowerCase().includes(he)||ne.model_identifier.toLowerCase().includes(he)||ne.api_provider.toLowerCase().includes(he)}),ea=Math.ceil(Dt.length/pe),rt=Dt.slice((Q-1)*pe,Q*pe),sa=()=>{const ne=parseInt(z);ne>=1&&ne<=ea&&(Se(ne),D(""))},xt=ne=>p?[p.utils?.model_list||[],p.tool_use?.model_list||[],p.replyer?.model_list||[],p.planner?.model_list||[],p.vlm?.model_list||[],p.voice?.model_list||[],p.embedding?.model_list||[],p.lpmm_entity_extract?.model_list||[],p.lpmm_rdf_build?.model_list||[]].some(ts=>ts.includes(ne)):!1;return N?e.jsx(Je,{className:"h-full",children:e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})})}):e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(YS,{trigger:e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(nv,{className:"mr-2 h-4 w-4"}),""]})}),e.jsxs(_,{onClick:$t,disabled:w||y||!R||Ut,size:"sm",variant:"outline",className:"flex-1 sm:flex-none sm:min-w-[120px]",children:[e.jsx(fc,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),w?"...":y?"...":R?"":""]}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{disabled:w||y||Ut,size:"sm",className:"flex-1 sm:flex-none sm:min-w-[120px]",children:[e.jsx(hc,{className:"mr-2 h-4 w-4"}),Ut?"...":R?"":""]})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsx(fs,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:R?",":","})})})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:R?gt:ls,children:R?"":""})]})]})]})]})]}),e.jsxs(at,{children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsxs(lt,{children:["",e.jsx("strong",{children:""}),'""']})]}),H.length>0&&e.jsxs(at,{variant:"destructive",children:[e.jsx(Jt,{className:"h-4 w-4"}),e.jsxs(lt,{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:""}),e.jsx("div",{className:"mt-2 space-y-1",children:H.map(({taskName:ne,invalidModels:he})=>e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:ne})," : ",he.join(", ")]},ne))})]}),e.jsx(_,{variant:"outline",size:"sm",className:"shrink-0 bg-background hover:bg-accent",onClick:ss,children:""})]})]}),Ue.length>0&&e.jsxs(at,{variant:"default",className:"border-yellow-500/50 bg-yellow-500/10",children:[e.jsx(Jt,{className:"h-4 w-4 text-yellow-600"}),e.jsxs(lt,{children:[e.jsx("strong",{className:"text-yellow-600",children:""}),e.jsxs("div",{className:"mt-2 text-sm",children:[Ue.join("")," "]})]})]}),e.jsxs(at,{className:"hidden lg:flex border-primary/30 bg-primary/5 cursor-pointer hover:bg-primary/10 transition-colors",onClick:aa,children:[e.jsx(E_,{className:"h-4 w-4 text-primary"}),e.jsxs(lt,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:[e.jsx("strong",{className:"text-primary",children:""}),""]}),e.jsx(_,{variant:"outline",size:"sm",className:"ml-4 shrink-0",children:""})]})]}),e.jsxs(ta,{defaultValue:"models",className:"w-full",children:[e.jsxs(Zt,{className:"grid w-full max-w-full sm:max-w-md grid-cols-2",children:[e.jsx(Xe,{value:"models",children:""}),e.jsx(Xe,{value:"tasks","data-tour":"tasks-tab-trigger",children:""})]}),e.jsxs(ws,{value:"models",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[M.size>0&&e.jsxs(_,{onClick:sr,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(ns,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"})," (",M.size,")"]}),e.jsxs(_,{onClick:()=>tt(null,null),size:"sm",variant:"outline",className:"w-full sm:w-auto","data-tour":"add-model-button",children:[e.jsx(et,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),""]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:max-w-sm",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:fe,onChange:ne=>ge(ne.target.value),className:"pl-9"})]}),fe&&e.jsxs("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[" ",Dt.length," "]})]}),e.jsx(ZS,{paginatedModels:rt,allModels:a,onEdit:tt,onDelete:Bt,isModelUsed:xt,searchQuery:fe}),e.jsx(WS,{paginatedModels:rt,allModels:a,filteredModels:Dt,selectedModels:M,onEdit:tt,onDelete:Bt,onToggleSelection:ll,onToggleSelectAll:xl,isModelUsed:xt,searchQuery:fe}),e.jsx(t4,{page:Q,pageSize:pe,totalItems:Dt.length,jumpToPage:z,onPageChange:Se,onPageSizeChange:Te,onJumpToPageChange:D,onJumpToPage:sa,onSelectionClear:()=>K(new Set)})]}),e.jsxs(ws,{value:"tasks",className:"space-y-6 mt-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),p&&e.jsxs("div",{className:"grid gap-4 sm:gap-6",children:[e.jsx(zl,{title:" (utils)",description:"",taskConfig:p.utils,modelNames:h,onChange:(ne,he)=>we("utils",ne,he),dataTour:"task-model-select"}),e.jsx(zl,{title:" (tool_use)",description:"",taskConfig:p.tool_use,modelNames:h,onChange:(ne,he)=>we("tool_use",ne,he)}),e.jsx(zl,{title:" (replyer)",description:"",taskConfig:p.replyer,modelNames:h,onChange:(ne,he)=>we("replyer",ne,he)}),e.jsx(zl,{title:" (planner)",description:"",taskConfig:p.planner,modelNames:h,onChange:(ne,he)=>we("planner",ne,he)}),e.jsx(zl,{title:" (vlm)",description:"",taskConfig:p.vlm,modelNames:h,onChange:(ne,he)=>we("vlm",ne,he),hideTemperature:!0}),e.jsx(zl,{title:" (voice)",description:"",taskConfig:p.voice,modelNames:h,onChange:(ne,he)=>we("voice",ne,he),hideTemperature:!0,hideMaxTokens:!0}),e.jsx(zl,{title:" (embedding)",description:"",taskConfig:p.embedding,modelNames:h,onChange:(ne,he)=>we("embedding",ne,he),hideTemperature:!0,hideMaxTokens:!0}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LPMM "}),e.jsx(zl,{title:" (lpmm_entity_extract)",description:"",taskConfig:p.lpmm_entity_extract,modelNames:h,onChange:(ne,he)=>we("lpmm_entity_extract",ne,he)}),e.jsx(zl,{title:"RDF  (lpmm_rdf_build)",description:"",taskConfig:p.lpmm_rdf_build,modelNames:h,onChange:(ne,he)=>we("lpmm_rdf_build",ne,he)})]})]})]})]}),e.jsx(Ps,{open:B,onOpenChange:Et,children:e.jsxs(Ds,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto","data-tour":"model-dialog",preventOutsideClose:Ja,children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:F!==null?"":""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":"model-name-input",children:[e.jsx(T,{htmlFor:"model_name",className:Ee.name?"text-destructive":"",children:" *"}),e.jsx(ae,{id:"model_name",value:C?.name||"",onChange:ne=>{A(he=>he?{...he,name:ne.target.value}:null),Ee.name&&me(he=>({...he,name:void 0}))},placeholder:": qwen3-30b",className:Ee.name?"border-destructive focus-visible:ring-destructive":""}),Ee.name?e.jsx("p",{className:"text-xs text-destructive",children:Ee.name}):e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"model-provider-select",children:[e.jsx(T,{htmlFor:"api_provider",className:Ee.api_provider?"text-destructive":"",children:"API  *"}),e.jsxs(Pe,{value:C?.api_provider||"",onValueChange:ne=>{A(he=>he?{...he,api_provider:ne}:null),bs(),Ee.api_provider&&me(he=>({...he,api_provider:void 0}))},children:[e.jsx($e,{id:"api_provider",className:Ee.api_provider?"border-destructive focus-visible:ring-destructive":"",children:e.jsx(Ie,{placeholder:""})}),e.jsx(Be,{children:r.map(ne=>e.jsx(Z,{value:ne,children:ne},ne))})]}),Ee.api_provider&&e.jsx("p",{className:"text-xs text-destructive",children:Ee.api_provider})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"model-identifier-input",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"model_identifier",className:Ee.model_identifier?"text-destructive":"",children:" *"}),Cs?.modelFetcher&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{variant:"secondary",className:"text-xs",children:Cs.display_name}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>C?.api_provider&&ze(C.api_provider,!0),disabled:Us,children:Us?e.jsx(zs,{className:"h-3 w-3 animate-spin"}):e.jsx(dt,{className:"h-3 w-3"})})]})]}),Cs?.modelFetcher?e.jsxs(ul,{open:G,onOpenChange:de,children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":G,className:"w-full justify-between font-normal",disabled:Us||!!as,children:[Us?e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(zs,{className:"h-4 w-4 animate-spin"}),"..."]}):as?e.jsx("span",{className:"text-muted-foreground text-sm",children:""}):C?.model_identifier?e.jsx("span",{className:"truncate",children:C.model_identifier}):e.jsx("span",{className:"text-muted-foreground",children:"..."}),e.jsx(rx,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(sl,{className:"p-0",align:"start",style:{width:"var(--radix-popover-trigger-width)"},children:e.jsxs(dd,{children:[e.jsx(ud,{placeholder:"..."}),e.jsx(Je,{className:"h-[300px]",children:e.jsxs(md,{className:"max-h-none overflow-visible",children:[e.jsx(xd,{children:as?e.jsxs("div",{className:"py-4 px-2 text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-destructive",children:as}),!as.includes("API Key")&&e.jsx(_,{variant:"link",size:"sm",onClick:()=>C?.api_provider&&ze(C.api_provider,!0),children:""})]}):""}),e.jsx(oc,{heading:"",children:es.map(ne=>e.jsxs(dc,{value:ne.id,onSelect:()=>{A(he=>he?{...he,model_identifier:ne.id}:null),de(!1)},children:[e.jsx(Ct,{className:`mr-2 h-4 w-4 ${C?.model_identifier===ne.id?"opacity-100":"opacity-0"}`}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:ne.id}),ne.name!==ne.id&&e.jsx("span",{className:"text-xs text-muted-foreground",children:ne.name})]})]},ne.id))}),e.jsx(oc,{heading:"",children:e.jsxs(dc,{value:"__manual_input__",onSelect:()=>{de(!1)},children:[e.jsx(Kn,{className:"mr-2 h-4 w-4"}),"..."]})})]})})]})})]}):e.jsx(ae,{id:"model_identifier",value:C?.model_identifier||"",onChange:ne=>{A(he=>he?{...he,model_identifier:ne.target.value}:null),Ee.model_identifier&&me(he=>({...he,model_identifier:void 0}))},placeholder:"Qwen/Qwen3-30B-A3B-Instruct-2507",className:Ee.model_identifier?"border-destructive focus-visible:ring-destructive":""}),Ee.model_identifier&&e.jsx("p",{className:"text-xs text-destructive",children:Ee.model_identifier}),as&&Cs?.modelFetcher&&!Ee.model_identifier&&e.jsxs(at,{variant:"destructive",className:"mt-2 py-2",children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsx(lt,{className:"text-xs",children:as})]}),Cs?.modelFetcher&&e.jsx(ae,{value:C?.model_identifier||"",onChange:ne=>{A(he=>he?{...he,model_identifier:ne.target.value}:null),Ee.model_identifier&&me(he=>({...he,model_identifier:void 0}))},placeholder:"",className:`mt-2 ${Ee.model_identifier?"border-destructive focus-visible:ring-destructive":""}`}),!Ee.model_identifier&&e.jsx("p",{className:"text-xs text-muted-foreground",children:as?'"" API Key':Cs?.modelFetcher?` ${Cs.display_name}`:"API  ID"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"price_in",children:" (/M token)"}),e.jsx(ae,{id:"price_in",type:"number",step:"0.1",min:"0",value:C?.price_in??"",onChange:ne=>{const he=ne.target.value===""?null:parseFloat(ne.target.value);A(ts=>ts?{...ts,price_in:he}:null)},placeholder:": 0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"price_out",children:" (/M token)"}),e.jsx(ae,{id:"price_out",type:"number",step:"0.1",min:"0",value:C?.price_out??"",onChange:ne=>{const he=ne.target.value===""?null:parseFloat(ne.target.value);A(ts=>ts?{...ts,price_out:he}:null)},placeholder:": 0"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"enable_model_temperature",className:"cursor-pointer",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"enable_model_temperature",checked:C?.temperature!=null,onCheckedChange:ne=>{A(ne?he=>he?{...he,temperature:.5}:null:he=>he?{...he,temperature:null}:null)}})]}),C?.temperature!=null&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm",children:""}),e.jsx("span",{className:"text-sm font-medium tabular-nums",children:C.temperature.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"0"}),e.jsx(Qa,{value:[C.temperature],onValueChange:ne=>A(he=>he?{...he,temperature:ne[0]}:null),min:0,max:1,step:.1,className:"flex-1"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"1"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0.1-0.30.7-1.0"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"enable_model_max_tokens",className:"cursor-pointer",children:" Token"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Token "})]}),e.jsx(Ve,{id:"enable_model_max_tokens",checked:C?.max_tokens!=null,onCheckedChange:ne=>{A(ne?he=>he?{...he,max_tokens:2048}:null:he=>he?{...he,max_tokens:null}:null)}})]}),C?.max_tokens!=null&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm",children:" Token "}),e.jsx(ae,{type:"number",min:"1",max:"128000",value:C.max_tokens,onChange:ne=>{const he=parseInt(ne.target.value);!isNaN(he)&&he>=1&&A(ts=>ts?{...ts,max_tokens:he}:null)},className:"w-28 h-8 text-sm"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" token "})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"force_stream_mode",checked:C?.force_stream_mode||!1,onCheckedChange:ne=>A(he=>he?{...he,force_stream_mode:ne}:null)}),e.jsx(T,{htmlFor:"force_stream_mode",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(_,{type:"button",variant:"outline",size:"sm",className:"flex-1 justify-start h-9",onClick:()=>U(!0),children:[e.jsx(vn,{className:"h-4 w-4 mr-2"}),Object.keys(C?.extra_params||{}).length>0?e.jsxs("span",{children:[" ",Object.keys(C?.extra_params||{}).length," "]}):e.jsx("span",{className:"text-muted-foreground",children:""})]})}),Object.keys(C?.extra_params||{}).length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground px-1",children:[Object.keys(C?.extra_params||{}).slice(0,3).map(ne=>e.jsx("span",{className:"inline-block mr-2",children:e.jsx("code",{className:"px-1.5 py-0.5 bg-muted rounded",children:ne})},ne)),Object.keys(C?.extra_params||{}).length>3&&e.jsx("span",{children:"..."})]})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>E(!1),"data-tour":"model-cancel-button",children:""}),e.jsx(_,{onClick:Ms,"data-tour":"model-save-button",children:""})]})]})}),e.jsx(Ns,{open:oe,onOpenChange:Ne,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[' "',je!==null?a[je]?.name:"",'"  ']})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:Oa,children:""})]})]})}),e.jsx(Ns,{open:P,onOpenChange:ue,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",M.size,"  "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:se,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(Ns,{open:Re,onOpenChange:W,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsxs(hs,{className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5 text-amber-500"}),""]}),e.jsx(fs,{asChild:!0,children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-foreground",children:""}),""]}),e.jsxs("ul",{className:"space-y-2 ml-4 list-disc text-muted-foreground",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:""})]}),e.jsx("p",{className:"text-foreground font-medium",children:""})]})})]}),e.jsxs(xs,{children:[e.jsx(gs,{onClick:Fs,children:""}),e.jsx(ps,{onClick:Le,className:"bg-amber-600 hover:bg-amber-700",children:""})]})]})}),e.jsx(BS,{open:J,onOpenChange:U,value:C?.extra_params||{},onChange:ne=>A(he=>he?{...he,extra_params:ne}:null)}),e.jsx(er,{})]})})}const uc=wj,mc=ww,xc=_w,hd="/api/webui/config";async function c4(){const n=await(await _e(`${hd}/adapter-config/path`)).json();return!n.success||!n.path?null:{path:n.path,lastModified:n.lastModified}}async function Hg(a){const r=await(await _e(`${hd}/adapter-config/path`,{method:"POST",headers:Hs(),body:JSON.stringify({path:a})})).json();if(!r.success)throw new Error(r.message||"")}async function Vg(a){const r=await(await _e(`${hd}/adapter-config?path=${encodeURIComponent(a)}`)).json();if(!r.success)throw new Error("");return r.content}async function Gg(a,n){const c=await(await _e(`${hd}/adapter-config`,{method:"POST",headers:Hs(),body:JSON.stringify({path:a,content:n})})).json();if(!c.success)throw new Error(c.message||"")}const bt={inner:{version:"0.1.2"},nickname:{nickname:""},napcat_server:{host:"localhost",port:8095,token:"",heartbeat_interval:30},maibot_server:{host:"localhost",port:8e3},chat:{group_list_type:"whitelist",group_list:[],private_list_type:"whitelist",private_list:[],ban_user_id:[],ban_qq_bot:!1,enable_poke:!0},voice:{use_tts:!1},debug:{level:"INFO"}},Bm={oneclick:{name:"",description:"",path:"../MaiBot-Napcat-Adapter/config.toml",icon:ra},docker:{name:"Docker",description:"Docker Compose ",path:"/MaiMBot/adapters-config/config.toml",icon:M_}};function o4(a,n){let r=a.slice(0,n).split(/\r\n|\n|\r/g);return[r.length,r.pop().length+1]}function d4(a,n,r){let c=a.split(/\r\n|\n|\r/g),d="",u=(Math.log10(n+1)|0)+1;for(let h=n-1;h<=n+1;h++){let f=c[h-1];f&&(d+=h.toString().padEnd(u," "),d+=":  ",d+=f,d+=`
`,h===n&&(d+=" ".repeat(u+r+2),d+=`^
`))}return d}class ks extends Error{line;column;codeblock;constructor(n,r){const[c,d]=o4(r.toml,r.ptr),u=d4(r.toml,c,d);super(`Invalid TOML document: ${n}

${u}`,r),this.line=c,this.column=d,this.codeblock=u}}function u4(a,n){let r=0;for(;a[n-++r]==="\\";);return--r&&r%2}function Yo(a,n=0,r=a.length){let c=a.indexOf(`
`,n);return a[c-1]==="\r"&&c--,c<=r?c:-1}function gx(a,n){for(let r=n;r<a.length;r++){let c=a[r];if(c===`
`)return r;if(c==="\r"&&a[r+1]===`
`)return r+1;if(c<" "&&c!=="	"||c==="")throw new ks("control characters are not allowed in comments",{toml:a,ptr:n})}return a.length}function Ol(a,n,r,c){let d;for(;(d=a[n])===" "||d==="	"||!r&&(d===`
`||d==="\r"&&a[n+1]===`
`);)n++;return c||d!=="#"?n:Ol(a,gx(a,n),r)}function qg(a,n,r,c,d=!1){if(!c)return n=Yo(a,n),n<0?a.length:n;for(let u=n;u<a.length;u++){let h=a[u];if(h==="#")u=Yo(a,u);else{if(h===r)return u+1;if(h===c||d&&(h===`
`||h==="\r"&&a[u+1]===`
`))return u}}throw new ks("cannot find end of structure",{toml:a,ptr:n})}function Jv(a,n){let r=a[n],c=r===a[n+1]&&a[n+1]===a[n+2]?a.slice(n,n+3):r;n+=c.length-1;do n=a.indexOf(c,++n);while(n>-1&&r!=="'"&&u4(a,n));return n>-1&&(n+=c.length,c.length>1&&(a[n]===r&&n++,a[n]===r&&n++)),n}let m4=/^(\d{4}-\d{2}-\d{2})?[T ]?(?:(\d{2}):\d{2}:\d{2}(?:\.\d+)?)?(Z|[-+]\d{2}:\d{2})?$/i;class Kr extends Date{#s=!1;#t=!1;#e=null;constructor(n){let r=!0,c=!0,d="Z";if(typeof n=="string"){let u=n.match(m4);u?(u[1]||(r=!1,n=`0000-01-01T${n}`),c=!!u[2],c&&n[10]===" "&&(n=n.replace(" ","T")),u[2]&&+u[2]>23?n="":(d=u[3]||null,n=n.toUpperCase(),!d&&c&&(n+="Z"))):n=""}super(n),isNaN(this.getTime())||(this.#s=r,this.#t=c,this.#e=d)}isDateTime(){return this.#s&&this.#t}isLocal(){return!this.#s||!this.#t||!this.#e}isDate(){return this.#s&&!this.#t}isTime(){return this.#t&&!this.#s}isValid(){return this.#s||this.#t}toISOString(){let n=super.toISOString();if(this.isDate())return n.slice(0,10);if(this.isTime())return n.slice(11,23);if(this.#e===null)return n.slice(0,-1);if(this.#e==="Z")return n;let r=+this.#e.slice(1,3)*60+ +this.#e.slice(4,6);return r=this.#e[0]==="-"?r:-r,new Date(this.getTime()-r*6e4).toISOString().slice(0,-1)+this.#e}static wrapAsOffsetDateTime(n,r="Z"){let c=new Kr(n);return c.#e=r,c}static wrapAsLocalDateTime(n){let r=new Kr(n);return r.#e=null,r}static wrapAsLocalDate(n){let r=new Kr(n);return r.#t=!1,r.#e=null,r}static wrapAsLocalTime(n){let r=new Kr(n);return r.#s=!1,r.#e=null,r}}let x4=/^((0x[0-9a-fA-F](_?[0-9a-fA-F])*)|(([+-]|0[ob])?\d(_?\d)*))$/,h4=/^[+-]?\d(_?\d)*(\.\d(_?\d)*)?([eE][+-]?\d(_?\d)*)?$/,f4=/^[+-]?0[0-9_]/,p4=/^[0-9a-f]{4,8}$/i,Kg={b:"\b",t:"	",n:`
`,f:"\f",r:"\r",'"':'"',"\\":"\\"};function Xv(a,n=0,r=a.length){let c=a[n]==="'",d=a[n++]===a[n]&&a[n]===a[n+1];d&&(r-=2,a[n+=2]==="\r"&&n++,a[n]===`
`&&n++);let u=0,h,f="",p=n;for(;n<r-1;){let g=a[n++];if(g===`
`||g==="\r"&&a[n]===`
`){if(!d)throw new ks("newlines are not allowed in strings",{toml:a,ptr:n-1})}else if(g<" "&&g!=="	"||g==="")throw new ks("control characters are not allowed in strings",{toml:a,ptr:n-1});if(h){if(h=!1,g==="u"||g==="U"){let N=a.slice(n,n+=g==="u"?4:8);if(!p4.test(N))throw new ks("invalid unicode escape",{toml:a,ptr:u});try{f+=String.fromCodePoint(parseInt(N,16))}catch{throw new ks("invalid unicode escape",{toml:a,ptr:u})}}else if(d&&(g===`
`||g===" "||g==="	"||g==="\r")){if(n=Ol(a,n-1,!0),a[n]!==`
`&&a[n]!=="\r")throw new ks("invalid escape: only line-ending whitespace may be escaped",{toml:a,ptr:u});n=Ol(a,n)}else if(g in Kg)f+=Kg[g];else throw new ks("unrecognized escape sequence",{toml:a,ptr:u});p=n}else!c&&g==="\\"&&(u=n-1,h=!0,f+=a.slice(p,u))}return f+a.slice(p,r-1)}function g4(a,n,r,c){if(a==="true")return!0;if(a==="false")return!1;if(a==="-inf")return-1/0;if(a==="inf"||a==="+inf")return 1/0;if(a==="nan"||a==="+nan"||a==="-nan")return NaN;if(a==="-0")return c?0n:0;let d=x4.test(a);if(d||h4.test(a)){if(f4.test(a))throw new ks("leading zeroes are not allowed",{toml:n,ptr:r});a=a.replace(/_/g,"");let h=+a;if(isNaN(h))throw new ks("invalid number",{toml:n,ptr:r});if(d){if((d=!Number.isSafeInteger(h))&&!c)throw new ks("integer value cannot be represented losslessly",{toml:n,ptr:r});(d||c===!0)&&(h=BigInt(a))}return h}const u=new Kr(a);if(!u.isValid())throw new ks("invalid value",{toml:n,ptr:r});return u}function j4(a,n,r,c){let d=a.slice(n,r),u=d.indexOf("#");u>-1&&(gx(a,u),d=d.slice(0,u));let h=d.trimEnd();if(!c){let f=d.indexOf(`
`,h.length);if(f>-1)throw new ks("newlines are not allowed in inline tables",{toml:a,ptr:n+f})}return[h,u]}function jx(a,n,r,c,d){if(c===0)throw new ks("document contains excessively nested structures. aborting.",{toml:a,ptr:n});let u=a[n];if(u==="["||u==="{"){let[p,g]=u==="["?b4(a,n,c,d):N4(a,n,c,d),N=r?qg(a,g,",",r):g;if(g-N&&r==="}"){let v=Yo(a,g,N);if(v>-1)throw new ks("newlines are not allowed in inline tables",{toml:a,ptr:v})}return[p,N]}let h;if(u==='"'||u==="'"){h=Jv(a,n);let p=Xv(a,n,h);if(r){if(h=Ol(a,h,r!=="]"),a[h]&&a[h]!==","&&a[h]!==r&&a[h]!==`
`&&a[h]!=="\r")throw new ks("unexpected character encountered",{toml:a,ptr:h});h+=+(a[h]===",")}return[p,h]}h=qg(a,n,",",r);let f=j4(a,n,h-+(a[h-1]===","),r==="]");if(!f[0])throw new ks("incomplete key-value declaration: no value specified",{toml:a,ptr:n});return r&&f[1]>-1&&(h=Ol(a,n+f[1]),h+=+(a[h]===",")),[g4(f[0],a,n,d),h]}let v4=/^[a-zA-Z0-9-_]+[ \t]*$/;function Zm(a,n,r="="){let c=n-1,d=[],u=a.indexOf(r,n);if(u<0)throw new ks("incomplete key-value: cannot find end of key",{toml:a,ptr:n});do{let h=a[n=++c];if(h!==" "&&h!=="	")if(h==='"'||h==="'"){if(h===a[n+1]&&h===a[n+2])throw new ks("multiline strings are not allowed in keys",{toml:a,ptr:n});let f=Jv(a,n);if(f<0)throw new ks("unfinished string encountered",{toml:a,ptr:n});c=a.indexOf(".",f);let p=a.slice(f,c<0||c>u?u:c),g=Yo(p);if(g>-1)throw new ks("newlines are not allowed in keys",{toml:a,ptr:n+c+g});if(p.trimStart())throw new ks("found extra tokens after the string part",{toml:a,ptr:f});if(u<f&&(u=a.indexOf(r,f),u<0))throw new ks("incomplete key-value: cannot find end of key",{toml:a,ptr:n});d.push(Xv(a,n,f))}else{c=a.indexOf(".",n);let f=a.slice(n,c<0||c>u?u:c);if(!v4.test(f))throw new ks("only letter, numbers, dashes and underscores are allowed in keys",{toml:a,ptr:n});d.push(f.trimEnd())}}while(c+1&&c<u);return[d,Ol(a,u+1,!0,!0)]}function N4(a,n,r,c){let d={},u=new Set,h,f=0;for(n++;(h=a[n++])!=="}"&&h;){let p={toml:a,ptr:n-1};if(h===`
`)throw new ks("newlines are not allowed in inline tables",p);if(h==="#")throw new ks("inline tables cannot contain comments",p);if(h===",")throw new ks("expected key-value, found comma",p);if(h!==" "&&h!=="	"){let g,N=d,v=!1,[w,b]=Zm(a,n-1);for(let R=0;R<w.length;R++){if(R&&(N=v?N[g]:N[g]={}),g=w[R],(v=Object.hasOwn(N,g))&&(typeof N[g]!="object"||u.has(N[g])))throw new ks("trying to redefine an already defined value",{toml:a,ptr:n});!v&&g==="__proto__"&&Object.defineProperty(N,g,{enumerable:!0,configurable:!0,writable:!0})}if(v)throw new ks("trying to redefine an already defined value",{toml:a,ptr:n});let[y,O]=jx(a,b,"}",r-1,c);u.add(y),N[g]=y,n=O,f=a[n-1]===","?n-1:0}}if(f)throw new ks("trailing commas are not allowed in inline tables",{toml:a,ptr:f});if(!h)throw new ks("unfinished table encountered",{toml:a,ptr:n});return[d,n]}function b4(a,n,r,c){let d=[],u;for(n++;(u=a[n++])!=="]"&&u;){if(u===",")throw new ks("expected value, found comma",{toml:a,ptr:n-1});if(u==="#")n=gx(a,n);else if(u!==" "&&u!=="	"&&u!==`
`&&u!=="\r"){let h=jx(a,n-1,"]",r-1,c);d.push(h[0]),n=h[1]}}if(!u)throw new ks("unfinished array encountered",{toml:a,ptr:n});return[d,n]}function Qg(a,n,r,c){let d=n,u=r,h,f=!1,p;for(let g=0;g<a.length;g++){if(g){if(d=f?d[h]:d[h]={},u=(p=u[h]).c,c===0&&(p.t===1||p.t===2))return null;if(p.t===2){let N=d.length-1;d=d[N],u=u[N].c}}if(h=a[g],(f=Object.hasOwn(d,h))&&u[h]?.t===0&&u[h]?.d)return null;f||(h==="__proto__"&&(Object.defineProperty(d,h,{enumerable:!0,configurable:!0,writable:!0}),Object.defineProperty(u,h,{enumerable:!0,configurable:!0,writable:!0})),u[h]={t:g<a.length-1&&c===2?3:c,d:!1,i:0,c:{}})}if(p=u[h],p.t!==c&&!(c===1&&p.t===3)||(c===2&&(p.d||(p.d=!0,d[h]=[]),d[h].push(d={}),p.c[p.i++]=p={t:1,d:!1,i:0,c:{}}),p.d))return null;if(p.d=!0,c===1)d=f?d[h]:d[h]={};else if(c===0&&f)return null;return[h,d,p.c]}function Zv(a,{maxDepth:n=1e3,integersAsBigInt:r}={}){let c={},d={},u=c,h=d;for(let f=Ol(a,0);f<a.length;){if(a[f]==="["){let p=a[++f]==="[",g=Zm(a,f+=+p,"]");if(p){if(a[g[1]-1]!=="]")throw new ks("expected end of table declaration",{toml:a,ptr:g[1]-1});g[1]++}let N=Qg(g[0],c,d,p?2:1);if(!N)throw new ks("trying to redefine an already defined table or value",{toml:a,ptr:f});h=N[2],u=N[1],f=g[1]}else{let p=Zm(a,f),g=Qg(p[0],u,h,0);if(!g)throw new ks("trying to redefine an already defined table or value",{toml:a,ptr:f});let N=jx(a,p[1],void 0,n,r);g[1][g[0]]=N[0],f=N[1]}if(f=Ol(a,f,!0),a[f]&&a[f]!==`
`&&a[f]!=="\r")throw new ks("each key-value declaration must be followed by an end-of-line",{toml:a,ptr:f});f=Ol(a,f)}return c}let Wv=/^[a-z0-9-_]+$/i;function gc(a){let n=typeof a;if(n==="object"){if(Array.isArray(a))return"array";if(a instanceof Date)return"date"}return n}function y4(a){for(let n=0;n<a.length;n++)if(gc(a[n])!=="object")return!1;return a.length!=0}function vx(a){return JSON.stringify(a).replace(/\x7f/g,"\\u007f")}function Nx(a,n,r,c){if(r===0)throw new Error("Could not stringify the object: maximum object depth exceeded");if(n==="number")return isNaN(a)?"nan":a===1/0?"inf":a===-1/0?"-inf":c&&Number.isInteger(a)?a.toFixed(1):a.toString();if(n==="bigint"||n==="boolean")return a.toString();if(n==="string")return vx(a);if(n==="date"){if(isNaN(a.getTime()))throw new TypeError("cannot serialize invalid date");return a.toISOString()}if(n==="object")return w4(a,r,c);if(n==="array")return _4(a,r,c)}function w4(a,n,r){let c=Object.keys(a);if(c.length===0)return"{}";let d="{ ";for(let u=0;u<c.length;u++){let h=c[u];u&&(d+=", "),d+=Wv.test(h)?h:vx(h),d+=" = ",d+=Nx(a[h],gc(a[h]),n-1,r)}return d+" }"}function _4(a,n,r){if(a.length===0)return"[]";let c="[ ";for(let d=0;d<a.length;d++){if(d&&(c+=", "),a[d]===null||a[d]===void 0)throw new TypeError("arrays cannot contain null or undefined values");c+=Nx(a[d],gc(a[d]),n-1,r)}return c+" ]"}function S4(a,n,r,c){if(r===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let d="";for(let u=0;u<a.length;u++)d+=`${d&&`
`}[[${n}]]
`,d+=bx(0,a[u],n,r,c);return d}function bx(a,n,r,c,d){if(c===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let u="",h="",f=Object.keys(n);for(let p=0;p<f.length;p++){let g=f[p];if(n[g]!==null&&n[g]!==void 0){let N=gc(n[g]);if(N==="symbol"||N==="function")throw new TypeError(`cannot serialize values of type '${N}'`);let v=Wv.test(g)?g:vx(g);if(N==="array"&&y4(n[g]))h+=(h&&`
`)+S4(n[g],r?`${r}.${v}`:v,c-1,d);else if(N==="object"){let w=r?`${r}.${v}`:v;h+=(h&&`
`)+bx(w,n[g],w,c-1,d)}else u+=v,u+=" = ",u+=Nx(n[g],N,c,d),u+=`
`}}return a&&(u||!h)&&(u=u?`[${a}]
${u}`:`[${a}]`),u&&h?`${u}
${h}`:u||h}function k4(a,{maxDepth:n=1e3,numbersAsFloat:r=!1}={}){if(gc(a)!=="object")throw new TypeError("stringify can only be called with an object");let c=bx(0,a,"",n,r);return c[c.length-1]!==`
`?c+`
`:c}function Pm(a){try{const n=Zv(a);return{inner:{...bt.inner,...n.inner},nickname:{...bt.nickname,...n.nickname},napcat_server:{...bt.napcat_server,...n.napcat_server},maibot_server:{...bt.maibot_server,...n.maibot_server},chat:{...bt.chat,...n.chat},voice:{...bt.voice,...n.voice},debug:{...bt.debug,...n.debug}}}catch(n){throw console.error("TOML :",n),new Error(` TOML : ${n instanceof Error?n.message:""}`)}}function Im(a){try{const n=(d,u)=>d===""||d===null||d===void 0?u:d,r={inner:{version:n(a.inner.version,bt.inner.version)},nickname:{nickname:n(a.nickname.nickname,bt.nickname.nickname)},napcat_server:{host:n(a.napcat_server.host,bt.napcat_server.host),port:n(a.napcat_server.port||0,bt.napcat_server.port),token:n(a.napcat_server.token,bt.napcat_server.token),heartbeat_interval:n(a.napcat_server.heartbeat_interval||0,bt.napcat_server.heartbeat_interval)},maibot_server:{host:n(a.maibot_server.host,bt.maibot_server.host),port:n(a.maibot_server.port||0,bt.maibot_server.port)},chat:{group_list_type:n(a.chat.group_list_type,bt.chat.group_list_type),group_list:a.chat.group_list||[],private_list_type:n(a.chat.private_list_type,bt.chat.private_list_type),private_list:a.chat.private_list||[],ban_user_id:a.chat.ban_user_id||[],ban_qq_bot:a.chat.ban_qq_bot??bt.chat.ban_qq_bot,enable_poke:a.chat.enable_poke??bt.chat.enable_poke},voice:{use_tts:a.voice.use_tts??bt.voice.use_tts},debug:{level:n(a.debug.level,bt.debug.level)}};let c=k4(r);return c=C4(c),c}catch(n){throw console.error("TOML :",n),new Error(` TOML : ${n instanceof Error?n.message:""}`)}}function C4(a){const n=a.split(`
`),r=[];for(let c=0;c<n.length;c++){const d=n[c];if(d==="[inner]"){r.push(d);continue}if(d.startsWith("version = ")){r.push(`${d} # `),r.push("# ");continue}if(d==="[nickname]"){r.push("[nickname] # ");continue}if(d==="[napcat_server]"){r.push("[napcat_server] # Napcatws");continue}if(d.startsWith("host = ")&&r[r.length-1]?.includes("[napcat_server]")){r.push(`${d}      # Napcat`);continue}if(d.startsWith("port = ")&&n[c-1]?.includes("host")){r.push(`${d}             # Napcat`);continue}if(d.startsWith("token = ")){r.push(`${d}              # Napcat`);continue}if(d.startsWith("heartbeat_interval = ")){r.push(`${d} # Napcat`);continue}if(d==="[maibot_server]"){r.push("[maibot_server] # ws");continue}if(d.startsWith("host = ")&&r[r.length-1]?.includes("[maibot_server]")){r.push(`${d} # .envHOST`);continue}if(d.startsWith("port = ")&&r[r.length-1]?.includes(".env")){r.push(`${d}        # .envPORT`);continue}if(d==="[chat]"){r.push("[chat] # ");continue}if(d.startsWith("group_list_type = ")){r.push(`${d} # whitelist, blacklist`);continue}if(d.startsWith("group_list = ")){r.push(`${d}               # `),r.push("# group_list_typewhitelist"),r.push("# group_list_typeblacklist");continue}if(d.startsWith("private_list_type = ")){r.push(`${d} # whitelist, blacklist`);continue}if(d.startsWith("private_list = ")){r.push(`${d}               # `),r.push("# private_list_typewhitelist"),r.push("# private_list_typeblacklist");continue}if(d.startsWith("ban_user_id = ")){r.push(`${d}   # `);continue}if(d.startsWith("ban_qq_bot = ")){r.push(`${d} # QQ`);continue}if(d.startsWith("enable_poke = ")){r.push(`${d} # `);continue}if(d==="[voice]"){r.push("[voice] # ");continue}if(d.startsWith("use_tts = ")){r.push(`${d} # ttsttsadapter`);continue}if(d.startsWith("level = ")&&r[r.length-1]==="[debug]"){r.push(`${d} # DEBUG, INFO, WARNING, ERROR, CRITICAL`);continue}r.push(d)}return r.join(`
`)}function Fm(a){if(!a.trim())return{valid:!1,error:""};if(!a.toLowerCase().endsWith(".toml"))return{valid:!1,error:" .toml "};const n=/^([a-zA-Z]:\\|\\\\[^\\]+\\[^\\]+\\).+\.toml$/i,r=/^(\/|~\/).+\.toml$/i,c=/^(\.{1,2}[\\/]|[^:\\/]).+\.toml$/i,d=n.test(a),u=r.test(a),h=c.test(a);return!d&&!u&&!h?{valid:!1,error:""}:/[<>"|?*\x00-\x1F]/.test(a)?{valid:!1,error:""}:{valid:!0,error:""}}function T4(){const[a,n]=m.useState("upload"),[r,c]=m.useState(null),[d,u]=m.useState(""),[h,f]=m.useState(""),[p,g]=m.useState("oneclick"),[N,v]=m.useState(""),[w,b]=m.useState(!1),[y,O]=m.useState(!1),[R,S]=m.useState(!1),[B,E]=m.useState(!1),[C,A]=m.useState(null),[F,L]=m.useState(!1),J=m.useRef(null),{toast:U}=Ys(),oe=m.useRef(null),Ne=G=>{if(f(G),G.trim()){const de=Fm(G);v(de.error)}else v("")},je=m.useCallback(async G=>{const de=Bm[G];O(!0);try{const Re=await Vg(de.path),W=Pm(Re);c(W),g(G),f(de.path),await Hg(de.path),U({title:"",description:`${de.name}`})}catch(Re){console.error(":",Re),U({title:"",description:Re instanceof Error?Re.message:"",variant:"destructive"})}finally{O(!1)}},[U]),re=m.useCallback(async G=>{const de=Fm(G);if(!de.valid){v(de.error),U({title:"",description:de.error,variant:"destructive"});return}v(""),O(!0);try{const Re=await Vg(G),W=Pm(Re);c(W),f(G),await Hg(G),U({title:"",description:""})}catch(Re){console.error(":",Re),U({title:"",description:Re instanceof Error?Re.message:"",variant:"destructive"})}finally{O(!1)}},[U]);m.useEffect(()=>{(async()=>{try{const de=await c4();if(de&&de.path){f(de.path);const Re=Object.entries(Bm).find(([,W])=>W.path===de.path);Re?(n("preset"),g(Re[0]),await je(Re[0])):(n("path"),await re(de.path))}}catch(de){console.error(":",de)}})()},[re,je]);const fe=m.useCallback(G=>{a!=="path"&&a!=="preset"||!h||(oe.current&&clearTimeout(oe.current),oe.current=setTimeout(async()=>{b(!0);try{const de=Im(G);await Gg(h,de),U({title:"",description:""})}catch(de){console.error(":",de),U({title:"",description:de instanceof Error?de.message:"",variant:"destructive"})}finally{b(!1)}},1e3))},[a,h,U]),ge=async()=>{if(!r||!h)return;const G=Fm(h);if(!G.valid){U({title:"",description:G.error,variant:"destructive"});return}b(!0);try{const de=Im(r);await Gg(h,de),U({title:"",description:""})}catch(de){console.error(":",de),U({title:"",description:de instanceof Error?de.message:"",variant:"destructive"})}finally{b(!1)}},M=async()=>{h&&await re(h)},K=G=>{if(G!==a){if(r){A(G),S(!0);return}P(G)}},P=G=>{c(null),u(""),v(""),n(G),G==="preset"&&je("oneclick"),U({title:"",description:{upload:"",path:"",preset:""}[G]})},ue=()=>{C&&(P(C),A(null)),S(!1)},Q=()=>{if(r){E(!0);return}Se()},Se=()=>{f(""),c(null),v(""),U({title:"",description:""})},pe=()=>{Se(),E(!1)},Te=G=>{const de=G.target.files?.[0];if(!de)return;const Re=new FileReader;Re.onload=W=>{try{const Y=W.target?.result,Fe=Pm(Y);c(Fe),u(de.name),U({title:"",description:`${de.name}`})}catch(Y){console.error(":",Y),U({title:"",description:"",variant:"destructive"})}},Re.readAsText(de)},z=()=>{if(!r)return;const G=Im(r),de=new Blob([G],{type:"text/plain;charset=utf-8"}),Re=URL.createObjectURL(de),W=document.createElement("a");W.href=Re,W.download=d||"config.toml",document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(Re),U({title:"",description:""})},D=()=>{c(JSON.parse(JSON.stringify(bt))),u("config.toml"),U({title:"",description:""})};return e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:" QQ "})]})}),e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg border border-amber-500/50 bg-amber-500/10 text-amber-700 dark:text-amber-400",children:[e.jsx(_t,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm",children:" WebUI "})]}),e.jsx(uc,{open:F,onOpenChange:L,children:e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Oe,{children:""}),e.jsx(os,{children:""})]}),e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[e.jsx(za,{className:`h-4 w-4 transition-transform duration-200 ${F?"transform rotate-180":""}`}),e.jsx("span",{className:"sr-only",children:""})]})})]})}),e.jsx(xc,{children:e.jsxs(Me,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4",children:[e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${a==="preset"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>K("preset"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(ra,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${a==="upload"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>K("upload"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(rc,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${a==="path"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>K("path"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(A_,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})})]}),a==="preset"&&e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Object.entries(Bm).map(([G,de])=>{const Re=de.icon,W=p===G;return e.jsx("div",{className:`border-2 rounded-lg p-3 cursor-pointer transition-all ${W?"border-primary bg-primary/5":"border-muted hover:border-primary/50"}`,onClick:()=>{g(G),je(G)},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Re,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-semibold text-sm",children:de.name}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:de.description}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 font-mono break-all",children:de.path})]})]})},G)})})]}),a==="path"&&e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"config-path",className:"text-sm md:text-base",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(ae,{id:"config-path",value:h,onChange:G=>Ne(G.target.value),placeholder:": C:\\Adapter\\config.toml",className:`text-sm ${N?"border-destructive":""}`}),N&&e.jsx("p",{className:"text-xs text-destructive",children:N})]}),e.jsx(_,{onClick:()=>re(h),disabled:y||!h||!!N,className:"w-full sm:w-auto",children:y?e.jsxs(e.Fragment,{children:[e.jsx(dt,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"sm:hidden",children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"sm:hidden",children:""}),e.jsx("span",{className:"hidden sm:inline",children:""})]})})]})]}),e.jsxs("details",{className:"rounded-lg bg-muted/50 p-3 group",children:[e.jsxs("summary",{className:"text-xs font-medium cursor-pointer select-none list-none flex items-center justify-between",children:[e.jsx("span",{children:""}),e.jsx("svg",{className:"h-4 w-4 transition-transform group-open:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsxs("div",{className:"mt-2 space-y-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-background px-1.5 py-0.5 rounded text-[10px] md:text-xs whitespace-nowrap",children:"Windows"})}),e.jsxs("div",{className:"pl-2 space-y-0.5 text-[10px] md:text-xs break-all",children:[e.jsx("div",{children:"C:\\Adapter\\config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"D:\\MaiBot\\adapter\\config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"\\\\server\\share\\config.toml"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-background px-1.5 py-0.5 rounded text-[10px] md:text-xs whitespace-nowrap",children:"Linux"})}),e.jsxs("div",{className:"pl-2 space-y-0.5 text-[10px] md:text-xs break-all",children:[e.jsx("div",{children:"/opt/adapter/config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"/home/user/adapter/config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"~/adapter/config.toml"})]})]}),e.jsx("p",{className:"pt-1 border-t text-[10px] md:text-xs",children:"  1 "})]})]})]})]})})]})}),e.jsxs(at,{children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsx(lt,{children:a==="preset"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""})," 1 ",w&&" (...)"]}):a==="upload"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""}),"      "]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""})," 1 ",w&&" (...)"]})})]}),a==="upload"&&!r&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[e.jsx("input",{ref:J,type:"file",accept:".toml",className:"hidden",onChange:Te}),e.jsxs(_,{onClick:()=>J.current?.click(),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(rc,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:D,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(Ea,{className:"mr-2 h-4 w-4"}),""]})]}),a==="upload"&&r&&e.jsx("div",{className:"flex gap-2",children:e.jsxs(_,{onClick:z,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(Xt,{className:"mr-2 h-4 w-4"}),""]})}),(a==="preset"||a==="path")&&r&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(_,{onClick:ge,size:"sm",disabled:w||!!N,className:"w-full sm:w-auto",children:[e.jsx(fc,{className:"mr-2 h-4 w-4"}),w?"...":""]}),e.jsxs(_,{onClick:M,size:"sm",variant:"outline",disabled:y,className:"w-full sm:w-auto",children:[e.jsx(dt,{className:`mr-2 h-4 w-4 ${y?"animate-spin":""}`}),""]}),a==="path"&&e.jsxs(_,{onClick:Q,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(ns,{className:"mr-2 h-4 w-4"}),""]})]}),r?e.jsxs(ta,{defaultValue:"napcat",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(Zt,{className:"inline-flex w-auto min-w-full sm:grid sm:w-full sm:grid-cols-5",children:[e.jsxs(Xe,{value:"napcat",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:"Napcat "}),e.jsx("span",{className:"sm:hidden",children:"Napcat"})]}),e.jsxs(Xe,{value:"maibot",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Xe,{value:"chat",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Xe,{value:"voice",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsx(Xe,{value:"debug",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:""})]})}),e.jsx(ws,{value:"napcat",className:"space-y-4",children:e.jsx(E4,{config:r,onChange:G=>{c(G),fe(G)}})}),e.jsx(ws,{value:"maibot",className:"space-y-4",children:e.jsx(M4,{config:r,onChange:G=>{c(G),fe(G)}})}),e.jsx(ws,{value:"chat",className:"space-y-4",children:e.jsx(A4,{config:r,onChange:G=>{c(G),fe(G)}})}),e.jsx(ws,{value:"voice",className:"space-y-4",children:e.jsx(z4,{config:r,onChange:G=>{c(G),fe(G)}})}),e.jsx(ws,{value:"debug",className:"space-y-4",children:e.jsx(R4,{config:r,onChange:G=>{c(G),fe(G)}})})]}):e.jsx("div",{className:"rounded-lg border bg-card p-6 md:p-12",children:e.jsxs("div",{className:"text-center space-y-3 md:space-y-4",children:[e.jsx(Ea,{className:"h-12 w-12 md:h-16 md:w-16 mx-auto text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-2 px-4",children:a==="preset"?"":a==="upload"?"":""})]})]})}),e.jsx(Ns,{open:R,onOpenChange:S,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:["",e.jsx("br",{}),e.jsx("span",{className:"text-destructive font-medium",children:""})]})]}),e.jsxs(xs,{children:[e.jsx(gs,{onClick:()=>{S(!1),A(null)},children:""}),e.jsx(ps,{onClick:ue,children:""})]})]})}),e.jsx(Ns,{open:B,onOpenChange:E,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:["",e.jsx("br",{}),e.jsx("span",{className:"text-muted-foreground text-sm",children:""})]})]}),e.jsxs(xs,{children:[e.jsx(gs,{onClick:()=>E(!1),children:""}),e.jsx(ps,{onClick:pe,className:"bg-destructive hover:bg-destructive/90",children:""})]})]})})]})})}function E4({config:a,onChange:n}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:"Napcat WebSocket "}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-host",className:"text-sm md:text-base",children:""}),e.jsx(ae,{id:"napcat-host",value:a.napcat_server.host,onChange:r=>n({...a,napcat_server:{...a.napcat_server,host:r.target.value}}),placeholder:"localhost",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-port",className:"text-sm md:text-base",children:""}),e.jsx(ae,{id:"napcat-port",type:"number",value:a.napcat_server.port||"",onChange:r=>n({...a,napcat_server:{...a.napcat_server,port:r.target.value?parseInt(r.target.value):0}}),placeholder:"8095",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat  8095"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-token",className:"text-sm md:text-base",children:"Token"}),e.jsx(ae,{id:"napcat-token",type:"password",value:a.napcat_server.token,onChange:r=>n({...a,napcat_server:{...a.napcat_server,token:r.target.value}}),placeholder:"",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-heartbeat",className:"text-sm md:text-base",children:""}),e.jsx(ae,{id:"napcat-heartbeat",type:"number",value:a.napcat_server.heartbeat_interval||"",onChange:r=>n({...a,napcat_server:{...a.napcat_server,heartbeat_interval:r.target.value?parseInt(r.target.value):0}}),placeholder:"30",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Napcat  30"})]})]})]})})}function M4({config:a,onChange:n}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:" WebSocket "}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"maibot-host",className:"text-sm md:text-base",children:""}),e.jsx(ae,{id:"maibot-host",value:a.maibot_server.host,onChange:r=>n({...a,maibot_server:{...a.maibot_server,host:r.target.value}}),placeholder:"localhost",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" .env  HOST "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"maibot-port",className:"text-sm md:text-base",children:""}),e.jsx(ae,{id:"maibot-port",type:"number",value:a.maibot_server.port||"",onChange:r=>n({...a,maibot_server:{...a.maibot_server,port:r.target.value?parseInt(r.target.value):0}}),placeholder:"8000",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" .env  PORT  8000"})]})]})]})})}function A4({config:a,onChange:n}){const r=u=>{const h={...a};u==="group"?h.chat.group_list=[...h.chat.group_list,0]:u==="private"?h.chat.private_list=[...h.chat.private_list,0]:h.chat.ban_user_id=[...h.chat.ban_user_id,0],n(h)},c=(u,h)=>{const f={...a};u==="group"?f.chat.group_list=f.chat.group_list.filter((p,g)=>g!==h):u==="private"?f.chat.private_list=f.chat.private_list.filter((p,g)=>g!==h):f.chat.ban_user_id=f.chat.ban_user_id.filter((p,g)=>g!==h),n(f)},d=(u,h,f)=>{const p={...a};u==="group"?p.chat.group_list[h]=f:u==="private"?p.chat.private_list[h]=f:p.chat.ban_user_id[h]=f,n(p)};return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsxs("div",{className:"grid gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Pe,{value:a.chat.group_list_type,onValueChange:u=>n({...a,chat:{...a.chat,group_list_type:u}}),children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"whitelist",children:""}),e.jsx(Z,{value:"blacklist",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(_,{onClick:()=>r("group"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(Ea,{className:"mr-1 h-4 w-4"}),""]})]}),a.chat.group_list.map((u,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{type:"number",value:u,onChange:f=>d("group",h,parseInt(f.target.value)||0),placeholder:"",className:"text-sm md:text-base"}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",u," "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>c("group",h),children:""})]})]})]})]},h)),a.chat.group_list.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Pe,{value:a.chat.private_list_type,onValueChange:u=>n({...a,chat:{...a.chat,private_list_type:u}}),children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"whitelist",children:""}),e.jsx(Z,{value:"blacklist",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(_,{onClick:()=>r("private"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(Ea,{className:"mr-1 h-4 w-4"}),""]})]}),a.chat.private_list.map((u,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{type:"number",value:u,onChange:f=>d("private",h,parseInt(f.target.value)||0),placeholder:"QQ",className:"text-sm md:text-base"}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",u," "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>c("private",h),children:""})]})]})]})]},h)),a.chat.private_list.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>r("ban"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(Ea,{className:"mr-1 h-4 w-4"}),""]})]}),a.chat.ban_user_id.map((u,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{type:"number",value:u,onChange:f=>d("ban",h,parseInt(f.target.value)||0),placeholder:"QQ",className:"text-sm md:text-base"}),e.jsxs(Ns,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",u," "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>c("ban",h),children:""})]})]})]})]},h)),a.chat.ban_user_id.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:"QQ"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"QQ"})]}),e.jsx(Ve,{checked:a.chat.ban_qq_bot,onCheckedChange:u=>n({...a,chat:{...a.chat,ban_qq_bot:u}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ve,{checked:a.chat.enable_poke,onCheckedChange:u=>n({...a,chat:{...a.chat,enable_poke:u}})})]})]})]})})}function z4({config:a,onChange:n}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:" TTS "}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:" TTS "})]}),e.jsx(Ve,{checked:a.voice.use_tts,onCheckedChange:r=>n({...a,voice:{use_tts:r}})})]})]})})}function R4({config:a,onChange:n}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsx("div",{className:"grid gap-3 md:gap-4",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Pe,{value:a.debug.level,onValueChange:r=>n({...a,debug:{level:r}}),children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"DEBUG",children:"DEBUG"}),e.jsx(Z,{value:"INFO",children:"INFO"}),e.jsx(Z,{value:"WARNING",children:"WARNING"}),e.jsx(Z,{value:"ERROR",children:"ERROR"}),e.jsx(Z,{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})})]})})}const D4=["defaultChecked","defaultValue","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML","accessKey","className","contentEditable","contextMenu","dir","draggable","hidden","id","lang","placeholder","slot","spellCheck","style","tabIndex","title","translate","radioGroup","role","about","datatype","inlist","prefix","property","resource","typeof","vocab","autoCapitalize","autoCorrect","autoSave","color","itemProp","itemScope","itemType","itemID","itemRef","results","security","unselectable","inputMode","is","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],O4=/^(aria-|data-)/,eN=a=>Object.fromEntries(Object.entries(a).filter(([n])=>O4.test(n)||D4.includes(n)));function L4(a,n){const r=eN(a);return Object.keys(a).some(c=>!Object.hasOwn(r,c)&&a[c]!==n[c])}class U4 extends m.Component{container;plugin;componentDidMount(){this.installPlugin()}componentDidUpdate(n){if(n.uppy!==this.props.uppy)this.uninstallPlugin(n),this.installPlugin();else if(L4(this.props,n)){const{uppy:r,...c}={...this.props,target:this.container};this.plugin.setOptions(c)}}componentWillUnmount(){this.uninstallPlugin()}installPlugin(){const{uppy:n,...r}={id:"Dashboard",...this.props,inline:!0,target:this.container};n.use(m1,r),this.plugin=n.getPlugin(r.id)}uninstallPlugin(n=this.props){const{uppy:r}=n;r.removePlugin(this.plugin)}render(){return m.createElement("div",{className:"uppy-Container",ref:n=>{this.container=n},...eN(this.props)})}}function $4({src:a,alt:n="",className:r,maxRetries:c=5,retryInterval:d=1500}){const[u,h]=m.useState("loading"),[f,p]=m.useState(0),[g,N]=m.useState(null),[v,w]=m.useState(a);a!==v&&(h("loading"),p(0),N(null),w(a));const b=m.useCallback(async()=>{try{const y=await fetch(a,{credentials:"include"});if(y.status===202){h("generating"),f<c?setTimeout(()=>{p(S=>S+1)},d):h("error");return}if(!y.ok){h("error");return}const O=await y.blob(),R=URL.createObjectURL(O);N(R),h("loaded")}catch(y){console.error(":",y),h("error")}},[a,f,c,d]);return m.useEffect(()=>{b()},[b]),m.useEffect(()=>()=>{g&&URL.revokeObjectURL(g)},[g]),u==="loading"||u==="generating"?e.jsx(vs,{className:I("w-full h-full",r)}):u==="error"||!g?e.jsx("div",{className:I("w-full h-full flex items-center justify-center bg-muted",r),children:e.jsx(ix,{className:"h-8 w-8 text-muted-foreground"})}):e.jsx("img",{src:g,alt:n,className:I("w-full h-full object-contain",r)})}function B4({children:a,className:n}){return e.jsx(fx,{content:a,className:n})}const Ya="/api/webui/emoji";async function P4(a){const n=new URLSearchParams;a.page&&n.append("page",a.page.toString()),a.page_size&&n.append("page_size",a.page_size.toString()),a.search&&n.append("search",a.search),a.is_registered!==void 0&&n.append("is_registered",a.is_registered.toString()),a.is_banned!==void 0&&n.append("is_banned",a.is_banned.toString()),a.format&&n.append("format",a.format),a.sort_by&&n.append("sort_by",a.sort_by),a.sort_order&&n.append("sort_order",a.sort_order);const r=await _e(`${Ya}/list?${n}`,{});if(!r.ok)throw new Error(`: ${r.statusText}`);return r.json()}async function I4(a){const n=await _e(`${Ya}/${a}`,{});if(!n.ok)throw new Error(`: ${n.statusText}`);return n.json()}async function F4(a,n){const r=await _e(`${Ya}/${a}`,{method:"PATCH",body:JSON.stringify(n)});if(!r.ok)throw new Error(`: ${r.statusText}`);return r.json()}async function H4(a){const n=await _e(`${Ya}/${a}`,{method:"DELETE"});if(!n.ok)throw new Error(`: ${n.statusText}`);return n.json()}async function V4(){const a=await _e(`${Ya}/stats/summary`,{});if(!a.ok)throw new Error(`: ${a.statusText}`);return a.json()}async function G4(a){const n=await _e(`${Ya}/${a}/register`,{method:"POST"});if(!n.ok)throw new Error(`: ${n.statusText}`);return n.json()}async function q4(a){const n=await _e(`${Ya}/${a}/ban`,{method:"POST"});if(!n.ok)throw new Error(`: ${n.statusText}`);return n.json()}function K4(a,n=!1){return n?`${Ya}/${a}/thumbnail?original=true`:`${Ya}/${a}/thumbnail`}function Q4(a){return`${Ya}/${a}/thumbnail?original=true`}async function Y4(a){const n=await _e(`${Ya}/batch/delete`,{method:"POST",body:JSON.stringify({emoji_ids:a})});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}function J4(){return`${Ya}/upload`}function X4(){const[a,n]=m.useState([]),[r,c]=m.useState(null),[d,u]=m.useState(!1),[h,f]=m.useState(1),[p,g]=m.useState(0),[N,v]=m.useState(20),[w,b]=m.useState("all"),[y,O]=m.useState("all"),[R,S]=m.useState("all"),[B,E]=m.useState("usage_count"),[C,A]=m.useState("desc"),[F,L]=m.useState(null),[J,U]=m.useState(!1),[oe,Ne]=m.useState(!1),[je,re]=m.useState(!1),[fe,ge]=m.useState(new Set),[M,K]=m.useState(!1),[P,ue]=m.useState(""),[Q,Se]=m.useState("medium"),[pe,Te]=m.useState(!1),{toast:z}=Ys(),D=m.useCallback(async()=>{try{u(!0);const me=await P4({page:h,page_size:N,is_registered:w==="all"?void 0:w==="registered",is_banned:y==="all"?void 0:y==="banned",format:R==="all"?void 0:R,sort_by:B,sort_order:C});n(me.data),g(me.total)}catch(me){const Ae=me instanceof Error?me.message:"";z({title:"",description:Ae,variant:"destructive"})}finally{u(!1)}},[h,N,w,y,R,B,C,z]),G=async()=>{try{const me=await V4();c(me.data)}catch(me){console.error(":",me)}};m.useEffect(()=>{D()},[D]),m.useEffect(()=>{G()},[]);const de=async me=>{try{const Ae=await I4(me.id);L(Ae.data),U(!0)}catch(Ae){const rs=Ae instanceof Error?Ae.message:"";z({title:"",description:rs,variant:"destructive"})}},Re=me=>{L(me),Ne(!0)},W=me=>{L(me),re(!0)},Y=async()=>{if(F)try{await H4(F.id),z({title:"",description:""}),re(!1),L(null),D(),G()}catch(me){const Ae=me instanceof Error?me.message:"";z({title:"",description:Ae,variant:"destructive"})}},Fe=async me=>{try{await G4(me.id),z({title:"",description:""}),D(),G()}catch(Ae){const rs=Ae instanceof Error?Ae.message:"";z({title:"",description:rs,variant:"destructive"})}},H=async me=>{try{await q4(me.id),z({title:"",description:""}),D(),G()}catch(Ae){const rs=Ae instanceof Error?Ae.message:"";z({title:"",description:rs,variant:"destructive"})}},ee=me=>{const Ae=new Set(fe);Ae.has(me)?Ae.delete(me):Ae.add(me),ge(Ae)},Ue=async()=>{try{const me=await Y4(Array.from(fe));z({title:"",description:me.message}),ge(new Set),K(!1),D(),G()}catch(me){z({title:"",description:me instanceof Error?me.message:"",variant:"destructive"})}},ie=()=>{const me=parseInt(P),Ae=Math.ceil(p/N);me>=1&&me<=Ae?(f(me),ue("")):z({title:"",description:`1-${Ae}`,variant:"destructive"})},Ee=r?.formats?Object.keys(r.formats):[];return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>Te(!0),className:"gap-2",children:[e.jsx(rc,{className:"h-4 w-4"}),""]})]}),e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[r&&e.jsxs("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsx(Ce,{children:e.jsxs(De,{className:"pb-2",children:[e.jsx(os,{children:""}),e.jsx(Oe,{className:"text-2xl",children:r.total})]})}),e.jsx(Ce,{children:e.jsxs(De,{className:"pb-2",children:[e.jsx(os,{children:""}),e.jsx(Oe,{className:"text-2xl text-green-600",children:r.registered})]})}),e.jsx(Ce,{children:e.jsxs(De,{className:"pb-2",children:[e.jsx(os,{children:""}),e.jsx(Oe,{className:"text-2xl text-red-600",children:r.banned})]})}),e.jsx(Ce,{children:e.jsxs(De,{className:"pb-2",children:[e.jsx(os,{children:""}),e.jsx(Oe,{className:"text-2xl text-gray-600",children:r.unregistered})]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsxs(Oe,{className:"flex items-center gap-2",children:[e.jsx(Bo,{className:"h-5 w-5"}),""]})}),e.jsxs(Me,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:`${B}-${C}`,onValueChange:me=>{const[Ae,rs]=me.split("-");E(Ae),A(rs),f(1)},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"usage_count-desc",children:" ()"}),e.jsx(Z,{value:"usage_count-asc",children:" ()"}),e.jsx(Z,{value:"register_time-desc",children:" ()"}),e.jsx(Z,{value:"register_time-asc",children:" ()"}),e.jsx(Z,{value:"record_time-desc",children:" ()"}),e.jsx(Z,{value:"record_time-asc",children:" ()"}),e.jsx(Z,{value:"last_used_time-desc",children:" ()"}),e.jsx(Z,{value:"last_used_time-asc",children:" ()"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:w,onValueChange:me=>{b(me),f(1)},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"registered",children:""}),e.jsx(Z,{value:"unregistered",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:y,onValueChange:me=>{O(me),f(1)},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"banned",children:""}),e.jsx(Z,{value:"unbanned",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:R,onValueChange:me=>{S(me),f(1)},children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"all",children:""}),Ee.map(me=>e.jsxs(Z,{value:me,children:[me.toUpperCase()," (",r?.formats[me],")"]},me))]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[fe.size>0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",fe.size," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:Q,onValueChange:me=>Se(me),children:[e.jsx($e,{className:"w-24",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"small",children:""}),e.jsx(Z,{value:"medium",children:""}),e.jsx(Z,{value:"large",children:""})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"emoji-page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:N.toString(),onValueChange:me=>{v(parseInt(me)),f(1),ge(new Set)},children:[e.jsx($e,{id:"emoji-page-size",className:"w-20",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"20",children:"20"}),e.jsx(Z,{value:"40",children:"40"}),e.jsx(Z,{value:"60",children:"60"}),e.jsx(Z,{value:"100",children:"100"})]})]}),fe.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>ge(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>K(!0),children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsxs(_,{variant:"outline",size:"sm",onClick:D,disabled:d,children:[e.jsx(dt,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),""]})})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsxs(os,{children:[" ",p,"  ",h," "]})]}),e.jsxs(Me,{children:[a.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:""}):e.jsx("div",{className:`grid gap-3 ${Q==="small"?"grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10":Q==="medium"?"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8":"grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5"}`,children:a.map(me=>e.jsxs("div",{className:`group relative rounded-lg border bg-card overflow-hidden hover:ring-2 hover:ring-primary transition-all cursor-pointer ${fe.has(me.id)?"ring-2 ring-primary bg-primary/5":""}`,onClick:()=>ee(me.id),children:[e.jsx("div",{className:`absolute top-1 left-1 z-10 transition-opacity ${fe.has(me.id)?"opacity-100":"opacity-0 group-hover:opacity-100"}`,children:e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${fe.has(me.id)?"bg-primary border-primary text-primary-foreground":"bg-background/80 border-muted-foreground/50"}`,children:fe.has(me.id)&&e.jsx(pt,{className:"h-3 w-3"})})}),e.jsxs("div",{className:"absolute top-1 right-1 z-10 flex flex-col gap-0.5",children:[me.is_registered&&e.jsx(ke,{variant:"default",className:"bg-green-600 text-[10px] px-1 py-0",children:""}),me.is_banned&&e.jsx(ke,{variant:"destructive",className:"text-[10px] px-1 py-0",children:""})]}),e.jsx("div",{className:`aspect-square bg-muted flex items-center justify-center overflow-hidden ${Q==="small"?"p-1":Q==="medium"?"p-2":"p-3"}`,children:e.jsx($4,{src:K4(me.id),alt:""})}),e.jsxs("div",{className:`border-t bg-card ${Q==="small"?"p-1":"p-2"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-1 text-xs text-muted-foreground mb-1",children:[e.jsx(ke,{variant:"outline",className:"text-[10px] px-1 py-0",children:me.format.toUpperCase()}),e.jsxs("span",{className:"font-mono",children:[me.usage_count,""]})]}),e.jsxs("div",{className:`flex gap-1 justify-center opacity-0 group-hover:opacity-100 transition-opacity ${Q==="small"?"flex-wrap":""}`,children:[e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:Ae=>{Ae.stopPropagation(),Re(me)},title:"",children:e.jsx(Jn,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:Ae=>{Ae.stopPropagation(),de(me)},title:"",children:e.jsx(Ft,{className:"h-3 w-3"})}),!me.is_registered&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-600 hover:text-green-700",onClick:Ae=>{Ae.stopPropagation(),Fe(me)},title:"",children:e.jsx(pt,{className:"h-3 w-3"})}),!me.is_banned&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-orange-600 hover:text-orange-700",onClick:Ae=>{Ae.stopPropagation(),H(me)},title:"",children:e.jsx(z_,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-red-600 hover:text-red-700",onClick:Ae=>{Ae.stopPropagation(),W(me)},title:"",children:e.jsx(ns,{className:"h-3 w-3"})})]})]})]},me.id))}),p>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",(h-1)*N+1," "," ",Math.min(h*N,p),"  ",p," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(me=>Math.max(1,me-1)),disabled:h===1,children:[e.jsx(Da,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"number",value:P,onChange:me=>ue(me.target.value),onKeyDown:me=>me.key==="Enter"&&ie(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(p/N)}),e.jsx(_,{variant:"outline",size:"sm",onClick:ie,disabled:!P,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(me=>me+1),disabled:h>=Math.ceil(p/N),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(Wt,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(p/N)),disabled:h>=Math.ceil(p/N),className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]})]}),e.jsx(Z4,{emoji:F,open:J,onOpenChange:U}),e.jsx(W4,{emoji:F,open:oe,onOpenChange:Ne,onSuccess:()=>{D(),G()}}),e.jsx(ek,{open:pe,onOpenChange:Te,onSuccess:()=>{D(),G()}})]})}),e.jsx(Ns,{open:M,onOpenChange:K,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",fe.size," "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:Ue,children:""})]})]})}),e.jsx(Ps,{open:je,onOpenChange:re,children:e.jsxs(Ds,{children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>re(!1),children:""}),e.jsx(_,{variant:"destructive",onClick:Y,children:""})]})]})})]})}function Z4({emoji:a,open:n,onOpenChange:r}){if(!a)return null;const c=d=>d?new Date(d*1e3).toLocaleString("zh-CN"):"-";return e.jsx(Ps,{open:n,onOpenChange:r,children:e.jsxs(Ds,{className:"max-w-2xl max-h-[90vh]",children:[e.jsx(Os,{children:e.jsx(Ls,{children:""})}),e.jsx(Je,{className:"max-h-[calc(90vh-8rem)] pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-32 h-32 bg-muted rounded-lg flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:Q4(a.id),alt:a.description||"",className:"w-full h-full object-cover",onError:d=>{const u=d.target;u.style.display="none";const h=u.parentElement;h&&(h.innerHTML='<svg class="h-16 w-16 text-muted-foreground" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>')}})})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:"ID"}),e.jsx("div",{className:"mt-1 font-mono",children:a.id})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(ke,{variant:"outline",children:a.format.toUpperCase()})})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-sm break-all bg-muted p-2 rounded",children:a.full_path})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-sm break-all bg-muted p-2 rounded",children:a.emoji_hash})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),a.description?e.jsx("div",{className:"mt-1 rounded-lg border bg-muted/50 p-3",children:e.jsx(B4,{className:"prose-sm",children:a.description})}):e.jsx("div",{className:"mt-1 text-sm text-muted-foreground",children:"-"})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:a.emotion?e.jsx("span",{className:"text-sm",children:a.emotion}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"-"})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[a.is_registered&&e.jsx(ke,{variant:"default",className:"bg-green-600",children:""}),a.is_banned&&e.jsx(ke,{variant:"destructive",children:""}),!a.is_registered&&!a.is_banned&&e.jsx(ke,{variant:"outline",children:""})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-lg",children:a.usage_count})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(a.record_time)})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(a.register_time)})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(a.last_used_time)})]})]})})]})})}function W4({emoji:a,open:n,onOpenChange:r,onSuccess:c}){const[d,u]=m.useState(""),[h,f]=m.useState(!1),[p,g]=m.useState(!1),[N,v]=m.useState(!1),{toast:w}=Ys();m.useEffect(()=>{a&&(u(a.emotion||""),f(a.is_registered),g(a.is_banned))},[a]);const b=async()=>{if(a)try{v(!0);const y=d.split(/[,,]/).map(O=>O.trim()).filter(Boolean).join(",");await F4(a.id,{emotion:y||void 0,is_registered:h,is_banned:p}),w({title:"",description:""}),r(!1),c()}catch(y){const O=y instanceof Error?y.message:"";w({title:"",description:O,variant:"destructive"})}finally{v(!1)}};return a?e.jsx(Ps,{open:n,onOpenChange:r,children:e.jsxs(Ds,{className:"max-w-2xl",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:""}),e.jsx(ot,{value:d,onChange:y=>u(y.target.value),placeholder:"...",rows:2,className:"mt-1"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"is_registered",checked:h,onCheckedChange:y=>{y===!0?(f(!0),g(!1)):f(!1)}}),e.jsx(T,{htmlFor:"is_registered",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"is_banned",checked:p,onCheckedChange:y=>{y===!0?(g(!0),f(!1)):g(!1)}}),e.jsx(T,{htmlFor:"is_banned",className:"cursor-pointer",children:""})]})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:b,disabled:N,children:N?"...":""})]})]})}):null}function ek({open:a,onOpenChange:n,onSuccess:r}){const[c,d]=m.useState("select"),[u,h]=m.useState([]),[f,p]=m.useState(null),[g,N]=m.useState(!1),{toast:v}=Ys(),w=m.useMemo(()=>new x1({id:"emoji-uploader",autoProceed:!1,restrictions:{maxFileSize:10485760,allowedFileTypes:["image/jpeg","image/png","image/gif","image/webp"],maxNumberOfFiles:20},locale:{pluralize:()=>0,strings:{addMoreFiles:"",addingMoreFiles:"",allowedFileTypes:"%{types}",cancel:"",closeModal:"",complete:"",connectedToInternet:"",copyLink:"",copyLinkToClipboardFallback:"",copyLinkToClipboardSuccess:"",dashboardTitle:"",dashboardWindowTitle:" ESC ",done:"",dropHereOr:" %{browse}",dropHint:"",dropPasteFiles:" %{browseFiles}",dropPasteFolders:" %{browseFolders}",dropPasteBoth:"%{browseFiles}  %{browseFolders}",dropPasteImportFiles:"%{browseFiles} ",dropPasteImportFolders:"%{browseFolders} ",dropPasteImportBoth:"%{browseFiles}%{browseFolders} ",editFile:"",editing:" %{file}",emptyFolderAdded:"",exceedsSize:"%{file}  %{size}",failedToUpload:" %{file} ",fileSource:"%{name}",filesUploadedOfTotal:{0:" %{complete} / %{smart_count} ",1:" %{complete} / %{smart_count} "},filter:"",finishEditingFile:"",folderAdded:{0:" %{folder}  %{smart_count} ",1:" %{folder}  %{smart_count} "},generatingThumbnails:"...",import:"",importFiles:"",importFrom:" %{name} ",loading:"...",logOut:"",myDevice:"",noFilesFound:"",noInternetConnection:"",openFolderNamed:" %{name}",pause:"",pauseUpload:"",paused:"",poweredBy:"%{uppy}",processingXFiles:{0:" %{smart_count} ",1:" %{smart_count} "},recording:"",removeFile:"",resetFilter:"",resume:"",resumeUpload:"",retry:"",retryUpload:"",save:"",saveChanges:"",selectFileNamed:" %{name}",selectX:{0:" %{smart_count}",1:" %{smart_count}"},smile:"",startRecording:"",stopRecording:"",takePicture:"",timedOut:" %{seconds} ",upload:"",uploadComplete:"",uploadFailed:"",uploadPaused:"",uploadXFiles:{0:"%{smart_count} ",1:"%{smart_count} "},uploadXNewFiles:{0:"+%{smart_count} ",1:"+%{smart_count} "},uploading:"",uploadingXFiles:{0:" %{smart_count} ",1:" %{smart_count} "},xFilesSelected:{0:" %{smart_count} ",1:" %{smart_count} "},xMoreFilesAdded:{0:" %{smart_count} ",1:" %{smart_count} "},xTimeLeft:" %{time}",youCanOnlyUploadFileTypes:"%{types}",youCanOnlyUploadX:{0:" %{smart_count} ",1:" %{smart_count} "},youHaveToAtLeastSelectX:{0:" %{smart_count} ",1:" %{smart_count} "},browseFiles:"",browseFolders:"",cancelUpload:"",addMore:"",back:"",editFileWithFilename:" %{file}"}}}),[]);m.useEffect(()=>{const F=()=>{const L=w.getFiles();if(L.length===0)return;const J=L.map(U=>({id:U.id,name:U.name,previewUrl:U.preview||URL.createObjectURL(U.data),emotion:"",description:"",isRegistered:!0,file:U.data}));h(J),L.length===1?(p(J[0].id),d("edit-single")):d("edit-multiple")};return w.on("upload",F),()=>{w.off("upload",F)}},[w]),m.useEffect(()=>{a||(w.cancelAll(),d("select"),h([]),p(null),N(!1))},[a,w]);const b=m.useCallback((F,L)=>{h(J=>J.map(U=>U.id===F?{...U,...L}:U))},[]),y=m.useCallback(F=>F.emotion.trim().length>0,[]),O=m.useMemo(()=>u.length>0&&u.every(y),[u,y]),R=m.useMemo(()=>u.find(F=>F.id===f)||null,[u,f]),S=m.useCallback(()=>{(c==="edit-single"||c==="edit-multiple")&&(d("select"),h([]),p(null))},[c]),B=m.useCallback(async()=>{if(!O){v({title:"",description:"",variant:"destructive"});return}N(!0);let F=0,L=0;try{for(const J of u){const U=new FormData;U.append("file",J.file),U.append("emotion",J.emotion),U.append("description",J.description),U.append("is_registered",J.isRegistered.toString());try{(await _e(J4(),{method:"POST",body:U})).ok?F++:L++}catch{L++}}L===0?(v({title:"",description:` ${F} `}),n(!1),r()):(v({title:"",description:` ${F}  ${L} `,variant:"destructive"}),r())}finally{N(!1)}},[O,u,v,n,r]),E=()=>e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"border rounded-lg overflow-hidden w-full",children:e.jsx(U4,{uppy:w,proudlyDisplayPoweredByUppy:!1,hideProgressDetails:!0,height:350,width:"100%",theme:"auto",note:" JPGPNGGIFWebP  20 "})})}),C=()=>{const F=u[0];return F?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:S,children:[e.jsx(Ma,{className:"h-4 w-4 mr-1"}),""]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("div",{className:"w-32 h-32 rounded-lg border overflow-hidden bg-muted flex items-center justify-center",children:e.jsx("img",{src:F.previewUrl,alt:F.name,className:"max-w-full max-h-full object-contain"})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center truncate max-w-32",children:F.name})]}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"single-emotion",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ae,{id:"single-emotion",value:F.emotion,onChange:L=>b(F.id,{emotion:L.target.value}),placeholder:",",className:F.emotion.trim()?"":"border-destructive"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"single-description",children:""}),e.jsx(ae,{id:"single-description",value:F.description,onChange:L=>b(F.id,{description:L.target.value}),placeholder:"..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"single-is-registered",checked:F.isRegistered,onCheckedChange:L=>b(F.id,{isRegistered:L===!0})}),e.jsx(T,{htmlFor:"single-is-registered",className:"cursor-pointer",children:""})]})]})]}),e.jsx(st,{children:e.jsx(_,{onClick:B,disabled:!O||g,children:g?"...":""})})]}):null},A=()=>{const F=u.filter(y).length,L=u.length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:S,children:[e.jsx(Ma,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["",F,"/",L," "]})]}),e.jsx(ke,{variant:O?"default":"secondary",children:O?e.jsxs(e.Fragment,{children:[e.jsx(Ct,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Aa,{className:"h-3 w-3 mr-1"}),""]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Je,{className:"h-[350px] pr-2",children:e.jsx("div",{className:"space-y-2",children:u.map(J=>{const U=y(J),oe=f===J.id;return e.jsxs("div",{onClick:()=>p(J.id),className:`
                      flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all
                      ${oe?"ring-2 ring-primary":""}
                      ${U?"border-green-500 bg-green-50 dark:bg-green-950/20":"border-border hover:border-muted-foreground/50"}
                    `,children:[e.jsx("div",{className:"w-12 h-12 rounded border overflow-hidden bg-muted flex-shrink-0 flex items-center justify-center",children:e.jsx("img",{src:J.previewUrl,alt:J.name,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:J.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:J.emotion||""})]}),U?e.jsx(pt,{className:"h-5 w-5 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"h-5 w-5 rounded-full border-2 border-muted-foreground/30 flex-shrink-0"})]},J.id)})})}),e.jsx("div",{className:"border rounded-lg p-4",children:R?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 rounded border overflow-hidden bg-muted flex items-center justify-center",children:e.jsx("img",{src:R.previewUrl,alt:R.name,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:R.name}),y(R)&&e.jsxs(ke,{variant:"outline",className:"text-green-600 border-green-600",children:[e.jsx(Ct,{className:"h-3 w-3 mr-1"}),""]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"multi-emotion",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ae,{id:"multi-emotion",value:R.emotion,onChange:J=>b(R.id,{emotion:J.target.value}),placeholder:",",className:R.emotion.trim()?"":"border-destructive"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"multi-description",children:""}),e.jsx(ae,{id:"multi-description",value:R.description,onChange:J=>b(R.id,{description:J.target.value}),placeholder:"..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"multi-is-registered",checked:R.isRegistered,onCheckedChange:J=>b(R.id,{isRegistered:J===!0})}),e.jsx(T,{htmlFor:"multi-is-registered",className:"cursor-pointer text-sm",children:""})]})]}):e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ix,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:""})]})})})]}),e.jsx(st,{children:e.jsx(_,{onClick:B,disabled:!O||g,children:g?"...":` (${L})`})})]})};return e.jsx(Ps,{open:a,onOpenChange:n,children:e.jsxs(Ds,{className:"max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsxs(Os,{children:[e.jsxs(Ls,{className:"flex items-center gap-2",children:[e.jsx(rc,{className:"h-5 w-5"}),c==="select"&&" - ",c==="edit-single"&&" - ",c==="edit-multiple"&&" - "]}),e.jsxs(Ks,{children:[c==="select"&&" JPGPNGGIFWebP  10MB",c==="edit-single"&&"",c==="edit-multiple"&&""]})]}),e.jsxs("div",{className:"overflow-y-auto pr-1",children:[c==="select"&&E(),c==="edit-single"&&C(),c==="edit-multiple"&&A()]})]})})}function sk(){const[a,n]=m.useState([]),[r,c]=m.useState(!0),[d,u]=m.useState(0),[h,f]=m.useState(1),[p,g]=m.useState(20),[N,v]=m.useState(""),[w,b]=m.useState(null),[y,O]=m.useState(!1),[R,S]=m.useState(!1),[B,E]=m.useState(!1),[C,A]=m.useState(null),[F,L]=m.useState(new Set),[J,U]=m.useState(!1),[oe,Ne]=m.useState(""),[je,re]=m.useState({total:0,recent_7days:0,chat_count:0,top_chats:{}}),[fe,ge]=m.useState([]),[M,K]=m.useState(new Map),[P,ue]=m.useState(!1),[Q,Se]=m.useState(0),{toast:pe}=Ys(),Te=async()=>{try{c(!0);const ie=await J1({page:h,page_size:p,search:N||void 0});n(ie.data),u(ie.total)}catch(ie){pe({title:"",description:ie instanceof Error?ie.message:"",variant:"destructive"})}finally{c(!1)}},z=async()=>{try{const ie=await t2();ie?.data&&re(ie.data)}catch(ie){console.error(":",ie)}},D=async()=>{try{const ie=await mx();Se(ie.unchecked)}catch(ie){console.error(":",ie)}},G=async()=>{try{const ie=await ux();if(ie?.data){ge(ie.data);const Ee=new Map;ie.data.forEach(me=>{Ee.set(me.chat_id,me.chat_name)}),K(Ee)}}catch(ie){console.error(":",ie)}},de=ie=>M.get(ie)||ie;m.useEffect(()=>{Te(),D(),z(),G()},[h,p,N]);const Re=async ie=>{try{const Ee=await X1(ie.id);b(Ee.data),O(!0)}catch(Ee){pe({title:"",description:Ee instanceof Error?Ee.message:"",variant:"destructive"})}},W=ie=>{b(ie),S(!0)},Y=async ie=>{try{await e2(ie.id),pe({title:"",description:`: ${ie.situation}`}),A(null),Te(),z()}catch(Ee){pe({title:"",description:Ee instanceof Error?Ee.message:"",variant:"destructive"})}},Fe=ie=>{const Ee=new Set(F);Ee.has(ie)?Ee.delete(ie):Ee.add(ie),L(Ee)},H=()=>{F.size===a.length&&a.length>0?L(new Set):L(new Set(a.map(ie=>ie.id)))},ee=async()=>{try{await s2(Array.from(F)),pe({title:"",description:` ${F.size} `}),L(new Set),U(!1),Te(),z()}catch(ie){pe({title:"",description:ie instanceof Error?ie.message:"",variant:"destructive"})}},Ue=()=>{const ie=parseInt(oe),Ee=Math.ceil(d/p);ie>=1&&ie<=Ee?(f(ie),Ne("")):pe({title:"",description:`1-${Ee}`,variant:"destructive"})};return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(Ra,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"outline",onClick:()=>ue(!0),className:"gap-2",children:[e.jsx(Wj,{className:"h-4 w-4"}),"",Q>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs rounded-full bg-orange-500 text-white",children:Q>99?"99+":Q})]}),e.jsxs(_,{onClick:()=>E(!0),className:"gap-2",children:[e.jsx(et,{className:"h-4 w-4"}),""]})]})]})}),e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:je.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"7"}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-green-600",children:je.recent_7days})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-blue-600",children:je.chat_count})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 mt-1.5",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Tt,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{id:"search",placeholder:"...",value:N,onChange:ie=>v(ie.target.value),className:"pl-9"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:F.size>0&&e.jsxs("span",{children:[" ",F.size," "]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:p.toString(),onValueChange:ie=>{g(parseInt(ie)),f(1),L(new Set)},children:[e.jsx($e,{id:"page-size",className:"w-20",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"10",children:"10"}),e.jsx(Z,{value:"20",children:"20"}),e.jsx(Z,{value:"50",children:"50"}),e.jsx(Z,{value:"100",children:"100"})]})]}),F.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>L(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>U(!0),children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ut,{children:[e.jsx(We,{className:"w-12",children:e.jsx(qs,{checked:F.size===a.length&&a.length>0,onCheckedChange:H})}),e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{className:"text-right",children:""})]})}),e.jsx(Bl,{children:r?e.jsx(ut,{children:e.jsx(Ke,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"..."})}):a.length===0?e.jsx(ut,{children:e.jsx(Ke,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:""})}):a.map(ie=>e.jsxs(ut,{children:[e.jsx(Ke,{children:e.jsx(qs,{checked:F.has(ie.id),onCheckedChange:()=>Fe(ie.id)})}),e.jsx(Ke,{className:"font-medium max-w-xs truncate",children:ie.situation}),e.jsx(Ke,{className:"max-w-xs truncate",children:ie.style}),e.jsx(Ke,{className:"max-w-[200px] truncate",title:de(ie.chat_id),style:{wordBreak:"keep-all"},children:e.jsx("span",{className:"whitespace-nowrap overflow-hidden text-ellipsis block",children:de(ie.chat_id)})}),e.jsx(Ke,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>W(ie),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>Re(ie),title:"",children:e.jsx(ia,{className:"h-4 w-4"})}),e.jsxs(_,{size:"sm",onClick:()=>A(ie),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})})]},ie.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):a.map(ie=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qs,{checked:F.has(ie.id),onCheckedChange:()=>Fe(ie.id),className:"mt-1"}),e.jsxs("div",{className:"min-w-0 flex-1 overflow-hidden space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-2 w-full break-all",title:ie.situation,children:ie.situation})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm line-clamp-2 w-full break-all",title:ie.style,children:ie.style})]})]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm truncate",title:de(ie.chat_id),style:{wordBreak:"keep-all"},children:de(ie.chat_id)})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t overflow-hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>W(ie),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(Jn,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Re(ie),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:e.jsx(ia,{className:"h-3 w-3"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>A(ie),className:"text-xs px-2 py-1 h-auto flex-shrink-0 text-destructive hover:text-destructive",children:[e.jsx(ns,{className:"h-3 w-3 mr-1"}),""]})]})]},ie.id))}),d>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",d,"  ",h," / ",Math.ceil(d/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Da,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"number",value:oe,onChange:ie=>Ne(ie.target.value),onKeyDown:ie=>ie.key==="Enter"&&Ue(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(d/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:Ue,disabled:!oe,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(d/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(Wt,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(d/p)),disabled:h>=Math.ceil(d/p),className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(tk,{expression:w,open:y,onOpenChange:O,chatNameMap:M}),e.jsx(ak,{open:B,onOpenChange:E,chatList:fe,onSuccess:()=>{Te(),z(),E(!1)}}),e.jsx(lk,{expression:w,open:R,onOpenChange:S,chatList:fe,onSuccess:()=>{Te(),z(),S(!1)}}),e.jsx(Ns,{open:!!C,onOpenChange:()=>A(null),children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[' "',C?.situation,'"  ']})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>C&&Y(C),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(nk,{open:J,onOpenChange:U,onConfirm:ee,count:F.size}),e.jsx(Dv,{open:P,onOpenChange:ie=>{ue(ie),ie||(Te(),z(),D())}})]})}function tk({expression:a,open:n,onOpenChange:r,chatNameMap:c}){if(!a)return null;const d=h=>h?new Date(h*1e3).toLocaleString("zh-CN"):"-",u=h=>c.get(h)||h;return e.jsx(Ps,{open:n,onOpenChange:r,children:e.jsxs(Ds,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Ki,{label:"",value:a.situation}),e.jsx(Ki,{label:"",value:a.style}),e.jsx(Ki,{label:"",value:u(a.chat_id)}),e.jsx(Ki,{icon:Jr,label:"ID",value:a.id.toString(),mono:!0})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsx(Ki,{icon:na,label:"",value:d(a.create_date)})}),e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-4",children:[e.jsx(T,{className:"text-xs text-muted-foreground mb-3 block",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:I("flex h-8 w-8 items-center justify-center rounded-full",a.checked?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600"),children:a.checked?e.jsx(pt,{className:"h-5 w-5"}):e.jsx(Ho,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.checked?"":""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:I("flex h-8 w-8 items-center justify-center rounded-full",a.rejected?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600"),children:a.rejected?e.jsx(Ka,{className:"h-5 w-5"}):e.jsx(Ho,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.rejected?"":""})]})]})]})]})]}),e.jsx(st,{children:e.jsx(_,{onClick:()=>r(!1),children:""})})]})})}function Ki({icon:a,label:n,value:r,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a&&e.jsx(a,{className:"h-3 w-3"}),n]}),e.jsx("div",{className:I("text-sm",c&&"font-mono",!r&&"text-muted-foreground"),children:r||"-"})]})}function ak({open:a,onOpenChange:n,chatList:r,onSuccess:c}){const[d,u]=m.useState({situation:"",style:"",chat_id:""}),[h,f]=m.useState(!1),{toast:p}=Ys(),g=async()=>{if(!d.situation||!d.style||!d.chat_id){p({title:"",description:"",variant:"destructive"});return}try{f(!0),await Z1(d),p({title:"",description:""}),u({situation:"",style:"",chat_id:""}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return e.jsx(Ps,{open:a,onOpenChange:n,children:e.jsxs(Ds,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"situation",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ae,{id:"situation",value:d.situation,onChange:N=>u({...d,situation:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"style",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ae,{id:"style",value:d.style,onChange:N=>u({...d,style:N.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"chat_id",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Pe,{value:d.chat_id,onValueChange:N=>u({...d,chat_id:N}),children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:""})}),e.jsx(Be,{children:r.map(N=>e.jsx(Z,{value:N.chat_id,children:e.jsxs("span",{className:"truncate",style:{wordBreak:"keep-all"},children:[N.chat_name,N.is_group&&e.jsx("span",{className:"text-muted-foreground ml-1",children:"()"})]})},N.chat_id))})]})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>n(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})})}function lk({expression:a,open:n,onOpenChange:r,chatList:c,onSuccess:d}){const[u,h]=m.useState({}),[f,p]=m.useState(!1),{toast:g}=Ys();m.useEffect(()=>{a&&h({situation:a.situation,style:a.style,chat_id:a.chat_id,checked:a.checked,rejected:a.rejected})},[a]);const N=async()=>{if(a)try{p(!0),await W1(a.id,u),g({title:"",description:""}),d()}catch(v){g({title:"",description:v instanceof Error?v.message:"",variant:"destructive"})}finally{p(!1)}};return a?e.jsx(Ps,{open:n,onOpenChange:r,children:e.jsxs(Ds,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_situation",children:""}),e.jsx(ae,{id:"edit_situation",value:u.situation||"",onChange:v=>h({...u,situation:v.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_style",children:""}),e.jsx(ae,{id:"edit_style",value:u.style||"",onChange:v=>h({...u,style:v.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_chat_id",children:""}),e.jsxs(Pe,{value:u.chat_id||"",onValueChange:v=>h({...u,chat_id:v}),children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:""})}),e.jsx(Be,{children:c.map(v=>e.jsx(Z,{value:v.chat_id,children:e.jsxs("span",{className:"truncate",style:{wordBreak:"keep-all"},children:[v.chat_name,v.is_group&&e.jsx("span",{className:"text-muted-foreground ml-1",children:"()"})]})},v.chat_id))})]})]}),e.jsxs(at,{children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsx(lt,{className:"text-xs",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:e.jsx("strong",{children:""})}),e.jsx("p",{children:" AI"}),e.jsx("p",{children:" "}),e.jsxs("p",{className:"text-muted-foreground mt-2",children:['""',e.jsx("br",{})," ",e.jsx("br",{})," "]})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"edit_checked",className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"edit_checked",checked:u.checked??!1,onCheckedChange:v=>h({...u,checked:v})})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"edit_rejected",className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"edit_rejected",checked:u.rejected??!1,onCheckedChange:v=>h({...u,rejected:v})})]})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:N,disabled:f,children:f?"...":""})]})]})}):null}function nk({open:a,onOpenChange:n,onConfirm:r,count:c}){return e.jsx(Ns,{open:a,onOpenChange:n,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",c," "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:r,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})}const Pl="/api/webui/jargon";async function rk(){const a=await _e(`${Pl}/chats`,{});if(!a.ok){const n=await a.json();throw new Error(n.detail||"")}return a.json()}async function ik(a){const n=new URLSearchParams;a.page&&n.append("page",a.page.toString()),a.page_size&&n.append("page_size",a.page_size.toString()),a.search&&n.append("search",a.search),a.chat_id&&n.append("chat_id",a.chat_id),a.is_jargon!==void 0&&a.is_jargon!==null&&n.append("is_jargon",a.is_jargon.toString()),a.is_global!==void 0&&n.append("is_global",a.is_global.toString());const r=await _e(`${Pl}/list?${n}`,{});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function ck(a){const n=await _e(`${Pl}/${a}`,{});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}async function ok(a){const n=await _e(`${Pl}/`,{method:"POST",body:JSON.stringify(a)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}async function dk(a,n){const r=await _e(`${Pl}/${a}`,{method:"PATCH",body:JSON.stringify(n)});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function uk(a){const n=await _e(`${Pl}/${a}`,{method:"DELETE"});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}async function mk(a){const n=await _e(`${Pl}/batch/delete`,{method:"POST",body:JSON.stringify({ids:a})});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}async function xk(){const a=await _e(`${Pl}/stats/summary`,{});if(!a.ok){const n=await a.json();throw new Error(n.detail||"")}return a.json()}async function hk(a,n){const r=new URLSearchParams;a.forEach(d=>r.append("ids",d.toString())),r.append("is_jargon",n.toString());const c=await _e(`${Pl}/batch/set-jargon?${r}`,{method:"POST"});if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return c.json()}function fk(){const[a,n]=m.useState([]),[r,c]=m.useState(!0),[d,u]=m.useState(0),[h,f]=m.useState(1),[p,g]=m.useState(20),[N,v]=m.useState(""),[w,b]=m.useState("all"),[y,O]=m.useState("all"),[R,S]=m.useState(null),[B,E]=m.useState(!1),[C,A]=m.useState(!1),[F,L]=m.useState(!1),[J,U]=m.useState(null),[oe,Ne]=m.useState(new Set),[je,re]=m.useState(!1),[fe,ge]=m.useState(""),[M,K]=m.useState({total:0,confirmed_jargon:0,confirmed_not_jargon:0,pending:0,global_count:0,complete_count:0,chat_count:0,top_chats:{}}),[P,ue]=m.useState([]),{toast:Q}=Ys(),Se=async()=>{try{c(!0);const ee=await ik({page:h,page_size:p,search:N||void 0,chat_id:w==="all"?void 0:w,is_jargon:y==="all"?void 0:y==="true"?!0:y==="false"?!1:void 0});n(ee.data),u(ee.total)}catch(ee){Q({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}finally{c(!1)}},pe=async()=>{try{const ee=await xk();ee?.data&&K(ee.data)}catch(ee){console.error(":",ee)}},Te=async()=>{try{const ee=await rk();ee?.data&&ue(ee.data)}catch(ee){console.error(":",ee)}};m.useEffect(()=>{Se(),pe(),Te()},[h,p,N,w,y]);const z=async ee=>{try{const Ue=await ck(ee.id);S(Ue.data),E(!0)}catch(Ue){Q({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},D=ee=>{S(ee),A(!0)},G=async ee=>{try{await uk(ee.id),Q({title:"",description:`: ${ee.content}`}),U(null),Se(),pe()}catch(Ue){Q({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},de=ee=>{const Ue=new Set(oe);Ue.has(ee)?Ue.delete(ee):Ue.add(ee),Ne(Ue)},Re=()=>{oe.size===a.length&&a.length>0?Ne(new Set):Ne(new Set(a.map(ee=>ee.id)))},W=async()=>{try{await mk(Array.from(oe)),Q({title:"",description:` ${oe.size} `}),Ne(new Set),re(!1),Se(),pe()}catch(ee){Q({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}},Y=async ee=>{try{await hk(Array.from(oe),ee),Q({title:"",description:` ${oe.size} ${ee?"":""}`}),Ne(new Set),Se(),pe()}catch(Ue){Q({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},Fe=()=>{const ee=parseInt(fe),Ue=Math.ceil(d/p);ee>=1&&ee<=Ue?(f(ee),ge("")):Q({title:"",description:`1-${Ue}`,variant:"destructive"})},H=ee=>ee===!0?e.jsxs(ke,{variant:"default",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Ct,{className:"h-3 w-3 mr-1"}),""]}):ee===!1?e.jsxs(ke,{variant:"secondary",children:[e.jsx(Aa,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(ke,{variant:"outline",children:[e.jsx(sv,{className:"h-3 w-3 mr-1"}),""]});return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(R_,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsxs(_,{onClick:()=>L(!0),className:"gap-2",children:[e.jsx(et,{className:"h-4 w-4"}),""]})]})}),e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-3",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1",children:M.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-green-600",children:M.confirmed_jargon})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-gray-500",children:M.confirmed_not_jargon})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-yellow-600",children:M.pending})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-blue-600",children:M.global_count})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-purple-600",children:M.complete_count})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1",children:M.chat_count})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(Tt,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{id:"search",placeholder:"...",value:N,onChange:ee=>v(ee.target.value),className:"pl-9"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:w,onValueChange:b,children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"all",children:""}),P.map(ee=>e.jsx(Z,{value:ee.chat_id,children:ee.chat_name},ee.chat_id))]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:y,onValueChange:O,children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"true",children:""}),e.jsx(Z,{value:"false",children:""})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{htmlFor:"page-size",children:""}),e.jsxs(Pe,{value:p.toString(),onValueChange:ee=>{g(parseInt(ee)),f(1),Ne(new Set)},children:[e.jsx($e,{id:"page-size",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"10",children:"10"}),e.jsx(Z,{value:"20",children:"20"}),e.jsx(Z,{value:"50",children:"50"}),e.jsx(Z,{value:"100",children:"100"})]})]})]})]}),oe.size>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-4 pt-4 border-t",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",oe.size," "]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Y(!0),children:[e.jsx(Ct,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Y(!1),children:[e.jsx(Aa,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Ne(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>re(!0),children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ut,{children:[e.jsx(We,{className:"w-12",children:e.jsx(qs,{checked:oe.size===a.length&&a.length>0,onCheckedChange:Re})}),e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{className:"text-center",children:""}),e.jsx(We,{className:"text-right",children:""})]})}),e.jsx(Bl,{children:r?e.jsx(ut,{children:e.jsx(Ke,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"..."})}):a.length===0?e.jsx(ut,{children:e.jsx(Ke,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:""})}):a.map(ee=>e.jsxs(ut,{children:[e.jsx(Ke,{children:e.jsx(qs,{checked:oe.has(ee.id),onCheckedChange:()=>de(ee.id)})}),e.jsx(Ke,{className:"font-medium max-w-[200px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[ee.is_global&&e.jsx("span",{title:"",children:e.jsx(Vo,{className:"h-4 w-4 text-blue-500 flex-shrink-0"})}),e.jsx("span",{className:"truncate",title:ee.content,children:ee.content})]})}),e.jsx(Ke,{className:"max-w-[200px] truncate",title:ee.meaning||"",children:ee.meaning||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Ke,{className:"max-w-[150px] truncate",title:ee.chat_name||ee.chat_id,children:ee.chat_name||ee.chat_id}),e.jsx(Ke,{children:H(ee.is_jargon)}),e.jsx(Ke,{className:"text-center",children:ee.count}),e.jsx(Ke,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>D(ee),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>z(ee),title:"",children:e.jsx(ia,{className:"h-4 w-4"})}),e.jsxs(_,{size:"sm",onClick:()=>U(ee),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})})]},ee.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):a.map(ee=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qs,{checked:oe.has(ee.id),onCheckedChange:()=>de(ee.id),className:"mt-1"}),e.jsxs("div",{className:"min-w-0 flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[ee.is_global&&e.jsx(Vo,{className:"h-4 w-4 text-blue-500 flex-shrink-0"}),e.jsx("h3",{className:"font-semibold text-sm break-all",children:ee.content})]}),ee.meaning&&e.jsx("p",{className:"text-sm text-muted-foreground break-all",children:ee.meaning}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[H(ee.is_jargon),e.jsxs("span",{className:"text-muted-foreground",children:[": ",ee.count]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:[": ",ee.chat_name||ee.chat_id]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>D(ee),className:"text-xs px-2 py-1 h-auto",children:[e.jsx(Jn,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>z(ee),className:"text-xs px-2 py-1 h-auto",children:e.jsx(ia,{className:"h-3 w-3"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>U(ee),className:"text-xs px-2 py-1 h-auto text-destructive hover:text-destructive",children:[e.jsx(ns,{className:"h-3 w-3 mr-1"}),""]})]})]},ee.id))}),d>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",d,"  ",h," / ",Math.ceil(d/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Da,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"number",value:fe,onChange:ee=>ge(ee.target.value),onKeyDown:ee=>ee.key==="Enter"&&Fe(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(d/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:Fe,disabled:!fe,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(d/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(Wt,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(d/p)),disabled:h>=Math.ceil(d/p),className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(pk,{jargon:R,open:B,onOpenChange:E}),e.jsx(gk,{open:F,onOpenChange:L,chatList:P,onSuccess:()=>{Se(),pe(),L(!1)}}),e.jsx(jk,{jargon:R,open:C,onOpenChange:A,chatList:P,onSuccess:()=>{Se(),pe(),A(!1)}}),e.jsx(Ns,{open:!!J,onOpenChange:()=>U(null),children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[' "',J?.content,'" ']})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>J&&G(J),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(Ns,{open:je,onOpenChange:re,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",oe.size," "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:W,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})]})}function pk({jargon:a,open:n,onOpenChange:r}){return a?e.jsx(Ps,{open:n,onOpenChange:r,children:e.jsxs(Ds,{className:"max-w-2xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:""})]}),e.jsx(Je,{className:"h-full pr-4",children:e.jsxs("div",{className:"space-y-4 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Hm,{icon:Jr,label:"ID",value:a.id.toString(),mono:!0}),e.jsx(Hm,{label:"",value:a.count.toString()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all whitespace-pre-wrap",children:a.content})]}),a.raw_content&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all",children:(()=>{try{const c=JSON.parse(a.raw_content);return Array.isArray(c)?c.map((d,u)=>e.jsxs("div",{children:[u>0&&e.jsx("hr",{className:"my-3 border-border"}),e.jsx("div",{className:"whitespace-pre-wrap",children:d})]},u)):e.jsx("div",{className:"whitespace-pre-wrap",children:a.raw_content})}catch{return e.jsx("div",{className:"whitespace-pre-wrap",children:a.raw_content})}})()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all",children:a.meaning?e.jsx(fx,{content:a.meaning}):"-"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Hm,{label:"",value:a.chat_name||a.chat_id}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.is_jargon===!0&&e.jsx(ke,{variant:"default",className:"bg-green-600",children:""}),a.is_jargon===!1&&e.jsx(ke,{variant:"secondary",children:""}),a.is_jargon===null&&e.jsx(ke,{variant:"outline",children:""}),a.is_global&&e.jsx(ke,{variant:"outline",className:"border-blue-500 text-blue-500",children:""}),a.is_complete&&e.jsx(ke,{variant:"outline",className:"border-purple-500 text-purple-500",children:""})]})]})]}),a.inference_with_context&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"p-2 bg-muted rounded break-all whitespace-pre-wrap font-mono text-xs max-h-[200px] overflow-y-auto",children:a.inference_with_context})]}),a.inference_content_only&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"p-2 bg-muted rounded break-all whitespace-pre-wrap font-mono text-xs max-h-[200px] overflow-y-auto",children:a.inference_content_only})]})]})}),e.jsx(st,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>r(!1),children:""})})]})}):null}function Hm({icon:a,label:n,value:r,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a&&e.jsx(a,{className:"h-3 w-3"}),n]}),e.jsx("div",{className:I("text-sm",c&&"font-mono",!r&&"text-muted-foreground"),children:r||"-"})]})}function gk({open:a,onOpenChange:n,chatList:r,onSuccess:c}){const[d,u]=m.useState({content:"",meaning:"",chat_id:"",is_global:!1}),[h,f]=m.useState(!1),{toast:p}=Ys(),g=async()=>{if(!d.content||!d.chat_id){p({title:"",description:"",variant:"destructive"});return}try{f(!0),await ok(d),p({title:"",description:""}),u({content:"",meaning:"",chat_id:"",is_global:!1}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return e.jsx(Ps,{open:a,onOpenChange:n,children:e.jsxs(Ds,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"content",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ae,{id:"content",value:d.content,onChange:N=>u({...d,content:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"meaning",children:""}),e.jsx(ot,{id:"meaning",value:d.meaning||"",onChange:N=>u({...d,meaning:N.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"chat_id",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Pe,{value:d.chat_id,onValueChange:N=>u({...d,chat_id:N}),children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:""})}),e.jsx(Be,{children:r.map(N=>e.jsx(Z,{value:N.chat_id,children:N.chat_name},N.chat_id))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"is_global",checked:d.is_global,onCheckedChange:N=>u({...d,is_global:N})}),e.jsx(T,{htmlFor:"is_global",children:""})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>n(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})})}function jk({jargon:a,open:n,onOpenChange:r,chatList:c,onSuccess:d}){const[u,h]=m.useState({}),[f,p]=m.useState(!1),{toast:g}=Ys();m.useEffect(()=>{a&&h({content:a.content,meaning:a.meaning||"",chat_id:a.stream_id||a.chat_id,is_global:a.is_global,is_jargon:a.is_jargon})},[a]);const N=async()=>{if(a)try{p(!0),await dk(a.id,u),g({title:"",description:""}),d()}catch(v){g({title:"",description:v instanceof Error?v.message:"",variant:"destructive"})}finally{p(!1)}};return a?e.jsx(Ps,{open:n,onOpenChange:r,children:e.jsxs(Ds,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_content",children:""}),e.jsx(ae,{id:"edit_content",value:u.content||"",onChange:v=>h({...u,content:v.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_meaning",children:""}),e.jsx(ot,{id:"edit_meaning",value:u.meaning||"",onChange:v=>h({...u,meaning:v.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_chat_id",children:""}),e.jsxs(Pe,{value:u.chat_id||"",onValueChange:v=>h({...u,chat_id:v}),children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:""})}),e.jsx(Be,{children:c.map(v=>e.jsx(Z,{value:v.chat_id,children:v.chat_name},v.chat_id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:u.is_jargon===null?"null":u.is_jargon?.toString()||"null",onValueChange:v=>h({...u,is_jargon:v==="null"?null:v==="true"}),children:[e.jsx($e,{children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"null",children:""}),e.jsx(Z,{value:"true",children:""}),e.jsx(Z,{value:"false",children:""})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"edit_is_global",checked:u.is_global,onCheckedChange:v=>h({...u,is_global:v})}),e.jsx(T,{htmlFor:"edit_is_global",children:""})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:N,disabled:f,children:f?"...":""})]})]})}):null}const si="/api/webui/person";async function vk(a){const n=new URLSearchParams;a.page&&n.append("page",a.page.toString()),a.page_size&&n.append("page_size",a.page_size.toString()),a.search&&n.append("search",a.search),a.is_known!==void 0&&n.append("is_known",a.is_known.toString()),a.platform&&n.append("platform",a.platform);const r=await _e(`${si}/list?${n}`,{headers:Hs()});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function Nk(a){const n=await _e(`${si}/${a}`,{headers:Hs()});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}async function bk(a,n){const r=await _e(`${si}/${a}`,{method:"PATCH",headers:Hs(),body:JSON.stringify(n)});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function yk(a){const n=await _e(`${si}/${a}`,{method:"DELETE",headers:Hs()});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}async function wk(){const a=await _e(`${si}/stats/summary`,{headers:Hs()});if(!a.ok){const n=await a.json();throw new Error(n.detail||"")}return a.json()}async function _k(a){const n=await _e(`${si}/batch/delete`,{method:"POST",headers:Hs(),body:JSON.stringify({person_ids:a})});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}function Sk(){const[a,n]=m.useState([]),[r,c]=m.useState(!0),[d,u]=m.useState(0),[h,f]=m.useState(1),[p,g]=m.useState(20),[N,v]=m.useState(""),[w,b]=m.useState(void 0),[y,O]=m.useState(void 0),[R,S]=m.useState(null),[B,E]=m.useState(!1),[C,A]=m.useState(!1),[F,L]=m.useState(null),[J,U]=m.useState({total:0,known:0,unknown:0,platforms:{}}),[oe,Ne]=m.useState(new Set),[je,re]=m.useState(!1),[fe,ge]=m.useState(""),{toast:M}=Ys(),K=async()=>{try{c(!0);const W=await vk({page:h,page_size:p,search:N||void 0,is_known:w,platform:y});n(W.data),u(W.total)}catch(W){M({title:"",description:W instanceof Error?W.message:"",variant:"destructive"})}finally{c(!1)}},P=async()=>{try{const W=await wk();W?.data&&U(W.data)}catch(W){console.error(":",W)}};m.useEffect(()=>{K(),P()},[h,p,N,w,y]);const ue=async W=>{try{const Y=await Nk(W.person_id);S(Y.data),E(!0)}catch(Y){M({title:"",description:Y instanceof Error?Y.message:"",variant:"destructive"})}},Q=W=>{S(W),A(!0)},Se=async W=>{try{await yk(W.person_id),M({title:"",description:`: ${W.person_name||W.nickname||W.user_id}`}),L(null),K(),P()}catch(Y){M({title:"",description:Y instanceof Error?Y.message:"",variant:"destructive"})}},pe=m.useMemo(()=>Object.keys(J.platforms),[J.platforms]),Te=W=>{const Y=new Set(oe);Y.has(W)?Y.delete(W):Y.add(W),Ne(Y)},z=()=>{oe.size===a.length&&a.length>0?Ne(new Set):Ne(new Set(a.map(W=>W.person_id)))},D=()=>{if(oe.size===0){M({title:"",description:"",variant:"destructive"});return}re(!0)},G=async()=>{try{const W=await _k(Array.from(oe));M({title:"",description:W.message}),Ne(new Set),re(!1),K(),P()}catch(W){M({title:"",description:W instanceof Error?W.message:"",variant:"destructive"})}},de=()=>{const W=parseInt(fe),Y=Math.ceil(d/p);W>=1&&W<=Y?(f(W),ge("")):M({title:"",description:`1-${Y}`,variant:"destructive"})},Re=W=>W?new Date(W*1e3).toLocaleString("zh-CN"):"-";return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(ic,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]})})}),e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:J.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-green-600",children:J.known})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-muted-foreground",children:J.unknown})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative mt-1.5",children:[e.jsx(Tt,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{id:"search",placeholder:"ID...",value:N,onChange:W=>v(W.target.value),className:"pl-9"})]})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"filter-known",children:""}),e.jsxs(Pe,{value:w===void 0?"all":w.toString(),onValueChange:W=>{b(W==="all"?void 0:W==="true"),f(1)},children:[e.jsx($e,{id:"filter-known",className:"mt-1.5",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"true",children:""}),e.jsx(Z,{value:"false",children:""})]})]})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"filter-platform",children:""}),e.jsxs(Pe,{value:y||"all",onValueChange:W=>{O(W==="all"?void 0:W),f(1)},children:[e.jsx($e,{id:"filter-platform",className:"mt-1.5",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"all",children:""}),pe.map(W=>e.jsxs(Z,{value:W,children:[W," (",J.platforms[W],")"]},W))]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:oe.size>0&&e.jsxs("span",{children:[" ",oe.size," "]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:p.toString(),onValueChange:W=>{g(parseInt(W)),f(1),Ne(new Set)},children:[e.jsx($e,{id:"page-size",className:"w-20",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"10",children:"10"}),e.jsx(Z,{value:"20",children:"20"}),e.jsx(Z,{value:"50",children:"50"}),e.jsx(Z,{value:"100",children:"100"})]})]}),oe.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Ne(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:D,children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ut,{children:[e.jsx(We,{className:"w-12",children:e.jsx(qs,{checked:a.length>0&&oe.size===a.length,onCheckedChange:z,"aria-label":""})}),e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{children:"ID"}),e.jsx(We,{children:""}),e.jsx(We,{className:"text-right",children:""})]})}),e.jsx(Bl,{children:r?e.jsx(ut,{children:e.jsx(Ke,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"..."})}):a.length===0?e.jsx(ut,{children:e.jsx(Ke,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:""})}):a.map(W=>e.jsxs(ut,{children:[e.jsx(Ke,{children:e.jsx(qs,{checked:oe.has(W.person_id),onCheckedChange:()=>Te(W.person_id),"aria-label":` ${W.person_name||W.nickname||W.user_id}`})}),e.jsx(Ke,{children:e.jsx("div",{className:I("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",W.is_known?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:W.is_known?"":""})}),e.jsx(Ke,{className:"font-medium",children:W.person_name||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Ke,{children:W.nickname||"-"}),e.jsx(Ke,{children:W.platform}),e.jsx(Ke,{className:"font-mono text-sm",children:W.user_id}),e.jsx(Ke,{className:"text-sm text-muted-foreground",children:Re(W.last_know)}),e.jsx(Ke,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>ue(W),children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"default",size:"sm",onClick:()=>Q(W),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>L(W),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})})]},W.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):a.map(W=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qs,{checked:oe.has(W.person_id),onCheckedChange:()=>Te(W.person_id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:I("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium mb-2",W.is_known?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:W.is_known?"":""}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-1 w-full break-all",children:W.person_name||e.jsx("span",{className:"text-muted-foreground",children:""})}),W.nickname&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-1 w-full break-all",children:[": ",W.nickname]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"font-medium text-xs",children:W.platform})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"ID"}),e.jsx("p",{className:"font-mono text-xs truncate",title:W.user_id,children:W.user_id})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-xs",children:Re(W.last_know)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t overflow-hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>ue(W),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(ia,{className:"h-3 w-3 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Q(W),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(Jn,{className:"h-3 w-3 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>L(W),className:"text-xs px-2 py-1 h-auto flex-shrink-0 text-destructive hover:text-destructive",children:[e.jsx(ns,{className:"h-3 w-3 mr-1"}),""]})]})]},W.id))}),d>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",d,"  ",h," / ",Math.ceil(d/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Da,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"number",value:fe,onChange:W=>ge(W.target.value),onKeyDown:W=>W.key==="Enter"&&de(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(d/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:de,disabled:!fe,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(d/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(Wt,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(d/p)),disabled:h>=Math.ceil(d/p),className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(kk,{person:R,open:B,onOpenChange:E}),e.jsx(Ck,{person:R,open:C,onOpenChange:A,onSuccess:()=>{K(),P(),A(!1)}}),e.jsx(Ns,{open:!!F,onOpenChange:()=>L(null),children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[' "',F?.person_name||F?.nickname||F?.user_id,'"  ']})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:()=>F&&Se(F),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(Ns,{open:je,onOpenChange:re,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:[" ",oe.size,"  "]})]}),e.jsxs(xs,{children:[e.jsx(gs,{children:""}),e.jsx(ps,{onClick:G,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})]})}function kk({person:a,open:n,onOpenChange:r}){if(!a)return null;const c=d=>d?new Date(d*1e3).toLocaleString("zh-CN"):"-";return e.jsx(Ps,{open:n,onOpenChange:r,children:e.jsxs(Ds,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsxs(Ks,{children:[" ",a.person_name||a.nickname||a.user_id," "]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Rl,{icon:jn,label:"",value:a.person_name}),e.jsx(Rl,{icon:Ra,label:"",value:a.nickname}),e.jsx(Rl,{icon:Jr,label:"ID",value:a.user_id,mono:!0}),e.jsx(Rl,{icon:Jr,label:"ID",value:a.person_id,mono:!0}),e.jsx(Rl,{label:"",value:a.platform}),e.jsx(Rl,{label:"",value:a.is_known?"":""})]}),a.name_reason&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"mt-1 text-sm",children:a.name_reason})]}),a.memory_points&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"mt-1 text-sm whitespace-pre-wrap",children:a.memory_points})]}),a.group_nick_name&&a.group_nick_name.length>0&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"mt-2 space-y-1",children:a.group_nick_name.map((d,u)=>e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-xs text-muted-foreground",children:d.group_id}),e.jsx("span",{children:""}),e.jsx("span",{children:d.group_nick_name})]},u))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Rl,{icon:na,label:"",value:c(a.know_times)}),e.jsx(Rl,{icon:na,label:"",value:c(a.know_since)}),e.jsx(Rl,{icon:na,label:"",value:c(a.last_know)})]})]}),e.jsx(st,{children:e.jsx(_,{onClick:()=>r(!1),children:""})})]})})}function Rl({icon:a,label:n,value:r,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a&&e.jsx(a,{className:"h-3 w-3"}),n]}),e.jsx("div",{className:I("text-sm",c&&"font-mono",!r&&"text-muted-foreground"),children:r||"-"})]})}function Ck({person:a,open:n,onOpenChange:r,onSuccess:c}){const[d,u]=m.useState({}),[h,f]=m.useState(!1),{toast:p}=Ys();m.useEffect(()=>{a&&u({person_name:a.person_name||"",name_reason:a.name_reason||"",nickname:a.nickname||"",is_known:a.is_known})},[a]);const g=async()=>{if(a)try{f(!0),await bk(a.person_id,d),p({title:"",description:""}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return a?e.jsx(Ps,{open:n,onOpenChange:r,children:e.jsxs(Ds,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsxs(Ks,{children:[" ",a.person_name||a.nickname||a.user_id," "]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"person_name",children:""}),e.jsx(ae,{id:"person_name",value:d.person_name||"",onChange:N=>u({...d,person_name:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"nickname",children:""}),e.jsx(ae,{id:"nickname",value:d.nickname||"",onChange:N=>u({...d,nickname:N.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"name_reason",children:""}),e.jsx(ot,{id:"name_reason",value:d.name_reason||"",onChange:N=>u({...d,name_reason:N.target.value}),placeholder:"",rows:2})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"is_known",className:"text-base font-medium",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"is_known",checked:d.is_known,onCheckedChange:N=>u({...d,is_known:N})})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})}):null}var Tk=j1();const Yg=lw(Tk),yx="/api/webui";async function Ek(a=100,n="all"){const r=`${yx}/knowledge/graph?limit=${a}&node_type=${n}`,c=await fetch(r);if(!c.ok)throw new Error(`: ${c.status}`);return c.json()}async function Mk(){const a=await fetch(`${yx}/knowledge/stats`);if(!a.ok)throw new Error("");return a.json()}async function Ak(a){const n=await fetch(`${yx}/knowledge/search?query=${encodeURIComponent(a)}`);if(!n.ok)throw new Error("");return n.json()}const sN=m.memo(({data:a})=>e.jsxs("div",{className:"px-4 py-2 shadow-md rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 border-2 border-blue-700 min-w-[120px]",children:[e.jsx(Ko,{type:"target",position:Qo.Top}),e.jsx("div",{className:"font-semibold text-white text-sm truncate max-w-[200px]",title:a.content,children:a.label}),e.jsx(Ko,{type:"source",position:Qo.Bottom})]}));sN.displayName="EntityNode";const tN=m.memo(({data:a})=>e.jsxs("div",{className:"px-3 py-2 shadow-md rounded-md bg-gradient-to-br from-green-500 to-green-600 border-2 border-green-700 min-w-[100px]",children:[e.jsx(Ko,{type:"target",position:Qo.Top}),e.jsx("div",{className:"font-medium text-white text-xs truncate max-w-[150px]",title:a.content,children:a.label}),e.jsx(Ko,{type:"source",position:Qo.Bottom})]}));tN.displayName="ParagraphNode";const zk={entity:sN,paragraph:tN};function Rk(a,n){const r=new Yg.graphlib.Graph;r.setDefaultEdgeLabel(()=>({})),r.setGraph({rankdir:"TB",ranksep:100,nodesep:80});const c=[],d=[];return a.forEach(u=>{r.setNode(u.id,{width:150,height:50})}),n.forEach(u=>{r.setEdge(u.source,u.target)}),Yg.layout(r),a.forEach(u=>{const h=r.node(u.id);c.push({id:u.id,type:u.type,position:{x:h.x-75,y:h.y-25},data:{label:u.content.slice(0,20)+(u.content.length>20?"...":""),content:u.content}})}),n.forEach((u,h)=>{const f={id:`edge-${h}`,source:u.source,target:u.target,animated:a.length<=200&&u.weight>5,style:{strokeWidth:Math.min(u.weight/2,5),opacity:.6}};u.weight>10&&a.length<100&&(f.label=`${u.weight.toFixed(0)}`),d.push(f)}),{nodes:c,edges:d}}function Dk(){const a=ca(),[n,r]=m.useState(!1),[c,d]=m.useState(null),[u,h]=m.useState(""),[f,p]=m.useState("all"),[g,N]=m.useState(50),[v,w]=m.useState("50"),[b,y]=m.useState(!1),[O,R]=m.useState(!0),[S,B]=m.useState(!1),[E,C]=m.useState(!1),[A,F,L]=v1([]),[J,U,oe]=N1([]),[Ne,je]=m.useState(0),[re,fe]=m.useState(null),[ge,M]=m.useState(null),{toast:K}=Ys(),P=m.useCallback(G=>G.type==="entity"?"#6366f1":G.type==="paragraph"?"#10b981":"#6b7280",[]),ue=m.useCallback(async(G=!1)=>{try{if(!G&&g>200){C(!0);return}r(!0);const[de,Re]=await Promise.all([Ek(g,f),Mk()]);if(d(Re),de.nodes.length===0){K({title:"",description:""}),F([]),U([]);return}const{nodes:W,edges:Y}=Rk(de.nodes,de.edges);F(W),U(Y),je(W.length),Re&&Re.total_nodes>g&&K({title:"",description:` ${Re.total_nodes}  ${W.length} `}),K({title:"",description:` ${W.length} ${Y.length} `})}catch(de){console.error(":",de),K({title:"",description:de instanceof Error?de.message:"",variant:"destructive"})}finally{r(!1)}},[g,f,K]),Q=m.useCallback(async()=>{if(!u.trim()){K({title:"",description:""});return}try{const G=await Ak(u);if(G.length===0){K({title:"",description:""});return}const de=new Set(G.map(Re=>Re.id));F(Re=>Re.map(W=>({...W,style:{...W.style,opacity:de.has(W.id)?1:.3,filter:de.has(W.id)?"brightness(1.2)":"brightness(0.8)"}}))),K({title:"",description:` ${G.length} `})}catch(G){console.error(":",G),K({title:"",description:G instanceof Error?G.message:"",variant:"destructive"})}},[u,K]),Se=m.useCallback(()=>{F(G=>G.map(de=>({...de,style:{...de.style,opacity:1,filter:"brightness(1)"}})))},[]),pe=m.useCallback(()=>{R(!1),B(!0),ue()},[ue]),Te=m.useCallback(()=>{C(!1),setTimeout(()=>{ue(!0)},0)},[ue]),z=m.useCallback((G,de)=>{A.find(W=>W.id===de.id)&&fe({id:de.id,type:de.type,content:de.data.content})},[A]);m.useEffect(()=>{O||S&&ue()},[g,f,O,S]);const D=m.useCallback((G,de)=>{const Re=A.find(Fe=>Fe.id===de.source),W=A.find(Fe=>Fe.id===de.target),Y=J.find(Fe=>Fe.id===de.id);Re&&W&&Y&&M({source:{id:Re.id,type:Re.type,content:Re.data.content},target:{id:W.id,type:W.type,content:W.data.content},edge:{source:de.source,target:de.target,weight:parseFloat(de.label||"0")}})},[A,J]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b bg-background",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1",children:""})]}),c&&e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(Yr,{className:"h-3 w-3"}),": ",c.total_nodes]}),e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(rv,{className:"h-3 w-3"}),": ",c.total_edges]}),e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(Ft,{className:"h-3 w-3"}),": ",c.entity_nodes]}),e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(Ea,{className:"h-3 w-3"}),": ",c.paragraph_nodes]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-4",children:[e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx(ae,{placeholder:"...",value:u,onChange:G=>h(G.target.value),onKeyDown:G=>G.key==="Enter"&&Q(),className:"flex-1"}),e.jsx(_,{onClick:Q,size:"sm",children:e.jsx(Tt,{className:"h-4 w-4"})}),e.jsx(_,{onClick:Se,variant:"outline",size:"sm",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Pe,{value:f,onValueChange:G=>p(G),children:[e.jsx($e,{className:"w-[120px]",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"entity",children:""}),e.jsx(Z,{value:"paragraph",children:""})]})]}),e.jsxs(Pe,{value:g===1e4?"all":b?"custom":g.toString(),onValueChange:G=>{G==="custom"?(y(!0),w(g.toString())):G==="all"?(y(!1),N(1e4)):(y(!1),N(Number(G)))},children:[e.jsx($e,{className:"w-[120px]",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"50",children:"50 "}),e.jsx(Z,{value:"100",children:"100 "}),e.jsx(Z,{value:"200",children:"200 "}),e.jsx(Z,{value:"500",children:"500 "}),e.jsx(Z,{value:"1000",children:"1000 "}),e.jsx(Z,{value:"all",children:" (10000)"}),e.jsx(Z,{value:"custom",children:"..."})]})]}),b&&e.jsx(ae,{type:"number",min:"50",value:v,onChange:G=>w(G.target.value),onBlur:()=>{const G=parseInt(v);!isNaN(G)&&G>=50?N(G):(w("50"),N(50))},onKeyDown:G=>{if(G.key==="Enter"){const de=parseInt(v);!isNaN(de)&&de>=50?N(de):(w("50"),N(50))}},placeholder:"50",className:"w-[120px]"}),e.jsx(_,{onClick:()=>ue(),variant:"outline",size:"sm",disabled:n,children:e.jsx(dt,{className:I("h-4 w-4",n&&"animate-spin")})})]})]})]}),e.jsx("div",{className:"flex-1 relative",children:n?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(dt,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]})}):A.length===0?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Yr,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-muted-foreground",children:""})]})}):e.jsxs(b1,{nodes:A,edges:J,onNodesChange:L,onEdgesChange:oe,onNodeClick:z,onEdgeClick:D,nodeTypes:zk,fitView:!0,minZoom:.05,maxZoom:1.5,defaultViewport:{x:0,y:0,zoom:.5},elevateNodesOnSelect:Ne<=500,nodesDraggable:Ne<=1e3,attributionPosition:"bottom-left",children:[e.jsx(y1,{variant:w1.Dots,gap:12,size:1}),e.jsx(_1,{}),Ne<=500&&e.jsx(S1,{nodeColor:P,nodeBorderRadius:8,pannable:!0,zoomable:!0}),e.jsxs(k1,{position:"top-right",className:"bg-background/95 backdrop-blur-sm rounded-lg border p-3 shadow-lg",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:""}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-blue-500 to-blue-600 border-2 border-blue-700"}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-green-500 to-green-600 border-2 border-green-700"}),e.jsx("span",{children:""})]}),Ne>200&&e.jsxs("div",{className:"mt-2 pt-2 border-t text-yellow-600 dark:text-yellow-500",children:[e.jsx("div",{className:"font-semibold",children:""}),e.jsx("div",{children:""}),Ne>500&&e.jsx("div",{children:""})]})]})]})]})}),e.jsx(Ps,{open:!!re,onOpenChange:G=>!G&&fe(null),children:e.jsxs(Ds,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Os,{children:e.jsx(Ls,{children:""})}),re&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(ke,{variant:re.type==="entity"?"default":"secondary",children:re.type==="entity"?" ":" "})})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"ID"}),e.jsx("code",{className:"mt-1 block p-2 bg-muted rounded text-xs break-all",children:re.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx(Je,{className:"mt-1 h-40 p-3 bg-muted rounded",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:re.content})})]})]})]})}),e.jsx(Ps,{open:!!ge,onOpenChange:G=>!G&&M(null),children:e.jsxs(Ds,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx(Os,{children:e.jsx(Ls,{children:""})}),ge&&e.jsx(Je,{className:"flex-1 pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0 p-3 bg-blue-50 dark:bg-blue-950 rounded border-2 border-blue-200 dark:border-blue-800",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"font-medium text-sm mb-2 truncate",children:ge.source.content}),e.jsxs("code",{className:"text-xs text-muted-foreground truncate block",children:[ge.source.id.slice(0,40),"..."]})]}),e.jsx("div",{className:"text-2xl text-muted-foreground flex-shrink-0",children:""}),e.jsxs("div",{className:"flex-1 min-w-0 p-3 bg-green-50 dark:bg-green-950 rounded border-2 border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"font-medium text-sm mb-2 truncate",children:ge.target.content}),e.jsxs("code",{className:"text-xs text-muted-foreground truncate block",children:[ge.target.id.slice(0,40),"..."]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(ke,{variant:"outline",className:"text-base font-mono",children:ge.edge.weight.toFixed(4)})})]})]})})]})}),e.jsx(Ns,{open:O,onOpenChange:R,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:""}),e.jsxs(fs,{children:["",e.jsx("br",{}),"?"]})]}),e.jsxs(xs,{children:[e.jsx(gs,{onClick:()=>a({to:"/"}),children:" ()"}),e.jsx(ps,{onClick:pe,children:""})]})]})}),e.jsx(Ns,{open:E,onOpenChange:C,children:e.jsxs(us,{children:[e.jsxs(ms,{children:[e.jsx(hs,{children:" "}),e.jsx(fs,{asChild:!0,children:e.jsxs("div",{children:[e.jsxs("p",{children:[" ",e.jsx("strong",{className:"text-orange-600",children:g>=1e4?" (10000)":g})," "]}),e.jsx("p",{className:"mt-4",children:":"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:""})]}),e.jsx("p",{className:"mt-4",children:" (50-200 )"})]})})]}),e.jsxs(xs,{children:[e.jsx(gs,{onClick:()=>{C(!1),g>200&&(N(50),y(!1))},children:""}),e.jsx(ps,{onClick:Te,className:"bg-orange-600 hover:bg-orange-700",children:""})]})]})})]})}function Ok(){return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-none border-b bg-card/50 px-6 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:""}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:""})]})})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsx("div",{className:"mx-auto max-w-4xl",children:e.jsxs(Ce,{children:[e.jsxs(De,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-20 w-20 items-center justify-center rounded-full bg-primary/10",children:e.jsx(Yr,{className:"h-10 w-10 text-primary"})}),e.jsx(Oe,{className:"text-2xl",children:""}),e.jsx(os,{className:"text-base",children:""})]}),e.jsx(Me,{className:"text-center text-sm text-muted-foreground",children:e.jsx("p",{children:""})})]})})})]})}function Jg({className:a,classNames:n,showOutsideDays:r=!0,captionLayout:c="label",buttonVariant:d="ghost",formatters:u,components:h,...f}){const p=yv();return e.jsx(u1,{showOutsideDays:r,className:I("bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,a),captionLayout:c,formatters:{formatMonthDropdown:g=>g.toLocaleString("default",{month:"short"}),...u},classNames:{root:I("w-fit",p.root),months:I("relative flex flex-col gap-4 md:flex-row",p.months),month:I("flex w-full flex-col gap-4",p.month),nav:I("absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1",p.nav),button_previous:I(Zr({variant:d}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",p.button_previous),button_next:I(Zr({variant:d}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",p.button_next),month_caption:I("flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]",p.month_caption),dropdowns:I("flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium",p.dropdowns),dropdown_root:I("has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border",p.dropdown_root),dropdown:I("bg-popover absolute inset-0 opacity-0",p.dropdown),caption_label:I("select-none font-medium",c==="label"?"text-sm":"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5",p.caption_label),table:"w-full border-collapse",weekdays:I("flex",p.weekdays),weekday:I("text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal",p.weekday),week:I("mt-2 flex w-full",p.week),week_number_header:I("w-[--cell-size] select-none",p.week_number_header),week_number:I("text-muted-foreground select-none text-[0.8rem]",p.week_number),day:I("group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md",p.day),range_start:I("bg-accent rounded-l-md",p.range_start),range_middle:I("rounded-none",p.range_middle),range_end:I("bg-accent rounded-r-md",p.range_end),today:I("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",p.today),outside:I("text-muted-foreground aria-selected:text-muted-foreground",p.outside),disabled:I("text-muted-foreground opacity-50",p.disabled),hidden:I("invisible",p.hidden),...n},components:{Root:({className:g,rootRef:N,...v})=>e.jsx("div",{"data-slot":"calendar",ref:N,className:I(g),...v}),Chevron:({className:g,orientation:N,...v})=>N==="left"?e.jsx(Da,{className:I("size-4",g),...v}):N==="right"?e.jsx(Wt,{className:I("size-4",g),...v}):e.jsx(za,{className:I("size-4",g),...v}),DayButton:Lk,WeekNumber:({children:g,...N})=>e.jsx("td",{...N,children:e.jsx("div",{className:"flex size-[--cell-size] items-center justify-center text-center",children:g})}),...h},...f})}function Lk({className:a,day:n,modifiers:r,...c}){const d=yv(),u=m.useRef(null);return m.useEffect(()=>{r.focused&&u.current?.focus()},[r.focused]),e.jsx(_,{ref:u,variant:"ghost",size:"icon","data-day":n.date.toLocaleDateString(),"data-selected-single":r.selected&&!r.range_start&&!r.range_end&&!r.range_middle,"data-range-start":r.range_start,"data-range-end":r.range_end,"data-range-middle":r.range_middle,className:I("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70",d.day,a),...c})}const Oo={xs:{label:"",rowHeight:28,class:"text-[10px] sm:text-xs"},sm:{label:"",rowHeight:36,class:"text-xs sm:text-sm"},base:{label:"",rowHeight:44,class:"text-sm sm:text-base"}};function Uk(){const[a,n]=m.useState([]),[r,c]=m.useState(""),[d,u]=m.useState("all"),[h,f]=m.useState("all"),[p,g]=m.useState(void 0),[N,v]=m.useState(void 0),[w,b]=m.useState(!0),[y,O]=m.useState(!1),[R,S]=m.useState("xs"),[B,E]=m.useState(4),[C,A]=m.useState(!1),F=m.useRef(null);m.useEffect(()=>{const Q=Hn.getAllLogs();n(Q);const Se=Hn.onLog(()=>{n(Hn.getAllLogs())}),pe=Hn.onConnectionChange(Te=>{O(Te)});return()=>{Se(),pe()}},[]);const L=m.useMemo(()=>{const Q=new Set(a.map(Se=>Se.module).filter(Se=>Se&&Se.trim()!==""));return Array.from(Q).sort()},[a]),J=Q=>{switch(Q){case"DEBUG":return"text-muted-foreground";case"INFO":return"text-blue-500 dark:text-blue-400";case"WARNING":return"text-yellow-600 dark:text-yellow-500";case"ERROR":return"text-red-600 dark:text-red-500";case"CRITICAL":return"text-red-700 dark:text-red-400 font-bold";default:return"text-foreground"}},U=Q=>{switch(Q){case"DEBUG":return"bg-gray-800/30 dark:bg-gray-800/50";case"INFO":return"bg-blue-900/20 dark:bg-blue-500/20";case"WARNING":return"bg-yellow-900/20 dark:bg-yellow-500/20";case"ERROR":return"bg-red-900/20 dark:bg-red-500/20";case"CRITICAL":return"bg-red-900/30 dark:bg-red-600/30";default:return"bg-gray-800/20 dark:bg-gray-800/30"}},oe=()=>{window.location.reload()},Ne=()=>{Hn.clearLogs(),n([])},je=()=>{const Q=ge.map(z=>`${z.timestamp} [${z.level.padEnd(8)}] [${z.module}] ${z.message}`).join(`
`),Se=new Blob([Q],{type:"text/plain;charset=utf-8"}),pe=URL.createObjectURL(Se),Te=document.createElement("a");Te.href=pe,Te.download=`logs-${Tm(new Date,"yyyy-MM-dd-HHmmss")}.txt`,Te.click(),URL.revokeObjectURL(pe)},re=()=>{b(!w)},fe=()=>{g(void 0),v(void 0)},ge=m.useMemo(()=>a.filter(Q=>{const Se=r===""||Q.message.toLowerCase().includes(r.toLowerCase())||Q.module.toLowerCase().includes(r.toLowerCase()),pe=d==="all"||Q.level===d,Te=h==="all"||Q.module===h;let z=!0;if(p||N){const D=new Date(Q.timestamp);if(p){const G=new Date(p);G.setHours(0,0,0,0),z=z&&D>=G}if(N){const G=new Date(N);G.setHours(23,59,59,999),z=z&&D<=G}}return Se&&pe&&Te&&z}),[a,r,d,h,p,N]),M=Oo[R].rowHeight+B,K=Y0({count:ge.length,getScrollElement:()=>F.current,estimateSize:()=>M,overscan:50}),P=m.useRef(!1),ue=m.useRef(ge.length);return m.useEffect(()=>{const Q=F.current;if(!Q)return;const Se=()=>{if(P.current)return;const{scrollTop:pe,scrollHeight:Te,clientHeight:z}=Q,D=Te-pe-z;D>100&&w?b(!1):D<50&&!w&&b(!0)};return Q.addEventListener("scroll",Se,{passive:!0}),()=>Q.removeEventListener("scroll",Se)},[w]),m.useEffect(()=>{const Q=ge.length>ue.current;ue.current=ge.length,w&&ge.length>0&&Q&&(P.current=!0,K.scrollToIndex(ge.length-1,{align:"end",behavior:"auto"}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{P.current=!1})}))},[ge.length,w,K]),e.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 space-y-2 sm:space-y-3 p-2 sm:p-3 lg:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 hidden sm:block",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:I("h-2 w-2 sm:h-2.5 sm:w-2.5 rounded-full",y?"bg-green-500 animate-pulse":"bg-red-500")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:y?"":""})]})]}),e.jsx(Ce,{className:"p-2 sm:p-3",children:e.jsx(uc,{open:C,onOpenChange:A,children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative min-w-0",children:[e.jsx(Tt,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:r,onChange:Q=>c(Q.target.value),className:"pl-8 h-8 text-xs sm:text-sm"})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(_,{variant:w?"default":"outline",size:"sm",onClick:re,className:"h-8 px-2",title:w?"":"",children:[w?e.jsx(D_,{className:"h-3.5 w-3.5"}):e.jsx(O_,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden sm:inline",children:w?"":""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:Ne,className:"h-8 px-2",title:"",children:[e.jsx(ns,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden md:inline",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:je,className:"h-8 px-2 hidden sm:flex",title:"",children:[e.jsx(Xt,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden lg:inline",children:""})]}),e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"h-8 px-2",title:C?"":"",children:[e.jsx(Bo,{className:"h-3.5 w-3.5"}),C?e.jsx(Qr,{className:"h-3.5 w-3.5 ml-1"}):e.jsx(za,{className:"h-3.5 w-3.5 ml-1"})]})})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center sm:text-right -mt-1",children:[e.jsxs("span",{className:"font-mono",children:[ge.length," / ",a.length]}),e.jsx("span",{className:"ml-1",children:""})]}),e.jsxs(xc,{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-2",children:[e.jsxs(Pe,{value:d,onValueChange:u,children:[e.jsxs($e,{className:"w-full sm:flex-1 h-8 text-xs",children:[e.jsx(Bo,{className:"h-3.5 w-3.5 mr-1.5"}),e.jsx(Ie,{placeholder:""})]}),e.jsxs(Be,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"DEBUG",children:"DEBUG"}),e.jsx(Z,{value:"INFO",children:"INFO"}),e.jsx(Z,{value:"WARNING",children:"WARNING"}),e.jsx(Z,{value:"ERROR",children:"ERROR"}),e.jsx(Z,{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsxs(Pe,{value:h,onValueChange:f,children:[e.jsxs($e,{className:"w-full sm:flex-1 h-8 text-xs",children:[e.jsx(Bo,{className:"h-3.5 w-3.5 mr-1.5"}),e.jsx(Ie,{placeholder:""})]}),e.jsxs(Be,{children:[e.jsx(Z,{value:"all",children:""}),L.map(Q=>e.jsx(Z,{value:Q,children:Q},Q))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-2",children:[e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:I("w-full sm:flex-1 justify-start text-left font-normal h-8",!p&&"text-muted-foreground"),children:[e.jsx(Go,{className:"mr-1.5 h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:p?Tm(p,"PP",{locale:Ro}):""})]})}),e.jsx(sl,{className:"w-auto p-0",align:"start",children:e.jsx(Jg,{mode:"single",selected:p,onSelect:g,initialFocus:!0,locale:Ro})})]}),e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:I("w-full sm:flex-1 justify-start text-left font-normal h-8",!N&&"text-muted-foreground"),children:[e.jsx(Go,{className:"mr-1.5 h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:N?Tm(N,"PP",{locale:Ro}):""})]})}),e.jsx(sl,{className:"w-auto p-0",align:"start",children:e.jsx(Jg,{mode:"single",selected:N,onSelect:v,initialFocus:!0,locale:Ro})})]}),(p||N)&&e.jsxs(_,{variant:"outline",size:"sm",onClick:fe,className:"w-full sm:w-auto h-8",children:[e.jsx(Aa,{className:"h-3.5 w-3.5 sm:mr-1"}),e.jsx("span",{className:"text-xs",children:""})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3 pt-2 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(L_,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:""})]}),e.jsx("div",{className:"flex gap-1",children:Object.keys(Oo).map(Q=>e.jsx(_,{variant:R===Q?"default":"outline",size:"sm",onClick:()=>S(Q),className:"h-6 px-2 text-xs",children:Oo[Q].label},Q))})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 max-w-[200px]",children:[e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:""}),e.jsx(Qa,{value:[B],onValueChange:([Q])=>E(Q),min:0,max:12,step:2,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground w-7",children:[B,"px"]})]}),e.jsxs("div",{className:"flex gap-2 sm:hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:oe,className:"flex-1 h-8",children:[e.jsx(dt,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{className:"text-xs",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:je,className:"flex-1 h-8",children:[e.jsx(Xt,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{className:"text-xs",children:""})]})]})]})]})]})})})]}),e.jsx("div",{className:"flex-1 min-h-0 px-2 sm:px-3 lg:px-4 pb-2 sm:pb-3 lg:pb-4",children:e.jsx(Ce,{className:"bg-black dark:bg-gray-950 border-gray-800 dark:border-gray-900 h-full overflow-hidden",children:e.jsx("div",{ref:F,className:I("h-full overflow-auto","[&::-webkit-scrollbar]:w-2.5","[&::-webkit-scrollbar-track]:bg-transparent","[&::-webkit-scrollbar-thumb]:bg-border [&::-webkit-scrollbar-thumb]:rounded-full","[&::-webkit-scrollbar-thumb:hover]:bg-border/80"),children:e.jsx("div",{className:I("p-2 sm:p-3 font-mono relative",Oo[R].class),style:{height:`${K.getTotalSize()}px`},children:ge.length===0?e.jsx("div",{className:"text-gray-500 dark:text-gray-600 text-center py-8 text-xs sm:text-sm",children:""}):K.getVirtualItems().map(Q=>{const Se=ge[Q.index];return e.jsxs("div",{"data-index":Q.index,ref:K.measureElement,className:I("absolute top-0 left-0 w-full px-2 sm:px-3 rounded hover:bg-white/5 transition-colors",U(Se.level)),style:{transform:`translateY(${Q.start}px)`,paddingTop:`${B/2}px`,paddingBottom:`${B/2}px`},children:[e.jsxs("div",{className:"flex flex-col gap-0.5 sm:hidden",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-600 text-[10px]",children:Se.timestamp}),e.jsxs("span",{className:I("font-semibold text-[10px]",J(Se.level)),children:["[",Se.level,"]"]})]}),e.jsx("div",{className:"text-cyan-400 dark:text-cyan-500 truncate text-[10px]",children:Se.module}),e.jsx("div",{className:"text-gray-300 dark:text-gray-400 whitespace-pre-wrap break-words text-[10px]",children:Se.message})]}),e.jsxs("div",{className:"hidden sm:flex gap-2 items-start",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-600 flex-shrink-0 w-[130px] lg:w-[160px]",children:Se.timestamp}),e.jsxs("span",{className:I("flex-shrink-0 w-[65px] lg:w-[75px] font-semibold",J(Se.level)),children:["[",Se.level,"]"]}),e.jsx("span",{className:"text-cyan-400 dark:text-cyan-500 flex-shrink-0 w-[100px] lg:w-[130px] truncate",children:Se.module}),e.jsx("span",{className:"text-gray-300 dark:text-gray-400 flex-1 whitespace-pre-wrap break-words",children:Se.message})]})]},Q.key)})})})})})]})}async function $k(){return(await _e("/api/planner/overview")).json()}async function Bk(a,n=1,r=20,c){const d=new URLSearchParams({page:n.toString(),page_size:r.toString()});return c&&d.append("search",c),(await _e(`/api/planner/chat/${a}/logs?${d}`)).json()}async function Pk(a,n){return(await _e(`/api/planner/log/${a}/${n}`)).json()}async function Ik(){return(await _e("/api/replier/overview")).json()}async function Fk(a,n=1,r=20,c){const d=new URLSearchParams({page:n.toString(),page_size:r.toString()});return c&&d.append("search",c),(await _e(`/api/replier/chat/${a}/logs?${d}`)).json()}async function Hk(a,n){return(await _e(`/api/replier/log/${a}/${n}`)).json()}function aN(){const[a,n]=m.useState(new Map),[r,c]=m.useState(!0),d=m.useCallback(async()=>{try{c(!0);const h=await ux();if(h?.data){const f=new Map;h.data.forEach(p=>{f.set(p.chat_id,p.chat_name)}),n(f)}}catch(h){console.error(":",h)}finally{c(!1)}},[]);m.useEffect(()=>{d()},[d]);const u=m.useCallback(h=>a.get(h)||h,[a]);return{chatNameMap:a,getChatName:u,loading:r,reload:d}}function Jo(a){return new Date(a*1e3).toLocaleString("zh-CN")}function lN(a){const r=Date.now()/1e3-a;return r<60?"":r<3600?`${Math.floor(r/60)} `:r<86400?`${Math.floor(r/3600)} `:`${Math.floor(r/86400)} `}function nN(a,n,r=1e4){m.useEffect(()=>{if(!a)return;const c=setInterval(n,r);return()=>clearInterval(c)},[a,n,r])}function Vk({autoRefresh:a,refreshKey:n}){const[r,c]=m.useState("overview"),[d,u]=m.useState(null),{getChatName:h}=aN(),[f,p]=m.useState(null),[g,N]=m.useState(!0),[v,w]=m.useState(null),[b,y]=m.useState(!1),[O,R]=m.useState(1),[S,B]=m.useState(20),[E,C]=m.useState(""),[A,F]=m.useState(""),[L,J]=m.useState(""),[U,oe]=m.useState(null),[Ne,je]=m.useState(!1),[re,fe]=m.useState(!1),ge=m.useCallback(async()=>{try{N(!0);const D=await $k();p(D)}catch(D){console.error(":",D)}finally{N(!1)}},[]),M=m.useCallback(async()=>{if(d)try{y(!0);const D=await Bk(d.chat_id,O,S,A||void 0);w(D)}catch(D){console.error(":",D)}finally{y(!1)}},[d,O,S,A]);m.useEffect(()=>{ge()},[ge]),m.useEffect(()=>{n>0&&(r==="overview"?ge():M())},[n,r,ge,M]),m.useEffect(()=>{r==="chat-logs"&&d&&M()},[r,d,M]),nN(a,m.useCallback(()=>{r==="overview"?ge():M()},[r,ge,M]));const K=D=>{u(D),R(1),F(""),J(""),c("chat-logs")},P=()=>{c("overview"),u(null),w(null),F(""),J("")},ue=()=>{F(L),R(1)},Q=()=>{J(""),F(""),R(1)},Se=async(D,G)=>{try{fe(!0),je(!0);const de=await Pk(D,G);oe(de)}catch(de){console.error(":",de)}finally{fe(!1)}},pe=D=>{B(Number(D)),R(1)},Te=()=>{const D=parseInt(E),G=v?Math.ceil(v.total/v.page_size):0;!isNaN(D)&&D>=1&&D<=G&&(R(D),C(""))},z=v?Math.ceil(v.total/v.page_size):0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:r==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(Ra,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:g?e.jsx(vs,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_chats||0})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(tx,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:g?e.jsx(vs,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_plans||0})})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsx(os,{children:""})]}),e.jsx(Me,{children:g?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((D,G)=>e.jsx(vs,{className:"h-24 w-full"},G))}):f?.chats&&f.chats.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:f.chats.map(D=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>K(D),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ra,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[180px]",title:h(D.chat_id),children:h(D.chat_id)})]}),e.jsx(ke,{variant:"secondary",children:D.plan_count})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[": ",lN(D.latest_timestamp)]})]},D.chat_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 mb-4",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:P,children:[e.jsx(Ma,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium",children:d?h(d.chat_id):""}),e.jsx("span",{className:"mx-2",children:""})," ",v?.total||0," "]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(Oe,{children:""}),e.jsx(os,{children:d?h(d.chat_id):""})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ae,{placeholder:"...",value:L,onChange:D=>J(D.target.value),onKeyDown:D=>D.key==="Enter"&&ue(),className:"w-full sm:w-48"}),e.jsx(_,{variant:"outline",size:"icon",onClick:ue,children:e.jsx(Tt,{className:"h-4 w-4"})}),A&&e.jsx(_,{variant:"ghost",size:"sm",onClick:Q,children:""})]}),e.jsxs(Pe,{value:S.toString(),onValueChange:pe,children:[e.jsx($e,{className:"w-full sm:w-32",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"10",children:"10/"}),e.jsx(Z,{value:"20",children:"20/"}),e.jsx(Z,{value:"50",children:"50/"}),e.jsx(Z,{value:"100",children:"100/"})]})]})]})]}),A&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[": ",e.jsxs("span",{className:"font-medium",children:['"',A,'"']})]})]}),e.jsx(Me,{children:b?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((D,G)=>e.jsx(vs,{className:"h-20 w-full"},G))}):v?.data&&v.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:v.data.map(D=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>Se(D.chat_id,D.filename),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:Jo(D.timestamp)}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs(ke,{variant:"secondary",className:"text-xs",children:[D.action_count," "]}),e.jsxs(ke,{variant:"outline",className:"text-xs",children:[D.total_plan_ms.toFixed(0),"ms"]})]})]}),D.action_types&&D.action_types.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:D.action_types.map((G,de)=>e.jsx(ke,{variant:"outline",className:"text-xs bg-blue-50 dark:bg-blue-950 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800",children:G},de))}),e.jsx("p",{className:"text-sm line-clamp-2",children:D.reasoning_preview||""})]},D.filename))}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",v.total,"  ",O," / ",z," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>R(1),disabled:O===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>R(D=>Math.max(1,D-1)),disabled:O===1,children:e.jsx(Da,{className:"h-4 w-4"})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[e.jsx(ae,{type:"number",min:1,max:z,value:E,onChange:D=>C(D.target.value),onKeyDown:D=>D.key==="Enter"&&Te(),placeholder:"",className:"w-20 h-8"}),e.jsx(_,{size:"sm",variant:"outline",onClick:Te,children:""})]}),e.jsxs("span",{className:"sm:hidden text-sm text-muted-foreground",children:[O,"/",z]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>R(D=>Math.min(z,D+1)),disabled:O===z,children:e.jsx(Wt,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>R(z),disabled:O===z,className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})}),e.jsx(Ps,{open:Ne,onOpenChange:je,children:e.jsxs(Ds,{className:"max-w-4xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs(Os,{children:[e.jsxs(Ls,{className:"flex items-center gap-2",children:[e.jsx(Ea,{className:"h-5 w-5"}),""]}),e.jsx(Ks,{children:""})]}),e.jsx(Je,{className:"h-full pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:re?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((D,G)=>e.jsx(vs,{className:"h-24 w-full"},G))}):U?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(na,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",title:U.chat_id,children:h(U.chat_id)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",children:Jo(U.timestamp)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx(ke,{variant:"outline",children:U.type})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsxs(ke,{children:[U.actions.length," "]})]})]})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(el,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Oe,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[U.timing.prompt_build_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Oe,{className:"text-xs text-muted-foreground",children:"LLM "})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[U.timing.llm_duration_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Oe,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[U.timing.total_plan_ms?.toFixed(2)||0,"ms"]})})]})]})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(cx,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:U.reasoning||""})})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(U_,{className:"h-4 w-4"})," (",U.actions.length,")"]}),e.jsx("div",{className:"space-y-3",children:U.actions.map((D,G)=>e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ke,{variant:"default",children:[" ",G+1]}),e.jsx(ke,{variant:"outline",children:D.action_type})]})})}),e.jsxs(Me,{className:"p-4 pt-0 space-y-3",children:[D.reasoning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded",children:typeof D.reasoning=="string"?D.reasoning:JSON.stringify(D.reasoning)})]}),D.action_message&&e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),typeof D.action_message=="string"?e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded break-all whitespace-pre-wrap",children:D.action_message}):e.jsx("pre",{className:"text-xs bg-muted/30 p-2 rounded overflow-x-auto whitespace-pre-wrap break-all",children:JSON.stringify(D.action_message,null,2)})]}),D.action_data&&Object.keys(D.action_data).length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("pre",{className:"text-xs bg-muted/30 p-2 rounded overflow-x-auto",children:JSON.stringify(D.action_data,null,2)})]}),D.action_reasoning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded",children:typeof D.action_reasoning=="string"?D.action_reasoning:JSON.stringify(D.action_reasoning)})]})]})]},G))})]}),e.jsx(Yt,{}),U.raw_output&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:U.raw_output})})]})]}),U.prompt&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:U.prompt})})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:""})})})}),e.jsx(st,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>je(!1),children:""})})]})})]})}function Gk({autoRefresh:a,refreshKey:n}){const[r,c]=m.useState("overview"),[d,u]=m.useState(null),{getChatName:h}=aN(),[f,p]=m.useState(null),[g,N]=m.useState(!0),[v,w]=m.useState(null),[b,y]=m.useState(!1),[O,R]=m.useState(1),[S,B]=m.useState(20),[E,C]=m.useState(""),[A,F]=m.useState(""),[L,J]=m.useState(""),[U,oe]=m.useState(null),[Ne,je]=m.useState(!1),[re,fe]=m.useState(!1),ge=m.useCallback(async()=>{try{N(!0);const D=await Ik();p(D)}catch(D){console.error(":",D)}finally{N(!1)}},[]),M=m.useCallback(async()=>{if(d)try{y(!0);const D=await Fk(d.chat_id,O,S,A||void 0);w(D)}catch(D){console.error(":",D)}finally{y(!1)}},[d,O,S,A]);m.useEffect(()=>{ge()},[ge]),m.useEffect(()=>{n>0&&(r==="overview"?ge():M())},[n,r,ge,M]),m.useEffect(()=>{r==="chat-logs"&&d&&M()},[r,d,M]),nN(a,m.useCallback(()=>{r==="overview"?ge():M()},[r,ge,M]));const K=D=>{u(D),R(1),F(""),J(""),c("chat-logs")},P=()=>{c("overview"),u(null),w(null),F(""),J("")},ue=()=>{F(L),R(1)},Q=()=>{J(""),F(""),R(1)},Se=async(D,G)=>{try{fe(!0),je(!0);const de=await Hk(D,G);oe(de)}catch(de){console.error(":",de)}finally{fe(!1)}},pe=D=>{B(Number(D)),R(1)},Te=()=>{const D=parseInt(E),G=v?Math.ceil(v.total/v.page_size):0;!isNaN(D)&&D>=1&&D<=G&&(R(D),C(""))},z=v?Math.ceil(v.total/v.page_size):0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:r==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(Ra,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:g?e.jsx(vs,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_chats||0})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(tx,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:g?e.jsx(vs,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_replies||0})})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsx(os,{children:""})]}),e.jsx(Me,{children:g?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((D,G)=>e.jsx(vs,{className:"h-24 w-full"},G))}):f?.chats&&f.chats.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:f.chats.map(D=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>K(D),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ra,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[180px]",title:h(D.chat_id),children:h(D.chat_id)})]}),e.jsx(ke,{variant:"secondary",children:D.reply_count})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[": ",lN(D.latest_timestamp)]})]},D.chat_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 mb-4",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:P,children:[e.jsx(Ma,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium",children:d?h(d.chat_id):""}),e.jsx("span",{className:"mx-2",children:""})," ",v?.total||0," "]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(Oe,{children:""}),e.jsx(os,{children:d?h(d.chat_id):""})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ae,{placeholder:"...",value:L,onChange:D=>J(D.target.value),onKeyDown:D=>D.key==="Enter"&&ue(),className:"w-full sm:w-48"}),e.jsx(_,{variant:"outline",size:"icon",onClick:ue,children:e.jsx(Tt,{className:"h-4 w-4"})}),A&&e.jsx(_,{variant:"ghost",size:"sm",onClick:Q,children:""})]}),e.jsxs(Pe,{value:S.toString(),onValueChange:pe,children:[e.jsx($e,{className:"w-full sm:w-32",children:e.jsx(Ie,{})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"10",children:"10/"}),e.jsx(Z,{value:"20",children:"20/"}),e.jsx(Z,{value:"50",children:"50/"}),e.jsx(Z,{value:"100",children:"100/"})]})]})]})]}),A&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[": ",e.jsxs("span",{className:"font-medium",children:['"',A,'"']})]})]}),e.jsx(Me,{children:b?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((D,G)=>e.jsx(vs,{className:"h-20 w-full"},G))}):v?.data&&v.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:v.data.map(D=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>Se(D.chat_id,D.filename),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:Jo(D.timestamp)}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[D.success?e.jsxs(ke,{variant:"default",className:"text-xs bg-green-600",children:[e.jsx(yg,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(ke,{variant:"destructive",className:"text-xs",children:[e.jsx(Ka,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(ke,{variant:"outline",className:"text-xs",children:D.model}),e.jsxs(ke,{variant:"secondary",className:"text-xs",children:[D.overall_ms.toFixed(0),"ms"]})]})]}),e.jsx("p",{className:"text-sm line-clamp-2",children:D.output_preview||""})]},D.filename))}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",v.total,"  ",O," / ",z," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>R(1),disabled:O===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>R(D=>Math.max(1,D-1)),disabled:O===1,children:e.jsx(Da,{className:"h-4 w-4"})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[e.jsx(ae,{type:"number",min:1,max:z,value:E,onChange:D=>C(D.target.value),onKeyDown:D=>D.key==="Enter"&&Te(),placeholder:"",className:"w-20 h-8"}),e.jsx(_,{size:"sm",variant:"outline",onClick:Te,children:""})]}),e.jsxs("span",{className:"sm:hidden text-sm text-muted-foreground",children:[O,"/",z]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>R(D=>Math.min(z,D+1)),disabled:O===z,children:e.jsx(Wt,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>R(z),disabled:O===z,className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})}),e.jsx(Ps,{open:Ne,onOpenChange:je,children:e.jsxs(Ds,{className:"max-w-4xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs(Os,{children:[e.jsxs(Ls,{className:"flex items-center gap-2",children:[e.jsx(Ea,{className:"h-5 w-5"}),""]}),e.jsx(Ks,{children:""})]}),e.jsx(Je,{className:"h-full pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:re?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((D,G)=>e.jsx(vs,{className:"h-24 w-full"},G))}):U?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(na,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",title:U.chat_id,children:h(U.chat_id)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",children:Jo(U.timestamp)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),U.success?e.jsxs(ke,{variant:"default",className:"bg-green-600",children:[e.jsx(yg,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(ke,{variant:"destructive",children:[e.jsx(Ka,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsxs(ke,{variant:"outline",children:["Level ",U.think_level]})]})]})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx($_,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx(ke,{variant:"secondary",className:"text-sm",children:U.model})})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(el,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Oe,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[U.timing.prompt_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Oe,{className:"text-xs text-muted-foreground",children:"LLM "})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[U.timing.llm_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Oe,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[U.timing.overall_ms?.toFixed(2)||0,"ms"]})})]})]}),U.timing.timing_logs&&U.timing.timing_logs.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-muted/30 rounded-lg",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"space-y-1",children:U.timing.timing_logs.map((D,G)=>e.jsx("div",{className:"text-xs text-muted-foreground",children:D},G))})]}),U.timing.almost_zero&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:": "}),U.timing.almost_zero]})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(cx,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:U.output||""})})]}),U.processed_output&&U.processed_output.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"space-y-2",children:U.processed_output.map((D,G)=>e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:D})},G))})]})]}),U.reasoning&&e.jsxs(e.Fragment,{children:[e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:U.reasoning})})]})]}),U.error&&e.jsxs(e.Fragment,{children:[e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-destructive",children:""}),e.jsx("div",{className:"p-4 bg-destructive/10 rounded-lg border border-destructive/20",children:e.jsx("p",{className:"text-sm text-destructive whitespace-pre-wrap",children:U.error})})]})]}),U.prompt&&e.jsxs(e.Fragment,{children:[e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:U.prompt})})]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:""})})})}),e.jsx(st,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>je(!1),children:""})})]})})]})}function qk(){const[a,n]=m.useState("planner"),[r,c]=m.useState(!1),[d,u]=m.useState(0),h=m.useCallback(()=>{u(f=>f+1)},[]);return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:" & "}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:r?"default":"outline",size:"sm",onClick:()=>c(!r),children:[e.jsx(dt,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),r?"":""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:h,children:e.jsx(dt,{className:"h-4 w-4"})})]})]}),e.jsxs(ta,{value:a,onValueChange:f=>n(f),className:"w-full",children:[e.jsxs(Zt,{className:"grid w-full grid-cols-2 gap-0.5 sm:gap-1 h-auto p-1",children:[e.jsxs(Xe,{value:"planner",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(sx,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Xe,{value:"replier",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(B_,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]})]}),e.jsxs(Je,{className:"h-[calc(100vh-240px)] sm:h-[calc(100vh-280px)] mt-4 sm:mt-6",children:[e.jsx(ws,{value:"planner",className:"mt-0",children:e.jsx(Vk,{autoRefresh:r,refreshKey:d})}),e.jsx(ws,{value:"replier",className:"mt-0",children:e.jsx(Gk,{autoRefresh:r,refreshKey:d})})]})]})]})}const Kk="Mai-with-u",Qk="plugin-repo",Yk="main",Jk="plugin_details.json";async function Xk(){try{const a=await _e("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:Kk,repo:Qk,branch:Yk,file_path:Jk})});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const n=await a.json();if(!n.success||!n.data)throw new Error(n.error||"");return JSON.parse(n.data).filter(d=>!d?.id||!d?.manifest?(console.warn(":",d),!1):!d.manifest.name||!d.manifest.version?(console.warn(":",d.id),!1):!0).map(d=>({id:d.id,manifest:{manifest_version:d.manifest.manifest_version||1,name:d.manifest.name,version:d.manifest.version,description:d.manifest.description||"",author:d.manifest.author||{name:"Unknown"},license:d.manifest.license||"Unknown",host_application:d.manifest.host_application||{min_version:"0.0.0"},homepage_url:d.manifest.homepage_url,repository_url:d.manifest.repository_url,keywords:d.manifest.keywords||[],categories:d.manifest.categories||[],default_locale:d.manifest.default_locale||"zh-CN",locales_path:d.manifest.locales_path},downloads:0,rating:0,review_count:0,installed:!1,published_at:new Date().toISOString(),updated_at:new Date().toISOString()}))}catch(a){throw console.error("Failed to fetch plugin list:",a),a}}async function rN(){try{const a=await _e("/api/webui/plugins/git-status");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){return console.error("Failed to check Git status:",a),{installed:!1,error:" Git "}}}async function iN(){try{const a=await _e("/api/webui/plugins/version");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){return console.error("Failed to get Maimai version:",a),{version:"0.0.0",version_major:0,version_minor:0,version_patch:0}}}function cN(a,n,r){const c=a.split(".").map(f=>parseInt(f)||0),d=c[0]||0,u=c[1]||0,h=c[2]||0;if(r.version_major<d||r.version_major===d&&r.version_minor<u||r.version_major===d&&r.version_minor===u&&r.version_patch<h)return!1;if(n){const f=n.split(".").map(v=>parseInt(v)||0),p=f[0]||0,g=f[1]||0,N=f[2]||0;if(r.version_major>p||r.version_major===p&&r.version_minor>g||r.version_major===p&&r.version_minor===g&&r.version_patch>N)return!1}return!0}async function Zk(){try{const a=await _e("/api/webui/ws-token");if(!a.ok)return console.error(" WebSocket token :",a.status),null;const n=await a.json();return n.success&&n.token?n.token:null}catch(a){return console.error(" WebSocket token :",a),null}}async function Wk(a,n){const r=await Zk();if(!r)return console.warn(" WebSocket token"),null;const c=window.location.protocol==="https:"?"wss:":"ws:",d=window.location.host,u=`${c}//${d}/api/webui/ws/plugin-progress?token=${encodeURIComponent(r)}`;try{const h=new WebSocket(u);return h.onopen=()=>{console.log("Plugin progress WebSocket connected");const f=setInterval(()=>{h.readyState===WebSocket.OPEN?h.send("ping"):clearInterval(f)},3e4)},h.onmessage=f=>{try{if(f.data==="pong")return;const p=JSON.parse(f.data);a(p)}catch(p){console.error("Failed to parse progress data:",p)}},h.onerror=f=>{console.error("Plugin progress WebSocket error:",f),n?.(f)},h.onclose=()=>{console.log("Plugin progress WebSocket disconnected")},h}catch(h){return console.error(" WebSocket :",h),null}}async function Dl(){try{const a=await _e("/api/webui/plugins/installed",{headers:Hs()});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const n=await a.json();if(!n.success)throw new Error(n.message||"");return n.plugins||[]}catch(a){return console.error("Failed to get installed plugins:",a),[]}}function hn(a,n){return n.some(r=>r.id===a)}function fn(a,n){const r=n.find(c=>c.id===a);if(r)return r.manifest?.version||r.version}async function oN(a,n,r="main"){const c=await _e("/api/webui/plugins/install",{method:"POST",body:JSON.stringify({plugin_id:a,repository_url:n,branch:r})});if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return await c.json()}async function dN(a){const n=await _e("/api/webui/plugins/uninstall",{method:"POST",body:JSON.stringify({plugin_id:a})});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return await n.json()}async function uN(a,n,r="main"){const c=await _e("/api/webui/plugins/update",{method:"POST",body:JSON.stringify({plugin_id:a,repository_url:n,branch:r})});if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return await c.json()}async function eC(a){const n=await _e(`/api/webui/plugins/config/${a}/schema`,{headers:Hs()});if(!n.ok){const c=await n.text();try{const d=JSON.parse(c);throw new Error(d.detail||" Schema ")}catch{throw new Error(` Schema  (${n.status})`)}}const r=await n.json();if(!r.success)throw new Error(r.message||" Schema ");return r.schema}async function sC(a){const n=await _e(`/api/webui/plugins/config/${a}`,{headers:Hs()});if(!n.ok){const c=await n.text();try{const d=JSON.parse(c);throw new Error(d.detail||"")}catch{throw new Error(` (${n.status})`)}}const r=await n.json();if(!r.success)throw new Error(r.message||"");return r.config}async function tC(a){const n=await _e(`/api/webui/plugins/config/${a}/raw`,{headers:Hs()});if(!n.ok){const c=await n.text();try{const d=JSON.parse(c);throw new Error(d.detail||"")}catch{throw new Error(` (${n.status})`)}}const r=await n.json();if(!r.success)throw new Error(r.message||"");return r.config}async function aC(a,n){const r=await _e(`/api/webui/plugins/config/${a}`,{method:"PUT",headers:Hs(),body:JSON.stringify({config:n})});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return await r.json()}async function lC(a,n){const r=await _e(`/api/webui/plugins/config/${a}/raw`,{method:"PUT",headers:Hs(),body:JSON.stringify({config:n})});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return await r.json()}async function nC(a){const n=await _e(`/api/webui/plugins/config/${a}/reset`,{method:"POST",headers:Hs()});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return await n.json()}async function rC(a){const n=await _e(`/api/webui/plugins/config/${a}/toggle`,{method:"POST",headers:Hs()});if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return await n.json()}const jc="https://maibot-plugin-stats.maibot-webui.workers.dev";async function mN(a){try{const n=await fetch(`${jc}/stats/${a}`);return n.ok?await n.json():(console.error("Failed to fetch plugin stats:",n.statusText),null)}catch(n){return console.error("Error fetching plugin stats:",n),null}}async function iC(a,n){try{const r=n||wx(),c=await fetch(`${jc}/stats/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a,user_id:r})}),d=await c.json();return c.status===429?{success:!1,error:""}:c.ok?{success:!0,...d}:{success:!1,error:d.error||""}}catch(r){return console.error("Error liking plugin:",r),{success:!1,error:""}}}async function cC(a,n){try{const r=n||wx(),c=await fetch(`${jc}/stats/dislike`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a,user_id:r})}),d=await c.json();return c.status===429?{success:!1,error:""}:c.ok?{success:!0,...d}:{success:!1,error:d.error||""}}catch(r){return console.error("Error disliking plugin:",r),{success:!1,error:""}}}async function oC(a,n,r,c){if(n<1||n>5)return{success:!1,error:" 1-5 "};try{const d=c||wx(),u=await fetch(`${jc}/stats/rate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a,rating:n,comment:r,user_id:d})}),h=await u.json();return u.status===429?{success:!1,error:" 3 "}:u.ok?{success:!0,...h}:{success:!1,error:h.error||""}}catch(d){return console.error("Error rating plugin:",d),{success:!1,error:""}}}async function xN(a){try{const n=await fetch(`${jc}/stats/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a})}),r=await n.json();return n.status===429?(console.warn("Download recording rate limited"),{success:!0}):n.ok?{success:!0,...r}:(console.error("Failed to record download:",r.error),{success:!1,error:r.error})}catch(n){return console.error("Error recording download:",n),{success:!1,error:""}}}function dC(){const a=navigator,n=[navigator.userAgent,navigator.language,navigator.languages?.join(",")||"",navigator.platform,navigator.hardwareConcurrency||0,screen.width,screen.height,screen.colorDepth,screen.pixelDepth,new Date().getTimezoneOffset(),Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.maxTouchPoints||0,a.deviceMemory||0].join("|");let r=0;for(let c=0;c<n.length;c++){const d=n.charCodeAt(c);r=(r<<5)-r+d,r=r&r}return`fp_${Math.abs(r).toString(36)}`}function wx(){const a="maibot_user_id";let n=localStorage.getItem(a);if(!n){const r=dC(),c=Date.now().toString(36),d=Math.random().toString(36).substring(2,15);n=`${r}_${c}_${d}`,localStorage.setItem(a,n)}return n}const uC={"Group Management":"","Entertainment & Interaction":"","Utility Tools":"","Content Generation":"",Multimedia:"","External Integration":"","Data Analysis & Insights":"",Other:""};function mC(){return e.jsx(Wn,{children:e.jsx(xC,{})})}function xC(){const a=ca(),{triggerRestart:n,isRestarting:r}=yn(),[c,d]=m.useState(""),[u,h]=m.useState("all"),[f,p]=m.useState("all"),[g,N]=m.useState(!0),[v,w]=m.useState([]),[b,y]=m.useState(!0),[O,R]=m.useState(null),[S,B]=m.useState(null),[E,C]=m.useState(null),[A,F]=m.useState(null),[,L]=m.useState([]),[J,U]=m.useState({}),[oe,Ne]=m.useState(!1),[je,re]=m.useState(null),[fe,ge]=m.useState("main"),[M,K]=m.useState(""),[P,ue]=m.useState("preset"),[Q,Se]=m.useState(!1),{toast:pe}=Ys(),Te=async H=>{const ee=H.map(async Ee=>{try{const me=await mN(Ee.id);return{id:Ee.id,stats:me}}catch(me){return console.warn(`Failed to load stats for ${Ee.id}:`,me),{id:Ee.id,stats:null}}}),Ue=await Promise.all(ee),ie={};Ue.forEach(({id:Ee,stats:me})=>{me&&(ie[Ee]=me)}),U(ie)};m.useEffect(()=>{let H=null,ee=!1;return(async()=>{if(H=await Wk(ie=>{ee||(C(ie),ie.stage==="success"?setTimeout(()=>{ee||C(null)},2e3):ie.stage==="error"&&(y(!1),R(ie.error||"")))},ie=>{console.error("WebSocket error:",ie),ee||pe({title:"WebSocket ",description:"",variant:"destructive"})}),await new Promise(ie=>{if(!H){ie();return}const Ee=()=>{H&&H.readyState===WebSocket.OPEN?(console.log("WebSocket connected, starting to load plugins"),ie()):H&&H.readyState===WebSocket.CLOSED?(console.warn("WebSocket closed before loading plugins"),ie()):setTimeout(Ee,100)};Ee()}),!ee){const ie=await rN();B(ie),ie.installed||pe({title:"Git ",description:ie.error||" Git ",variant:"destructive"})}if(!ee){const ie=await iN();F(ie)}if(!ee)try{y(!0),R(null);const ie=await Xk();if(!ee){const Ee=await Dl();L(Ee);const me=ie.map(Ae=>{const rs=hn(Ae.id,Ee),Ut=fn(Ae.id,Ee);return{...Ae,installed:rs,installed_version:Ut}});for(const Ae of Ee)!me.some(Ut=>Ut.id===Ae.id)&&Ae.manifest&&me.push({id:Ae.id,manifest:{manifest_version:Ae.manifest.manifest_version||1,name:Ae.manifest.name,version:Ae.manifest.version,description:Ae.manifest.description||"",author:Ae.manifest.author,license:Ae.manifest.license||"Unknown",host_application:Ae.manifest.host_application,homepage_url:Ae.manifest.homepage_url,repository_url:Ae.manifest.repository_url,keywords:Ae.manifest.keywords||[],categories:Ae.manifest.categories||[],default_locale:Ae.manifest.default_locale||"zh-CN",locales_path:Ae.manifest.locales_path},downloads:0,rating:0,review_count:0,installed:!0,installed_version:Ae.manifest.version,published_at:new Date().toISOString(),updated_at:new Date().toISOString()});w(me),Te(me)}}catch(ie){if(!ee){const Ee=ie instanceof Error?ie.message:"";R(Ee),pe({title:"",description:Ee,variant:"destructive"})}}finally{ee||y(!1)}})(),()=>{ee=!0,H&&H.close()}},[pe]);const z=H=>{if(!H.installed&&A&&!D(H))return e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(_t,{className:"h-3 w-3"}),""]});if(H.installed){const ee=H.installed_version?.trim(),Ue=H.manifest.version?.trim();if(ee!==Ue){const ie=ee?.split(".").map(Number)||[0,0,0],Ee=Ue?.split(".").map(Number)||[0,0,0];for(let me=0;me<3;me++){if((Ee[me]||0)>(ie[me]||0))return e.jsxs(ke,{variant:"outline",className:"gap-1 text-orange-600 border-orange-600",children:[e.jsx(_t,{className:"h-3 w-3"}),""]});if((Ee[me]||0)<(ie[me]||0))break}}return e.jsxs(ke,{variant:"default",className:"gap-1",children:[e.jsx(pt,{className:"h-3 w-3"}),""]})}return null},D=H=>!A||!H.manifest?.host_application?!0:cN(H.manifest.host_application.min_version,H.manifest.host_application.max_version,A),G=H=>{if(!H.installed||!H.installed_version||!H.manifest?.version)return!1;const ee=H.installed_version.trim(),Ue=H.manifest.version.trim();if(ee===Ue)return!1;const ie=ee.split(".").map(Number),Ee=Ue.split(".").map(Number);for(let me=0;me<3;me++){if((Ee[me]||0)>(ie[me]||0))return!0;if((Ee[me]||0)<(ie[me]||0))return!1}return!1},de=v.filter(H=>{if(!H.manifest)return console.warn("[]  manifest :",H.id),!1;const ee=c===""||H.manifest.name?.toLowerCase().includes(c.toLowerCase())||H.manifest.description?.toLowerCase().includes(c.toLowerCase())||H.manifest.keywords&&H.manifest.keywords.some(me=>me.toLowerCase().includes(c.toLowerCase())),Ue=u==="all"||H.manifest.categories&&H.manifest.categories.includes(u);let ie=!0;f==="installed"?ie=H.installed===!0:f==="updates"&&(ie=H.installed===!0&&G(H));const Ee=!g||!A||D(H);return ee&&Ue&&ie&&Ee}),Re=H=>{if(!S?.installed){pe({title:"",description:"Git ",variant:"destructive"});return}if(A&&!D(H)){pe({title:"",description:"",variant:"destructive"});return}re(H),ge("main"),K(""),ue("preset"),Se(!1),Ne(!0)},W=async()=>{if(!je)return;const H=P==="custom"?M:fe;if(!H||H.trim()===""){pe({title:"",variant:"destructive"});return}try{Ne(!1),await oN(je.id,je.manifest.repository_url||"",H),xN(je.id).catch(Ue=>{console.warn("Failed to record download:",Ue)}),pe({title:"",description:`${je.manifest.name} `});const ee=await Dl();L(ee),w(Ue=>Ue.map(ie=>{if(ie.id===je.id){const Ee=hn(ie.id,ee),me=fn(ie.id,ee);return{...ie,installed:Ee,installed_version:me}}return ie}))}catch(ee){pe({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}finally{re(null)}},Y=async H=>{try{await dN(H.id),pe({title:"",description:`${H.manifest.name} `});const ee=await Dl();L(ee),w(Ue=>Ue.map(ie=>{if(ie.id===H.id){const Ee=hn(ie.id,ee),me=fn(ie.id,ee);return{...ie,installed:Ee,installed_version:me}}return ie}))}catch(ee){pe({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}},Fe=async H=>{if(!S?.installed){pe({title:"",description:"Git ",variant:"destructive"});return}try{const ee=await uN(H.id,H.manifest.repository_url||"","main");pe({title:"",description:`${H.manifest.name}  ${ee.old_version}  ${ee.new_version}`});const Ue=await Dl();L(Ue),w(ie=>ie.map(Ee=>{if(Ee.id===H.id){const me=hn(Ee.id,Ue),Ae=fn(Ee.id,Ue);return{...Ee,installed:me,installed_version:Ae}}return Ee}))}catch(ee){pe({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}};return e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{variant:"outline",onClick:()=>n(),disabled:r,children:[e.jsx(iv,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),""]}),e.jsxs(_,{onClick:()=>a({to:"/plugin-mirrors"}),children:[e.jsx(P_,{className:"h-4 w-4 mr-2"}),""]})]})]}),e.jsx(Ce,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950/20 dark:border-blue-900",children:e.jsx(Me,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["",e.jsx("span",{className:"font-semibold",children:""}),""]})]})})}),S&&!S.installed&&e.jsxs(Ce,{className:"border-orange-600 bg-orange-50 dark:bg-orange-950/20",children:[e.jsx(De,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Jt,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx(Oe,{className:"text-lg text-orange-900 dark:text-orange-100",children:"Git "}),e.jsx(os,{className:"text-orange-800 dark:text-orange-200",children:S.error||" Git "})]})]})}),e.jsx(Me,{children:e.jsxs("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:[" ",e.jsx("a",{href:"https://git-scm.com/downloads",target:"_blank",rel:"noopener noreferrer",className:"underline font-medium",children:"git-scm.com"}),"  Git "]})})]}),e.jsx(Ce,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:c,onChange:H=>d(H.target.value),className:"pl-9"})]}),e.jsxs(Pe,{value:u,onValueChange:h,children:[e.jsx($e,{className:"w-full sm:w-[200px]",children:e.jsx(Ie,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"Group Management",children:""}),e.jsx(Z,{value:"Entertainment & Interaction",children:""}),e.jsx(Z,{value:"Utility Tools",children:""}),e.jsx(Z,{value:"Content Generation",children:""}),e.jsx(Z,{value:"Multimedia",children:""}),e.jsx(Z,{value:"External Integration",children:""}),e.jsx(Z,{value:"Data Analysis & Insights",children:""}),e.jsx(Z,{value:"Other",children:""})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"compatible-only",checked:g,onCheckedChange:H=>N(H===!0)}),e.jsx("label",{htmlFor:"compatible-only",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:""})]})]})}),e.jsx(ta,{value:f,onValueChange:p,className:"w-full",children:e.jsxs(Zt,{className:"grid w-full grid-cols-3",children:[e.jsxs(Xe,{value:"all",children:[" (",v.filter(H=>{if(!H.manifest)return!1;const ee=c===""||H.manifest.name?.toLowerCase().includes(c.toLowerCase())||H.manifest.description?.toLowerCase().includes(c.toLowerCase())||H.manifest.keywords&&H.manifest.keywords.some(Ee=>Ee.toLowerCase().includes(c.toLowerCase())),Ue=u==="all"||H.manifest.categories&&H.manifest.categories.includes(u),ie=!g||!A||D(H);return ee&&Ue&&ie}).length,")"]}),e.jsxs(Xe,{value:"installed",children:[" (",v.filter(H=>{if(!H.manifest)return!1;const ee=c===""||H.manifest.name?.toLowerCase().includes(c.toLowerCase())||H.manifest.description?.toLowerCase().includes(c.toLowerCase())||H.manifest.keywords&&H.manifest.keywords.some(Ee=>Ee.toLowerCase().includes(c.toLowerCase())),Ue=u==="all"||H.manifest.categories&&H.manifest.categories.includes(u),ie=!g||!A||D(H);return H.installed&&ee&&Ue&&ie}).length,")"]}),e.jsxs(Xe,{value:"updates",children:[" (",v.filter(H=>{if(!H.manifest)return!1;const ee=c===""||H.manifest.name?.toLowerCase().includes(c.toLowerCase())||H.manifest.description?.toLowerCase().includes(c.toLowerCase())||H.manifest.keywords&&H.manifest.keywords.some(Ee=>Ee.toLowerCase().includes(c.toLowerCase())),Ue=u==="all"||H.manifest.categories&&H.manifest.categories.includes(u),ie=!g||!A||D(H);return H.installed&&G(H)&&ee&&Ue&&ie}).length,")"]})]})}),E&&E.stage==="loading"&&E.operation==="fetch"&&e.jsx(Ce,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:""})]}),e.jsxs("span",{className:"text-sm font-medium",children:[E.progress,"%"]})]}),e.jsx(Xn,{value:E.progress,className:"h-2"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:E.message}),E.total_plugins>0&&e.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:[" ",E.loaded_plugins," / ",E.total_plugins," "]})]})}),E&&E.stage==="error"&&E.error&&e.jsx(Ce,{className:"border-destructive bg-destructive/10",children:e.jsx(De,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Jt,{className:"h-5 w-5 text-destructive"}),e.jsxs("div",{children:[e.jsx(Oe,{className:"text-lg text-destructive",children:""}),e.jsx(os,{className:"text-destructive/80",children:E.error})]})]})})}),b?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(zs,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"..."})]}):O?e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Jt,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:O}),e.jsx(_,{onClick:()=>window.location.reload(),children:""})]})}):de.length===0?e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Tt,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c||u!=="all"?"":""})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:de.map(H=>e.jsxs(Ce,{className:"flex flex-col hover:shadow-lg transition-shadow h-full",children:[e.jsxs(De,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx(Oe,{className:"text-xl",children:H.manifest?.name||H.id}),e.jsxs("div",{className:"flex flex-col gap-1",children:[H.manifest?.categories&&H.manifest.categories[0]&&e.jsx(ke,{variant:"secondary",className:"text-xs whitespace-nowrap",children:uC[H.manifest.categories[0]]||H.manifest.categories[0]}),z(H)]})]}),e.jsx(os,{className:"line-clamp-2",children:H.manifest?.description||""})]}),e.jsx(Me,{className:"flex-1",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Xt,{className:"h-4 w-4"}),e.jsx("span",{children:(J[H.id]?.downloads??H.downloads??0).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(mn,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:(J[H.id]?.rating??H.rating??0).toFixed(1)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[H.manifest?.keywords&&H.manifest.keywords.slice(0,3).map(ee=>e.jsx(ke,{variant:"outline",className:"text-xs",children:ee},ee)),H.manifest?.keywords&&H.manifest.keywords.length>3&&e.jsxs(ke,{variant:"outline",className:"text-xs",children:["+",H.manifest.keywords.length-3]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t space-y-1",children:[e.jsxs("div",{children:["v",H.manifest?.version||"unknown","  ",H.manifest?.author?.name||"Unknown"]}),H.manifest?.host_application&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:":"}),e.jsxs("span",{className:"font-medium",children:[H.manifest.host_application.min_version,H.manifest.host_application.max_version?` - ${H.manifest.host_application.max_version}`:" - "]})]})]})]})}),e.jsx(id,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 w-full",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>a({to:"/plugin-detail",search:{pluginId:H.id}}),children:""}),H.installed?G(H)?e.jsxs(_,{size:"sm",disabled:!S?.installed,title:S?.installed?void 0:"Git ",onClick:()=>Fe(H),children:[e.jsx(dt,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(_,{variant:"destructive",size:"sm",disabled:!S?.installed,title:S?.installed?void 0:"Git ",onClick:()=>Y(H),children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(_,{size:"sm",disabled:!S?.installed||E?.operation==="install"||A!==null&&!D(H),title:S?.installed?A!==null&&!D(H)?` ( ${H.manifest?.host_application?.min_version||""}${H.manifest?.host_application?.max_version?` - ${H.manifest.host_application.max_version}`:"+"} ${A?.version})`:void 0:"Git ",onClick:()=>Re(H),children:[e.jsx(Xt,{className:"h-4 w-4 mr-1"}),E?.operation==="install"&&E?.plugin_id===H.id?"...":""]})]})}),E&&(E.stage==="loading"||E.stage==="success"||E.stage==="error")&&E.operation!=="fetch"&&E.plugin_id===H.id&&e.jsx("div",{className:"px-6 pb-4 -mt-2",children:e.jsxs("div",{className:`space-y-2 p-3 rounded-lg border ${E.stage==="success"?"bg-green-50 dark:bg-green-950/20 border-green-200 dark:border-green-900":E.stage==="error"?"bg-red-50 dark:bg-red-950/20 border-red-200 dark:border-red-900":"bg-muted/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[E.stage==="loading"?e.jsx(zs,{className:"h-3 w-3 animate-spin"}):E.stage==="success"?e.jsx(pt,{className:"h-3 w-3 text-green-600"}):e.jsx(_t,{className:"h-3 w-3 text-red-600"}),e.jsx("span",{className:`text-xs font-medium ${E.stage==="success"?"text-green-700 dark:text-green-300":E.stage==="error"?"text-red-700 dark:text-red-300":""}`,children:E.stage==="loading"?e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]}):E.stage==="success"?e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]}):e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]})})]}),E.stage!=="error"&&e.jsxs("span",{className:`text-xs font-medium ${E.stage==="success"?"text-green-700 dark:text-green-300":""}`,children:[E.progress,"%"]})]}),E.stage!=="error"&&e.jsx(Xn,{value:E.progress,className:`h-1.5 ${E.stage==="success"?"[&>div]:bg-green-500":""}`}),e.jsx("div",{className:`text-xs ${E.stage==="success"?"text-green-600 dark:text-green-400 truncate":E.stage==="error"?"text-red-600 dark:text-red-400":"text-muted-foreground truncate"}`,children:E.stage==="error"?E.error||E.message||"":E.message})]})})]},H.id))}),e.jsx(Ps,{open:oe,onOpenChange:Ne,children:e.jsxs(Ds,{children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsxs(Ks,{children:[" ",je?.manifest.name]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",je?.manifest.version]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",typeof je?.manifest.author=="string"?je.manifest.author:je?.manifest.author?.name]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"advanced-options",checked:Q,onCheckedChange:H=>Se(H)}),e.jsx("label",{htmlFor:"advanced-options",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:""})]}),Q&&e.jsx("div",{className:"space-y-4 p-4 border rounded-lg",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:""}),e.jsxs(ta,{value:P,onValueChange:H=>ue(H),children:[e.jsxs(Zt,{className:"grid w-full grid-cols-2",children:[e.jsx(Xe,{value:"preset",className:"text-xs",children:""}),e.jsx(Xe,{value:"custom",className:"text-xs",children:""})]}),P==="preset"&&e.jsx("div",{className:"mt-3",children:e.jsxs(Pe,{value:fe,onValueChange:ge,children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(Z,{value:"main",children:"main ()"}),e.jsx(Z,{value:"master",children:"master"}),e.jsx(Z,{value:"dev",children:"dev ()"}),e.jsx(Z,{value:"develop",children:"develop"}),e.jsx(Z,{value:"beta",children:"beta ()"}),e.jsx(Z,{value:"stable",children:"stable ()"})]})]})}),P==="custom"&&e.jsxs("div",{className:"space-y-2 mt-3",children:[e.jsx("input",{type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:": feature/new-feature",value:M,onChange:H=>K(H.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Git "})]})]})]})}),!Q&&e.jsx("p",{className:"text-sm text-muted-foreground",children:" (main) "})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>Ne(!1),children:""}),e.jsxs(_,{onClick:W,children:[e.jsx(Xt,{className:"h-4 w-4 mr-2"}),""]})]})]})}),e.jsx(er,{})]})})}function hC(){return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(cv,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]})})}),e.jsx(Je,{className:"flex-1",children:e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-12rem)]",children:e.jsxs(Ce,{className:"max-w-2xl w-full border-dashed",children:[e.jsxs(De,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(ra,{className:"h-16 w-16 text-muted-foreground"})}),e.jsx(Oe,{className:"text-2xl",children:""}),e.jsx(os,{className:"text-base",children:""})]}),e.jsx(Me,{children:e.jsxs("div",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium text-foreground",children:" "}),e.jsxs("ul",{className:"space-y-2 ml-6",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]})]})]})})]})})})]})}function fC({field:a,value:n,onChange:r}){const[c,d]=m.useState(!1);switch(a.ui_type){case"switch":return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:a.label}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]}),e.jsx(Ve,{checked:!!n,onCheckedChange:r,disabled:a.disabled})]});case"number":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(ae,{type:"number",value:n??a.default,onChange:u=>r(parseFloat(u.target.value)||0),min:a.min,max:a.max,step:a.step??1,placeholder:a.placeholder,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"slider":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:a.label}),e.jsx("span",{className:"text-sm text-muted-foreground",children:n??a.default})]}),e.jsx(Qa,{value:[n??a.default],onValueChange:u=>r(u[0]),min:a.min??0,max:a.max??100,step:a.step??1,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"select":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsxs(Pe,{value:String(n??a.default),onValueChange:r,disabled:a.disabled,children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:a.placeholder??""})}),e.jsx(Be,{children:a.choices?.map(u=>e.jsx(Z,{value:String(u),children:String(u)},String(u)))})]}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"textarea":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(ot,{value:n??a.default,onChange:u=>r(u.target.value),placeholder:a.placeholder,rows:a.rows??3,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"password":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsxs("div",{className:"relative",children:[e.jsx(ae,{type:c?"text":"password",value:n??"",onChange:u=>r(u.target.value),placeholder:a.placeholder,disabled:a.disabled,className:"pr-10"}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3",onClick:()=>d(!c),children:c?e.jsx(nc,{className:"h-4 w-4"}):e.jsx(ia,{className:"h-4 w-4"})})]}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"list":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(NS,{value:Array.isArray(n)?n:[],onChange:u=>r(u),itemType:a.item_type??"string",itemFields:a.item_fields,minItems:a.min_items,maxItems:a.max_items,disabled:a.disabled,placeholder:a.placeholder}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"text":default:return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(ae,{type:"text",value:n??a.default??"",onChange:u=>r(u.target.value),placeholder:a.placeholder,maxLength:a.max_length,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]})}}function Xg({section:a,config:n,onChange:r}){const[c,d]=m.useState(!a.collapsed),u=Object.entries(a.fields).filter(([,h])=>!h.hidden).sort(([,h],[,f])=>h.order-f.order);return e.jsx(uc,{open:c,onOpenChange:d,children:e.jsxs(Ce,{children:[e.jsx(mc,{asChild:!0,children:e.jsxs(De,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c?e.jsx(za,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(Wt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(Oe,{className:"text-lg",children:a.title})]}),e.jsxs(ke,{variant:"secondary",className:"text-xs",children:[u.length," "]})]}),a.description&&e.jsx(os,{className:"ml-6",children:a.description})]})}),e.jsx(xc,{children:e.jsx(Me,{className:"space-y-4 pt-0",children:u.map(([h,f])=>e.jsx(fC,{field:f,value:n[a.name]?.[h],onChange:p=>r(a.name,h,p),sectionName:a.name},h))})})]})})}function pC({plugin:a,onBack:n}){const{toast:r}=Ys(),{triggerRestart:c,isRestarting:d}=yn(),[u,h]=m.useState("visual"),[f,p]=m.useState(null),[g,N]=m.useState({}),[v,w]=m.useState({}),[b,y]=m.useState(""),[O,R]=m.useState(""),[S,B]=m.useState(!0),[E,C]=m.useState(!1),[A,F]=m.useState(!1),[L,J]=m.useState(!1),[U,oe]=m.useState(!1),Ne=m.useCallback(async()=>{B(!0);try{const[P,ue,Q]=await Promise.all([eC(a.id),sC(a.id),tC(a.id)]);p(P),N(ue),w(JSON.parse(JSON.stringify(ue))),y(Q),R(Q)}catch(P){r({title:"",description:P instanceof Error?P.message:"",variant:"destructive"})}finally{B(!1)}},[a.id,r]);m.useEffect(()=>{Ne()},[Ne]),m.useEffect(()=>{F(u==="visual"?JSON.stringify(g)!==JSON.stringify(v):b!==O)},[g,v,b,O,u]);const je=(P,ue,Q)=>{N(Se=>({...Se,[P]:{...Se[P]||{},[ue]:Q}}))},re=async()=>{C(!0);try{if(u==="source"){try{Zv(b)}catch(P){J(!0),r({title:"TOML ",description:P instanceof Error?P.message:" TOML ",variant:"destructive"}),C(!1);return}await lC(a.id,b),R(b),J(!1)}else await aC(a.id,g),w(JSON.parse(JSON.stringify(g)));r({title:"",description:""})}catch(P){r({title:"",description:P instanceof Error?P.message:"",variant:"destructive"})}finally{C(!1)}},fe=async()=>{try{await nC(a.id),r({title:"",description:""}),oe(!1),Ne()}catch(P){r({title:"",description:P instanceof Error?P.message:"",variant:"destructive"})}},ge=async()=>{try{const P=await rC(a.id);r({title:P.message,description:P.note}),Ne()}catch(P){r({title:"",description:P instanceof Error?P.message:"",variant:"destructive"})}};if(S)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(zs,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(!f)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[e.jsx(_t,{className:"h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:""}),e.jsxs(_,{onClick:n,variant:"outline",children:[e.jsx(Ma,{className:"h-4 w-4 mr-2"}),""]})]});const M=Object.values(f.sections).sort((P,ue)=>P.order-ue.order),K=g.plugin?.enabled!==!1;return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:n,children:e.jsx(Ma,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:f.plugin_info.name||a.manifest.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ke,{variant:K?"default":"secondary",children:K?"":""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["v",f.plugin_info.version||a.manifest.version]})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-10 sm:ml-0",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>h(u==="visual"?"source":"visual"),children:u==="visual"?e.jsxs(e.Fragment,{children:[e.jsx(lv,{className:"h-4 w-4 mr-2"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(av,{className:"h-4 w-4 mr-2"}),""]})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>c(),disabled:d,children:[e.jsx(iv,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:ge,children:[e.jsx(hc,{className:"h-4 w-4 mr-2"}),K?"":""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>oe(!0),children:[e.jsx(lc,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs(_,{size:"sm",onClick:re,disabled:!A||E,children:[E?e.jsx(zs,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(fc,{className:"h-4 w-4 mr-2"}),""]})]})]}),A&&e.jsx(Ce,{className:"border-orange-200 bg-orange-50 dark:bg-orange-950/20 dark:border-orange-900",children:e.jsx(Me,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"h-4 w-4 text-orange-600"}),e.jsx("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:""})]})})}),u==="source"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(at,{children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsxs(lt,{children:[e.jsx("strong",{children:""})," TOML ",L&&e.jsx("span",{className:"text-destructive font-semibold ml-2",children:"  TOML "})]})]}),e.jsx(Iv,{value:b,onChange:P=>{y(P),L&&J(!1)},language:"toml",theme:"dark",height:"calc(100vh - 350px)",minHeight:"500px",placeholder:"TOML "})]}),u==="visual"&&e.jsxs(e.Fragment,{children:[e.jsxs(at,{children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsxs(lt,{children:[e.jsx("strong",{children:""}),"WebUI  "]})]}),f.layout.type==="tabs"&&f.layout.tabs.length>0?e.jsxs(ta,{defaultValue:f.layout.tabs[0]?.id,children:[e.jsx(Zt,{children:f.layout.tabs.map(P=>e.jsxs(Xe,{value:P.id,children:[P.title,P.badge&&e.jsx(ke,{variant:"secondary",className:"ml-2 text-xs",children:P.badge})]},P.id))}),f.layout.tabs.map(P=>e.jsx(ws,{value:P.id,className:"space-y-4 mt-4",children:P.sections.map(ue=>{const Q=f.sections[ue];return Q?e.jsx(Xg,{section:Q,config:g,onChange:je},ue):null})},P.id))]}):e.jsx("div",{className:"space-y-4",children:M.map(P=>e.jsx(Xg,{section:P,config:g,onChange:je},P.name))})]}),e.jsx(Ps,{open:U,onOpenChange:oe,children:e.jsxs(Ds,{children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>oe(!1),children:""}),e.jsx(_,{variant:"destructive",onClick:fe,children:""})]})]})})]})}function gC(){return e.jsx(Wn,{children:e.jsx(jC,{})})}function jC(){const{toast:a}=Ys(),[n,r]=m.useState([]),[c,d]=m.useState(!0),[u,h]=m.useState(""),[f,p]=m.useState(null),g=async()=>{d(!0);try{const y=await Dl();r(y)}catch(y){a({title:"",description:y instanceof Error?y.message:"",variant:"destructive"})}finally{d(!1)}};m.useEffect(()=>{g()},[]);const v=n.filter(y=>{const O=u.toLowerCase();return y.id.toLowerCase().includes(O)||y.manifest.name.toLowerCase().includes(O)||y.manifest.description?.toLowerCase().includes(O)}).filter((y,O,R)=>O===R.findIndex(S=>S.id===y.id)),w=n.length,b=0;return f?e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"h-full",children:e.jsx("div",{className:"p-4 sm:p-6",children:e.jsx(pC,{plugin:f,onBack:()=>p(null)})})}),e.jsx(er,{})]}):e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:g,children:[e.jsx(dt,{className:`h-4 w-4 mr-2 ${c?"animate-spin":""}`}),""]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 xs:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(ra,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:c?"...":""})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(pt,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-2xl font-bold",children:w}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:""}),e.jsx(_t,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:u,onChange:y=>h(y.target.value),className:"pl-9"})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsx(os,{children:""})]}),e.jsx(Me,{children:c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(zs,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):v.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(ra,{className:"h-16 w-16 text-muted-foreground/50"}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:u?"":""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u?"":""})]})]}):e.jsx("div",{className:"space-y-2",children:v.map(y=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>p(y),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(ra,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium truncate",children:y.manifest.name}),e.jsxs(ke,{variant:"secondary",className:"text-xs flex-shrink-0",children:["v",y.manifest.version]})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:y.manifest.description||""})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(_,{variant:"ghost",size:"sm",children:e.jsx(vn,{className:"h-4 w-4"})}),e.jsx(Wt,{className:"h-4 w-4 text-muted-foreground"})]})]},y.id))})})]})]})})}function vC(){const a=ca(),{toast:n}=Ys(),[r,c]=m.useState([]),[d,u]=m.useState(!0),[h,f]=m.useState(null),[p,g]=m.useState(null),[N,v]=m.useState(!1),[w,b]=m.useState(!1),[y,O]=m.useState({id:"",name:"",raw_prefix:"",clone_prefix:"",enabled:!0,priority:1}),R=m.useCallback(async()=>{try{u(!0),f(null);const L=await _e("/api/webui/plugins/mirrors");if(!L.ok)throw new Error("");const J=await L.json();c(J.mirrors||[])}catch(L){const J=L instanceof Error?L.message:"";f(J),n({title:"",description:J,variant:"destructive"})}finally{u(!1)}},[n]);m.useEffect(()=>{R()},[R]);const S=async()=>{try{const L=await _e("/api/webui/plugins/mirrors",{method:"POST",body:JSON.stringify(y)});if(!L.ok){const J=await L.json();throw new Error(J.detail||"")}n({title:"",description:""}),v(!1),O({id:"",name:"",raw_prefix:"",clone_prefix:"",enabled:!0,priority:1}),R()}catch(L){n({title:"",description:L instanceof Error?L.message:"",variant:"destructive"})}},B=async()=>{if(p)try{if(!(await _e(`/api/webui/plugins/mirrors/${p.id}`,{method:"PUT",body:JSON.stringify({name:y.name,raw_prefix:y.raw_prefix,clone_prefix:y.clone_prefix,enabled:y.enabled,priority:y.priority})})).ok)throw new Error("");n({title:"",description:""}),b(!1),g(null),R()}catch(L){n({title:"",description:L instanceof Error?L.message:"",variant:"destructive"})}},E=async L=>{if(confirm(""))try{if(!(await _e(`/api/webui/plugins/mirrors/${L}`,{method:"DELETE"})).ok)throw new Error("");n({title:"",description:""}),R()}catch(J){n({title:"",description:J instanceof Error?J.message:"",variant:"destructive"})}},C=async L=>{try{if(!(await _e(`/api/webui/plugins/mirrors/${L.id}`,{method:"PUT",body:JSON.stringify({enabled:!L.enabled})})).ok)throw new Error("");R()}catch(J){n({title:"",description:J instanceof Error?J.message:"",variant:"destructive"})}},A=L=>{g(L),O({id:L.id,name:L.name,raw_prefix:L.raw_prefix,clone_prefix:L.clone_prefix,enabled:L.enabled,priority:L.priority}),b(!0)},F=async(L,J)=>{const U=J==="up"?L.priority-1:L.priority+1;if(!(U<1))try{if(!(await _e(`/api/webui/plugins/mirrors/${L.id}`,{method:"PUT",body:JSON.stringify({priority:U})})).ok)throw new Error("");R()}catch(oe){n({title:"",description:oe instanceof Error?oe.message:"",variant:"destructive"})}};return e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),children:e.jsx(Ma,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:" Git "})]})]}),e.jsxs(_,{onClick:()=>v(!0),children:[e.jsx(et,{className:"h-4 w-4 mr-2"}),""]})]}),d?e.jsx(Ce,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(zs,{className:"h-8 w-8 animate-spin text-primary"})})}):h?e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Jt,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:h}),e.jsx(_,{onClick:R,children:""})]})}):e.jsxs(Ce,{children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ut,{children:[e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{children:"ID"}),e.jsx(We,{children:""}),e.jsx(We,{className:"text-right",children:""})]})}),e.jsx(Bl,{children:r.map(L=>e.jsxs(ut,{children:[e.jsx(Ke,{children:e.jsx(Ve,{checked:L.enabled,onCheckedChange:()=>C(L)})}),e.jsx(Ke,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:L.name}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Raw: ",L.raw_prefix]})]})}),e.jsx(Ke,{children:e.jsx(ke,{variant:"outline",children:L.id})}),e.jsx(Ke,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono",children:L.priority}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(_,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>F(L,"up"),disabled:L.priority===1,children:e.jsx(Qr,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>F(L,"down"),children:e.jsx(za,{className:"h-3 w-3"})})]})]})}),e.jsx(Ke,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>A(L),children:e.jsx(Kn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>E(L.id),children:e.jsx(ns,{className:"h-4 w-4 text-destructive"})})]})})]},L.id))})]})}),e.jsx("div",{className:"md:hidden p-4 space-y-4",children:r.map(L=>e.jsx(Ce,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold",children:L.name}),L.enabled&&e.jsx(ke,{variant:"default",className:"text-xs",children:""})]}),e.jsx(ke,{variant:"outline",className:"mt-1 text-xs",children:L.id})]}),e.jsx(Ve,{checked:L.enabled,onCheckedChange:()=>C(L)})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Raw: "}),e.jsx("span",{className:"break-all",children:L.raw_prefix})]}),e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:": "}),e.jsx("span",{className:"font-mono",children:L.priority})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t",children:[e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>A(L),children:[e.jsx(Kn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>F(L,"up"),disabled:L.priority===1,children:e.jsx(Qr,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>F(L,"down"),children:e.jsx(za,{className:"h-4 w-4"})}),e.jsx(_,{variant:"destructive",size:"sm",onClick:()=>E(L.id),children:e.jsx(ns,{className:"h-4 w-4"})})]})]})},L.id))})]}),e.jsx(Ps,{open:N,onOpenChange:v,children:e.jsxs(Ds,{className:"max-w-lg",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:" Git "})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-id",children:" ID *"}),e.jsx(ae,{id:"add-id",placeholder:": my-mirror",value:y.id,onChange:L=>O({...y,id:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-name",children:" *"}),e.jsx(ae,{id:"add-name",placeholder:": ",value:y.name,onChange:L=>O({...y,name:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-raw",children:"Raw  *"}),e.jsx(ae,{id:"add-raw",placeholder:"https://example.com/raw",value:y.raw_prefix,onChange:L=>O({...y,raw_prefix:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-clone",children:" *"}),e.jsx(ae,{id:"add-clone",placeholder:"https://example.com/clone",value:y.clone_prefix,onChange:L=>O({...y,clone_prefix:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-priority",children:""}),e.jsx(ae,{id:"add-priority",type:"number",min:"1",value:y.priority,onChange:L=>O({...y,priority:parseInt(L.target.value)||1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"add-enabled",checked:y.enabled,onCheckedChange:L=>O({...y,enabled:L})}),e.jsx(T,{htmlFor:"add-enabled",children:""})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>v(!1),children:""}),e.jsx(_,{onClick:S,children:""})]})]})}),e.jsx(Ps,{open:w,onOpenChange:b,children:e.jsxs(Ds,{className:"max-w-lg",children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:" ID"}),e.jsx(ae,{value:y.id,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-name",children:" *"}),e.jsx(ae,{id:"edit-name",value:y.name,onChange:L=>O({...y,name:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-raw",children:"Raw  *"}),e.jsx(ae,{id:"edit-raw",value:y.raw_prefix,onChange:L=>O({...y,raw_prefix:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-clone",children:" *"}),e.jsx(ae,{id:"edit-clone",value:y.clone_prefix,onChange:L=>O({...y,clone_prefix:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-priority",children:""}),e.jsx(ae,{id:"edit-priority",type:"number",min:"1",value:y.priority,onChange:L=>O({...y,priority:parseInt(L.target.value)||1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"edit-enabled",checked:y.enabled,onCheckedChange:L=>O({...y,enabled:L})}),e.jsx(T,{htmlFor:"edit-enabled",children:""})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>b(!1),children:""}),e.jsx(_,{onClick:B,children:""})]})]})})]})})}function NC({pluginId:a,compact:n=!1}){const[r,c]=m.useState(null),[d,u]=m.useState(!0),[h,f]=m.useState(0),[p,g]=m.useState(""),[N,v]=m.useState(!1),{toast:w}=Ys(),b=async()=>{u(!0);const S=await mN(a);S&&c(S),u(!1)};m.useEffect(()=>{b()},[a]);const y=async()=>{const S=await iC(a);S.success?(w({title:"",description:""}),b()):w({title:"",description:S.error||"",variant:"destructive"})},O=async()=>{const S=await cC(a);S.success?(w({title:"",description:""}),b()):w({title:"",description:S.error||"",variant:"destructive"})},R=async()=>{if(h===0){w({title:"",description:" 1 ",variant:"destructive"});return}const S=await oC(a,h,p||void 0);S.success?(w({title:"",description:""}),v(!1),f(0),g(""),b()):w({title:"",description:S.error||"",variant:"destructive"})};return d?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Xt,{className:"h-4 w-4"}),e.jsx("span",{children:"-"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(mn,{className:"h-4 w-4"}),e.jsx("span",{children:"-"})]})]}):r?n?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",title:`: ${r.downloads.toLocaleString()}`,children:[e.jsx(Xt,{className:"h-4 w-4"}),e.jsx("span",{children:r.downloads.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1",title:`: ${r.rating.toFixed(1)} (${r.rating_count} )`,children:[e.jsx(mn,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:r.rating.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-1",title:`: ${r.likes}`,children:[e.jsx(Em,{className:"h-4 w-4"}),e.jsx("span",{children:r.likes})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(Xt,{className:"h-5 w-5 text-muted-foreground mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:r.downloads.toLocaleString()}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(mn,{className:"h-5 w-5 text-yellow-400 mb-1 fill-yellow-400"}),e.jsx("span",{className:"text-2xl font-bold",children:r.rating.toFixed(1)}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[r.rating_count," "]})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(Em,{className:"h-5 w-5 text-green-500 mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:r.likes}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(wg,{className:"h-5 w-5 text-red-500 mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:r.dislikes}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:y,children:[e.jsx(Em,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:O,children:[e.jsx(wg,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(Ps,{open:N,onOpenChange:v,children:[e.jsx(cd,{asChild:!0,children:e.jsxs(_,{variant:"default",size:"sm",children:[e.jsx(mn,{className:"h-4 w-4 mr-1"}),""]})}),e.jsxs(Ds,{children:[e.jsxs(Os,{children:[e.jsx(Ls,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(S=>e.jsx("button",{onClick:()=>f(S),className:"focus:outline-none",children:e.jsx(mn,{className:`h-8 w-8 transition-colors ${S<=h?"fill-yellow-400 text-yellow-400":"text-muted-foreground hover:text-yellow-300"}`})},S))}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h===0&&"",h===1&&"",h===2&&"",h===3&&"",h===4&&"",h===5&&""]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:""}),e.jsx(ot,{value:p,onChange:S=>g(S.target.value),placeholder:"...",rows:4,maxLength:500}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 text-right",children:[p.length," / 500"]})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>v(!1),children:""}),e.jsx(_,{onClick:R,disabled:h===0,children:""})]})]})]})]}),r.recent_ratings&&r.recent_ratings.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"space-y-3",children:r.recent_ratings.map((S,B)=>e.jsxs("div",{className:"p-3 rounded-lg border bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(E=>e.jsx(mn,{className:`h-3 w-3 ${E<=S.rating?"fill-yellow-400 text-yellow-400":"text-muted-foreground"}`},E))}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(S.created_at).toLocaleDateString()})]}),S.comment&&e.jsx("p",{className:"text-sm text-muted-foreground",children:S.comment})]},B))})]})]}):null}const bC={"Group Management":"","Entertainment & Interaction":"","Utility Tools":"","Content Generation":"",Multimedia:"","External Integration":"","Data Analysis & Insights":"",Other:""};function yC(){const a=ca(),n=J0({strict:!1}),{toast:r}=Ys(),[c,d]=m.useState(null),[u,h]=m.useState(""),[f,p]=m.useState(!0),[g,N]=m.useState(!0),[v,w]=m.useState(null),[b,y]=m.useState(null),[O,R]=m.useState(null),[S,B]=m.useState(!1),[E,C]=m.useState(),[A,F]=m.useState(!1);m.useEffect(()=>{(async()=>{if(!n.pluginId){w(" ID"),p(!1);return}try{p(!0),w(null);const fe=await _e("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:"Mai-with-u",repo:"plugin-repo",branch:"main",file_path:"plugin_details.json"})});if(!fe.ok)throw new Error("");const ge=await fe.json();if(!ge.success||!ge.data)throw new Error(ge.error||"");const K=JSON.parse(ge.data).find(pe=>pe.id===n.pluginId);if(!K)throw new Error("");const P={id:K.id,manifest:K.manifest,downloads:0,rating:0,review_count:0,installed:!1,published_at:new Date().toISOString(),updated_at:new Date().toISOString()};d(P);const[ue,Q,Se]=await Promise.all([rN(),iN(),Dl()]);y(ue),R(Q),B(hn(n.pluginId,Se)),C(fn(n.pluginId,Se))}catch(fe){w(fe instanceof Error?fe.message:"")}finally{p(!1)}})()},[n.pluginId]),m.useEffect(()=>{(async()=>{if(!c?.manifest?.repository_url){N(!1);return}try{if(N(!0),S&&n.pluginId)try{const Q=await _e(`/api/webui/plugins/local-readme/${n.pluginId}`);if(Q.ok){const Se=await Q.json();if(Se.success&&Se.data){h(Se.data),N(!1);return}}}catch(Q){console.log(" README :",Q)}const fe=c.manifest.repository_url.match(/github\.com\/([^/]+)\/([^/\s]+)/);if(!fe){h("");return}const[,ge,M]=fe,K=M.replace(/\.git$/,""),P=await _e("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:ge,repo:K,branch:"main",file_path:"README.md"})});if(!P.ok)throw new Error(" README ");const ue=await P.json();ue.success&&ue.data?h(ue.data):h(" README ")}catch(fe){console.error(" README :",fe),h(" README ")}finally{N(!1)}})()},[c,S,n.pluginId]);const L=()=>!c||!S||!E?!1:E!==c.manifest.version,J=()=>!c||!O?!0:cN(c.manifest.host_application.min_version,c.manifest.host_application.max_version,O),U=async()=>{if(!(!c||!b?.installed))try{F(!0),await oN(c.id,c.manifest.repository_url||"","main"),xN(c.id).catch(fe=>{console.warn("Failed to record download:",fe)}),r({title:"",description:`${c.manifest.name} `});const re=await Dl();B(hn(c.id,re)),C(fn(c.id,re))}catch(re){r({title:"",description:re instanceof Error?re.message:"",variant:"destructive"})}finally{F(!1)}},oe=async()=>{if(c)try{F(!0),await dN(c.id),r({title:"",description:`${c.manifest.name} `});const re=await Dl();B(hn(c.id,re)),C(fn(c.id,re))}catch(re){r({title:"",description:re instanceof Error?re.message:"",variant:"destructive"})}finally{F(!1)}},Ne=async()=>{if(!(!c||!b?.installed))try{F(!0);const re=await uN(c.id,c.manifest.repository_url||"","main");r({title:"",description:`${c.manifest.name}  ${re.old_version}  ${re.new_version}`});const fe=await Dl();B(hn(c.id,fe)),C(fn(c.id,fe))}catch(re){r({title:"",description:re instanceof Error?re.message:"",variant:"destructive"})}finally{F(!1)}};if(f)return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),children:e.jsx(Ma,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""})})]}),e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(zs,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"..."})]})]});if(v||!c)return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),children:e.jsx(Ma,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""})})]}),e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(_t,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:v}),e.jsx(_,{onClick:()=>a({to:"/plugins"}),children:""})]})})]});const je=J();return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),className:"shrink-0",children:e.jsx(Ma,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:c.manifest.name})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:S?e.jsxs(e.Fragment,{children:[L()?e.jsx(_,{disabled:!b?.installed||A,onClick:Ne,title:b?.installed?void 0:"Git ",children:A?e.jsxs(e.Fragment,{children:[e.jsx(zs,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(dt,{className:"h-4 w-4 mr-2"}),""]})}):null,e.jsx(_,{variant:"destructive",disabled:!b?.installed||A,onClick:oe,title:b?.installed?void 0:"Git ",children:A?e.jsxs(e.Fragment,{children:[e.jsx(zs,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),""]})})]}):e.jsx(_,{disabled:!b?.installed||!je||A,onClick:U,title:b?.installed?je?void 0:` ( ${c.manifest.host_application.min_version}${c.manifest.host_application.max_version?` - ${c.manifest.host_application.max_version}`:"+"} ${O?.version})`:"Git ",children:A?e.jsxs(e.Fragment,{children:[e.jsx(zs,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Xt,{className:"h-4 w-4 mr-2"}),""]})})})]}),e.jsx(Je,{className:"h-[calc(100vh-200px)] sm:h-[calc(100vh-220px)]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[e.jsx(Ce,{children:e.jsx(De,{children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx(Oe,{className:"text-2xl",children:c.manifest.name}),e.jsxs(ke,{variant:"secondary",className:"text-sm",children:["v",c.manifest.version]}),S&&e.jsxs(ke,{variant:"default",className:"text-sm",children:[e.jsx(pt,{className:"h-3 w-3 mr-1"})," ",E&&`(v${E})`]}),L()&&e.jsxs(ke,{variant:"outline",className:"text-sm border-orange-500 text-orange-500",children:[e.jsx(dt,{className:"h-3 w-3 mr-1"}),""]}),!je&&e.jsxs(ke,{variant:"destructive",className:"text-sm",children:[e.jsx(_t,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsx(os,{className:"text-base",children:c.manifest.description})]})})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Oe,{className:"text-lg",children:""})}),e.jsx(Me,{children:e.jsx(NC,{pluginId:c.id})})]}),e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Oe,{className:"text-lg",children:""})}),e.jsx(Me,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(jn,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-medium",children:c.manifest.author?.name||"Unknown"}),c.manifest.author?.url&&e.jsx("a",{href:c.manifest.author.url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:e.jsx($o,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ra,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"font-medium",children:["v",c.manifest.version]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ev,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-medium",children:c.manifest.license})]}),c.manifest.homepage_url&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Vo,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("a",{href:c.manifest.homepage_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1",children:["",e.jsx($o,{className:"h-3 w-3"})]})]}),c.manifest.repository_url&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(I_,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("a",{href:c.manifest.repository_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1",children:["GitHub",e.jsx($o,{className:"h-3 w-3"})]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-2",children:[e.jsx(Ft,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"})]}),e.jsxs("div",{className:"text-sm pl-6 font-medium",children:[c.manifest.host_application.min_version,c.manifest.host_application.max_version?` - ${c.manifest.host_application.max_version}`:" - "]})]})]})})]}),(c.manifest.categories||c.manifest.keywords)&&e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Oe,{className:"text-lg",children:""})}),e.jsxs(Me,{className:"space-y-4",children:[c.manifest.categories&&c.manifest.categories.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.manifest.categories.map(re=>e.jsx(ke,{variant:"secondary",children:bC[re]||re},re))})]}),c.manifest.keywords&&c.manifest.keywords.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.manifest.keywords.map(re=>e.jsxs(ke,{variant:"outline",className:"text-xs",children:[e.jsx(rd,{className:"h-3 w-3 mr-1"}),re]},re))})]})]})]})]}),e.jsxs(Ce,{className:"lg:col-span-2",children:[e.jsx(De,{children:e.jsx(Oe,{className:"text-lg",children:""})}),e.jsx(Me,{children:e.jsx(Je,{className:"h-[600px] pr-4",children:g?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(zs,{className:"h-6 w-6 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-sm text-muted-foreground",children:"..."})]}):u?e.jsx(fx,{content:u}):e.jsx("div",{className:"text-center text-muted-foreground py-12",children:""})})})]})]})]})})]})}const Zi=m.forwardRef(({className:a,...n},r)=>e.jsx(_j,{ref:r,className:I("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...n}));Zi.displayName=_j.displayName;const wC=m.forwardRef(({className:a,...n},r)=>e.jsx(Sj,{ref:r,className:I("aspect-square h-full w-full",a),...n}));wC.displayName=Sj.displayName;const Wi=m.forwardRef(({className:a,...n},r)=>e.jsx(kj,{ref:r,className:I("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...n}));Wi.displayName=kj.displayName;function _C(){return"webui_"+Math.random().toString(36).substr(2,9)+"_"+Date.now().toString(36)}function SC(){const a="maibot_webui_user_id";let n=localStorage.getItem(a);return n||(n=_C(),localStorage.setItem(a,n)),n}function kC(){return localStorage.getItem("maibot_webui_user_name")||"WebUI"}function CC(a){localStorage.setItem("maibot_webui_user_name",a)}const hN="maibot_webui_virtual_tabs";function TC(){try{const a=localStorage.getItem(hN);if(a)return JSON.parse(a)}catch(a){console.error("[Chat] :",a)}return[]}function Zg(a){try{localStorage.setItem(hN,JSON.stringify(a))}catch(n){console.error("[Chat] :",n)}}function EC({segment:a}){switch(a.type){case"text":return e.jsx("span",{className:"whitespace-pre-wrap",children:String(a.data)});case"image":case"emoji":return e.jsx("img",{src:String(a.data),alt:a.type==="emoji"?"":"",className:I("rounded-lg max-w-full",a.type==="emoji"?"max-h-32":"max-h-64"),loading:"lazy",onError:n=>{const r=n.target;r.style.display="none",r.parentElement?.insertAdjacentHTML("beforeend",`<span class="text-muted-foreground text-xs">[${a.type==="emoji"?"":""}]</span>`)}});case"voice":return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("audio",{controls:!0,src:String(a.data),className:"max-w-[200px] h-8",children:""})});case"video":return e.jsx("video",{controls:!0,src:String(a.data),className:"rounded-lg max-w-full max-h-64",children:""});case"face":return e.jsxs("span",{className:"text-muted-foreground",children:["[:",String(a.data),"]"]});case"music":return e.jsx("span",{className:"text-muted-foreground",children:"[]"});case"file":return e.jsxs("span",{className:"text-muted-foreground",children:["[: ",String(a.data),"]"]});case"reply":return e.jsx("span",{className:"text-muted-foreground text-xs",children:"[]"});case"forward":return e.jsx("span",{className:"text-muted-foreground",children:"[]"});case"unknown":default:return e.jsxs("span",{className:"text-muted-foreground",children:["[",a.original_type||"","]"]})}}function MC({message:a,isBot:n}){return a.message_type==="rich"&&a.segments&&a.segments.length>0?e.jsx("div",{className:"flex flex-col gap-2",children:a.segments.map((r,c)=>e.jsx(EC,{segment:r},c))}):e.jsx("span",{className:"whitespace-pre-wrap",children:a.content})}function AC(){const a={id:"webui-default",type:"webui",label:"WebUI",messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}},n=()=>{const qe=TC().map(Qe=>{const es=Qe.virtualConfig;return!es.groupId&&es.platform&&es.userId&&(es.groupId=`webui_virtual_group_${es.platform}_${es.userId}`),{id:Qe.id,type:"virtual",label:Qe.label,virtualConfig:es,messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}}});return[a,...qe]},[r,c]=m.useState(n),[d,u]=m.useState("webui-default"),h=r.find(q=>q.id===d)||r[0],[f,p]=m.useState(""),[g,N]=m.useState(!1),[v,w]=m.useState(!0),[b,y]=m.useState(kC()),[O,R]=m.useState(!1),[S,B]=m.useState(""),[E,C]=m.useState(!1),[A,F]=m.useState([]),[L,J]=m.useState([]),[U,oe]=m.useState(!1),[Ne,je]=m.useState(!1),[re,fe]=m.useState(""),[ge,M]=m.useState({platform:"",personId:"",userId:"",userName:"",groupName:"",groupId:""}),K=m.useRef(SC()),P=m.useRef(new Map),ue=m.useRef(null),Q=m.useRef(new Map),Se=m.useRef(0),pe=m.useRef(new Map),{toast:Te}=Ys(),z=q=>(Se.current+=1,`${q}-${Date.now()}-${Se.current}-${Math.random().toString(36).substr(2,9)}`),D=m.useCallback((q,qe)=>{c(Qe=>Qe.map(es=>es.id===q?{...es,...qe}:es))},[]),G=m.useCallback((q,qe)=>{c(Qe=>Qe.map(es=>es.id===q?{...es,messages:[...es.messages,qe]}:es))},[]),de=m.useCallback(()=>{ue.current?.scrollIntoView({behavior:"smooth"})},[]);m.useEffect(()=>{de()},[h?.messages,de]);const Re=m.useCallback(async()=>{oe(!0);try{const q=await _e("/api/chat/platforms");if(console.log("[Chat] :",q.status,q.headers.get("content-type")),q.ok){const qe=q.headers.get("content-type");if(qe&&qe.includes("application/json")){const Qe=await q.json();console.log("[Chat] :",Qe),F(Qe.platforms||[])}else{const Qe=await q.text();console.error("[Chat] :  JSON :",Qe.substring(0,200)),Te({title:"",description:" MaiBot ",variant:"destructive"})}}else console.error("[Chat] : HTTP",q.status),Te({title:"",description:`: ${q.status}`,variant:"destructive"})}catch(q){console.error("[Chat] :",q),Te({title:"",description:"",variant:"destructive"})}finally{oe(!1)}},[Te]),W=m.useCallback(async(q,qe)=>{je(!0);try{const Qe=new URLSearchParams;q&&Qe.append("platform",q),qe&&Qe.append("search",qe),Qe.append("limit","50");const es=await _e(`/api/chat/persons?${Qe.toString()}`);if(es.ok){const Us=es.headers.get("content-type");if(Us&&Us.includes("application/json")){const as=await es.json();J(as.persons||[])}else console.error("[Chat] :  JSON ")}}catch(Qe){console.error("[Chat] :",Qe)}finally{je(!1)}},[]);m.useEffect(()=>{ge.platform&&W(ge.platform,re)},[ge.platform,re,W]);const Y=m.useCallback(async(q,qe)=>{w(!0);try{const Qe=new URLSearchParams;Qe.append("user_id",K.current),Qe.append("limit","50"),qe&&Qe.append("group_id",qe);const es=`/api/chat/history?${Qe.toString()}`;console.log("[Chat] :",es);const Us=await _e(es);if(Us.ok){const as=await Us.text();try{const Cs=JSON.parse(as);if(Cs.messages&&Cs.messages.length>0){const ze=Cs.messages.map(ls=>({id:ls.id,type:ls.type,content:ls.content,timestamp:ls.timestamp,sender:{name:ls.sender_name||(ls.is_bot?"":"WebUI"),user_id:ls.user_id,is_bot:ls.is_bot}}));D(q,{messages:ze});const bs=pe.current.get(q)||new Set;ze.forEach(ls=>{if(ls.type==="bot"){const ss=`bot-${ls.content}-${Math.floor(ls.timestamp*1e3)}`;bs.add(ss)}}),pe.current.set(q,bs)}}catch(Cs){console.error("[Chat] JSON :",Cs)}}}catch(Qe){console.error("[Chat] :",Qe)}finally{w(!1)}},[D]),Fe=m.useCallback(async(q,qe,Qe)=>{const es=P.current.get(q);if(es?.readyState===WebSocket.OPEN||es?.readyState===WebSocket.CONNECTING){console.log(`[Tab ${q}] WebSocket `);return}N(!0);let Us=null;try{const bs=await _e("/api/webui/ws-token");if(bs.ok){const ls=await bs.json();if(ls.success&&ls.token)Us=ls.token;else{console.warn(`[Tab ${q}]  WebSocket token : ${ls.message||""}`),N(!1);return}}}catch(bs){console.error(`[Tab ${q}]  WebSocket token :`,bs),N(!1);return}if(!Us){N(!1);return}const as=window.location.protocol==="https:"?"wss:":"ws:",Cs=new URLSearchParams;Cs.append("token",Us),qe==="virtual"&&Qe?(Cs.append("user_id",Qe.userId),Cs.append("user_name",Qe.userName),Cs.append("platform",Qe.platform),Cs.append("person_id",Qe.personId),Cs.append("group_name",Qe.groupName||"WebUI"),Qe.groupId&&Cs.append("group_id",Qe.groupId)):(Cs.append("user_id",K.current),Cs.append("user_name",b));const ze=`${as}//${window.location.host}/api/chat/ws?${Cs.toString()}`;console.log(`[Tab ${q}]  WebSocket:`,ze);try{const bs=new WebSocket(ze);P.current.set(q,bs),bs.onopen=()=>{D(q,{isConnected:!0}),N(!1),console.log(`[Tab ${q}] WebSocket `)},bs.onmessage=ls=>{try{const ss=JSON.parse(ls.data);switch(ss.type){case"session_info":D(q,{sessionInfo:{session_id:ss.session_id,user_id:ss.user_id,user_name:ss.user_name,bot_name:ss.bot_name}});break;case"system":G(q,{id:z("sys"),type:"system",content:ss.content||"",timestamp:ss.timestamp||Date.now()/1e3});break;case"user_message":{const ys=ss.sender?.user_id,gt=qe==="virtual"&&Qe?Qe.userId:K.current;console.log(`[Tab ${q}]  user_message, sender: ${ys}, current: ${gt}`);const $t=ys?ys.replace(/^webui_user_/,""):"",tt=gt?gt.replace(/^webui_user_/,""):"";if($t&&tt&&$t===tt){console.log(`[Tab ${q}] user_id `);break}const Ms=pe.current.get(q)||new Set,Et=`user-${ss.content}-${Math.floor((ss.timestamp||0)*1e3)}`;if(Ms.has(Et)){console.log(`[Tab ${q}] `);break}if(Ms.add(Et),pe.current.set(q,Ms),Ms.size>100){const Bt=Ms.values().next().value;Bt&&Ms.delete(Bt)}G(q,{id:ss.message_id||z("user"),type:"user",content:ss.content||"",timestamp:ss.timestamp||Date.now()/1e3,sender:ss.sender});break}case"bot_message":{D(q,{isTyping:!1});const ys=pe.current.get(q)||new Set,gt=`bot-${ss.content}-${Math.floor((ss.timestamp||0)*1e3)}`;if(ys.has(gt))break;if(ys.add(gt),pe.current.set(q,ys),ys.size>100){const $t=ys.values().next().value;$t&&ys.delete($t)}c($t=>$t.map(tt=>{if(tt.id!==q)return tt;const Ms=tt.messages.filter(Bt=>Bt.type!=="thinking"),Et={id:z("bot"),type:"bot",content:ss.content||"",message_type:ss.message_type==="rich"?"rich":"text",segments:ss.segments,timestamp:ss.timestamp||Date.now()/1e3,sender:ss.sender};return{...tt,messages:[...Ms,Et]}}));break}case"typing":D(q,{isTyping:ss.is_typing||!1});break;case"error":c(ys=>ys.map(gt=>{if(gt.id!==q)return gt;const $t=gt.messages.filter(tt=>tt.type!=="thinking");return{...gt,messages:[...$t,{id:z("error"),type:"error",content:ss.content||"",timestamp:ss.timestamp||Date.now()/1e3}]}})),Te({title:"",description:ss.content,variant:"destructive"});break;case"pong":break;case"history":{const ys=ss.messages||[];if(ys.length>0){const gt=pe.current.get(q)||new Set,$t=ys.map(tt=>{const Ms=tt.is_bot||!1,Et=tt.id||z(Ms?"bot":"user"),Bt=`${Ms?"bot":"user"}-${tt.content}-${Math.floor(tt.timestamp*1e3)}`;return gt.add(Bt),{id:Et,type:Ms?"bot":"user",content:tt.content,timestamp:tt.timestamp,sender:{name:tt.sender_name||(Ms?"":""),user_id:tt.sender_id,is_bot:Ms}}});pe.current.set(q,gt),D(q,{messages:$t}),console.log(`[Tab ${q}]  ${$t.length} `)}break}default:console.log(":",ss.type)}}catch(ss){console.error(":",ss)}},bs.onclose=()=>{D(q,{isConnected:!1}),N(!1),P.current.delete(q),console.log(`[Tab ${q}] WebSocket `);const ls=Q.current.get(q);ls&&clearTimeout(ls);const ss=window.setTimeout(()=>{if(!H.current){const ys=r.find(gt=>gt.id===q);ys&&Fe(q,ys.type,ys.virtualConfig)}},5e3);Q.current.set(q,ss)},bs.onerror=ls=>{console.error(`[Tab ${q}] WebSocket :`,ls),N(!1)}}catch(bs){console.error(`[Tab ${q}]  WebSocket :`,bs),N(!1)}},[b,D,G,Te,r]),H=m.useRef(!1);m.useEffect(()=>{H.current=!1;const q=P.current,qe=Q.current,Qe=pe.current;Y("webui-default");const es=setTimeout(()=>{H.current||(Fe("webui-default","webui"),r.forEach(as=>{as.type==="virtual"&&as.virtualConfig&&(Qe.set(as.id,new Set),setTimeout(()=>{H.current||Fe(as.id,"virtual",as.virtualConfig)},200))}))},100),Us=setInterval(()=>{q.forEach(as=>{as.readyState===WebSocket.OPEN&&as.send(JSON.stringify({type:"ping"}))})},3e4);return()=>{H.current=!0,clearTimeout(es),clearInterval(Us),qe.forEach(as=>{clearTimeout(as)}),qe.clear(),q.forEach(as=>{as.close()}),q.clear()}},[]);const ee=m.useCallback(()=>{const q=P.current.get(d);if(!f.trim()||!q||q.readyState!==WebSocket.OPEN)return;const qe=h?.type==="virtual"&&h.virtualConfig?.userName||b,Qe=f.trim(),es=Date.now()/1e3;q.send(JSON.stringify({type:"message",content:Qe,user_name:qe}));const Us=pe.current.get(d)||new Set,as=`user-${Qe}-${Math.floor(es*1e3)}`;if(Us.add(as),pe.current.set(d,Us),Us.size>100){const bs=Us.values().next().value;bs&&Us.delete(bs)}const Cs={id:z("user"),type:"user",content:Qe,timestamp:es,sender:{name:qe,is_bot:!1}};G(d,Cs);const ze={id:z("thinking"),type:"thinking",content:"",timestamp:es+.001,sender:{name:h?.sessionInfo.bot_name||"",is_bot:!0}};G(d,ze),p("")},[f,b,d,h,G]),Ue=q=>{q.key==="Enter"&&!q.shiftKey&&(q.preventDefault(),ee())},ie=()=>{B(b),R(!0)},Ee=()=>{const q=S.trim()||"WebUI";y(q),CC(q),R(!1);const qe=P.current.get(d);qe?.readyState===WebSocket.OPEN&&qe.send(JSON.stringify({type:"update_nickname",user_name:q}))},me=()=>{B(""),R(!1)},Ae=q=>new Date(q*1e3).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),rs=()=>{const q=P.current.get(d);q&&(q.close(),P.current.delete(d)),Fe(d,h?.type||"webui",h?.virtualConfig)},Ut=()=>{M({platform:"",personId:"",userId:"",userName:"",groupName:"",groupId:""}),fe(""),Re(),C(!0)},aa=()=>{if(!ge.platform||!ge.personId){Te({title:"",description:"",variant:"destructive"});return}const q=`webui_virtual_group_${ge.platform}_${ge.userId}`,qe=`virtual-${ge.platform}-${ge.userId}-${Date.now()}`,Qe=ge.userName||ge.userId,es={id:qe,type:"virtual",label:Qe,virtualConfig:{...ge,groupId:q},messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}};c(Us=>{const as=[...Us,es],Cs=as.filter(ze=>ze.type==="virtual"&&ze.virtualConfig).map(ze=>({id:ze.id,label:ze.label,virtualConfig:ze.virtualConfig,createdAt:Date.now()}));return Zg(Cs),as}),u(qe),C(!1),pe.current.set(qe,new Set),setTimeout(()=>{Fe(qe,"virtual",ge)},100),Te({title:"",description:` ${Qe} `})},Ja=(q,qe)=>{if(qe?.stopPropagation(),q==="webui-default")return;const Qe=P.current.get(q);Qe&&(Qe.close(),P.current.delete(q));const es=Q.current.get(q);es&&(clearTimeout(es),Q.current.delete(q)),pe.current.delete(q),c(Us=>{const as=Us.filter(ze=>ze.id!==q),Cs=as.filter(ze=>ze.type==="virtual"&&ze.virtualConfig).map(ze=>({id:ze.id,label:ze.label,virtualConfig:ze.virtualConfig,createdAt:Date.now()}));return Zg(Cs),as}),d===q&&u("webui-default")},Ht=q=>{u(q)},mt=q=>{M(qe=>({...qe,personId:q.person_id,userId:q.user_id,userName:q.nickname||q.person_name}))};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(Ps,{open:E,onOpenChange:C,children:e.jsxs(Ds,{className:"sm:max-w-[500px] max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs(Os,{children:[e.jsxs(Ls,{className:"flex items-center gap-2",children:[e.jsx(Mm,{className:"h-5 w-5"}),""]}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(Vo,{className:"h-4 w-4"}),""]}),e.jsxs(Pe,{value:ge.platform,onValueChange:q=>{M(qe=>({...qe,platform:q,personId:"",userId:"",userName:""})),J([])},children:[e.jsx($e,{disabled:U,children:e.jsx(Ie,{placeholder:U?"...":""})}),e.jsx(Be,{children:A.map(q=>e.jsxs(Z,{value:q.platform,children:[q.platform," (",q.count," )"]},q.platform))})]})]}),ge.platform&&e.jsxs("div",{className:"space-y-2 flex-1 overflow-hidden flex flex-col",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(ic,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"relative",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:re,onChange:q=>fe(q.target.value),className:"pl-9"})]}),e.jsx(Je,{className:"h-[250px] border rounded-md",children:e.jsx("div",{className:"p-2",children:Ne?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(zs,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):L.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(ic,{className:"h-8 w-8 mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:""})]}):e.jsx("div",{className:"space-y-1",children:L.map(q=>e.jsxs("button",{onClick:()=>mt(q),className:I("w-full flex items-center gap-3 p-2 rounded-md text-left transition-colors",ge.personId===q.person_id?"bg-primary text-primary-foreground":"hover:bg-muted"),children:[e.jsx(Zi,{className:"h-8 w-8 shrink-0",children:e.jsx(Wi,{className:I("text-xs",ge.personId===q.person_id?"bg-primary-foreground/20":"bg-muted"),children:(q.nickname||q.person_name||"?").charAt(0)})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium truncate",children:q.nickname||q.person_name}),e.jsxs("div",{className:I("text-xs truncate",ge.personId===q.person_id?"text-primary-foreground/70":"text-muted-foreground"),children:["ID: ",q.user_id,q.is_known&&"  "]})]})]},q.person_id))})})})]}),ge.personId&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{placeholder:"WebUI",value:ge.groupName,onChange:q=>M(qe=>({...qe,groupName:q.target.value}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]}),e.jsxs(st,{className:"gap-2 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:()=>C(!1),children:""}),e.jsx(_,{onClick:aa,disabled:!ge.platform||!ge.personId,children:""})]})]})}),e.jsx("div",{className:"shrink-0 border-b bg-muted/30",children:e.jsx("div",{className:"max-w-4xl mx-auto px-2 sm:px-4",children:e.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto py-1.5 scrollbar-thin",children:[r.map(q=>e.jsxs("div",{className:I("flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm whitespace-nowrap transition-colors cursor-pointer","hover:bg-muted",d===q.id?"bg-background shadow-sm border":"text-muted-foreground"),onClick:()=>Ht(q.id),children:[q.type==="webui"?e.jsx(Ra,{className:"h-3.5 w-3.5"}):e.jsx(Mm,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"max-w-[100px] truncate",children:q.label}),e.jsx("span",{className:I("w-1.5 h-1.5 rounded-full",q.isConnected?"bg-green-500":"bg-muted-foreground/50")}),q.id!=="webui-default"&&e.jsx("span",{onClick:qe=>Ja(q.id,qe),className:"ml-0.5 p-0.5 rounded hover:bg-muted-foreground/20 cursor-pointer",role:"button",tabIndex:0,onKeyDown:qe=>{(qe.key==="Enter"||qe.key===" ")&&(qe.preventDefault(),Ja(q.id,qe))},children:e.jsx(Aa,{className:"h-3 w-3"})})]},q.id)),e.jsx("button",{onClick:Ut,className:"flex items-center gap-1 px-2 py-1.5 rounded-md text-sm text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",title:"",children:e.jsx(et,{className:"h-3.5 w-3.5"})})]})})}),e.jsx("div",{className:"shrink-0 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[e.jsx(Zi,{className:"h-8 w-8 sm:h-10 sm:w-10 shrink-0",children:e.jsx(Wi,{className:"bg-primary/10 text-primary",children:e.jsx(Vn,{className:"h-4 w-4 sm:h-5 sm:w-5"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:h?.sessionInfo.bot_name||""}),e.jsx("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:h?.isConnected?e.jsxs(e.Fragment,{children:[e.jsx(F_,{className:"h-3 w-3 text-green-500"}),e.jsx("span",{className:"text-green-600 dark:text-green-400",children:""})]}):g?e.jsxs(e.Fragment,{children:[e.jsx(zs,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(H_,{className:"h-3 w-3 text-red-500"}),e.jsx("span",{className:"text-red-600 dark:text-red-400",children:""})]})})]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[v&&e.jsx(zs,{className:"h-4 w-4 animate-spin text-muted-foreground"}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:rs,disabled:g,title:"",children:e.jsx(dt,{className:I("h-4 w-4",g&&"animate-spin")})})]})]}),e.jsx("div",{className:"hidden sm:flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:h?.type==="virtual"&&h.virtualConfig?e.jsxs(e.Fragment,{children:[e.jsx(Mm,{className:"h-3 w-3 text-primary"}),e.jsx("span",{children:""}),e.jsx("span",{className:"font-medium text-primary",children:h.virtualConfig.userName}),e.jsxs("span",{className:"text-xs",children:["(",h.virtualConfig.platform,")"]}),h.virtualConfig.groupName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1",children:""}),e.jsxs("span",{className:"text-xs",children:["",h.virtualConfig.groupName]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(jn,{className:"h-3 w-3"}),e.jsx("span",{children:""}),O?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{value:S,onChange:q=>B(q.target.value),onKeyDown:q=>{q.key==="Enter"&&Ee(),q.key==="Escape"&&me()},className:"h-7 w-32",placeholder:"",autoFocus:!0}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:Ee,children:""}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:me,children:""})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium text-foreground",children:b}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:ie,title:"",children:e.jsx(V_,{className:"h-3 w-3"})})]})]})})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto space-y-3 sm:space-y-4",children:[h?.messages.length===0&&!v&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[e.jsx(Vn,{className:"h-12 w-12 mb-4 opacity-50"}),e.jsxs("p",{className:"text-sm",children:[" ",h?.sessionInfo.bot_name||""," "]})]}),h?.messages.map(q=>e.jsxs("div",{className:I("flex gap-2 sm:gap-3",q.type==="user"&&"flex-row-reverse",q.type==="system"&&"justify-center",q.type==="error"&&"justify-center"),children:[q.type==="system"&&e.jsx("div",{className:"text-xs text-muted-foreground bg-muted/50 px-3 py-1 rounded-full max-w-[90%]",children:q.content}),q.type==="error"&&e.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/30 px-3 py-1 rounded-full max-w-[90%]",children:q.content}),q.type==="thinking"&&e.jsxs(e.Fragment,{children:[e.jsx(Zi,{className:"h-7 w-7 sm:h-8 sm:w-8 shrink-0",children:e.jsx(Wi,{className:"bg-primary/10 text-primary",children:e.jsx(Vn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})}),e.jsxs("div",{className:"flex flex-col gap-1 max-w-[75%] sm:max-w-[70%]",children:[e.jsx("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-muted-foreground",children:e.jsx("span",{className:"hidden sm:inline",children:q.sender?.name||h?.sessionInfo.bot_name})}),e.jsx("div",{className:"bg-muted rounded-2xl rounded-tl-sm px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"..."})]})})]})]}),(q.type==="user"||q.type==="bot")&&e.jsxs(e.Fragment,{children:[e.jsx(Zi,{className:"h-7 w-7 sm:h-8 sm:w-8 shrink-0",children:e.jsx(Wi,{className:I("text-xs",q.type==="bot"?"bg-primary/10 text-primary":"bg-secondary text-secondary-foreground"),children:q.type==="bot"?e.jsx(Vn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}):e.jsx(jn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})}),e.jsxs("div",{className:I("flex flex-col gap-1 max-w-[75%] sm:max-w-[70%]",q.type==="user"&&"items-end"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-muted-foreground",children:[e.jsx("span",{className:"hidden sm:inline",children:q.sender?.name||(q.type==="bot"?h?.sessionInfo.bot_name:b)}),e.jsx("span",{children:Ae(q.timestamp)})]}),e.jsx("div",{className:I("rounded-2xl px-3 py-2 text-sm break-words",q.type==="bot"?"bg-muted rounded-tl-sm":"bg-primary text-primary-foreground rounded-tr-sm"),children:e.jsx(MC,{message:q,isBot:q.type==="bot"})})]})]})]},q.id)),e.jsx("div",{ref:ue})]})})}),e.jsx("div",{className:"shrink-0 border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{value:f,onChange:q=>p(q.target.value),onKeyDown:Ue,placeholder:h?.isConnected?"...":"...",disabled:!h?.isConnected,className:"flex-1 h-10 sm:h-10"}),e.jsx(_,{onClick:ee,disabled:!h?.isConnected||!f.trim(),size:"icon",className:"h-10 w-10 shrink-0",children:e.jsx(G_,{className:"h-4 w-4"})})]})})})]})}var _x="Radio",[zC,fN]=td(_x),[RC,DC]=zC(_x),pN=m.forwardRef((a,n)=>{const{__scopeRadio:r,name:c,checked:d=!1,required:u,disabled:h,value:f="on",onCheck:p,form:g,...N}=a,[v,w]=m.useState(null),b=ad(n,R=>w(R)),y=m.useRef(!1),O=v?g||!!v.closest("form"):!0;return e.jsxs(RC,{scope:r,checked:d,disabled:h,children:[e.jsx(Zn.button,{type:"button",role:"radio","aria-checked":d,"data-state":NN(d),"data-disabled":h?"":void 0,disabled:h,value:f,...N,ref:b,onClick:gn(a.onClick,R=>{d||p?.(),O&&(y.current=R.isPropagationStopped(),y.current||R.stopPropagation())})}),O&&e.jsx(vN,{control:v,bubbles:!y.current,name:c,value:f,checked:d,required:u,disabled:h,form:g,style:{transform:"translateX(-100%)"}})]})});pN.displayName=_x;var gN="RadioIndicator",jN=m.forwardRef((a,n)=>{const{__scopeRadio:r,forceMount:c,...d}=a,u=DC(gN,r);return e.jsx(o_,{present:c||u.checked,children:e.jsx(Zn.span,{"data-state":NN(u.checked),"data-disabled":u.disabled?"":void 0,...d,ref:n})})});jN.displayName=gN;var OC="RadioBubbleInput",vN=m.forwardRef(({__scopeRadio:a,control:n,checked:r,bubbles:c=!0,...d},u)=>{const h=m.useRef(null),f=ad(h,u),p=d_(r),g=u_(n);return m.useEffect(()=>{const N=h.current;if(!N)return;const v=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(v,"checked").set;if(p!==r&&b){const y=new Event("click",{bubbles:c});b.call(N,r),N.dispatchEvent(y)}},[p,r,c]),e.jsx(Zn.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...d,tabIndex:-1,ref:f,style:{...d.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});vN.displayName=OC;function NN(a){return a?"checked":"unchecked"}var LC=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],fd="RadioGroup",[UC]=td(fd,[Cj,fN]),bN=Cj(),yN=fN(),[$C,BC]=UC(fd),wN=m.forwardRef((a,n)=>{const{__scopeRadioGroup:r,name:c,defaultValue:d,value:u,required:h=!1,disabled:f=!1,orientation:p,dir:g,loop:N=!0,onValueChange:v,...w}=a,b=bN(r),y=Gj(g),[O,R]=sd({prop:u,defaultProp:d??null,onChange:v,caller:fd});return e.jsx($C,{scope:r,name:c,required:h,disabled:f,value:O,onValueChange:R,children:e.jsx(Sw,{asChild:!0,...b,orientation:p,dir:y,loop:N,children:e.jsx(Zn.div,{role:"radiogroup","aria-required":h,"aria-orientation":p,"data-disabled":f?"":void 0,dir:y,...w,ref:n})})})});wN.displayName=fd;var _N="RadioGroupItem",SN=m.forwardRef((a,n)=>{const{__scopeRadioGroup:r,disabled:c,...d}=a,u=BC(_N,r),h=u.disabled||c,f=bN(r),p=yN(r),g=m.useRef(null),N=ad(n,g),v=u.value===d.value,w=m.useRef(!1);return m.useEffect(()=>{const b=O=>{LC.includes(O.key)&&(w.current=!0)},y=()=>w.current=!1;return document.addEventListener("keydown",b),document.addEventListener("keyup",y),()=>{document.removeEventListener("keydown",b),document.removeEventListener("keyup",y)}},[]),e.jsx(kw,{asChild:!0,...f,focusable:!h,active:v,children:e.jsx(pN,{disabled:h,required:u.required,checked:v,...p,...d,name:u.name,ref:N,onCheck:()=>u.onValueChange(d.value),onKeyDown:gn(b=>{b.key==="Enter"&&b.preventDefault()}),onFocus:gn(d.onFocus,()=>{w.current&&g.current?.click()})})})});SN.displayName=_N;var PC="RadioGroupIndicator",kN=m.forwardRef((a,n)=>{const{__scopeRadioGroup:r,...c}=a,d=yN(r);return e.jsx(jN,{...d,...c,ref:n})});kN.displayName=PC;var CN=wN,TN=SN,IC=kN;const Sx=m.forwardRef(({className:a,...n},r)=>e.jsx(CN,{className:I("grid gap-2",a),...n,ref:r}));Sx.displayName=CN.displayName;const Xo=m.forwardRef(({className:a,...n},r)=>e.jsx(TN,{ref:r,className:I("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),...n,children:e.jsx(IC,{className:"flex items-center justify-center",children:e.jsx(Ho,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Xo.displayName=TN.displayName;function FC({question:a,value:n,onChange:r,error:c,disabled:d=!1}){const[u,h]=m.useState(null),f=d||a.readOnly,p=()=>{switch(a.type){case"single":return e.jsx(Sx,{value:n||"",onValueChange:r,disabled:f,className:"space-y-2",children:a.options?.map(g=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xo,{value:g.value,id:`${a.id}-${g.id}`}),e.jsx(T,{htmlFor:`${a.id}-${g.id}`,className:"cursor-pointer font-normal",children:g.label})]},g.id))});case"multiple":{const g=n||[];return e.jsxs("div",{className:"space-y-2",children:[a.options?.map(N=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:`${a.id}-${N.id}`,checked:g.includes(N.value),disabled:f||a.maxSelections!==void 0&&g.length>=a.maxSelections&&!g.includes(N.value),onCheckedChange:v=>{r(v?[...g,N.value]:g.filter(w=>w!==N.value))}}),e.jsx(T,{htmlFor:`${a.id}-${N.id}`,className:"cursor-pointer font-normal",children:N.label})]},N.id)),a.maxSelections&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",a.maxSelections," "]})]})}case"text":return e.jsx(ae,{value:n||"",onChange:g=>r(g.target.value),placeholder:a.placeholder||"...",disabled:f,readOnly:a.readOnly,maxLength:a.maxLength,className:I(a.readOnly&&"bg-muted cursor-not-allowed")});case"textarea":return e.jsxs("div",{className:"space-y-1",children:[e.jsx(ot,{value:n||"",onChange:g=>r(g.target.value),placeholder:a.placeholder||"...",disabled:f,readOnly:a.readOnly,maxLength:a.maxLength,rows:4,className:I(a.readOnly&&"bg-muted cursor-not-allowed")}),a.maxLength&&e.jsxs("p",{className:"text-xs text-muted-foreground text-right",children:[(n||"").length," / ",a.maxLength]})]});case"rating":{const g=n||0,N=u!==null?u:g;return e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(v=>e.jsx("button",{type:"button",disabled:f,className:I("p-1 transition-colors focus:outline-none focus:ring-2 focus:ring-ring rounded",f&&"cursor-not-allowed opacity-50"),onMouseEnter:()=>!f&&h(v),onMouseLeave:()=>h(null),onClick:()=>!f&&r(v),children:e.jsx(mn,{className:I("h-6 w-6 transition-colors",v<=N?"fill-yellow-400 text-yellow-400":"text-muted-foreground")})},v)),g>0&&e.jsxs("span",{className:"ml-2 text-sm text-muted-foreground",children:[g," / 5"]})]})}case"scale":{const g=a.min??1,N=a.max??10,v=a.step??1,w=n??g;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Qa,{value:[w],onValueChange:([b])=>r(b),min:g,max:N,step:v,disabled:f}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:a.minLabel||g}),e.jsx("span",{className:"font-medium text-foreground",children:w}),e.jsx("span",{children:a.maxLabel||N})]})]})}case"dropdown":return e.jsxs(Pe,{value:n||"",onValueChange:r,disabled:f,children:[e.jsx($e,{children:e.jsx(Ie,{placeholder:a.placeholder||"..."})}),e.jsx(Be,{children:a.options?.map(g=>e.jsx(Z,{value:g.value,children:g.label},g.id))})]});default:return e.jsx("div",{className:"text-muted-foreground",children:""})}};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-base font-medium",children:[a.title,a.required&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),a.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description})]}),p(),c&&e.jsx("p",{className:"text-sm text-destructive",children:c})]})}const EN="https://maibot-plugin-stats.maibot-webui.workers.dev";function MN(){const a="maibot_user_id";let n=localStorage.getItem(a);if(!n){const r=Math.random().toString(36).substring(2,10),c=Date.now().toString(36),d=Math.random().toString(36).substring(2,10);n=`fp_${r}_${c}_${d}`,localStorage.setItem(a,n)}return n}async function HC(a,n,r,c){try{const d=c?.userId||MN(),u={surveyId:a,surveyVersion:n,userId:d,answers:r,submittedAt:new Date().toISOString(),allowMultiple:c?.allowMultiple,metadata:{userAgent:navigator.userAgent,language:navigator.language}},h=await fetch(`${EN}/survey/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),f=await h.json();return h.status===429?{success:!1,error:""}:h.status===409?{success:!1,error:f.error||""}:h.ok?{success:!0,submissionId:f.submissionId,message:f.message}:{success:!1,error:f.error||""}}catch(d){return console.error("Error submitting survey:",d),{success:!1,error:""}}}async function VC(a,n){try{const r=n||MN(),c=new URLSearchParams({user_id:r,survey_id:a}),d=await fetch(`${EN}/survey/check?${c}`);return d.ok?{success:!0,hasSubmitted:(await d.json()).hasSubmitted}:{success:!1,error:(await d.json()).error||""}}catch(r){return console.error("Error checking submission:",r),{success:!1,error:""}}}function AN({config:a,initialAnswers:n,onSubmitSuccess:r,onSubmitError:c,showProgress:d=!0,paginateQuestions:u=!1,className:h}){const f=m.useCallback(()=>!n||n.length===0?{}:n.reduce((P,ue)=>(P[ue.questionId]=ue.value,P),{}),[n]),[p,g]=m.useState(()=>f()),[N,v]=m.useState({}),[w,b]=m.useState(0),[y,O]=m.useState(!1),[R,S]=m.useState(!1),[B,E]=m.useState(null),[C,A]=m.useState(null),[F,L]=m.useState(!1),[J,U]=m.useState(!0);m.useEffect(()=>{n&&n.length>0&&g(P=>({...P,...f()}))},[n,f]),m.useEffect(()=>{(async()=>{if(!a.settings?.allowMultiple){const ue=await VC(a.id);ue.success&&ue.hasSubmitted&&L(!0)}U(!1)})()},[a.id,a.settings?.allowMultiple]);const oe=m.useCallback(()=>{const P=new Date;return!(a.settings?.startTime&&new Date(a.settings.startTime)>P||a.settings?.endTime&&new Date(a.settings.endTime)<P)},[a.settings?.startTime,a.settings?.endTime]),Ne=a.questions.filter(P=>{const ue=p[P.id];return ue==null?!1:Array.isArray(ue)?ue.length>0:typeof ue=="string"?ue.trim()!=="":!0}).length,je=Ne/a.questions.length*100,re=m.useCallback((P,ue)=>{g(Q=>({...Q,[P]:ue})),v(Q=>{const Se={...Q};return delete Se[P],Se})},[]),fe=m.useCallback(()=>{const P={};for(const ue of a.questions){if(ue.required){const Q=p[ue.id];if(Q==null){P[ue.id]="";continue}if(Array.isArray(Q)&&Q.length===0){P[ue.id]="";continue}if(typeof Q=="string"&&Q.trim()===""){P[ue.id]="";continue}}ue.minLength&&typeof p[ue.id]=="string"&&p[ue.id].length<ue.minLength&&(P[ue.id]=` ${ue.minLength} `)}return v(P),Object.keys(P).length===0},[a.questions,p]),ge=m.useCallback(async()=>{if(!fe()){if(u){const P=a.questions.findIndex(ue=>N[ue.id]);P>=0&&b(P)}return}O(!0),E(null);try{const P=a.questions.filter(Q=>p[Q.id]!==void 0).map(Q=>({questionId:Q.id,value:p[Q.id]})),ue=await HC(a.id,a.version,P,{allowMultiple:a.settings?.allowMultiple});if(ue.success&&ue.submissionId)S(!0),A(ue.submissionId),r?.(ue.submissionId);else{const Q=ue.error||"";E(Q),c?.(Q)}}catch(P){const ue=P instanceof Error?P.message:"";E(ue),c?.(ue)}finally{O(!1)}},[fe,u,a,p,N,r,c]),M=m.useCallback(P=>{P>=0&&P<a.questions.length&&b(P)},[a.questions.length]);if(J)return e.jsx(Ce,{className:I("w-full max-w-2xl mx-auto",h),children:e.jsx(Me,{className:"py-12 flex items-center justify-center",children:e.jsx(zs,{className:"h-6 w-6 animate-spin text-muted-foreground"})})});if(F&&!a.settings?.allowMultiple)return e.jsxs(Ce,{className:I("w-full max-w-2xl mx-auto",h),children:[e.jsx(De,{children:e.jsx(Oe,{children:a.title})}),e.jsx(Me,{className:"py-8",children:e.jsxs(at,{children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx(lt,{children:""})]})})]});if(!oe())return e.jsxs(Ce,{className:I("w-full max-w-2xl mx-auto",h),children:[e.jsx(De,{children:e.jsx(Oe,{children:a.title})}),e.jsx(Me,{className:"py-8",children:e.jsxs(at,{variant:"destructive",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx(lt,{children:""})]})})]});if(R)return e.jsxs(Ce,{className:I("w-full max-w-2xl mx-auto",h),children:[e.jsx(De,{children:e.jsxs(Oe,{className:"flex items-center gap-2 text-green-600",children:[e.jsx(pt,{className:"h-6 w-6"}),""]})}),e.jsxs(Me,{className:"py-8",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:a.settings?.thankYouMessage||""}),C&&e.jsxs("p",{className:"text-center text-xs text-muted-foreground mt-4",children:["",C]})]})]});const K=u?[a.questions[w]]:a.questions;return e.jsxs("div",{className:I("h-full flex flex-col",h),children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 mb-4 shrink-0",children:[e.jsx("h2",{className:"text-xl font-semibold",children:a.title}),a.description&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:a.description}),d&&e.jsxs("div",{className:"space-y-1 pt-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[Ne," / ",a.questions.length]})]}),e.jsx(Xn,{value:je,className:"h-2"})]})]}),e.jsx(Je,{className:"flex-1 min-h-0",children:e.jsxs("div",{className:"space-y-4 pr-4",children:[K.map((P,ue)=>e.jsxs("div",{className:I("p-4 rounded-lg border bg-card",N[P.id]?"border-destructive bg-destructive/5":"border-border"),children:[u&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[" ",w+1," / ",a.questions.length]}),!u&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[ue+1,"."]}),e.jsx(FC,{question:P,value:p[P.id],onChange:Q=>re(P.id,Q),error:N[P.id],disabled:y})]},P.id)),B&&e.jsxs(at,{variant:"destructive",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx(lt,{children:B})]}),e.jsx("div",{className:"flex justify-between items-center py-4",children:u?e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"outline",onClick:()=>M(w-1),disabled:w===0||y,children:[e.jsx(Da,{className:"h-4 w-4 mr-1"}),""]}),w===a.questions.length-1?e.jsxs(_,{onClick:ge,disabled:y,children:[y&&e.jsx(zs,{className:"h-4 w-4 mr-2 animate-spin"}),""]}):e.jsxs(_,{onClick:()=>M(w+1),disabled:y,children:["",e.jsx(Wt,{className:"h-4 w-4 ml-1"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:Object.keys(N).length>0&&e.jsxs("span",{className:"text-destructive",children:[" ",Object.keys(N).length," "]})}),e.jsxs(_,{onClick:ge,disabled:y,size:"lg",children:[y&&e.jsx(zs,{className:"h-4 w-4 mr-2 animate-spin"}),""]})]})})]})})]})}const GC={id:"webui-feedback-v1",version:"1.0.0",title:" WebUI ",description:" WebUI",questions:[{id:"webui_version",type:"text",title:" WebUI ",description:"",required:!0,readOnly:!0,placeholder:"..."},{id:"ui_design_satisfaction",type:"single",title:" WebUI ",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"problems_encountered",type:"multiple",title:" WebUI ",description:"",required:!0,options:[{id:"lag",label:"",value:"lag"},{id:"incomplete",label:"",value:"incomplete"},{id:"complex",label:"",value:"complex"},{id:"bugs",label:" Bug",value:"bugs"},{id:"none",label:"",value:"none"},{id:"other",label:"",value:"other"}]},{id:"problems_other",type:"text",title:'""',required:!1,placeholder:"...",maxLength:500},{id:"useful_features",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"feature_requests",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"overall_satisfaction",type:"single",title:" WebUI ",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"would_recommend",type:"single",title:" WebUI ",required:!0,options:[{id:"yes",label:"",value:"yes"},{id:"no",label:"",value:"no"}]},{id:"other_suggestions",type:"textarea",title:"",description:"",required:!1,placeholder:"...",maxLength:2e3}],settings:{allowMultiple:!1,thankYouMessage:""}},qC={id:"maibot-feedback-v1",version:"1.0.0",title:"",description:" AI ",questions:[{id:"maibot_version",type:"text",title:"",description:"",required:!0,readOnly:!0,placeholder:"..."},{id:"improvement_areas",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"problems_encountered",type:"multiple",title:"",description:"",required:!0,options:[{id:"incomplete",label:"",value:"incomplete"},{id:"slow_response",label:"",value:"slow_response"},{id:"complex",label:"",value:"complex"},{id:"unstable",label:"",value:"unstable"},{id:"config_difficult",label:"",value:"config_difficult"},{id:"none",label:"",value:"none"},{id:"other",label:"",value:"other"}]},{id:"problems_other",type:"text",title:'""',required:!1,placeholder:"...",maxLength:500},{id:"helpful_features",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"feature_requests",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"overall_satisfaction",type:"single",title:"",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"would_recommend",type:"single",title:"",required:!0,options:[{id:"yes",label:"",value:"yes"},{id:"no",label:"",value:"no"}]},{id:"other_suggestions",type:"textarea",title:"",description:"",required:!1,placeholder:"...",maxLength:2e3}],settings:{allowMultiple:!1,thankYouMessage:""}};function KC(){const[a,n]=m.useState(!0),r=m.useMemo(()=>JSON.parse(JSON.stringify(GC)),[]);m.useEffect(()=>{n(!1)},[]);const c=m.useMemo(()=>[{questionId:"webui_version",value:`v${od}`}],[]),d=m.useCallback(h=>{console.log("WebUI Survey submitted:",h)},[]),u=m.useCallback(h=>{console.error("WebUI Survey submission error:",h)},[]);return a?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(zs,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):r?e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 shrink-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(ov,{className:"h-8 w-8",strokeWidth:2}),"WebUI "]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(AN,{config:r,initialAnswers:c,showProgress:!0,paginateQuestions:!1,onSubmitSuccess:d,onSubmitError:u})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[e.jsxs(at,{variant:"destructive",className:"max-w-md",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx(lt,{children:""})]}),e.jsx(_,{variant:"outline",onClick:()=>window.location.reload(),children:""})]})}function QC(){const[a,n]=m.useState(null),[r,c]=m.useState(!0),[d,u]=m.useState("");m.useEffect(()=>{(async()=>{try{const v=await $1();u(v.version||"")}catch(v){console.error("Failed to get MaiBot version:",v),u("")}const N=JSON.parse(JSON.stringify(qC));n(N),c(!1)})()},[]);const h=m.useMemo(()=>[{questionId:"maibot_version",value:d}],[d]),f=m.useCallback(g=>{console.log("MaiBot Survey submitted:",g)},[]),p=m.useCallback(g=>{console.error("MaiBot Survey submission error:",g)},[]);return r?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(zs,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):a?e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 shrink-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(ov,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:" AI "})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(AN,{config:a,initialAnswers:h,showProgress:!0,paginateQuestions:!1,onSubmitSuccess:f,onSubmitError:p})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[e.jsxs(at,{variant:"destructive",className:"max-w-md",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx(lt,{children:""})]}),e.jsx(_,{variant:"outline",onClick:()=>window.location.reload(),children:""})]})}async function YC(a=2025){const n=await _e(`/api/webui/annual-report/full?year=${a}`);if(!n.ok){const r=await n.json();throw new Error(r.detail||"")}return n.json()}function JC(a,n){if(a.match(/^[a-z]+:\/\//i))return a;if(a.match(/^\/\//))return window.location.protocol+a;if(a.match(/^[a-z]+:/i))return a;const r=document.implementation.createHTMLDocument(),c=r.createElement("base"),d=r.createElement("a");return r.head.appendChild(c),r.body.appendChild(d),n&&(c.href=n),d.href=a,d.href}const XC=(()=>{let a=0;const n=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(a+=1,`u${n()}${a}`)})();function pn(a){const n=[];for(let r=0,c=a.length;r<c;r++)n.push(a[r]);return n}let Ir=null;function zN(a={}){return Ir||(a.includeStyleProperties?(Ir=a.includeStyleProperties,Ir):(Ir=pn(window.getComputedStyle(document.documentElement)),Ir))}function Zo(a,n){const c=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(n);return c?parseFloat(c.replace("px","")):0}function ZC(a){const n=Zo(a,"border-left-width"),r=Zo(a,"border-right-width");return a.clientWidth+n+r}function WC(a){const n=Zo(a,"border-top-width"),r=Zo(a,"border-bottom-width");return a.clientHeight+n+r}function RN(a,n={}){const r=n.width||ZC(a),c=n.height||WC(a);return{width:r,height:c}}function e3(){let a,n;try{n=process}catch{}const r=n&&n.env?n.env.devicePixelRatio:null;return r&&(a=parseInt(r,10),Number.isNaN(a)&&(a=1)),a||window.devicePixelRatio||1}const Ca=16384;function s3(a){(a.width>Ca||a.height>Ca)&&(a.width>Ca&&a.height>Ca?a.width>a.height?(a.height*=Ca/a.width,a.width=Ca):(a.width*=Ca/a.height,a.height=Ca):a.width>Ca?(a.height*=Ca/a.width,a.width=Ca):(a.width*=Ca/a.height,a.height=Ca))}function Wo(a){return new Promise((n,r)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>n(c))})},c.onerror=r,c.crossOrigin="anonymous",c.decoding="async",c.src=a})}async function t3(a){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(a)).then(encodeURIComponent).then(n=>`data:image/svg+xml;charset=utf-8,${n}`)}async function a3(a,n,r){const c="http://www.w3.org/2000/svg",d=document.createElementNS(c,"svg"),u=document.createElementNS(c,"foreignObject");return d.setAttribute("width",`${n}`),d.setAttribute("height",`${r}`),d.setAttribute("viewBox",`0 0 ${n} ${r}`),u.setAttribute("width","100%"),u.setAttribute("height","100%"),u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("externalResourcesRequired","true"),d.appendChild(u),u.appendChild(a),t3(d)}const ga=(a,n)=>{if(a instanceof n)return!0;const r=Object.getPrototypeOf(a);return r===null?!1:r.constructor.name===n.name||ga(r,n)};function l3(a){const n=a.getPropertyValue("content");return`${a.cssText} content: '${n.replace(/'|"/g,"")}';`}function n3(a,n){return zN(n).map(r=>{const c=a.getPropertyValue(r),d=a.getPropertyPriority(r);return`${r}: ${c}${d?" !important":""};`}).join(" ")}function r3(a,n,r,c){const d=`.${a}:${n}`,u=r.cssText?l3(r):n3(r,c);return document.createTextNode(`${d}{${u}}`)}function Wg(a,n,r,c){const d=window.getComputedStyle(a,r),u=d.getPropertyValue("content");if(u===""||u==="none")return;const h=XC();try{n.className=`${n.className} ${h}`}catch{return}const f=document.createElement("style");f.appendChild(r3(h,r,d,c)),n.appendChild(f)}function i3(a,n,r){Wg(a,n,":before",r),Wg(a,n,":after",r)}const ej="application/font-woff",sj="image/jpeg",c3={woff:ej,woff2:ej,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:sj,jpeg:sj,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function o3(a){const n=/\.([^./]*?)$/g.exec(a);return n?n[1]:""}function kx(a){const n=o3(a).toLowerCase();return c3[n]||""}function d3(a){return a.split(/,/)[1]}function Wm(a){return a.search(/^(data:)/)!==-1}function u3(a,n){return`data:${n};base64,${a}`}async function DN(a,n,r){const c=await fetch(a,n);if(c.status===404)throw new Error(`Resource "${c.url}" not found`);const d=await c.blob();return new Promise((u,h)=>{const f=new FileReader;f.onerror=h,f.onloadend=()=>{try{u(r({res:c,result:f.result}))}catch(p){h(p)}},f.readAsDataURL(d)})}const Vm={};function m3(a,n,r){let c=a.replace(/\?.*/,"");return r&&(c=a),/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,"")),n?`[${n}]${c}`:c}async function Cx(a,n,r){const c=m3(a,n,r.includeQueryParams);if(Vm[c]!=null)return Vm[c];r.cacheBust&&(a+=(/\?/.test(a)?"&":"?")+new Date().getTime());let d;try{const u=await DN(a,r.fetchRequestInit,({res:h,result:f})=>(n||(n=h.headers.get("Content-Type")||""),d3(f)));d=u3(u,n)}catch(u){d=r.imagePlaceholder||"";let h=`Failed to fetch resource: ${a}`;u&&(h=typeof u=="string"?u:u.message),h&&console.warn(h)}return Vm[c]=d,d}async function x3(a){const n=a.toDataURL();return n==="data:,"?a.cloneNode(!1):Wo(n)}async function h3(a,n){if(a.currentSrc){const u=document.createElement("canvas"),h=u.getContext("2d");u.width=a.clientWidth,u.height=a.clientHeight,h?.drawImage(a,0,0,u.width,u.height);const f=u.toDataURL();return Wo(f)}const r=a.poster,c=kx(r),d=await Cx(r,c,n);return Wo(d)}async function f3(a,n){var r;try{if(!((r=a?.contentDocument)===null||r===void 0)&&r.body)return await pd(a.contentDocument.body,n,!0)}catch{}return a.cloneNode(!1)}async function p3(a,n){return ga(a,HTMLCanvasElement)?x3(a):ga(a,HTMLVideoElement)?h3(a,n):ga(a,HTMLIFrameElement)?f3(a,n):a.cloneNode(ON(a))}const g3=a=>a.tagName!=null&&a.tagName.toUpperCase()==="SLOT",ON=a=>a.tagName!=null&&a.tagName.toUpperCase()==="SVG";async function j3(a,n,r){var c,d;if(ON(n))return n;let u=[];return g3(a)&&a.assignedNodes?u=pn(a.assignedNodes()):ga(a,HTMLIFrameElement)&&(!((c=a.contentDocument)===null||c===void 0)&&c.body)?u=pn(a.contentDocument.body.childNodes):u=pn(((d=a.shadowRoot)!==null&&d!==void 0?d:a).childNodes),u.length===0||ga(a,HTMLVideoElement)||await u.reduce((h,f)=>h.then(()=>pd(f,r)).then(p=>{p&&n.appendChild(p)}),Promise.resolve()),n}function v3(a,n,r){const c=n.style;if(!c)return;const d=window.getComputedStyle(a);d.cssText?(c.cssText=d.cssText,c.transformOrigin=d.transformOrigin):zN(r).forEach(u=>{let h=d.getPropertyValue(u);u==="font-size"&&h.endsWith("px")&&(h=`${Math.floor(parseFloat(h.substring(0,h.length-2)))-.1}px`),ga(a,HTMLIFrameElement)&&u==="display"&&h==="inline"&&(h="block"),u==="d"&&n.getAttribute("d")&&(h=`path(${n.getAttribute("d")})`),c.setProperty(u,h,d.getPropertyPriority(u))})}function N3(a,n){ga(a,HTMLTextAreaElement)&&(n.innerHTML=a.value),ga(a,HTMLInputElement)&&n.setAttribute("value",a.value)}function b3(a,n){if(ga(a,HTMLSelectElement)){const c=Array.from(n.children).find(d=>a.value===d.getAttribute("value"));c&&c.setAttribute("selected","")}}function y3(a,n,r){return ga(n,Element)&&(v3(a,n,r),i3(a,n,r),N3(a,n),b3(a,n)),n}async function w3(a,n){const r=a.querySelectorAll?a.querySelectorAll("use"):[];if(r.length===0)return a;const c={};for(let u=0;u<r.length;u++){const f=r[u].getAttribute("xlink:href");if(f){const p=a.querySelector(f),g=document.querySelector(f);!p&&g&&!c[f]&&(c[f]=await pd(g,n,!0))}}const d=Object.values(c);if(d.length){const u="http://www.w3.org/1999/xhtml",h=document.createElementNS(u,"svg");h.setAttribute("xmlns",u),h.style.position="absolute",h.style.width="0",h.style.height="0",h.style.overflow="hidden",h.style.display="none";const f=document.createElementNS(u,"defs");h.appendChild(f);for(let p=0;p<d.length;p++)f.appendChild(d[p]);a.appendChild(h)}return a}async function pd(a,n,r){return!r&&n.filter&&!n.filter(a)?null:Promise.resolve(a).then(c=>p3(c,n)).then(c=>j3(a,c,n)).then(c=>y3(a,c,n)).then(c=>w3(c,n))}const LN=/url\((['"]?)([^'"]+?)\1\)/g,_3=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,S3=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function k3(a){const n=a.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${n})(['"]?\\))`,"g")}function C3(a){const n=[];return a.replace(LN,(r,c,d)=>(n.push(d),r)),n.filter(r=>!Wm(r))}async function T3(a,n,r,c,d){try{const u=r?JC(n,r):n,h=kx(n);let f;return d||(f=await Cx(u,h,c)),a.replace(k3(n),`$1${f}$3`)}catch{}return a}function E3(a,{preferredFontFormat:n}){return n?a.replace(S3,r=>{for(;;){const[c,,d]=_3.exec(r)||[];if(!d)return"";if(d===n)return`src: ${c};`}}):a}function UN(a){return a.search(LN)!==-1}async function $N(a,n,r){if(!UN(a))return a;const c=E3(a,r);return C3(c).reduce((u,h)=>u.then(f=>T3(f,h,n,r)),Promise.resolve(c))}async function Fr(a,n,r){var c;const d=(c=n.style)===null||c===void 0?void 0:c.getPropertyValue(a);if(d){const u=await $N(d,null,r);return n.style.setProperty(a,u,n.style.getPropertyPriority(a)),!0}return!1}async function M3(a,n){await Fr("background",a,n)||await Fr("background-image",a,n),await Fr("mask",a,n)||await Fr("-webkit-mask",a,n)||await Fr("mask-image",a,n)||await Fr("-webkit-mask-image",a,n)}async function A3(a,n){const r=ga(a,HTMLImageElement);if(!(r&&!Wm(a.src))&&!(ga(a,SVGImageElement)&&!Wm(a.href.baseVal)))return;const c=r?a.src:a.href.baseVal,d=await Cx(c,kx(c),n);await new Promise((u,h)=>{a.onload=u,a.onerror=n.onImageErrorHandler?(...p)=>{try{u(n.onImageErrorHandler(...p))}catch(g){h(g)}}:h;const f=a;f.decode&&(f.decode=u),f.loading==="lazy"&&(f.loading="eager"),r?(a.srcset="",a.src=d):a.href.baseVal=d})}async function z3(a,n){const c=pn(a.childNodes).map(d=>BN(d,n));await Promise.all(c).then(()=>a)}async function BN(a,n){ga(a,Element)&&(await M3(a,n),await A3(a,n),await z3(a,n))}function R3(a,n){const{style:r}=a;n.backgroundColor&&(r.backgroundColor=n.backgroundColor),n.width&&(r.width=`${n.width}px`),n.height&&(r.height=`${n.height}px`);const c=n.style;return c!=null&&Object.keys(c).forEach(d=>{r[d]=c[d]}),a}const tj={};async function aj(a){let n=tj[a];if(n!=null)return n;const c=await(await fetch(a)).text();return n={url:a,cssText:c},tj[a]=n,n}async function lj(a,n){let r=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,u=(r.match(/url\([^)]+\)/g)||[]).map(async h=>{let f=h.replace(c,"$1");return f.startsWith("https://")||(f=new URL(f,a.url).href),DN(f,n.fetchRequestInit,({result:p})=>(r=r.replace(h,`url(${p})`),[h,p]))});return Promise.all(u).then(()=>r)}function nj(a){if(a==null)return[];const n=[],r=/(\/\*[\s\S]*?\*\/)/gi;let c=a.replace(r,"");const d=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const p=d.exec(c);if(p===null)break;n.push(p[0])}c=c.replace(d,"");const u=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,h="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",f=new RegExp(h,"gi");for(;;){let p=u.exec(c);if(p===null){if(p=f.exec(c),p===null)break;u.lastIndex=f.lastIndex}else f.lastIndex=u.lastIndex;n.push(p[0])}return n}async function D3(a,n){const r=[],c=[];return a.forEach(d=>{if("cssRules"in d)try{pn(d.cssRules||[]).forEach((u,h)=>{if(u.type===CSSRule.IMPORT_RULE){let f=h+1;const p=u.href,g=aj(p).then(N=>lj(N,n)).then(N=>nj(N).forEach(v=>{try{d.insertRule(v,v.startsWith("@import")?f+=1:d.cssRules.length)}catch(w){console.error("Error inserting rule from remote css",{rule:v,error:w})}})).catch(N=>{console.error("Error loading remote css",N.toString())});c.push(g)}})}catch(u){const h=a.find(f=>f.href==null)||document.styleSheets[0];d.href!=null&&c.push(aj(d.href).then(f=>lj(f,n)).then(f=>nj(f).forEach(p=>{h.insertRule(p,h.cssRules.length)})).catch(f=>{console.error("Error loading remote stylesheet",f)})),console.error("Error inlining remote css file",u)}}),Promise.all(c).then(()=>(a.forEach(d=>{if("cssRules"in d)try{pn(d.cssRules||[]).forEach(u=>{r.push(u)})}catch(u){console.error(`Error while reading CSS rules from ${d.href}`,u)}}),r))}function O3(a){return a.filter(n=>n.type===CSSRule.FONT_FACE_RULE).filter(n=>UN(n.style.getPropertyValue("src")))}async function L3(a,n){if(a.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=pn(a.ownerDocument.styleSheets),c=await D3(r,n);return O3(c)}function PN(a){return a.trim().replace(/["']/g,"")}function U3(a){const n=new Set;function r(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(u=>{n.add(PN(u))}),Array.from(c.children).forEach(u=>{u instanceof HTMLElement&&r(u)})}return r(a),n}async function $3(a,n){const r=await L3(a,n),c=U3(a);return(await Promise.all(r.filter(u=>c.has(PN(u.style.fontFamily))).map(u=>{const h=u.parentStyleSheet?u.parentStyleSheet.href:null;return $N(u.cssText,h,n)}))).join(`
`)}async function B3(a,n){const r=n.fontEmbedCSS!=null?n.fontEmbedCSS:n.skipFonts?null:await $3(a,n);if(r){const c=document.createElement("style"),d=document.createTextNode(r);c.appendChild(d),a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}}async function P3(a,n={}){const{width:r,height:c}=RN(a,n),d=await pd(a,n,!0);return await B3(d,n),await BN(d,n),R3(d,n),await a3(d,r,c)}async function I3(a,n={}){const{width:r,height:c}=RN(a,n),d=await P3(a,n),u=await Wo(d),h=document.createElement("canvas"),f=h.getContext("2d"),p=n.pixelRatio||e3(),g=n.canvasWidth||r,N=n.canvasHeight||c;return h.width=g*p,h.height=N*p,n.skipAutoScale||s3(h),h.style.width=`${g}`,h.style.height=`${N}`,n.backgroundColor&&(f.fillStyle=n.backgroundColor,f.fillRect(0,0,h.width,h.height)),f.drawImage(u,0,0,h.width,h.height),h}async function F3(a,n={}){return(await I3(a,n)).toDataURL()}const Lo=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"];function H3(a){return a>=8760?"7x24":a>=5e3?"":a>=2e3?" 1000 ":a>=1e3?" 80 ":a>=500?" 100 ":a>=100?" 25 ":""}function V3(a){return a>=1e3?"":a>=500?"":a>=100?"":a>=50?"":""}function G3(a){const n=a/1e6;return n>=100?"":n>=50?"":n>=10?"":n>=1?"":""}function q3(a){return a>=1e3?"":a>=500?"":a>=100?"":a>=50?"":a>=10?"":""}function K3(a){return a>=80?"":a>=60?"":a>=40?"":a>=20?"":""}function Q3(a){return a>=1e4?"":a>=5e3?"":a>=1e3?"":a>=500?"":a>=100?"":""}function Y3(a){return a>=500?"":a>=200?"":a>=100?"":a>=50?"":a>=10?"":""}function J3(a){return a>=1?"":a>=.5?"":a>=.1?"":a>=.01?"":""}function X3(a,n){return a>=100?"":a>=50?"":a>=20?`${n}`:a>=10?"":""}function Z3(a,n){return a?n>=1e3?"":n>=500?"":n>=100?"":"":n<=10?"":n<=50?"":""}function W3(a){return a>=1e3?"":a>=500?"":a>=200?"":a>=100?"":a>=50?"":""}function e5(){const[a]=m.useState(2025),[n,r]=m.useState(null),[c,d]=m.useState(!0),[u,h]=m.useState(!1),[f,p]=m.useState(null),g=m.useRef(null),{toast:N}=Ys(),v=m.useCallback(async()=>{try{d(!0),p(null);const b=await YC(a);r(b)}catch(b){p(b instanceof Error?b:new Error(""))}finally{d(!1)}},[a]),w=m.useCallback(async()=>{if(!(!g.current||!n)){h(!0),N({title:"",description:"..."});try{const b=g.current,y=getComputedStyle(document.documentElement),O=y.getPropertyValue("--background").trim()?`hsl(${y.getPropertyValue("--background").trim()})`:document.documentElement.classList.contains("dark")?"#0a0a0a":"#ffffff",R=b.style.width,S=b.style.maxWidth;b.style.width="1024px",b.style.maxWidth="1024px";const B=await F3(b,{quality:1,pixelRatio:2,backgroundColor:O,cacheBust:!0,filter:C=>!(C instanceof HTMLElement&&C.hasAttribute("data-export-btn"))});b.style.width=R,b.style.maxWidth=S;const E=document.createElement("a");E.download=`${n.bot_name}_${n.year}_.png`,E.href=B,E.click(),N({title:"",description:""})}catch(b){console.error(":",b),N({title:"",description:"",variant:"destructive"})}finally{h(!1)}}},[n,N]);return m.useEffect(()=>{v()},[v]),c?e.jsx(s5,{}):f?e.jsxs("div",{className:"flex h-screen items-center justify-center text-red-500",children:[": ",f.message]}):n?e.jsx(Je,{className:"h-[calc(100vh-4rem)]",children:e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/50 p-4 md:p-8 print:p-0",ref:g,children:e.jsxs("div",{className:"mx-auto max-w-5xl space-y-8 print:space-y-4",children:[e.jsxs("header",{className:"relative overflow-hidden rounded-3xl bg-primary p-8 text-primary-foreground shadow-2xl print:rounded-none print:shadow-none",children:[e.jsx("div",{className:"absolute right-4 top-4 z-20 print:hidden","data-export-btn":!0,children:e.jsx(_,{variant:"secondary",size:"sm",onClick:w,disabled:u,className:"gap-2 bg-white/20 hover:bg-white/30 text-white border-white/30",children:u?e.jsxs(e.Fragment,{children:[e.jsx(zs,{className:"h-4 w-4 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Xt,{className:"h-4 w-4"}),""]})})}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[e.jsx(Vn,{className:"mb-4 h-16 w-16 animate-bounce"}),e.jsxs("h1",{className:"text-4xl font-bold tracking-tighter sm:text-6xl",children:[n.bot_name," ",n.year," "]}),e.jsx("p",{className:"mt-4 max-w-2xl text-lg opacity-90",children:"  Connection & Growth"}),e.jsxs("div",{className:"mt-6 flex items-center gap-2 text-sm opacity-75",children:[e.jsx(Go,{className:"h-4 w-4"}),e.jsxs("span",{children:[": ",n.generated_at]})]})]}),e.jsx("div",{className:"absolute -right-20 -top-20 h-64 w-64 rounded-full bg-white/10 blur-3xl"}),e.jsx("div",{className:"absolute -bottom-20 -left-20 h-64 w-64 rounded-full bg-white/10 blur-3xl"})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(na,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(Ta,{title:"",value:`${n.time_footprint.total_online_hours} `,description:H3(n.time_footprint.total_online_hours),icon:e.jsx(na,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:n.time_footprint.busiest_day||"N/A",description:W3(n.time_footprint.busiest_day_count),icon:e.jsx(Go,{className:"h-4 w-4"})}),e.jsx(Ta,{title:" (0-4)",value:`${n.time_footprint.midnight_chat_count} `,description:V3(n.time_footprint.midnight_chat_count),icon:e.jsx(ec,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:n.time_footprint.is_night_owl?"":"",description:Z3(n.time_footprint.is_night_owl,n.time_footprint.midnight_chat_count),icon:n.time_footprint.is_night_owl?e.jsx(ec,{className:"h-4 w-4"}):e.jsx(ax,{className:"h-4 w-4"})})]}),e.jsxs(Ce,{className:"overflow-hidden",children:[e.jsxs(De,{children:[e.jsx(Oe,{children:"24"}),e.jsxs(os,{children:[n.bot_name,""]})]}),e.jsx(Me,{className:"h-[300px]",children:e.jsx(Mj,{width:"100%",height:"100%",children:e.jsxs(Uo,{data:n.time_footprint.hourly_distribution.map((b,y)=>({hour:`${y}`,count:b})),children:[e.jsx(Qi,{strokeDasharray:"3 3",vertical:!1}),e.jsx(Yi,{dataKey:"hour"}),e.jsx(Hr,{}),e.jsx(Aj,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},cursor:{fill:"transparent"}}),e.jsx(Ji,{dataKey:"count",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),n.time_footprint.first_message_time&&e.jsx(Ce,{className:"bg-muted/30 border-dashed",children:e.jsxs(Me,{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-2",children:"2025"}),e.jsx("div",{className:"text-xl font-bold text-primary mb-1",children:n.time_footprint.first_message_time}),e.jsxs("p",{className:"text-lg",children:[e.jsx("span",{className:"font-semibold text-foreground",children:n.time_footprint.first_message_user})," ",e.jsxs("span",{className:"italic text-muted-foreground",children:['"',n.time_footprint.first_message_content,'"']})]})]})})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ic,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(Ta,{title:"",value:`${n.social_network.total_groups} `,description:`${n.bot_name}`,icon:e.jsx(ic,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:`${n.social_network.at_count+n.social_network.mentioned_count} `,description:"",icon:e.jsx(q_,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:n.social_network.longest_companion_user||"N/A",description:` ${n.social_network.longest_companion_days} `,icon:e.jsx(Xr,{className:"h-4 w-4 text-red-500"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Oe,{children:" TOP5"})}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-3",children:n.social_network.top_groups.length>0?n.social_network.top_groups.map((b,y)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{variant:y===0?"default":"secondary",className:"h-6 w-6 rounded-full p-0 flex items-center justify-center shrink-0",children:y+1}),e.jsx("span",{className:"font-medium truncate max-w-[120px]",children:b.group_name}),b.is_webui&&e.jsx(ke,{variant:"outline",className:"text-xs px-1.5 py-0 h-5 bg-blue-50 text-blue-600 border-blue-200",children:"WebUI"})]}),e.jsxs("span",{className:"text-muted-foreground text-sm shrink-0",children:[b.message_count," "]})]},b.group_id)):e.jsx("div",{className:"text-center text-muted-foreground py-4",children:""})})})]}),e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Oe,{children:" TOP5"})}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-3",children:n.social_network.top_users.length>0?n.social_network.top_users.map((b,y)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{variant:y===0?"default":"secondary",className:"h-6 w-6 rounded-full p-0 flex items-center justify-center shrink-0",children:y+1}),e.jsx("span",{className:"font-medium truncate max-w-[120px]",children:b.user_nickname}),b.is_webui&&e.jsx(ke,{variant:"outline",className:"text-xs px-1.5 py-0 h-5 bg-blue-50 text-blue-600 border-blue-200",children:"WebUI"})]}),e.jsxs("span",{className:"text-muted-foreground text-sm shrink-0",children:[b.message_count," "]})]},b.user_id)):e.jsx("div",{className:"text-center text-muted-foreground py-4",children:""})})})]})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(cx,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(Ta,{title:" Token ",value:(n.brain_power.total_tokens/1e6).toFixed(2)+" M",description:G3(n.brain_power.total_tokens),icon:e.jsx(el,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:`$${n.brain_power.total_cost.toFixed(2)}`,description:q3(n.brain_power.total_cost),icon:e.jsx("span",{className:"font-bold",children:"$"})}),e.jsx(Ta,{title:"",value:`${n.brain_power.silence_rate}%`,description:K3(n.brain_power.silence_rate),icon:e.jsx(ec,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:n.brain_power.max_interest_value??"N/A",description:n.brain_power.max_interest_time?` ${n.brain_power.max_interest_time}`:"",icon:e.jsx(Xr,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Oe,{children:""})}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-3",children:n.brain_power.model_distribution.slice(0,5).map((b,y)=>{const O=n.brain_power.model_distribution[0]?.count||1,R=Math.round(b.count/O*100);return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium truncate max-w-[200px]",children:b.model}),e.jsxs("span",{className:"text-muted-foreground",children:[b.count.toLocaleString()," "]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${R}%`,backgroundColor:Lo[y%Lo.length]}})})]},b.model)})})})]}),n.brain_power.top_reply_models&&n.brain_power.top_reply_models.length>0&&e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:" TOP5"}),e.jsxs(os,{children:[n.bot_name,""]})]}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-3",children:n.brain_power.top_reply_models.map((b,y)=>{const O=n.brain_power.top_reply_models[0]?.count||1,R=Math.round(b.count/O*100);return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium truncate max-w-[200px]",children:b.model}),e.jsxs("span",{className:"text-muted-foreground",children:[b.count.toLocaleString()," "]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${R}%`,backgroundColor:Lo[y%Lo.length]}})})]},b.model)})})})]}),n.brain_power.top_token_consumers&&n.brain_power.top_token_consumers.length>0&&e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:" TOP3"}),e.jsx(os,{children:" API "})]}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-6",children:n.brain_power.top_token_consumers.map(b=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm font-medium",children:[e.jsxs("span",{children:[" ",b.user_id]}),e.jsxs("span",{children:["$",b.cost.toFixed(2)]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-500",style:{width:`${b.cost/(n.brain_power.top_token_consumers[0]?.cost||1)*100}%`}})})]},b.user_id))})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20",children:[e.jsx(De,{children:e.jsxs(Oe,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]})}),e.jsxs(Me,{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-bold text-amber-600 dark:text-amber-400",children:["$",n.brain_power.most_expensive_cost.toFixed(4)]}),n.brain_power.most_expensive_time&&e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:[" ",n.brain_power.most_expensive_time]}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:J3(n.brain_power.most_expensive_cost)})]})]}),e.jsxs(Ce,{className:"bg-gradient-to-br from-indigo-50 to-blue-50 dark:from-indigo-950/20 dark:to-blue-950/20",children:[e.jsx(De,{children:e.jsxs(Oe,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]})}),e.jsxs(Me,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:n.brain_power.avg_reasoning_length?.toFixed(0)||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:n.brain_power.max_reasoning_length?.toLocaleString()||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]})]}),n.brain_power.max_reasoning_time&&e.jsxs("p",{className:"mt-4 text-center text-xs text-muted-foreground",children:[" ",n.brain_power.max_reasoning_time]})]})]})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ld,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),(n.expression_vibe.late_night_reply||n.expression_vibe.favorite_reply)&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[n.expression_vibe.late_night_reply&&e.jsxs(Ce,{className:"bg-gradient-to-br from-indigo-50 to-violet-50 dark:from-indigo-950/20 dark:to-violet-950/20",children:[e.jsxs(De,{children:[e.jsxs(Oe,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsxs(os,{children:[" ",n.expression_vibe.late_night_reply.time,"",n.bot_name,"..."]})]}),e.jsxs(Me,{className:"text-center",children:[e.jsxs("p",{className:"text-lg italic text-muted-foreground",children:['"',n.expression_vibe.late_night_reply.content,'"']}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:""})]})]}),n.expression_vibe.favorite_reply&&e.jsxs(Ce,{className:"bg-gradient-to-br from-rose-50 to-pink-50 dark:from-rose-950/20 dark:to-pink-950/20",children:[e.jsxs(De,{children:[e.jsxs(Oe,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsxs(os,{children:[" ",n.expression_vibe.favorite_reply.count," "]})]}),e.jsxs(Me,{className:"text-center",children:[e.jsxs("p",{className:"text-lg font-medium text-primary",children:['"',n.expression_vibe.favorite_reply.content,'"']}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:X3(n.expression_vibe.favorite_reply.count,n.bot_name)})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{className:"bg-gradient-to-br from-pink-50 to-purple-50 dark:from-pink-950/20 dark:to-purple-950/20",children:[e.jsxs(De,{children:[e.jsx(Oe,{children:" TOP3"}),e.jsx(os,{children:""})]}),e.jsx(Me,{children:n.expression_vibe.top_emojis&&n.expression_vibe.top_emojis.length>0?e.jsx("div",{className:"flex justify-center gap-4",children:n.expression_vibe.top_emojis.slice(0,3).map((b,y)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`/api/webui/emoji/${b.id}/thumbnail?original=true`,alt:`TOP ${y+1}`,className:"h-24 w-24 rounded-lg object-cover shadow-md transition-transform hover:scale-105"}),e.jsx(ke,{className:I("absolute -top-2 -right-2",y===0?"bg-yellow-500":y===1?"bg-gray-400":"bg-amber-700"),children:y+1})]}),e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:[b.usage_count," "]})]},b.id))}):e.jsx("div",{className:"flex h-32 items-center justify-center text-muted-foreground",children:""})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsxs(os,{children:[n.bot_name,""]})]}),e.jsx(Me,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:n.expression_vibe.top_expressions.map((b,y)=>e.jsxs(ke,{variant:"outline",className:I("px-3 py-1 text-sm",y===0&&"border-primary bg-primary/10 text-primary text-base px-4 py-2"),children:[b.style," (",b.count,")"]},b.style))})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Ta,{title:"",value:`${n.expression_vibe.image_processed_count} `,description:Q3(n.expression_vibe.image_processed_count),icon:e.jsx(ix,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:`${n.expression_vibe.rejected_expression_count} `,description:Y3(n.expression_vibe.rejected_expression_count),icon:e.jsx(el,{className:"h-4 w-4"})})]})]})]}),n.expression_vibe.action_types.length>0&&e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsxs(Oe,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsx(os,{children:""})]}),e.jsx(Me,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:n.expression_vibe.action_types.map(b=>e.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-primary/10 px-4 py-2",children:[e.jsx("span",{className:"font-medium text-primary",children:b.action}),e.jsxs(ke,{variant:"secondary",children:[b.count," "]})]},b.action))})})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(K_,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(Ce,{className:"col-span-1 md:col-span-2",children:[e.jsxs(De,{children:[e.jsx(Oe,{children:'""'}),e.jsxs(os,{children:[" ",n.achievements.new_jargon_count," "]})]}),e.jsx(Me,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:n.achievements.sample_jargons.map(b=>e.jsxs("div",{className:"group relative rounded-lg border bg-card p-3 shadow-sm transition-all hover:shadow-md",children:[e.jsx("div",{className:"font-bold text-primary",children:b.content}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1 line-clamp-2 max-w-[200px]",children:b.meaning||""})]},b.content))})})]}),e.jsx(Ce,{className:"flex flex-col justify-center items-center bg-primary text-primary-foreground",children:e.jsxs(Me,{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(Ra,{className:"h-12 w-12 mb-4 opacity-80"}),e.jsx("div",{className:"text-4xl font-bold mb-2",children:n.achievements.total_messages.toLocaleString()}),e.jsx("div",{className:"text-sm opacity-80",children:""}),e.jsxs("div",{className:"mt-4 text-xs opacity-60",children:[" ",n.achievements.total_replies.toLocaleString()," "]})]})})]})]}),e.jsxs("footer",{className:"mt-12 text-center text-muted-foreground",children:[e.jsx("p",{children:"MaiBot 2025 Annual Report"}),e.jsx("p",{className:"text-sm",children:"Generated with  by MaiBot Team"})]})]})})}):null}function Ta({title:a,value:n,description:r,icon:c}){return e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Oe,{className:"text-sm font-medium",children:a}),e.jsx("div",{className:"text-muted-foreground",children:c})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r})]})]})}function s5(){return e.jsxs("div",{className:"container mx-auto space-y-8 p-8",children:[e.jsx(vs,{className:"h-64 w-full rounded-3xl"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[...Array(4)].map((a,n)=>e.jsx(vs,{className:"h-32 w-full"},n))}),e.jsx(vs,{className:"h-96 w-full"})]})}var gd="DropdownMenu",[t5]=td(gd,[Tj]),oa=Tj(),[a5,IN]=t5(gd),FN=a=>{const{__scopeDropdownMenu:n,children:r,dir:c,open:d,defaultOpen:u,onOpenChange:h,modal:f=!0}=a,p=oa(n),g=m.useRef(null),[N,v]=sd({prop:d,defaultProp:u??!1,onChange:h,caller:gd});return e.jsx(a5,{scope:n,triggerId:qm(),triggerRef:g,contentId:qm(),open:N,onOpenChange:v,onOpenToggle:m.useCallback(()=>v(w=>!w),[v]),modal:f,children:e.jsx(Uw,{...p,open:N,onOpenChange:v,dir:c,modal:f,children:r})})};FN.displayName=gd;var HN="DropdownMenuTrigger",VN=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,disabled:c=!1,...d}=a,u=IN(HN,r),h=oa(r);return e.jsx($w,{asChild:!0,...h,children:e.jsx(Zn.button,{type:"button",id:u.triggerId,"aria-haspopup":"menu","aria-expanded":u.open,"aria-controls":u.open?u.contentId:void 0,"data-state":u.open?"open":"closed","data-disabled":c?"":void 0,disabled:c,...d,ref:m_(n,u.triggerRef),onPointerDown:gn(a.onPointerDown,f=>{!c&&f.button===0&&f.ctrlKey===!1&&(u.onOpenToggle(),u.open||f.preventDefault())}),onKeyDown:gn(a.onKeyDown,f=>{c||(["Enter"," "].includes(f.key)&&u.onOpenToggle(),f.key==="ArrowDown"&&u.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(f.key)&&f.preventDefault())})})})});VN.displayName=HN;var l5="DropdownMenuPortal",GN=a=>{const{__scopeDropdownMenu:n,...r}=a,c=oa(n);return e.jsx(Ew,{...c,...r})};GN.displayName=l5;var qN="DropdownMenuContent",KN=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,...c}=a,d=IN(qN,r),u=oa(r),h=m.useRef(!1);return e.jsx(Mw,{id:d.contentId,"aria-labelledby":d.triggerId,...u,...c,ref:n,onCloseAutoFocus:gn(a.onCloseAutoFocus,f=>{h.current||d.triggerRef.current?.focus(),h.current=!1,f.preventDefault()}),onInteractOutside:gn(a.onInteractOutside,f=>{const p=f.detail.originalEvent,g=p.button===0&&p.ctrlKey===!0,N=p.button===2||g;(!d.modal||N)&&(h.current=!0)}),style:{...a.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});KN.displayName=qN;var n5="DropdownMenuGroup",r5=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Bw,{...d,...c,ref:n})});r5.displayName=n5;var i5="DropdownMenuLabel",QN=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Ow,{...d,...c,ref:n})});QN.displayName=i5;var c5="DropdownMenuItem",YN=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Aw,{...d,...c,ref:n})});YN.displayName=c5;var o5="DropdownMenuCheckboxItem",JN=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(zw,{...d,...c,ref:n})});JN.displayName=o5;var d5="DropdownMenuRadioGroup",u5=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Pw,{...d,...c,ref:n})});u5.displayName=d5;var m5="DropdownMenuRadioItem",XN=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Dw,{...d,...c,ref:n})});XN.displayName=m5;var x5="DropdownMenuItemIndicator",ZN=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Rw,{...d,...c,ref:n})});ZN.displayName=x5;var h5="DropdownMenuSeparator",WN=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Lw,{...d,...c,ref:n})});WN.displayName=h5;var f5="DropdownMenuArrow",p5=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Iw,{...d,...c,ref:n})});p5.displayName=f5;var g5="DropdownMenuSubTrigger",eb=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Cw,{...d,...c,ref:n})});eb.displayName=g5;var j5="DropdownMenuSubContent",sb=m.forwardRef((a,n)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Tw,{...d,...c,ref:n,style:{...a.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});sb.displayName=j5;var v5=FN,N5=VN,b5=GN,tb=KN,ab=QN,lb=YN,nb=JN,rb=XN,ib=ZN,cb=WN,ob=eb,db=sb;const y5=v5,w5=N5,_5=m.forwardRef(({className:a,inset:n,children:r,...c},d)=>e.jsxs(ob,{ref:d,className:I("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",n&&"pl-8",a),...c,children:[r,e.jsx(Wt,{className:"ml-auto h-4 w-4"})]}));_5.displayName=ob.displayName;const S5=m.forwardRef(({className:a,...n},r)=>e.jsx(db,{ref:r,className:I("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n}));S5.displayName=db.displayName;const ub=m.forwardRef(({className:a,sideOffset:n=4,...r},c)=>e.jsx(b5,{children:e.jsx(tb,{ref:c,sideOffset:n,className:I("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}));ub.displayName=tb.displayName;const mb=m.forwardRef(({className:a,inset:n,...r},c)=>e.jsx(lb,{ref:c,className:I("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n&&"pl-8",a),...r}));mb.displayName=lb.displayName;const k5=m.forwardRef(({className:a,children:n,checked:r,...c},d)=>e.jsxs(nb,{ref:d,className:I("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:r,...c,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ib,{children:e.jsx(Ct,{className:"h-4 w-4"})})}),n]}));k5.displayName=nb.displayName;const C5=m.forwardRef(({className:a,children:n,...r},c)=>e.jsxs(rb,{ref:c,className:I("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ib,{children:e.jsx(Ho,{className:"h-2 w-2 fill-current"})})}),n]}));C5.displayName=rb.displayName;const T5=m.forwardRef(({className:a,inset:n,...r},c)=>e.jsx(ab,{ref:c,className:I("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",a),...r}));T5.displayName=ab.displayName;const E5=m.forwardRef(({className:a,...n},r)=>e.jsx(cb,{ref:r,className:I("-mx-1 my-1 h-px bg-muted",a),...n}));E5.displayName=cb.displayName;const Gm=[{value:"created_at",label:"",icon:na},{value:"downloads",label:"",icon:Xt},{value:"likes",label:"",icon:Xr}];function M5(){const a=ca(),[n,r]=m.useState([]),[c,d]=m.useState(!0),[u,h]=m.useState(""),[f,p]=m.useState("downloads"),[g,N]=m.useState(1),[v,w]=m.useState(1),[b,y]=m.useState(0),[O,R]=m.useState(new Set),[S,B]=m.useState(new Set),E=Yv(),C=m.useCallback(async()=>{d(!0);try{const U=await PS({status:"approved",page:g,page_size:12,search:u||void 0,sort_by:f,sort_order:"desc"});r(U.packs),w(U.total_pages),y(U.total);const oe=new Set;for(const Ne of U.packs)await Qv(Ne.id,E)&&oe.add(Ne.id);R(oe)}catch(U){console.error(" Pack :",U),Qt({title:" Pack ",variant:"destructive"})}finally{d(!1)}},[g,u,f,E]);m.useEffect(()=>{C()},[C]);const A=U=>{U.preventDefault(),N(1),C()},F=async U=>{if(!S.has(U)){B(oe=>new Set(oe).add(U));try{const oe=await Kv(U,E);R(Ne=>{const je=new Set(Ne);return oe.liked?je.add(U):je.delete(U),je}),r(Ne=>Ne.map(je=>je.id===U?{...je,likes:oe.likes}:je))}catch(oe){console.error(":",oe),Qt({title:"",variant:"destructive"})}finally{B(oe=>{const Ne=new Set(oe);return Ne.delete(U),Ne})}}},L=U=>{a({to:"/config/pack-market/$packId",params:{packId:U}})},J=Gm.find(U=>U.value===f)||Gm[0];return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(ra,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:" MaiBot"})]}),e.jsxs(_,{variant:"outline",onClick:C,disabled:c,className:"gap-2",children:[e.jsx(dt,{className:`h-4 w-4 ${c?"animate-spin":""}`}),""]})]})}),e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx("form",{onSubmit:A,className:"flex-1 min-w-[200px] max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:u,onChange:U=>h(U.target.value),className:"pl-10"})]})}),e.jsxs(y5,{children:[e.jsx(w5,{asChild:!0,children:e.jsxs(_,{variant:"outline",className:"min-w-[140px] gap-2",children:[e.jsx(Q_,{className:"w-4 h-4"}),J.label,e.jsx(za,{className:"w-4 h-4 ml-auto"})]})}),e.jsx(ub,{align:"end",children:Gm.map(U=>e.jsxs(mb,{onClick:()=>{p(U.value),N(1)},children:[e.jsx(U.icon,{className:"w-4 h-4 mr-2"}),U.label]},U.value))})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",e.jsx("span",{className:"font-medium text-foreground",children:b})," "]}),c?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((U,oe)=>e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(vs,{className:"h-6 w-3/4"}),e.jsx(vs,{className:"h-4 w-full mt-2"})]}),e.jsx(Me,{children:e.jsx(vs,{className:"h-20 w-full"})}),e.jsx(id,{children:e.jsx(vs,{className:"h-9 w-full"})})]},oe))}):n.length===0?e.jsx(Ce,{className:"py-12",children:e.jsxs(Me,{className:"text-center text-muted-foreground",children:[e.jsx(ra,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:""}),e.jsx("p",{className:"mt-1",children:""})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(U=>e.jsx(A5,{pack:U,liked:O.has(U.id),liking:S.has(U.id),onLike:()=>F(U.id),onView:()=>L(U.id)},U.id))}),v>1&&e.jsx(ox,{children:e.jsxs(dx,{children:[e.jsx(qn,{children:e.jsx(Av,{onClick:()=>N(U=>Math.max(1,U-1)),className:g===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:v},(U,oe)=>oe+1).filter(U=>U===1||U===v||Math.abs(U-g)<=1).map((U,oe,Ne)=>{const je=oe>0&&U-Ne[oe-1]>1;return e.jsxs(qn,{children:[je&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(pc,{onClick:()=>N(U),isActive:U===g,className:"cursor-pointer",children:U})]},U)}),e.jsx(qn,{children:e.jsx(zv,{onClick:()=>N(U=>Math.min(v,U+1)),className:g===v?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})]})}function A5({pack:a,liked:n,liking:r,onLike:c,onView:d}){const u=h=>new Date(h).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"});return e.jsxs(Ce,{className:"flex flex-col hover:shadow-md transition-shadow",children:[e.jsxs(De,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(Oe,{className:"text-lg line-clamp-1",children:a.name}),e.jsxs(ke,{variant:"secondary",className:"text-xs",children:["v",a.version]})]}),e.jsx(os,{className:"line-clamp-2 min-h-[40px]",children:a.description})]}),e.jsxs(Me,{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(jn,{className:"w-3.5 h-3.5"}),a.author]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(na,{className:"w-3.5 h-3.5"}),u(a.created_at)]})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Ll,{className:"w-3.5 h-3.5"}),a.provider_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Qn,{className:"w-3.5 h-3.5"}),a.model_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Yn,{className:"w-3.5 h-3.5"}),a.task_count]})]}),a.tags&&a.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.tags.slice(0,3).map(h=>e.jsxs(ke,{variant:"outline",className:"text-xs",children:[e.jsx(rd,{className:"w-2.5 h-2.5 mr-1"}),h]},h)),a.tags.length>3&&e.jsxs(ke,{variant:"outline",className:"text-xs",children:["+",a.tags.length-3]})]})]}),e.jsx(id,{className:"pt-3 border-t",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Xt,{className:"w-4 h-4"}),a.downloads]}),e.jsxs("button",{onClick:h=>{h.stopPropagation(),c()},disabled:r,className:`flex items-center gap-1 transition-colors ${n?"text-red-500":"hover:text-red-500"} ${r?"opacity-50":""}`,children:[e.jsx(Xr,{className:`w-4 h-4 ${n?"fill-current":""}`}),a.likes]})]}),e.jsx(_,{size:"sm",onClick:d,children:""})]})})]})}var al="Accordion",z5=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Tx,R5,D5]=x_(al),[jd]=td(al,[D5,Ej]),Ex=Ej(),xb=Rs.forwardRef((a,n)=>{const{type:r,...c}=a,d=c,u=c;return e.jsx(Tx.Provider,{scope:a.__scopeAccordion,children:r==="multiple"?e.jsx($5,{...u,ref:n}):e.jsx(U5,{...d,ref:n})})});xb.displayName=al;var[hb,O5]=jd(al),[fb,L5]=jd(al,{collapsible:!1}),U5=Rs.forwardRef((a,n)=>{const{value:r,defaultValue:c,onValueChange:d=()=>{},collapsible:u=!1,...h}=a,[f,p]=sd({prop:r,defaultProp:c??"",onChange:d,caller:al});return e.jsx(hb,{scope:a.__scopeAccordion,value:Rs.useMemo(()=>f?[f]:[],[f]),onItemOpen:p,onItemClose:Rs.useCallback(()=>u&&p(""),[u,p]),children:e.jsx(fb,{scope:a.__scopeAccordion,collapsible:u,children:e.jsx(pb,{...h,ref:n})})})}),$5=Rs.forwardRef((a,n)=>{const{value:r,defaultValue:c,onValueChange:d=()=>{},...u}=a,[h,f]=sd({prop:r,defaultProp:c??[],onChange:d,caller:al}),p=Rs.useCallback(N=>f((v=[])=>[...v,N]),[f]),g=Rs.useCallback(N=>f((v=[])=>v.filter(w=>w!==N)),[f]);return e.jsx(hb,{scope:a.__scopeAccordion,value:h,onItemOpen:p,onItemClose:g,children:e.jsx(fb,{scope:a.__scopeAccordion,collapsible:!0,children:e.jsx(pb,{...u,ref:n})})})}),[B5,vd]=jd(al),pb=Rs.forwardRef((a,n)=>{const{__scopeAccordion:r,disabled:c,dir:d,orientation:u="vertical",...h}=a,f=Rs.useRef(null),p=ad(f,n),g=R5(r),v=Gj(d)==="ltr",w=gn(a.onKeyDown,b=>{if(!z5.includes(b.key))return;const y=b.target,O=g().filter(J=>!J.ref.current?.disabled),R=O.findIndex(J=>J.ref.current===y),S=O.length;if(R===-1)return;b.preventDefault();let B=R;const E=0,C=S-1,A=()=>{B=R+1,B>C&&(B=E)},F=()=>{B=R-1,B<E&&(B=C)};switch(b.key){case"Home":B=E;break;case"End":B=C;break;case"ArrowRight":u==="horizontal"&&(v?A():F());break;case"ArrowDown":u==="vertical"&&A();break;case"ArrowLeft":u==="horizontal"&&(v?F():A());break;case"ArrowUp":u==="vertical"&&F();break}const L=B%S;O[L].ref.current?.focus()});return e.jsx(B5,{scope:r,disabled:c,direction:d,orientation:u,children:e.jsx(Tx.Slot,{scope:r,children:e.jsx(Zn.div,{...h,"data-orientation":u,ref:p,onKeyDown:c?void 0:w})})})}),ed="AccordionItem",[P5,Mx]=jd(ed),gb=Rs.forwardRef((a,n)=>{const{__scopeAccordion:r,value:c,...d}=a,u=vd(ed,r),h=O5(ed,r),f=Ex(r),p=qm(),g=c&&h.value.includes(c)||!1,N=u.disabled||a.disabled;return e.jsx(P5,{scope:r,open:g,disabled:N,triggerId:p,children:e.jsx(wj,{"data-orientation":u.orientation,"data-state":wb(g),...f,...d,ref:n,disabled:N,open:g,onOpenChange:v=>{v?h.onItemOpen(c):h.onItemClose(c)}})})});gb.displayName=ed;var jb="AccordionHeader",vb=Rs.forwardRef((a,n)=>{const{__scopeAccordion:r,...c}=a,d=vd(al,r),u=Mx(jb,r);return e.jsx(Zn.h3,{"data-orientation":d.orientation,"data-state":wb(u.open),"data-disabled":u.disabled?"":void 0,...c,ref:n})});vb.displayName=jb;var ex="AccordionTrigger",Nb=Rs.forwardRef((a,n)=>{const{__scopeAccordion:r,...c}=a,d=vd(al,r),u=Mx(ex,r),h=L5(ex,r),f=Ex(r);return e.jsx(Tx.ItemSlot,{scope:r,children:e.jsx(Fw,{"aria-disabled":u.open&&!h.collapsible||void 0,"data-orientation":d.orientation,id:u.triggerId,...f,...c,ref:n})})});Nb.displayName=ex;var bb="AccordionContent",yb=Rs.forwardRef((a,n)=>{const{__scopeAccordion:r,...c}=a,d=vd(al,r),u=Mx(bb,r),h=Ex(r);return e.jsx(Hw,{role:"region","aria-labelledby":u.triggerId,"data-orientation":d.orientation,...h,...c,ref:n,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...a.style}})});yb.displayName=bb;function wb(a){return a?"open":"closed"}var I5=xb,F5=gb,H5=vb,_b=Nb,Sb=yb;const V5=I5,kb=m.forwardRef(({className:a,...n},r)=>e.jsx(F5,{ref:r,className:I("border-b",a),...n}));kb.displayName="AccordionItem";const Cb=m.forwardRef(({className:a,children:n,...r},c)=>e.jsx(H5,{className:"flex",children:e.jsxs(_b,{ref:c,className:I("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",a),...r,children:[n,e.jsx(za,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Cb.displayName=_b.displayName;const Tb=m.forwardRef(({className:a,children:n,...r},c)=>e.jsx(Sb,{ref:c,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:e.jsx("div",{className:I("pb-4 pt-0",a),children:n})}));Tb.displayName=Sb.displayName;const G5={utils:"",utils_small:"",tool_use:"",replyer:"",planner:"",vlm:"",voice:"",embedding:"",lpmm_entity_extract:"",lpmm_rdf_build:"RDF",lpmm_qa:""};function q5(){const{packId:a}=Rb.useParams(),n=ca(),[r,c]=m.useState(null),[d,u]=m.useState(!0),[h,f]=m.useState(!1),[p,g]=m.useState(!1),[N,v]=m.useState(!1),[w,b]=m.useState(1),[y,O]=m.useState(null),[R,S]=m.useState(!1),[B,E]=m.useState(!1),[C,A]=m.useState({apply_providers:!0,apply_models:!0,apply_task_config:!0,task_mode:"append",selected_providers:void 0,selected_models:void 0,selected_tasks:void 0}),[F,L]=m.useState({}),[J,U]=m.useState({}),oe=Yv(),Ne=m.useCallback(async()=>{if(a){u(!0);try{const M=await IS(a);c(M);const K=await Qv(a,oe);f(K)}catch(M){console.error(" Pack :",M),Qt({title:"",variant:"destructive"})}finally{u(!1)}}},[a,oe]);m.useEffect(()=>{Ne()},[Ne]);const je=async()=>{if(!(!a||p)){g(!0);try{const M=await Kv(a,oe);f(M.liked),r&&c({...r,likes:M.likes})}catch(M){console.error(":",M),Qt({title:"",variant:"destructive"})}finally{g(!1)}}},re=async()=>{if(r){v(!0),b(1),S(!0);try{const M=await VS(r);O(M);const K={};for(const ue of M.existing_providers)K[ue.pack_provider.name]=ue.local_providers[0].name;L(K);const P={};for(const ue of M.new_providers)P[ue.name]="";U(P)}catch(M){console.error(":",M),Qt({title:"",variant:"destructive"}),v(!1)}finally{S(!1)}}},fe=async()=>{if(r){if(C.apply_providers&&y){for(const M of y.new_providers)if(!J[M.name]){Qt({title:` "${M.name}"  API Key`,variant:"destructive"});return}}E(!0);try{await GS(r,C,F,J),await HS(r.id,oe),c({...r,downloads:r.downloads+1}),Qt({title:""}),v(!1)}catch(M){console.error(" Pack :",M),Qt({title:M instanceof Error?M.message:"",variant:"destructive"})}finally{E(!1)}}},ge=M=>new Date(M).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"});return d?e.jsx(Q5,{}):r?e.jsx("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>n({to:"/config/pack-market"}),className:"gap-2",children:[e.jsx(Ma,{className:"w-4 h-4"}),""]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ra,{className:"w-10 h-10 text-primary mt-1"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[r.name,e.jsxs(ke,{variant:"secondary",children:["v",r.version]})]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:r.description})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(jn,{className:"w-4 h-4"}),r.author]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(na,{className:"w-4 h-4"}),ge(r.created_at)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Xt,{className:"w-4 h-4"}),r.downloads," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Xr,{className:`w-4 h-4 ${h?"fill-red-500 text-red-500":""}`}),r.likes," "]})]}),r.tags&&r.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map(M=>e.jsxs(ke,{variant:"outline",children:[e.jsx(rd,{className:"w-3 h-3 mr-1"}),M]},M))})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[e.jsxs(_,{size:"lg",onClick:re,children:[e.jsx(Xt,{className:"w-4 h-4 mr-2"}),""]}),e.jsxs(_,{variant:"outline",onClick:je,disabled:p,className:h?"text-red-500 border-red-200":"",children:[e.jsx(Xr,{className:`w-4 h-4 mr-2 ${h?"fill-current":""}`}),h?"":""]})]})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(Ce,{children:e.jsxs(Me,{className:"flex items-center gap-3 py-4",children:[e.jsx(Ll,{className:"w-8 h-8 text-blue-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.providers.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"API "})]})]})}),e.jsx(Ce,{children:e.jsxs(Me,{className:"flex items-center gap-3 py-4",children:[e.jsx(Qn,{className:"w-8 h-8 text-green-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.models.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})}),e.jsx(Ce,{children:e.jsxs(Me,{className:"flex items-center gap-3 py-4",children:[e.jsx(Yn,{className:"w-8 h-8 text-purple-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Object.keys(r.task_config).length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})})]}),e.jsxs(ta,{defaultValue:"providers",className:"space-y-4",children:[e.jsxs(Zt,{className:"w-full sm:w-auto grid grid-cols-3 sm:flex",children:[e.jsxs(Xe,{value:"providers",className:"gap-1 sm:gap-2",children:[e.jsx(Ll,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r.providers.length,")"]})]}),e.jsxs(Xe,{value:"models",className:"gap-1 sm:gap-2",children:[e.jsx(Qn,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r.models.length,")"]})]}),e.jsxs(Xe,{value:"tasks",className:"gap-1 sm:gap-2",children:[e.jsx(Yn,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",Object.keys(r.task_config).length,")"]})]})]}),e.jsx(ws,{value:"providers",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:"API "}),e.jsx(os,{children:" API  API Key"})]}),e.jsx(Me,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ut,{children:[e.jsx(We,{children:""}),e.jsx(We,{children:"Base URL"}),e.jsx(We,{children:""})]})}),e.jsx(Bl,{children:r.providers.map(M=>e.jsxs(ut,{children:[e.jsx(Ke,{className:"font-medium whitespace-nowrap",children:M.name}),e.jsx(Ke,{className:"text-muted-foreground font-mono text-sm max-w-[200px] truncate",children:M.base_url}),e.jsx(Ke,{children:e.jsx(ke,{variant:"outline",children:M.client_type})})]},M.name))})]})})})]})}),e.jsx(ws,{value:"models",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsx(os,{children:""})]}),e.jsx(Me,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ut,{children:[e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{children:""}),e.jsx(We,{className:"text-right",children:" (/)"})]})}),e.jsx(Bl,{children:r.models.map(M=>e.jsxs(ut,{children:[e.jsx(Ke,{className:"font-medium whitespace-nowrap",children:M.name}),e.jsx(Ke,{className:"text-muted-foreground font-mono text-sm max-w-[150px] truncate",children:M.model_identifier}),e.jsx(Ke,{className:"whitespace-nowrap",children:M.api_provider}),e.jsxs(Ke,{className:"text-right text-muted-foreground whitespace-nowrap",children:["",M.price_in," / ",M.price_out]})]},M.name))})]})})})]})}),e.jsx(ws,{value:"tasks",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:""}),e.jsx(os,{children:""})]}),e.jsx(Me,{children:e.jsx(V5,{type:"multiple",className:"w-full",children:Object.entries(r.task_config).map(([M,K])=>e.jsxs(kb,{value:M,children:[e.jsx(Cb,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vn,{className:"w-4 h-4"}),G5[M]||M,e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[K.model_list.length," "]})]})}),e.jsx(Tb,{children:e.jsxs("div",{className:"space-y-2 pl-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:K.model_list.map(P=>e.jsx(ke,{variant:"outline",children:P},P))}),K.temperature!==void 0&&e.jsxs("div",{className:"text-sm",children:["Temperature: ",e.jsx("span",{className:"font-mono",children:K.temperature})]}),K.max_tokens!==void 0&&e.jsxs("div",{className:"text-sm",children:["Max Tokens: ",e.jsx("span",{className:"font-mono",children:K.max_tokens})]})]})})]},M))})})]})})]}),e.jsx(K5,{open:N,onOpenChange:v,pack:r,step:w,setStep:b,conflicts:y,detectingConflicts:R,applying:B,options:C,setOptions:A,_providerMapping:F,_setProviderMapping:L,newProviderApiKeys:J,setNewProviderApiKeys:U,onApply:fe})]})})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ra,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("h2",{className:"text-xl font-semibold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2",children:""}),e.jsxs(_,{className:"mt-4",onClick:()=>n({to:"/config/pack-market"}),children:[e.jsx(Ma,{className:"w-4 h-4 mr-2"}),""]})]})}function K5({open:a,onOpenChange:n,pack:r,step:c,setStep:d,conflicts:u,detectingConflicts:h,applying:f,options:p,setOptions:g,_providerMapping:N,_setProviderMapping:v,newProviderApiKeys:w,setNewProviderApiKeys:b,onApply:y}){return e.jsx(Ps,{open:a,onOpenChange:n,children:e.jsxs(Ds,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Os,{children:[e.jsxs(Ls,{className:"flex items-center gap-2",children:[e.jsx(ra,{className:"w-5 h-5"}),""]}),e.jsxs(Ks,{children:[" ",c," / ",3,"",c===1&&"",c===2&&"",c===3&&""]})]}),h?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(zs,{className:"w-8 h-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"..."})]}):e.jsxs(e.Fragment,{children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"apply_providers",checked:p.apply_providers,onCheckedChange:R=>g({...p,apply_providers:R})}),e.jsxs(T,{htmlFor:"apply_providers",className:"flex items-center gap-2",children:[e.jsx(Ll,{className:"w-4 h-4"})," (",r.providers.length," )"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"apply_models",checked:p.apply_models,onCheckedChange:R=>g({...p,apply_models:R})}),e.jsxs(T,{htmlFor:"apply_models",className:"flex items-center gap-2",children:[e.jsx(Qn,{className:"w-4 h-4"})," (",r.models.length," )"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"apply_task_config",checked:p.apply_task_config,onCheckedChange:R=>g({...p,apply_task_config:R})}),e.jsxs(T,{htmlFor:"apply_task_config",className:"flex items-center gap-2",children:[e.jsx(Yn,{className:"w-4 h-4"})," (",Object.keys(r.task_config).length," )"]})]})]}),p.apply_task_config&&e.jsxs("div",{className:"pl-6 space-y-2 border-l-2 border-muted",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs(Sx,{value:p.task_mode,onValueChange:R=>g({...p,task_mode:R}),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xo,{value:"append",id:"mode_append"}),e.jsx(T,{htmlFor:"mode_append",className:"font-normal",children:" - "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xo,{value:"replace",id:"mode_replace"}),e.jsx(T,{htmlFor:"mode_replace",className:"font-normal",children:" - "})]})]})]})]}),c===2&&u&&e.jsxs("div",{className:"space-y-4",children:[p.apply_providers&&u.existing_providers.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(at,{children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsx(Gn,{children:""}),e.jsx(lt,{children:" URL "})]}),e.jsx("div",{className:"space-y-2",children:u.existing_providers.map(({pack_provider:R,local_providers:S})=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg",children:[e.jsx(Ct,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{className:"font-medium flex-shrink-0",children:R.name}),e.jsx(Wt,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),S.length===1?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:S[0].name}),e.jsx(ke,{variant:"outline",className:"ml-auto",children:"URL "})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{value:N[R.name]||S[0].name,onValueChange:B=>v({...N,[R.name]:B}),children:[e.jsx($e,{className:"w-[200px]",children:e.jsx(Ie,{})}),e.jsx(Be,{children:S.map(B=>e.jsx(Z,{value:B.name,children:B.name},B.name))})]}),e.jsxs(ke,{variant:"outline",className:"ml-auto",children:[S.length," "]})]})]},R.name))})]}),p.apply_providers&&u.new_providers.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(at,{variant:"destructive",children:[e.jsx(Jt,{className:"h-4 w-4"}),e.jsx(Gn,{children:" API Key"}),e.jsx(lt,{children:" API Key"})]}),e.jsx("div",{className:"space-y-4",children:u.new_providers.map(R=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lx,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"font-medium",children:R.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",R.base_url,")"]})]}),e.jsx(ae,{type:"password",placeholder:` ${R.name}  API Key`,value:w[R.name]||"",onChange:S=>b({...w,[R.name]:S.target.value})})]},R.name))})]}),(!p.apply_providers||u.existing_providers.length===0&&u.new_providers.length===0)&&e.jsxs(at,{children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx(Gn,{children:""}),e.jsx(lt,{children:""})]})]}),c===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(at,{children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsx(Gn,{children:""}),e.jsx(lt,{children:""})]}),e.jsxs("div",{className:"space-y-2",children:[p.apply_providers&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ct,{className:"w-4 h-4 text-green-500"}),e.jsx(Ll,{className:"w-4 h-4"}),e.jsxs("span",{children:[" ",r.providers.length," "]})]}),p.apply_models&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ct,{className:"w-4 h-4 text-green-500"}),e.jsx(Qn,{className:"w-4 h-4"}),e.jsxs("span",{children:[" ",r.models.length," "]})]}),p.apply_task_config&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ct,{className:"w-4 h-4 text-green-500"}),e.jsx(Yn,{className:"w-4 h-4"}),e.jsxs("span",{children:[p.task_mode==="append"?"":""," ",Object.keys(r.task_config).length," "]})]})]}),u&&u.new_providers.length>0&&e.jsxs(at,{variant:"destructive",children:[e.jsx(Jt,{className:"h-4 w-4"}),e.jsxs(lt,{children:[" ",u.new_providers.length,"  API Key"]})]})]})]}),e.jsxs(st,{className:"flex justify-between",children:[e.jsx("div",{children:c>1&&!h&&e.jsx(_,{variant:"outline",onClick:()=>d(c-1),disabled:f,children:""})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>n(!1),disabled:f,children:""}),c<3?e.jsx(_,{onClick:()=>d(c+1),disabled:h,children:""}):e.jsxs(_,{onClick:y,disabled:f,children:[f&&e.jsx(zs,{className:"w-4 h-4 mr-2 animate-spin"}),""]})]})]})]})})}function Q5(){return e.jsx("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(vs,{className:"h-9 w-24"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(vs,{className:"w-10 h-10"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(vs,{className:"h-8 w-2/3"}),e.jsx(vs,{className:"h-4 w-full"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx(vs,{className:"h-4 w-24"}),e.jsx(vs,{className:"h-4 w-32"}),e.jsx(vs,{className:"h-4 w-28"}),e.jsx(vs,{className:"h-4 w-20"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(vs,{className:"h-6 w-20"}),e.jsx(vs,{className:"h-6 w-24"}),e.jsx(vs,{className:"h-6 w-16"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[e.jsx(vs,{className:"h-10 w-full"}),e.jsx(vs,{className:"h-10 w-full"})]})]}),e.jsx(vs,{className:"h-px w-full"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(vs,{className:"h-24"}),e.jsx(vs,{className:"h-24"}),e.jsx(vs,{className:"h-24"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(vs,{className:"h-10 w-32"}),e.jsx(vs,{className:"h-10 w-32"}),e.jsx(vs,{className:"h-10 w-32"})]}),e.jsx(vs,{className:"h-96 w-full"})]})]})})})}function Y5(){const a=ca(),[n,r]=m.useState(!0);return m.useEffect(()=>{let c=!1;return(async()=>{try{const u=await cc();!c&&!u&&a({to:"/auth"})}catch{c||a({to:"/auth"})}finally{c||r(!1)}})(),()=>{c=!0}},[a]),{checking:n}}async function J5(){return await cc()}const X5=Wr("pointer-events-none inline-flex select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono font-medium opacity-100",{variants:{size:{sm:"h-5 text-[10px]",default:"h-6 text-xs",lg:"h-7 text-sm"}},defaultVariants:{size:"default"}}),Eb=m.forwardRef(({className:a,size:n,abbrTitle:r,children:c,...d},u)=>e.jsx("kbd",{className:I(X5({size:n,className:a})),ref:u,...d,children:r?e.jsx("abbr",{title:r,children:c}):c}));Eb.displayName="Kbd";const Z5=[{icon:nd,title:"",description:"",path:"/",category:""},{icon:Ea,title:"",description:"",path:"/config/bot",category:""},{icon:Ll,title:"",description:"",path:"/config/modelProvider",category:""},{icon:dv,title:"",description:"",path:"/config/model",category:""},{icon:ld,title:"",description:"",path:"/resource/emoji",category:""},{icon:Ra,title:"",description:"",path:"/resource/expression",category:""},{icon:uv,title:"",description:"",path:"/resource/person",category:""},{icon:Jr,title:"",description:"",path:"/resource/jargon",category:""},{icon:Y_,title:"",description:"",path:"/statistics",category:""},{icon:ra,title:"",description:"",path:"/plugins",category:""},{icon:nx,title:"",description:"",path:"/logs",category:""},{icon:vn,title:"",description:"",path:"/settings",category:""}];function W5({open:a,onOpenChange:n}){const[r,c]=m.useState(""),[d,u]=m.useState(0),h=ca(),f=Z5.filter(N=>N.title.toLowerCase().includes(r.toLowerCase())||N.description.toLowerCase().includes(r.toLowerCase())||N.category.toLowerCase().includes(r.toLowerCase())),p=m.useCallback(N=>{h({to:N}),n(!1),c(""),u(0)},[h,n]),g=m.useCallback(N=>{N.key==="ArrowDown"?(N.preventDefault(),u(v=>(v+1)%f.length)):N.key==="ArrowUp"?(N.preventDefault(),u(v=>(v-1+f.length)%f.length)):N.key==="Enter"&&f[d]&&(N.preventDefault(),p(f[d].path))},[f,d,p]);return e.jsx(Ps,{open:a,onOpenChange:n,children:e.jsxs(Ds,{className:"max-w-2xl p-0 gap-0",children:[e.jsxs(Os,{className:"px-4 pt-4 pb-0",children:[e.jsx(Ls,{className:"sr-only",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-muted-foreground"}),e.jsx(ae,{value:r,onChange:N=>{c(N.target.value),u(0)},onKeyDown:g,placeholder:"...",className:"h-12 pl-11 text-base border-0 focus-visible:ring-0 shadow-none",autoFocus:!0})]})]}),e.jsx("div",{className:"border-t",children:e.jsx(Je,{className:"h-[400px]",children:f.length>0?e.jsx("div",{className:"p-2",children:f.map((N,v)=>{const w=N.icon;return e.jsxs("button",{onClick:()=>p(N.path),onMouseEnter:()=>u(v),className:I("w-full flex items-center gap-3 px-3 py-2.5 rounded-md text-left transition-colors",v===d?"bg-accent text-accent-foreground":"hover:bg-accent/50"),children:[e.jsx(w,{className:"h-5 w-5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm",children:N.title}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:N.description})]}),e.jsx("div",{className:"text-xs text-muted-foreground px-2 py-1 bg-muted rounded",children:N.category})]},N.path)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Tt,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r?"":""})]})})}),e.jsx("div",{className:"border-t px-4 py-3 flex items-center justify-between text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:""}),e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:""}),""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:"Enter"}),""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:"Esc"}),""]})]})})]})})}function eT(){const a=window.location.protocol==="http:",n=window.location.hostname.toLowerCase(),r=n==="localhost"||n==="127.0.0.1"||n==="::1",c=sessionStorage.getItem("http-warning-dismissed")==="true",[d,u]=m.useState(a&&!r&&!c),[h,f]=m.useState(!1),p=()=>{f(!0),u(!1),sessionStorage.setItem("http-warning-dismissed","true")};return!d||h?null:e.jsx("div",{className:"relative bg-amber-500/10 border-b border-amber-500/20 backdrop-blur-sm",children:e.jsx("div",{className:"container mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(Jt,{className:"h-5 w-5 text-amber-600 dark:text-amber-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-amber-900 dark:text-amber-100",children:[e.jsx("span",{className:"font-semibold",children:""})," ",e.jsx("strong",{children:"HTTP"}),"  MaiBot WebUI"]}),e.jsx("p",{className:"text-xs text-amber-800 dark:text-amber-200 mt-1",children:" Token HTTPS "})]})]}),e.jsx(_,{variant:"ghost",size:"icon",onClick:p,className:"h-8 w-8 text-amber-700 hover:text-amber-900 dark:text-amber-400 dark:hover:text-amber-200 flex-shrink-0","aria-label":"",children:e.jsx(Aa,{className:"h-4 w-4"})})]})})})}function sT(){const[a,n]=m.useState(0),[r,c]=m.useState(!1),d=m.useRef(null);m.useEffect(()=>{const g=N=>{const v=N.target;if(v.scrollHeight>v.clientHeight+100){d.current=v;const w=v.scrollTop,b=v.scrollHeight-v.clientHeight,y=b>0?w/b*100:0;n(y),c(w>300)}};return window.addEventListener("scroll",g,{capture:!0,passive:!0}),()=>window.removeEventListener("scroll",g,{capture:!0})},[]);const u=()=>{d.current?.scrollTo({top:0,behavior:"smooth"})},h=18,f=2*Math.PI*h,p=f-a/100*f;return e.jsx("div",{className:I("fixed bottom-24 right-8 z-50 transition-all duration-500 ease-in-out transform",r?"translate-x-0 opacity-100":"translate-x-32 opacity-0 pointer-events-none"),children:e.jsxs(_,{variant:"outline",size:"icon",className:I("relative h-12 w-12 rounded-full shadow-xl","bg-background/80 backdrop-blur-md border-border/50","hover:bg-accent hover:scale-110 hover:shadow-2xl hover:border-primary/50","transition-all duration-300","group"),onClick:u,"aria-label":"",children:[e.jsxs("svg",{className:"absolute inset-0 h-full w-full -rotate-90 transform p-1",viewBox:"0 0 44 44",children:[e.jsx("circle",{className:"text-muted-foreground/10",strokeWidth:"3",stroke:"currentColor",fill:"transparent",r:h,cx:"22",cy:"22"}),e.jsx("circle",{className:"text-primary transition-all duration-100 ease-out",strokeWidth:"3",strokeDasharray:f,strokeDashoffset:p,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:h,cx:"22",cy:"22"})]}),e.jsx(J_,{className:"h-5 w-5 text-primary transition-transform duration-300 group-hover:-translate-y-1 group-hover:scale-110",strokeWidth:2.5}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})})}const tT=f_,aT=p_,lT=g_,Mb=m.forwardRef(({className:a,sideOffset:n=4,...r},c)=>e.jsx(h_,{children:e.jsx(qj,{ref:c,sideOffset:n,className:I("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",a),...r})}));Mb.displayName=qj.displayName;function nT({children:a}){const{checking:n}=Y5(),[r,c]=m.useState(!0),[d,u]=m.useState(!1),[h,f]=m.useState(!1),[p,g]=m.useState(!1),{theme:N,setTheme:v}=xx(),w=X0();if(m.useEffect(()=>{if(r)g(!1);else{const S=setTimeout(()=>{g(!0)},350);return()=>clearTimeout(S)}},[r]),m.useEffect(()=>{const S=B=>{(B.metaKey||B.ctrlKey)&&B.key==="k"&&(B.preventDefault(),f(!0))};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[]),n)return e.jsx("div",{className:"flex h-screen items-center justify-center bg-background",children:e.jsx("div",{className:"text-muted-foreground",children:"..."})});const b=[{title:"",items:[{icon:nd,label:"",path:"/"}]},{title:"",items:[{icon:Ea,label:"",path:"/config/bot"},{icon:Ll,label:"AI",path:"/config/modelProvider",tourId:"sidebar-model-provider"},{icon:dv,label:"",path:"/config/model",tourId:"sidebar-model-management"},{icon:_g,label:"",path:"/config/adapter"}]},{title:"",items:[{icon:ld,label:"",path:"/resource/emoji"},{icon:Ra,label:"",path:"/resource/expression"},{icon:Jr,label:"",path:"/resource/jargon"},{icon:uv,label:"",path:"/resource/person"},{icon:rv,label:"",path:"/resource/knowledge-graph"},{icon:Yr,label:"",path:"/resource/knowledge-base"}]},{title:"",items:[{icon:ra,label:"",path:"/plugins"},{icon:cv,label:"",path:"/config/pack-market"},{icon:_g,label:"",path:"/plugin-config"},{icon:nx,label:"",path:"/logs"},{icon:sx,label:"&",path:"/planner-monitor"},{icon:Ra,label:"",path:"/chat"}]},{title:"",items:[{icon:vn,label:"",path:"/settings"}]}],O=N==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":N,R=async()=>{await z1()};return e.jsx(tT,{delayDuration:300,children:e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsxs("aside",{className:I("fixed inset-y-0 left-0 z-50 flex flex-col border-r bg-card transition-all duration-300 lg:relative lg:z-0","w-64 lg:w-auto",r?"lg:w-64":"lg:w-16",d?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:[e.jsx("div",{className:"flex h-16 items-center border-b px-4",children:e.jsxs("div",{className:I("relative flex items-center justify-center flex-1 transition-all overflow-hidden","lg:flex-1",!r&&"lg:flex-none lg:w-8"),children:[e.jsxs("div",{className:I("flex items-baseline gap-2",!r&&"lg:hidden"),children:[e.jsx("span",{className:"font-bold text-xl text-primary-gradient whitespace-nowrap",children:"MaiBot WebUI"}),e.jsx("span",{className:"text-xs text-primary/60 whitespace-nowrap",children:x2()})]}),!r&&e.jsx("span",{className:"hidden lg:block font-bold text-primary-gradient text-2xl",children:"M"})]})}),e.jsx(Je,{className:I("flex-1 overflow-x-hidden",!r&&"lg:w-16"),children:e.jsx("nav",{className:I("p-4",!r&&"lg:p-2 lg:w-16"),children:e.jsx("ul",{className:I("space-y-6",!r&&"lg:space-y-3 lg:w-full"),children:b.map((S,B)=>e.jsxs("li",{children:[e.jsx("div",{className:I("px-3 h-[1.25rem]","mb-2",!r&&"lg:mb-1 lg:invisible"),children:e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground/60 whitespace-nowrap",children:S.title})}),!r&&B>0&&e.jsx("div",{className:"hidden lg:block mb-2 border-t border-border"}),e.jsx("ul",{className:"space-y-1",children:S.items.map(E=>{const C=w({to:E.path}),A=E.icon,F=e.jsxs(e.Fragment,{children:[C&&e.jsx("div",{className:"absolute left-0 top-1/2 h-8 w-1 -translate-y-1/2 rounded-r-full bg-primary transition-opacity duration-300"}),e.jsxs("div",{className:I("flex items-center transition-all duration-300",r?"gap-3":"gap-3 lg:gap-0"),children:[e.jsx(A,{className:I("h-5 w-5 flex-shrink-0",C&&"text-primary"),strokeWidth:2,fill:"none"}),e.jsx("span",{className:I("text-sm font-medium whitespace-nowrap transition-all duration-300",C&&"font-semibold",r?"opacity-100 max-w-[200px]":"opacity-100 max-w-[200px] lg:opacity-0 lg:max-w-0 lg:overflow-hidden"),children:E.label})]})]});return e.jsx("li",{className:"relative",children:e.jsxs(aT,{children:[e.jsx(lT,{asChild:!0,children:e.jsx(Fn,{to:E.path,"data-tour":E.tourId,className:I("relative flex items-center rounded-lg py-2 transition-all duration-300","hover:bg-accent hover:text-accent-foreground",C?"bg-accent text-foreground":"text-muted-foreground hover:text-foreground",r?"px-3":"px-3 lg:px-0 lg:justify-center lg:w-12 lg:mx-auto"),onClick:()=>u(!1),children:F})}),p&&e.jsx(Mb,{side:"right",className:"hidden lg:block",children:e.jsx("p",{children:E.label})})]})},E.path)})})]},S.title))})})})]}),d&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>u(!1)}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(eT,{}),e.jsxs("header",{className:"flex h-16 items-center justify-between border-b bg-card/80 backdrop-blur-md px-4 sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>u(!d),className:"rounded-lg p-2 hover:bg-accent lg:hidden",children:e.jsx(X_,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>c(!r),className:"hidden rounded-lg p-2 hover:bg-accent lg:block",title:r?"":"",children:e.jsx(Da,{className:I("h-5 w-5 transition-transform",!r&&"rotate-180")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fn,{to:"/annual-report",children:e.jsxs(_,{variant:"ghost",size:"sm",className:"gap-2 bg-gradient-to-r from-pink-500/10 to-purple-500/10 hover:from-pink-500/20 hover:to-purple-500/20 border border-pink-500/20",title:"",children:[e.jsx(Z_,{className:"h-4 w-4 text-pink-500"}),e.jsx("span",{className:"hidden sm:inline bg-gradient-to-r from-pink-500 to-purple-500 bg-clip-text text-transparent font-medium",children:"2025 "})]})}),e.jsxs("button",{onClick:()=>f(!0),className:"relative hidden md:flex items-center w-64 h-9 pl-9 pr-16 bg-background/50 border rounded-md hover:bg-accent/50 transition-colors text-left",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"..."}),e.jsxs(Eb,{size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2",children:[e.jsx("span",{className:"text-xs",children:""}),"K"]})]}),e.jsx(W5,{open:h,onOpenChange:f}),e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>window.open("https://docs.mai-mai.org","_blank"),className:"gap-2",title:"",children:[e.jsx(W_,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsx("button",{onClick:S=>{c2(O==="dark"?"light":"dark",v,S)},className:"rounded-lg p-2 hover:bg-accent",title:O==="dark"?"":"",children:O==="dark"?e.jsx(ax,{className:"h-5 w-5"}):e.jsx(ec,{className:"h-5 w-5"})}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsxs(_,{variant:"ghost",size:"sm",onClick:R,className:"gap-2",title:"",children:[e.jsx(e1,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]})]}),e.jsx("main",{className:"flex-1 overflow-hidden bg-background",children:a}),e.jsx(sT,{})]})]})})}function rT(a){const n=a.split(`
`).slice(1),r=[];for(const c of n){const d=c.trim();if(!d.startsWith("at "))continue;const u=d.match(/at\s+(?:(.+?)\s+\()?(.+?):(\d+):(\d+)\)?$/);u?r.push({functionName:u[1]||"<anonymous>",fileName:u[2],lineNumber:u[3],columnNumber:u[4],raw:d}):r.push({functionName:"<unknown>",fileName:"",lineNumber:"",columnNumber:"",raw:d})}return r}function iT({error:a,errorInfo:n}){const[r,c]=m.useState(!0),[d,u]=m.useState(!1),[h,f]=m.useState(!1),p=a.stack?rT(a.stack):[],g=async()=>{const N=`
Error: ${a.name}
Message: ${a.message}

Stack Trace:
${a.stack||"No stack trace available"}

Component Stack:
${n?.componentStack||"No component stack available"}

URL: ${window.location.href}
User Agent: ${navigator.userAgent}
Time: ${new Date().toISOString()}
    `.trim();try{await navigator.clipboard.writeText(N),f(!0),setTimeout(()=>f(!1),2e3)}catch(v){console.error("Failed to copy:",v)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(at,{variant:"destructive",className:"border-red-500/50 bg-red-500/10",children:[e.jsx(Jt,{className:"h-4 w-4"}),e.jsxs(lt,{className:"font-mono text-sm",children:[e.jsxs("span",{className:"font-semibold",children:[a.name,":"]})," ",a.message]})]}),p.length>0&&e.jsxs(uc,{open:r,onOpenChange:c,children:[e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[e.jsxs("span",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(s1,{className:"h-4 w-4"}),"Stack Trace (",p.length," frames)"]}),r?e.jsx(Qr,{className:"h-4 w-4"}):e.jsx(za,{className:"h-4 w-4"})]})}),e.jsx(xc,{children:e.jsx(Je,{className:"h-[280px] rounded-md border bg-muted/30",children:e.jsx("div",{className:"p-3 space-y-1",children:p.map((N,v)=>e.jsx("div",{className:"font-mono text-xs p-2 rounded hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"text-muted-foreground w-6 text-right flex-shrink-0",children:[v+1,"."]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-primary font-medium",children:N.functionName}),N.fileName&&e.jsxs("div",{className:"text-muted-foreground mt-0.5 break-all",children:[N.fileName,N.lineNumber&&e.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400",children:[":",N.lineNumber,":",N.columnNumber]})]})]})]})},v))})})})]}),n?.componentStack&&e.jsxs(uc,{open:d,onOpenChange:u,children:[e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[e.jsxs("span",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(Jt,{className:"h-4 w-4"}),"Component Stack"]}),d?e.jsx(Qr,{className:"h-4 w-4"}):e.jsx(za,{className:"h-4 w-4"})]})}),e.jsx(xc,{children:e.jsx(Je,{className:"h-[200px] rounded-md border bg-muted/30",children:e.jsx("pre",{className:"p-3 font-mono text-xs whitespace-pre-wrap text-muted-foreground",children:n.componentStack})})})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:g,className:"w-full",children:h?e.jsxs(e.Fragment,{children:[e.jsx(Ct,{className:"mr-2 h-4 w-4 text-green-500"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Fo,{className:"mr-2 h-4 w-4"}),""]})})]})}function Ab({error:a,errorInfo:n}){const r=()=>{window.location.href="/"},c=()=>{window.location.reload()};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs(Ce,{className:"w-full max-w-2xl shadow-lg",children:[e.jsxs(De,{className:"text-center pb-2",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/30 mb-4",children:e.jsx(Jt,{className:"h-8 w-8 text-red-600 dark:text-red-400"})}),e.jsx(Oe,{className:"text-2xl font-bold",children:""}),e.jsx(os,{className:"text-base mt-2",children:""})]}),e.jsxs(Me,{className:"space-y-4",children:[e.jsx(iT,{error:a,errorInfo:n}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-2",children:[e.jsxs(_,{onClick:c,className:"flex-1",children:[e.jsx(dt,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:r,variant:"outline",className:"flex-1",children:[e.jsx(nd,{className:"mr-2 h-4 w-4"}),""]})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground pt-2",children:""})]})]})})}class cT extends m.Component{constructor(n){super(n),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("ErrorBoundary caught an error:",n,r),this.setState({errorInfo:r})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError&&this.state.error?this.props.fallback?this.props.fallback:e.jsx(Ab,{error:this.state.error,errorInfo:this.state.errorInfo}):this.props.children}}function zb({error:a}){return e.jsx(Ab,{error:a,errorInfo:null})}const vc=Z0({component:()=>e.jsxs(e.Fragment,{children:[e.jsx(rj,{}),!1]}),beforeLoad:()=>{if(window.location.pathname==="/"&&!J5())throw ew({to:"/auth"})}}),oT=Qs({getParentRoute:()=>vc,path:"/auth",component:E2}),dT=Qs({getParentRoute:()=>vc,path:"/setup",component:G2}),nt=Qs({getParentRoute:()=>vc,id:"protected",component:()=>e.jsx(nT,{children:e.jsx(rj,{})}),errorComponent:({error:a})=>e.jsx(zb,{error:a})}),uT=Qs({getParentRoute:()=>nt,path:"/",component:l2}),mT=Qs({getParentRoute:()=>nt,path:"/config/bot",component:wS}),xT=Qs({getParentRoute:()=>nt,path:"/config/modelProvider",component:OS}),hT=Qs({getParentRoute:()=>nt,path:"/config/model",component:r4}),fT=Qs({getParentRoute:()=>nt,path:"/config/adapter",component:T4}),pT=Qs({getParentRoute:()=>nt,path:"/resource/emoji",component:X4}),gT=Qs({getParentRoute:()=>nt,path:"/resource/expression",component:sk}),jT=Qs({getParentRoute:()=>nt,path:"/resource/person",component:Sk}),vT=Qs({getParentRoute:()=>nt,path:"/resource/jargon",component:fk}),NT=Qs({getParentRoute:()=>nt,path:"/resource/knowledge-graph",component:Dk}),bT=Qs({getParentRoute:()=>nt,path:"/resource/knowledge-base",component:Ok}),yT=Qs({getParentRoute:()=>nt,path:"/logs",component:Uk}),wT=Qs({getParentRoute:()=>nt,path:"/planner-monitor",component:qk}),_T=Qs({getParentRoute:()=>nt,path:"/chat",component:AC}),ST=Qs({getParentRoute:()=>nt,path:"/plugins",component:mC}),kT=Qs({getParentRoute:()=>nt,path:"/plugin-detail",component:yC}),CT=Qs({getParentRoute:()=>nt,path:"/model-presets",component:hC}),TT=Qs({getParentRoute:()=>nt,path:"/plugin-config",component:gC}),ET=Qs({getParentRoute:()=>nt,path:"/plugin-mirrors",component:vC}),MT=Qs({getParentRoute:()=>nt,path:"/settings",component:y2}),AT=Qs({getParentRoute:()=>nt,path:"/config/pack-market",component:M5}),Rb=Qs({getParentRoute:()=>nt,path:"/config/pack-market/$packId",component:q5}),zT=Qs({getParentRoute:()=>nt,path:"/survey/webui-feedback",component:KC}),RT=Qs({getParentRoute:()=>nt,path:"/survey/maibot-feedback",component:QC}),DT=Qs({getParentRoute:()=>nt,path:"/annual-report",component:e5}),OT=Qs({getParentRoute:()=>vc,path:"*",component:Pv}),LT=vc.addChildren([oT,dT,nt.addChildren([uT,mT,xT,hT,fT,pT,gT,vT,jT,NT,bT,ST,kT,CT,TT,ET,yT,wT,_T,MT,AT,Rb,zT,RT,DT]),OT]),UT=W0({routeTree:LT,defaultNotFoundComponent:Pv,defaultErrorComponent:({error:a})=>e.jsx(zb,{error:a})});function $T({children:a,defaultTheme:n="system",storageKey:r="ui-theme",...c}){const[d,u]=m.useState(()=>localStorage.getItem(r)||n);m.useEffect(()=>{const f=window.document.documentElement;if(f.classList.remove("light","dark"),d==="system"){const p=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";f.classList.add(p);return}f.classList.add(d)},[d]),m.useEffect(()=>{const f=localStorage.getItem("accent-color");if(f){const p=document.documentElement,N={blue:{hsl:"221.2 83.2% 53.3%",darkHsl:"217.2 91.2% 59.8%",gradient:null},purple:{hsl:"271 91% 65%",darkHsl:"270 95% 75%",gradient:null},green:{hsl:"142 71% 45%",darkHsl:"142 76% 36%",gradient:null},orange:{hsl:"25 95% 53%",darkHsl:"20 90% 48%",gradient:null},pink:{hsl:"330 81% 60%",darkHsl:"330 85% 70%",gradient:null},red:{hsl:"0 84% 60%",darkHsl:"0 90% 70%",gradient:null},"gradient-sunset":{hsl:"15 95% 60%",darkHsl:"15 95% 65%",gradient:"linear-gradient(135deg, hsl(25 95% 53%) 0%, hsl(330 81% 60%) 100%)"},"gradient-ocean":{hsl:"200 90% 55%",darkHsl:"200 90% 60%",gradient:"linear-gradient(135deg, hsl(221.2 83.2% 53.3%) 0%, hsl(189 94% 43%) 100%)"},"gradient-forest":{hsl:"150 70% 45%",darkHsl:"150 75% 40%",gradient:"linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%)"},"gradient-aurora":{hsl:"310 85% 65%",darkHsl:"310 90% 70%",gradient:"linear-gradient(135deg, hsl(271 91% 65%) 0%, hsl(330 81% 60%) 100%)"},"gradient-fire":{hsl:"15 95% 55%",darkHsl:"15 95% 60%",gradient:"linear-gradient(135deg, hsl(0 84% 60%) 0%, hsl(25 95% 53%) 100%)"},"gradient-twilight":{hsl:"250 90% 60%",darkHsl:"250 95% 65%",gradient:"linear-gradient(135deg, hsl(239 84% 67%) 0%, hsl(271 91% 65%) 100%)"}}[f];N&&(p.style.setProperty("--primary",N.hsl),N.gradient?(p.style.setProperty("--primary-gradient",N.gradient),p.classList.add("has-gradient")):(p.style.removeProperty("--primary-gradient"),p.classList.remove("has-gradient")))}},[]);const h={theme:d,setTheme:f=>{localStorage.setItem(r,f),u(f)}};return e.jsx(Ov.Provider,{...c,value:h,children:a})}function BT({children:a,defaultEnabled:n=!0,defaultWavesEnabled:r=!0,storageKey:c="enable-animations",wavesStorageKey:d="enable-waves-background"}){const[u,h]=m.useState(()=>{const N=localStorage.getItem(c);return N!==null?N==="true":n}),[f,p]=m.useState(()=>{const N=localStorage.getItem(d);return N!==null?N==="true":r});m.useEffect(()=>{const N=document.documentElement;u?N.classList.remove("no-animations"):N.classList.add("no-animations"),localStorage.setItem(c,String(u))},[u,c]),m.useEffect(()=>{localStorage.setItem(d,String(f))},[f,d]);const g={enableAnimations:u,setEnableAnimations:h,enableWavesBackground:f,setEnableWavesBackground:p};return e.jsx(Lv.Provider,{value:g,children:a})}const PT=j_,Db=m.forwardRef(({className:a,...n},r)=>e.jsx(Kj,{ref:r,className:I("fixed bottom-0 right-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:max-w-[420px] gap-2",a),...n}));Db.displayName=Kj.displayName;const IT=Wr("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-slide-in-from-right data-[state=open]:animate-fade-in data-[state=closed]:animate-slide-out-to-right data-[state=closed]:animate-fade-out data-[swipe=end]:animate-slide-out-to-right",{variants:{variant:{default:"border bg-primary/5 text-foreground backdrop-blur-sm",destructive:"destructive group border-destructive bg-destructive/10 text-destructive-foreground backdrop-blur-sm"}},defaultVariants:{variant:"default"}}),Ob=m.forwardRef(({className:a,variant:n,...r},c)=>e.jsx(Qj,{ref:c,className:I(IT({variant:n}),a),...r}));Ob.displayName=Qj.displayName;const FT=m.forwardRef(({className:a,...n},r)=>e.jsx(Yj,{ref:r,className:I("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",a),...n}));FT.displayName=Yj.displayName;const Lb=m.forwardRef(({className:a,...n},r)=>e.jsx(Jj,{ref:r,className:I("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),"toast-close":"",...n,children:e.jsx(Aa,{className:"h-4 w-4"})}));Lb.displayName=Jj.displayName;const Ub=m.forwardRef(({className:a,...n},r)=>e.jsx(Xj,{ref:r,className:I("text-sm font-semibold [&+div]:text-xs",a),...n}));Ub.displayName=Xj.displayName;const $b=m.forwardRef(({className:a,...n},r)=>e.jsx(Zj,{ref:r,className:I("text-sm opacity-90",a),...n}));$b.displayName=Zj.displayName;function HT(){const{toasts:a}=Ys();return e.jsxs(PT,{children:[a.map(function({id:n,title:r,description:c,action:d,...u}){return e.jsxs(Ob,{...u,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(Ub,{children:r}),c&&e.jsx($b,{children:c})]}),d,e.jsx(Lb,{})]},n)}),e.jsx(Db,{})]})}A1.createRoot(document.getElementById("root")).render(e.jsx(m.StrictMode,{children:e.jsx(cT,{children:e.jsx($T,{defaultTheme:"system",children:e.jsx(BT,{children:e.jsxs(ES,{children:[e.jsx(sw,{router:UT}),e.jsx(zS,{}),e.jsx(HT,{})]})})})})}));
